\doxysection{openphase\+::Stabilization\+Impl Class Reference}
\hypertarget{classopenphase_1_1StabilizationImpl}{}\label{classopenphase_1_1StabilizationImpl}\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}}
Inheritance diagram for openphase\+::Stabilization\+Impl\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{df/d89/classopenphase_1_1StabilizationImpl}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a818c1d125487481dd2999b46cf96e9ed}{Stabilization\+Impl}} ()
\item 
\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a68235c58f44735253f3fc804bba0f290}{Stabilization\+Impl}} (\mbox{\hyperlink{classopenphase_1_1Settings}{Settings}} \&loc\+Settings)
\item 
void \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a720007b30873ce5a645b0e553bb26ebc}{Initialize}} (\mbox{\hyperlink{classopenphase_1_1Settings}{Settings}} \&loc\+Settings)
\item 
void \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a0d52d878b467d8e4a87b096f3c229034}{Initialize}} (\mbox{\hyperlink{classopenphase_1_1Settings}{Settings}} \&loc\+Settings, \mbox{\hyperlink{classopenphase_1_1LaplacianStencil}{Laplacian\+Stencil}} \+\_\+\+DStencil)
\item 
void \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_aaaed9390e70d7c8f511a249604cfc749}{Read\+Input}} (const std\+::string File\+Name) override
\item 
void \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a6ebce2b982b011038ea5061d9ad800db}{Read\+Input}} (std\+::stringstream \&inp) override
\item 
void \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a458c5fa7b6665d0e03729fac788cf0ea}{Calculate\+Curvature}} (\mbox{\hyperlink{classopenphase_1_1PhaseField}{Phase\+Field}} \&\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}})
\item 
void \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a5dfccaef919082beef95882b0d177fd6}{Calculate\+Curvature\+\_\+\+SPF}} (\mbox{\hyperlink{classopenphase_1_1PhaseField}{Phase\+Field}} \&\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}})
\item 
void \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a9f3f3fc49e1c15863a7fc214eea724d6}{Calculate\+Average\+Curvature}} (\mbox{\hyperlink{classopenphase_1_1PhaseField}{Phase\+Field}} \&\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}})
\item 
void \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a42447a8f1f7777442fb8e62b6438e41e}{Calculate\+Average\+Curvature\+Regularization}} (\mbox{\hyperlink{classopenphase_1_1PhaseField}{Phase\+Field}} \&\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}})
\item 
void \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a7353d803d6235133a1dcbe1e6ef2db3c}{Calculate\+Average\+Curvature\+Normal}} (\mbox{\hyperlink{classopenphase_1_1PhaseField}{Phase\+Field}} \&\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}})
\item 
void \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_adf8f0d8715c49b7dcf5042fb51edb4a3}{Calculate\+Average\+Curvature\+Normal\+Snap}} (\mbox{\hyperlink{classopenphase_1_1PhaseField}{Phase\+Field}} \&\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}})
\item 
void \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a60753afd1767ebfb4aab9e6ce850a07a}{Calculate\+Average\+Curvature\+Simple}} (\mbox{\hyperlink{classopenphase_1_1PhaseField}{Phase\+Field}} \&\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}})
\item 
void \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_abce5a0c9dc868eb3cc4304b4bad0beec}{Compute\+Velocity}} (\mbox{\hyperlink{classopenphase_1_1PhaseField}{Phase\+Field}} \&\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}, \mbox{\hyperlink{classopenphase_1_1InterfaceProperties}{Interface\+Properties}} \&IP, \mbox{\hyperlink{classopenphase_1_1DrivingForce}{Driving\+Force}} \&dG)
\item 
void \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a3615aa9c3294a85283d978de8fdb3294}{Compute\+Update}} (\mbox{\hyperlink{classopenphase_1_1PhaseField}{Phase\+Field}} \&\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}, \mbox{\hyperlink{classopenphase_1_1DrivingForce}{Driving\+Force}} \&dG, double dt)
\item 
double \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a5c0667db3e15eece5b44f3232d18b58a}{Get\+Max\+DT}} ()
\item 
void \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a0c3f92b617405dcc60a7799b50641baf}{Smooth}} (\mbox{\hyperlink{classopenphase_1_1PhaseField}{Phase\+Field}} \&\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}})
\item 
void \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_ae1b22babe0ee2f7697d48dd5b966e417}{Write\+VTK}} (const \mbox{\hyperlink{classopenphase_1_1Settings}{Settings}} \&loc\+Settings, const int t\+Step, const size\+\_\+t indexA, const size\+\_\+t indexB, const int precision) const
\item 
virtual void \mbox{\hyperlink{classopenphase_1_1OPObject_ab7b5d4fd526d189f269fade8896a789c}{Initialize}} (\mbox{\hyperlink{classopenphase_1_1Settings}{Settings}} \&loc\+Settings, std\+::string Object\+Name\+Suffix="{}"{})
\item 
virtual void \mbox{\hyperlink{classopenphase_1_1OPObject_a2dbefda68bf2a6123a095d4776f67cab}{Move\+Frame}} (const int dx, const int dy, const int dz, const \mbox{\hyperlink{classopenphase_1_1BoundaryConditions}{Boundary\+Conditions}} \&BC)
\item 
virtual void \mbox{\hyperlink{classopenphase_1_1OPObject_af421c7d819be4718f586fb3f97c34583}{Remesh}} (int new\+Nx, int new\+Ny, int new\+Nz, const \mbox{\hyperlink{classopenphase_1_1BoundaryConditions}{Boundary\+Conditions}} \&BC)
\item 
virtual void \mbox{\hyperlink{classopenphase_1_1OPObject_afd82ead485f6d9695aa733729100614c}{Advect}} (\mbox{\hyperlink{classopenphase_1_1AdvectionHR}{Advection\+HR}} \&Adv, const \mbox{\hyperlink{classopenphase_1_1Velocities}{Velocities}} \&Vel, \mbox{\hyperlink{classopenphase_1_1PhaseField}{Phase\+Field}} \&\mbox{\hyperlink{namespaceopenphase_a44913b19d54d780a4b9e00fcab11cbb6}{Phi}}, const \mbox{\hyperlink{classopenphase_1_1BoundaryConditions}{Boundary\+Conditions}} \&BC, const double dt, const double t\+Step)
\item 
virtual bool \mbox{\hyperlink{classopenphase_1_1OPObject_adbd36cc2fee5c391f60f52ecd6114d2c}{Read}} (const \mbox{\hyperlink{classopenphase_1_1Settings}{Settings}} \&loc\+Settings, const \mbox{\hyperlink{classopenphase_1_1BoundaryConditions}{Boundary\+Conditions}} \&BC, const int t\+Step)
\item 
virtual bool \mbox{\hyperlink{classopenphase_1_1OPObject_a2b2d60f99c90b6fc30f52b516ee0df2b}{Write}} (const \mbox{\hyperlink{classopenphase_1_1Settings}{Settings}} \&loc\+Settings, const int t\+Step) const
\begin{DoxyCompactList}\small\item\em \texorpdfstring{$<$}{<} Writes binary output \end{DoxyCompactList}\item 
virtual void \mbox{\hyperlink{classopenphase_1_1OPObject_a098bf706cf87cf06361ec9bca1c7d32c}{Set\+Boundary\+Conditions}} (const \mbox{\hyperlink{classopenphase_1_1BoundaryConditions}{Boundary\+Conditions}} \&BC)
\end{DoxyCompactItemize}
\doxysubsubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static \mbox{\hyperlink{classopenphase_1_1OPObject}{OPObject}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{classopenphase_1_1OPObject_af6910712da7e1d8d4df869a36cc41fb1}{Find\+Object}} (std\+::vector$<$ \mbox{\hyperlink{classopenphase_1_1OPObject}{OPObject}} \texorpdfstring{$\ast$}{*} $>$ Object\+List, std\+::string Object\+Name, std\+::string \mbox{\hyperlink{classopenphase_1_1OPObject_a9006e8f49762d851b52708b363ba14f2}{thisclassname}}, std\+::string thisfunctionname, bool necessary, bool verbose=true)
\item 
static std\+::vector$<$ \mbox{\hyperlink{classopenphase_1_1OPObject}{OPObject}} \texorpdfstring{$\ast$}{*} $>$ \mbox{\hyperlink{classopenphase_1_1OPObject_aa710a4052d686aac0b3f38a9a615682e}{Find\+Objects}} (std\+::vector$<$ \mbox{\hyperlink{classopenphase_1_1OPObject}{OPObject}} \texorpdfstring{$\ast$}{*} $>$ Object\+List, std\+::string Object\+Name, std\+::string \mbox{\hyperlink{classopenphase_1_1OPObject_a9006e8f49762d851b52708b363ba14f2}{thisclassname}}, std\+::string thisfunctionname, bool necessary, bool verbose=true)
\end{DoxyCompactItemize}
\doxysubsubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classopenphase_1_1Storage3D}{Storage3D}}$<$ \mbox{\hyperlink{classopenphase_1_1NodePF}{Node\+PF}}, 0 $>$ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_abcb3da65d0437d93a0ffb25c3f5e71a8}{Average\+Curvature}}
\item 
\mbox{\hyperlink{classopenphase_1_1Storage3D}{Storage3D}}$<$ \mbox{\hyperlink{classopenphase_1_1NodePF}{Node\+PF}}, 0 $>$ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a23018d7acc8f9d117be93bd4e040aa85}{Average\+Curvature\+Weight}}
\item 
\mbox{\hyperlink{classopenphase_1_1Storage3D}{Storage3D}}$<$ \mbox{\hyperlink{classopenphase_1_1NodePF}{Node\+PF}}, 0 $>$ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a88de321d75e4df7048b19ba200c95a1d}{Average\+Curvature\+Aux}}
\item 
\mbox{\hyperlink{classopenphase_1_1Storage3D}{Storage3D}}$<$ \mbox{\hyperlink{classopenphase_1_1NodePF}{Node\+PF}}, 0 $>$ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a281828ecf220bcea9081aaa7b16d122a}{Average\+Curvature\+Aux\+Weight}}
\item 
\mbox{\hyperlink{classopenphase_1_1Storage3D}{Storage3D}}$<$ \mbox{\hyperlink{classopenphase_1_1NodePF}{Node\+PF}}, 0 $>$ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a246515fab4f0968c8427b13aec75c737}{Curvature}}
\item 
\mbox{\hyperlink{classopenphase_1_1Storage3D}{Storage3D}}$<$ \mbox{\hyperlink{classopenphase_1_1NodePF}{Node\+PF}}, 0 $>$ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a135732ea710428502c6e1a99998f6b20}{Average\+Interface}}
\item 
\mbox{\hyperlink{classopenphase_1_1Storage3D}{Storage3D}}$<$ \mbox{\hyperlink{classopenphase_1_1NodePF}{Node\+PF}}, 0 $>$ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a17b62c9d05638005288801132ac70f7d}{Average\+Interface\+Weight}}
\item 
\mbox{\hyperlink{classopenphase_1_1Storage3D}{Storage3D}}$<$ \mbox{\hyperlink{classopenphase_1_1NodePF}{Node\+PF}}, 0 $>$ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a32f128b0714e28d3117de25afa3c3653}{Average\+Interface\+Aux}}
\item 
\mbox{\hyperlink{classopenphase_1_1Storage3D}{Storage3D}}$<$ \mbox{\hyperlink{classopenphase_1_1NodePF}{Node\+PF}}, 0 $>$ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a30033c931fec65ad587d59b674b98541}{Average\+Interface\+Aux\+Weight}}
\item 
\mbox{\hyperlink{classopenphase_1_1Storage3D}{Storage3D}}$<$ \mbox{\hyperlink{classopenphase_1_1NodePF}{Node\+PF}}, 0 $>$ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a106646554b97f07c33196ab4104822ec}{Interface}}
\item 
\mbox{\hyperlink{classopenphase_1_1Storage3D}{Storage3D}}$<$ \mbox{\hyperlink{classopenphase_1_1NodeAB}{Node\+AB}}$<$ double, double $>$, 0 $>$ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_aba3c1835d0779921de0474313c8aeecc}{Velocity}}
\item 
double \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a071e83a8af60c35d4813698976d2b0cc}{maxvelocity}}
\item 
double \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_addd3d5ec1cf53f50a7991ef63d989044}{maxdt}}
\item 
\mbox{\hyperlink{classopenphase_1_1GridParameters}{Grid\+Parameters}} \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}}
\begin{DoxyCompactList}\small\item\em Simulation grid parameters. \end{DoxyCompactList}\item 
std\+::string \mbox{\hyperlink{classopenphase_1_1OPObject_a9006e8f49762d851b52708b363ba14f2}{thisclassname}}
\begin{DoxyCompactList}\small\item\em Object\textquotesingle{}s implementation class name. \end{DoxyCompactList}\item 
std\+::string \mbox{\hyperlink{classopenphase_1_1OPObject_ac8c040bdc306f76b58d5a79201e5df66}{thisobjectname}}
\begin{DoxyCompactList}\small\item\em Object\textquotesingle{}s name. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classopenphase_1_1OPObject_aa112048d179026f359161b1f20e5e98e}{initialized}} = false
\begin{DoxyCompactList}\small\item\em True if obect\textquotesingle{}s Initialize has been executed. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classopenphase_1_1OPObject_a65ef7d7ae73be8f9a7fa626762c4937d}{input\+\_\+read}} = false
\begin{DoxyCompactList}\small\item\em True if obect\textquotesingle{}s \doxylink{classopenphase_1_1OPObject_a9c766ff0ddd3866b7c2f2f83ebebcf31}{Read\+Input()} has been executed. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classopenphase_1_1OPObject_a44d40bc5a3ef87d7c461b457e01091dd}{remeshable}} = false
\begin{DoxyCompactList}\small\item\em True if the object has non-\/empty \doxylink{classopenphase_1_1OPObject_af421c7d819be4718f586fb3f97c34583}{Remesh()} method. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classopenphase_1_1OPObject_a7f54d22dc59afcace6359f599fabcaac}{advectable}} = false
\begin{DoxyCompactList}\small\item\em True if the object has non-\/empty \doxylink{classopenphase_1_1OPObject_afd82ead485f6d9695aa733729100614c}{Advect()} method. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classopenphase_1_1OPObject_aa5b7ff7b56e2d266c2fd59b620a1603b}{readable}} = false
\begin{DoxyCompactList}\small\item\em True if the object has non-\/empty \doxylink{classopenphase_1_1OPObject_adbd36cc2fee5c391f60f52ecd6114d2c}{Read()} method. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classopenphase_1_1OPObject_a49a9d1e352e5dafc93f493012d527ee1}{boundary\+\_\+conditions}} = false
\begin{DoxyCompactList}\small\item\em True if the object has non-\/empty \doxylink{classopenphase_1_1OPObject_a098bf706cf87cf06361ec9bca1c7d32c}{Set\+Boundary\+Conditions()} \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classopenphase_1_1LaplacianStencil}{Laplacian\+Stencil}} \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a4d0ae7e8e12a38a3cdbaa8582e9a9f8a}{DStencil}}
\item 
double \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a7861e796060fff81c6cc84c553e43b17}{exponent}}
\item 
double \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}
\item 
double \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a50c82db68405e2180be417ad58df0f22}{STAB}}
\item 
std\+::vector$<$ double $>$ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_ad9f96040f8b817329567ddd4fa708717}{n\+\_\+vector}}
\item 
std\+::vector$<$ \mbox{\hyperlink{classopenphase_1_1StencilDirection}{Stencil\+Direction}} $>$ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a4cdea978e722c0bee973f487f92514f7}{Stencil\+Directions}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00060}{60}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.



\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classopenphase_1_1StabilizationImpl_a818c1d125487481dd2999b46cf96e9ed}\label{classopenphase_1_1StabilizationImpl_a818c1d125487481dd2999b46cf96e9ed} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!StabilizationImpl@{StabilizationImpl}}
\index{StabilizationImpl@{StabilizationImpl}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{StabilizationImpl()}{StabilizationImpl()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily openphase\+::\+Stabilization\+Impl\+::\+Stabilization\+Impl (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00187}{187}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00188\ \{}
\DoxyCodeLine{00189\ }
\DoxyCodeLine{00190\ \}}

\end{DoxyCode}
\Hypertarget{classopenphase_1_1StabilizationImpl_a68235c58f44735253f3fc804bba0f290}\label{classopenphase_1_1StabilizationImpl_a68235c58f44735253f3fc804bba0f290} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!StabilizationImpl@{StabilizationImpl}}
\index{StabilizationImpl@{StabilizationImpl}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{StabilizationImpl()}{StabilizationImpl()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily openphase\+::\+Stabilization\+Impl\+::\+Stabilization\+Impl (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classopenphase_1_1Settings}{Settings}} \&}]{loc\+Settings }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00192}{192}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00193\ \{}
\DoxyCodeLine{00194\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a720007b30873ce5a645b0e553bb26ebc}{Initialize}}(locSettings);}
\DoxyCodeLine{00195\ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classopenphase_1_1OPObject_afd82ead485f6d9695aa733729100614c}\label{classopenphase_1_1OPObject_afd82ead485f6d9695aa733729100614c} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!Advect@{Advect}}
\index{Advect@{Advect}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{Advect()}{Advect()}}
{\footnotesize\ttfamily virtual void openphase\+::\+OPObject\+::\+Advect (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classopenphase_1_1AdvectionHR}{Advection\+HR}} \&}]{Adv,  }\item[{const \mbox{\hyperlink{classopenphase_1_1Velocities}{Velocities}} \&}]{Vel,  }\item[{\mbox{\hyperlink{classopenphase_1_1PhaseField}{Phase\+Field}} \&}]{Phi,  }\item[{const \mbox{\hyperlink{classopenphase_1_1BoundaryConditions}{Boundary\+Conditions}} \&}]{BC,  }\item[{const double}]{dt,  }\item[{const double}]{t\+Step }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}


\begin{DoxyParams}{Parameters}
{\em t\+Step} & Advects relevant fields \\
\hline
\end{DoxyParams}


Reimplemented in \mbox{\hyperlink{classopenphase_1_1Composition_a6ee3785e72c0180118ef05c83e490bbf}{openphase\+::\+Composition}}, \mbox{\hyperlink{classopenphase_1_1ElasticProperties_af1d84be6585c0737a194d465054d4a56}{openphase\+::\+Elastic\+Properties}}, \mbox{\hyperlink{classopenphase_1_1FractureField_a02f3075805d6c88aac380c8e64edb476}{openphase\+::\+Fracture\+Field}}, \mbox{\hyperlink{classopenphase_1_1GrandPotentialSolver_a06d388daf0eb61ee202ddd036c1711f4}{openphase\+::\+Grand\+Potential\+Solver}}, \mbox{\hyperlink{classopenphase_1_1Orientations_a9dde57a361a724f5cd7f73a6589bc75b}{openphase\+::\+Orientations}}, \mbox{\hyperlink{classopenphase_1_1PhaseField_aca24a7b03b7fba39de79695ef541937e}{openphase\+::\+Phase\+Field}}, \mbox{\hyperlink{classopenphase_1_1Temperature_a066369acadd4bf1555850a255a70e211}{openphase\+::\+Temperature}}, and \mbox{\hyperlink{classopenphase_1_1Velocities_ac7b998d9b85443c730de36d54fb1a8cc}{openphase\+::\+Velocities}}.



Definition at line \mbox{\hyperlink{OPObject_8h_source_l00097}{97}} of file \mbox{\hyperlink{OPObject_8h_source}{OPObject.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00100\ \ \ \ \ \{}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ (void)\ Adv;\ \ \ \textcolor{comment}{//unused}}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ (void)\ Vel;\ \ \ \textcolor{comment}{//unused}}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ (void)\ \mbox{\hyperlink{namespaceopenphase_a44913b19d54d780a4b9e00fcab11cbb6}{Phi}};\ \ \ \textcolor{comment}{//unused}}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ (void)\ BC;\ \ \ \ \textcolor{comment}{//unused}}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ (void)\ dt;\ \ \ \ \textcolor{comment}{//unused}}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ (void)\ tStep;\ \textcolor{comment}{//unused}}
\DoxyCodeLine{00107\ \ \ \ \ \}}

\end{DoxyCode}
\Hypertarget{classopenphase_1_1StabilizationImpl_a9f3f3fc49e1c15863a7fc214eea724d6}\label{classopenphase_1_1StabilizationImpl_a9f3f3fc49e1c15863a7fc214eea724d6} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!CalculateAverageCurvature@{CalculateAverageCurvature}}
\index{CalculateAverageCurvature@{CalculateAverageCurvature}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{CalculateAverageCurvature()}{CalculateAverageCurvature()}}
{\footnotesize\ttfamily void openphase\+::\+Stabilization\+Impl\+::\+Calculate\+Average\+Curvature (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classopenphase_1_1PhaseField}{Phase\+Field}} \&}]{Phase }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00396}{396}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00397\ \{}
\DoxyCodeLine{00398\ \ \ \ \ \textcolor{keyword}{auto}\&\ PF\ =\ (\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}}.\mbox{\hyperlink{classopenphase_1_1GridParameters_af0b28822d6a3aba3df4db780b51db71a}{Resolution}}\ ==\ \mbox{\hyperlink{namespaceopenphase_a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e}{Resolutions::Single}})?\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.Fields:\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.FieldsDR;}
\DoxyCodeLine{00399\ }
\DoxyCodeLine{00400\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,PF.Bcells(),)}
\DoxyCodeLine{00401\ \ \ \ \ \{}
\DoxyCodeLine{00402\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_abcb3da65d0437d93a0ffb25c3f5e71a8}{AverageCurvature}}(i,j,k).clear();}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a23018d7acc8f9d117be93bd4e040aa85}{AverageCurvatureWeight}}(i,j,k).clear();}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a88de321d75e4df7048b19ba200c95a1d}{AverageCurvatureAux}}(i,j,k).clear();}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a281828ecf220bcea9081aaa7b16d122a}{AverageCurvatureAuxWeight}}(i,j,k).clear();}
\DoxyCodeLine{00406\ \ \ \ \ \}}
\DoxyCodeLine{00407\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00408\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,0,)}
\DoxyCodeLine{00409\ \ \ \ \ \{}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i,j,k).wide\_interface())}
\DoxyCodeLine{00411\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00412\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ alpha\ \ =\ PF(i,j,k).cbegin();}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ !=\ PF(i,j,k).cend();\ ++alpha)}
\DoxyCodeLine{00414\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ii\ =\ -\/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNx();\ ii\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNx();\ ++ii)}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ jj\ =\ -\/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNy();\ jj\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNy();\ ++jj)}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ kk\ =\ -\/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNz();\ kk\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNz();\ ++kk)}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ii*ii+jj*jj+kk*kk\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}})}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ +\ ii\ >=\ -\/PF.Bcells()+1\ \&\&\ i+\ ii\ <\ PF.sizeX()+PF.Bcells()-\/1)}
\DoxyCodeLine{00420\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ +\ jj\ >=\ -\/PF.Bcells()+1\ \&\&\ j+\ jj\ <\ PF.sizeY()+PF.Bcells()-\/1)}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (k\ +\ kk\ >=\ -\/PF.Bcells()+1\ \&\&\ k+\ kk\ <\ PF.sizeZ()+PF.Bcells()-\/1)}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00423\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i+ii,j+jj,k+kk).wide\_interface()\ \ \&\&\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a246515fab4f0968c8427b13aec75c737}{Curvature}}(i+ii,j+jj,k+kk).get\_value(alpha-\/>index)\ !=\ 0.0)}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00425\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ dist\ =\ sqrt(ii*ii\ +\ jj*jj\ +\ kk*kk);}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ locPhiAlphaValue\ =\ PF(i+ii,j+jj,k+kk).get\_value(alpha-\/>index);}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ weight\ =\ std::pow(locPhiAlphaValue\ *\ (1.0-\/locPhiAlphaValue),\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a7861e796060fff81c6cc84c553e43b17}{exponent}})*(\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}-\/dist);}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a88de321d75e4df7048b19ba200c95a1d}{AverageCurvatureAux}}(i,j,k).add\_value(alpha-\/>index,\ weight*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a246515fab4f0968c8427b13aec75c737}{Curvature}}(i+ii,j+jj,k+kk).get\_value(alpha-\/>index));}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a281828ecf220bcea9081aaa7b16d122a}{AverageCurvatureAuxWeight}}(i,j,k).add\_value(alpha-\/>index,\ weight);}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00434\ \ \ \ \ \}}
\DoxyCodeLine{00435\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00436\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,0,)}
\DoxyCodeLine{00437\ \ \ \ \ \{}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i,j,k).wide\_interface())}
\DoxyCodeLine{00439\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ alpha\ \ =\ PF(i,j,k).cbegin();}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ !=\ PF(i,j,k).cend();\ ++alpha)}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a281828ecf220bcea9081aaa7b16d122a}{AverageCurvatureAuxWeight}}(i,j,k).get\_value(alpha-\/>index)\ !=\ 0.0)}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00445\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a88de321d75e4df7048b19ba200c95a1d}{AverageCurvatureAux}}(i,j,k).set\_value(alpha-\/>index,\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a88de321d75e4df7048b19ba200c95a1d}{AverageCurvatureAux}}(i,j,k).get\_value(alpha-\/>index)/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a281828ecf220bcea9081aaa7b16d122a}{AverageCurvatureAuxWeight}}(i,j,k).get\_value(alpha-\/>index));}
\DoxyCodeLine{00446\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00447\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00448\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00449\ \ \ \ \ \}}
\DoxyCodeLine{00450\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00451\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,0,)}
\DoxyCodeLine{00452\ \ \ \ \ \{}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i,j,k).wide\_interface())}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ alpha\ \ =\ PF(i,j,k).cbegin();}
\DoxyCodeLine{00456\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ !=\ PF(i,j,k).cend();\ ++alpha)}
\DoxyCodeLine{00457\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00458\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ii\ =\ -\/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNx();\ ii\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNx();\ ++ii)}
\DoxyCodeLine{00459\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ jj\ =\ -\/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNy();\ jj\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNy();\ ++jj)}
\DoxyCodeLine{00460\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ kk\ =\ -\/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNz();\ kk\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNz();\ ++kk)}
\DoxyCodeLine{00461\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ii*ii+jj*jj+kk*kk\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}})}
\DoxyCodeLine{00462\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ +\ ii\ >=\ -\/PF.Bcells()+1\ \&\&\ i\ +\ ii\ <\ PF.sizeX()+PF.Bcells()\ -\/1)}
\DoxyCodeLine{00463\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ +\ jj\ >=\ -\/PF.Bcells()+1\ \&\&\ j\ +\ jj\ <\ PF.sizeY()+PF.Bcells()\ -\/1)}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (k\ +\ kk\ >=\ -\/PF.Bcells()+1\ \&\&\ k\ +\ kk\ <\ PF.sizeZ()+PF.Bcells()\ -\/1)}
\DoxyCodeLine{00465\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00466\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i+ii,j+jj,k+kk).wide\_interface()\ \&\&\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a88de321d75e4df7048b19ba200c95a1d}{AverageCurvatureAux}}(i+ii,j+jj,k+kk).get\_value(alpha-\/>index)\ !=\ 0.0)}
\DoxyCodeLine{00467\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_abcb3da65d0437d93a0ffb25c3f5e71a8}{AverageCurvature}}(i,j,k).add\_value(alpha-\/>index,\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a88de321d75e4df7048b19ba200c95a1d}{AverageCurvatureAux}}(i+ii,j+jj,k+kk).get\_value(alpha-\/>index));}
\DoxyCodeLine{00469\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a23018d7acc8f9d117be93bd4e040aa85}{AverageCurvatureWeight}}(i,j,k).add\_value(alpha-\/>index,\ 1);}
\DoxyCodeLine{00470\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00471\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00472\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00473\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00474\ \ \ \ \ \}}
\DoxyCodeLine{00475\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00476\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,0,)}
\DoxyCodeLine{00477\ \ \ \ \ \{}
\DoxyCodeLine{00478\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i,j,k).wide\_interface())}
\DoxyCodeLine{00479\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00480\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ alpha\ \ =\ PF(i,j,k).cbegin();}
\DoxyCodeLine{00481\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ !=\ PF(i,j,k).cend();\ ++alpha)}
\DoxyCodeLine{00482\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00483\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a23018d7acc8f9d117be93bd4e040aa85}{AverageCurvatureWeight}}(i,j,k).get\_value(alpha-\/>index)\ !=\ 0.0)}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00485\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_abcb3da65d0437d93a0ffb25c3f5e71a8}{AverageCurvature}}(i,j,k).set\_value(alpha-\/>index,\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_abcb3da65d0437d93a0ffb25c3f5e71a8}{AverageCurvature}}(i,j,k).get\_value(alpha-\/>index)/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a23018d7acc8f9d117be93bd4e040aa85}{AverageCurvatureWeight}}(i,j,k).get\_value(alpha-\/>index));}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00487\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00489\ \ \ \ \ \}}
\DoxyCodeLine{00490\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00491\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,PF.Bcells(),)}
\DoxyCodeLine{00492\ \ \ \ \ \{}
\DoxyCodeLine{00493\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a135732ea710428502c6e1a99998f6b20}{AverageInterface}}(i,j,k).clear();}
\DoxyCodeLine{00494\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a17b62c9d05638005288801132ac70f7d}{AverageInterfaceWeight}}(i,j,k).clear();}
\DoxyCodeLine{00495\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a32f128b0714e28d3117de25afa3c3653}{AverageInterfaceAux}}(i,j,k).clear();}
\DoxyCodeLine{00496\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a30033c931fec65ad587d59b674b98541}{AverageInterfaceAuxWeight}}(i,j,k).clear();}
\DoxyCodeLine{00497\ \ \ \ \ \}}
\DoxyCodeLine{00498\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00499\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,0,)}
\DoxyCodeLine{00500\ \ \ \ \ \{}
\DoxyCodeLine{00501\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i,j,k).wide\_interface())}
\DoxyCodeLine{00502\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00503\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ alpha\ \ =\ PF(i,j,k).cbegin();}
\DoxyCodeLine{00504\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ !=\ PF(i,j,k).cend();\ ++alpha)}
\DoxyCodeLine{00505\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00506\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ii\ =\ -\/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNx();\ ii\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNx();\ ++ii)}
\DoxyCodeLine{00507\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ jj\ =\ -\/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNy();\ jj\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNy();\ ++jj)}
\DoxyCodeLine{00508\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ kk\ =\ -\/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNz();\ kk\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNz();\ ++kk)}
\DoxyCodeLine{00509\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ii*ii+jj*jj+kk*kk\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}})}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ +\ ii\ >=\ -\/PF.Bcells()+1\ \&\&\ i+\ ii\ <\ PF.sizeX()+PF.Bcells()-\/1)}
\DoxyCodeLine{00511\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ +\ jj\ >=\ -\/PF.Bcells()+1\ \&\&\ j+\ jj\ <\ PF.sizeY()+PF.Bcells()-\/1)}
\DoxyCodeLine{00512\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (k\ +\ kk\ >=\ -\/PF.Bcells()+1\ \&\&\ k+\ kk\ <\ PF.sizeZ()+PF.Bcells()-\/1)}
\DoxyCodeLine{00513\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00514\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i+ii,j+jj,k+kk).wide\_interface())}
\DoxyCodeLine{00515\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00516\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ dist\ =\ sqrt(ii*ii\ +\ jj*jj\ +\ kk*kk);}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ locPhiAlphaValue\ =\ PF(i+ii,j+jj,k+kk).get\_value(alpha-\/>index);}
\DoxyCodeLine{00518\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ weight\ =\ std::pow(locPhiAlphaValue\ *\ (1.-\/locPhiAlphaValue),\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a7861e796060fff81c6cc84c553e43b17}{exponent}})*(\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}-\/dist);}
\DoxyCodeLine{00519\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a32f128b0714e28d3117de25afa3c3653}{AverageInterfaceAux}}(i,j,k).add\_value(alpha-\/>index,\ weight*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a106646554b97f07c33196ab4104822ec}{Interface}}(i+ii,j+jj,k+kk).get\_value(alpha-\/>index));}
\DoxyCodeLine{00520\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a30033c931fec65ad587d59b674b98541}{AverageInterfaceAuxWeight}}(i,j,k).add\_value(alpha-\/>index,\ weight);}
\DoxyCodeLine{00521\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00522\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00523\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00524\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00525\ \ \ \ \ \}}
\DoxyCodeLine{00526\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00527\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,0,)}
\DoxyCodeLine{00528\ \ \ \ \ \{}
\DoxyCodeLine{00529\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i,j,k).wide\_interface())}
\DoxyCodeLine{00530\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00531\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ alpha\ =\ PF(i,j,k).cbegin();}
\DoxyCodeLine{00532\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ !=\ PF(i,j,k).cend();\ ++alpha)}
\DoxyCodeLine{00533\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00534\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a30033c931fec65ad587d59b674b98541}{AverageInterfaceAuxWeight}}(i,j,k).get\_value(alpha-\/>index)\ !=\ 0.0)}
\DoxyCodeLine{00535\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00536\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a32f128b0714e28d3117de25afa3c3653}{AverageInterfaceAux}}(i,j,k).set\_value(alpha-\/>index,\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a32f128b0714e28d3117de25afa3c3653}{AverageInterfaceAux}}(i,j,k).get\_value(alpha-\/>index)/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a30033c931fec65ad587d59b674b98541}{AverageInterfaceAuxWeight}}(i,j,k).get\_value(alpha-\/>index));}
\DoxyCodeLine{00537\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00538\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00539\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00540\ \ \ \ \ \}}
\DoxyCodeLine{00541\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00542\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,0,)}
\DoxyCodeLine{00543\ \ \ \ \ \{}
\DoxyCodeLine{00544\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i,j,k).wide\_interface())}
\DoxyCodeLine{00545\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00546\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ alpha\ =\ PF(i,j,k).cbegin();}
\DoxyCodeLine{00547\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ !=\ PF(i,j,k).cend();\ ++alpha)}
\DoxyCodeLine{00548\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00549\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ii\ =\ -\/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNx();\ ii\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNx();\ ++ii)}
\DoxyCodeLine{00550\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ jj\ =\ -\/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNy();\ jj\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNy();\ ++jj)}
\DoxyCodeLine{00551\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ kk\ =\ -\/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNz();\ kk\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNz();\ ++kk)}
\DoxyCodeLine{00552\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ii*ii+jj*jj+kk*kk\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}})}
\DoxyCodeLine{00553\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ +\ ii\ >=\ -\/PF.Bcells()+1\ \&\&\ i+\ ii\ <\ PF.sizeX()+PF.Bcells()-\/1)}
\DoxyCodeLine{00554\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ +\ jj\ >=\ -\/PF.Bcells()+1\ \&\&\ j+\ jj\ <\ PF.sizeY()+PF.Bcells()-\/1)}
\DoxyCodeLine{00555\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (k\ +\ kk\ >=\ -\/PF.Bcells()+1\ \&\&\ k+\ kk\ <\ PF.sizeZ()+PF.Bcells()-\/1)}
\DoxyCodeLine{00556\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00557\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i+ii,j+jj,k+kk).wide\_interface())}
\DoxyCodeLine{00558\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00559\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a135732ea710428502c6e1a99998f6b20}{AverageInterface}}(i,j,k).add\_value(alpha-\/>index,\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a32f128b0714e28d3117de25afa3c3653}{AverageInterfaceAux}}(i+ii,j+jj,k+kk).get\_value(alpha-\/>index));}
\DoxyCodeLine{00560\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a17b62c9d05638005288801132ac70f7d}{AverageInterfaceWeight}}(i,j,k).add\_value(alpha-\/>index,\ 1);}
\DoxyCodeLine{00561\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00562\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00563\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00564\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00565\ \ \ \ \ \}}
\DoxyCodeLine{00566\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00567\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,0,)}
\DoxyCodeLine{00568\ \ \ \ \ \{}
\DoxyCodeLine{00569\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i,j,k).wide\_interface())}
\DoxyCodeLine{00570\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00571\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ alpha\ \ =\ PF(i,j,k).cbegin();}
\DoxyCodeLine{00572\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ !=\ PF(i,j,k).cend();\ ++alpha)}
\DoxyCodeLine{00573\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00574\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a17b62c9d05638005288801132ac70f7d}{AverageInterfaceWeight}}(i,j,k).get\_value(alpha-\/>index)\ !=\ 0.0)}
\DoxyCodeLine{00575\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00576\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a135732ea710428502c6e1a99998f6b20}{AverageInterface}}(i,j,k).set\_value(alpha-\/>index,\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a135732ea710428502c6e1a99998f6b20}{AverageInterface}}(i,j,k).get\_value(alpha-\/>index)/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a17b62c9d05638005288801132ac70f7d}{AverageInterfaceWeight}}(i,j,k).get\_value(alpha-\/>index));}
\DoxyCodeLine{00577\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00578\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00579\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00580\ \ \ \ \ \}}
\DoxyCodeLine{00581\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00582\ \}}

\end{DoxyCode}
\Hypertarget{classopenphase_1_1StabilizationImpl_a7353d803d6235133a1dcbe1e6ef2db3c}\label{classopenphase_1_1StabilizationImpl_a7353d803d6235133a1dcbe1e6ef2db3c} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!CalculateAverageCurvatureNormal@{CalculateAverageCurvatureNormal}}
\index{CalculateAverageCurvatureNormal@{CalculateAverageCurvatureNormal}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{CalculateAverageCurvatureNormal()}{CalculateAverageCurvatureNormal()}}
{\footnotesize\ttfamily void openphase\+::\+Stabilization\+Impl\+::\+Calculate\+Average\+Curvature\+Normal (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classopenphase_1_1PhaseField}{Phase\+Field}} \&}]{Phase }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00778}{778}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00779\ \{}
\DoxyCodeLine{00780\ \ \ \ \ \textcolor{keyword}{auto}\&\ PF\ =\ (\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}}.\mbox{\hyperlink{classopenphase_1_1GridParameters_af0b28822d6a3aba3df4db780b51db71a}{Resolution}}\ ==\ \mbox{\hyperlink{namespaceopenphase_a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e}{Resolutions::Single}})?\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.Fields:\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.FieldsDR;}
\DoxyCodeLine{00781\ }
\DoxyCodeLine{00782\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,PF.Bcells(),)}
\DoxyCodeLine{00783\ \ \ \ \ \{}
\DoxyCodeLine{00784\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_abcb3da65d0437d93a0ffb25c3f5e71a8}{AverageCurvature}}(i,j,k).clear();}
\DoxyCodeLine{00785\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a23018d7acc8f9d117be93bd4e040aa85}{AverageCurvatureWeight}}(i,j,k).clear();}
\DoxyCodeLine{00786\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a135732ea710428502c6e1a99998f6b20}{AverageInterface}}(i,j,k).clear();}
\DoxyCodeLine{00787\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a17b62c9d05638005288801132ac70f7d}{AverageInterfaceWeight}}(i,j,k).clear();}
\DoxyCodeLine{00788\ \ \ \ \ \}}
\DoxyCodeLine{00789\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00790\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,PF.Bcells()-\/1,)}
\DoxyCodeLine{00791\ \ \ \ \ \{}
\DoxyCodeLine{00792\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i,j,k).wide\_interface())}
\DoxyCodeLine{00793\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00794\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ NodePF\&\ locPF\ =\ (\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}}.\mbox{\hyperlink{classopenphase_1_1GridParameters_af0b28822d6a3aba3df4db780b51db71a}{Resolution}}\ ==\ \mbox{\hyperlink{namespaceopenphase_a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e}{Resolutions::Single}})?\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.Fields(i,j,k):\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.FieldsDR(i,j,k);}
\DoxyCodeLine{00795\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ alpha\ \ =\ locPF.cbegin();}
\DoxyCodeLine{00796\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ !=\ locPF.cend();\ ++alpha)}
\DoxyCodeLine{00797\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \ beta\ \ =\ locPF.cbegin();}
\DoxyCodeLine{00798\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ beta\ !=\ locPF.cend();\ ++beta)}
\DoxyCodeLine{00799\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alpha\ !=\ beta)}
\DoxyCodeLine{00800\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00801\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dVector3\ normal\ =\ \mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.Normal(alpha,beta);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00802\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ r\ =\ -\/2;\ r\ <=\ 2;\ ++r)}
\DoxyCodeLine{00803\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00804\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ ii\ =\ i+0.5*r*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*normal[0];}
\DoxyCodeLine{00805\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ jj\ =\ j+0.5*r*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*normal[1];}
\DoxyCodeLine{00806\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ kk\ =\ k+0.5*r*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*normal[2];}
\DoxyCodeLine{00807\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ii\ >=\ -\/PF.Bcells()+1\ \&\&\ ii\ <\ PF.sizeX()+PF.Bcells()-\/1)}
\DoxyCodeLine{00808\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (jj\ >=\ -\/PF.Bcells()+1\ \&\&\ jj\ <\ PF.sizeY()+PF.Bcells()-\/1)}
\DoxyCodeLine{00809\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (kk\ >=\ -\/PF.Bcells()+1\ \&\&\ kk\ <\ PF.sizeZ()+PF.Bcells()-\/1)}
\DoxyCodeLine{00810\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00811\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ weight\ =\ std::pow(PF.at(ii,jj,kk).get\_value(alpha-\/>index)*PF.at(ii,jj,kk).get\_value(beta-\/>index),\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a7861e796060fff81c6cc84c553e43b17}{exponent}});}
\DoxyCodeLine{00812\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_abcb3da65d0437d93a0ffb25c3f5e71a8}{AverageCurvature}}(i,j,k).add\_value(alpha-\/>index,\ weight*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a246515fab4f0968c8427b13aec75c737}{Curvature}}.at(ii,jj,kk).get\_value(alpha-\/>index));}
\DoxyCodeLine{00813\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a135732ea710428502c6e1a99998f6b20}{AverageInterface}}(i,j,k).add\_value(alpha-\/>index,\ weight*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a106646554b97f07c33196ab4104822ec}{Interface}}.at(ii,jj,kk).get\_value(alpha-\/>index));}
\DoxyCodeLine{00814\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a23018d7acc8f9d117be93bd4e040aa85}{AverageCurvatureWeight}}(i,j,k).add\_value(alpha-\/>index,\ weight);}
\DoxyCodeLine{00815\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a17b62c9d05638005288801132ac70f7d}{AverageInterfaceWeight}}(i,j,k).add\_value(alpha-\/>index,\ weight);}
\DoxyCodeLine{00816\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00817\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00818\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00819\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00820\ \ \ \ \ \}}
\DoxyCodeLine{00821\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00822\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,PF.Bcells(),)}
\DoxyCodeLine{00823\ \ \ \ \ \{}
\DoxyCodeLine{00824\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i,j,k).wide\_interface())}
\DoxyCodeLine{00825\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00826\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ alpha\ \ =\ PF(i,j,k).cbegin();}
\DoxyCodeLine{00827\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ !=\ PF(i,j,k).cend();\ ++alpha)}
\DoxyCodeLine{00828\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00829\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a23018d7acc8f9d117be93bd4e040aa85}{AverageCurvatureWeight}}(i,j,k).get\_value(alpha-\/>index)\ !=\ 0.0)}
\DoxyCodeLine{00830\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00831\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_abcb3da65d0437d93a0ffb25c3f5e71a8}{AverageCurvature}}(i,j,k).set\_value(alpha-\/>index,\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_abcb3da65d0437d93a0ffb25c3f5e71a8}{AverageCurvature}}(i,j,k).get\_value(alpha-\/>index)/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a23018d7acc8f9d117be93bd4e040aa85}{AverageCurvatureWeight}}(i,j,k).get\_value(alpha-\/>index));}
\DoxyCodeLine{00832\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00833\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a17b62c9d05638005288801132ac70f7d}{AverageInterfaceWeight}}(i,j,k).get\_value(alpha-\/>index)\ !=\ 0.0)}
\DoxyCodeLine{00834\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00835\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a135732ea710428502c6e1a99998f6b20}{AverageInterface}}(i,j,k).set\_value(alpha-\/>index,\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a135732ea710428502c6e1a99998f6b20}{AverageInterface}}(i,j,k).get\_value(alpha-\/>index)/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a17b62c9d05638005288801132ac70f7d}{AverageInterfaceWeight}}(i,j,k).get\_value(alpha-\/>index));}
\DoxyCodeLine{00836\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00837\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00838\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00839\ \ \ \ \ \}}
\DoxyCodeLine{00840\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00841\ \}}

\end{DoxyCode}
\Hypertarget{classopenphase_1_1StabilizationImpl_adf8f0d8715c49b7dcf5042fb51edb4a3}\label{classopenphase_1_1StabilizationImpl_adf8f0d8715c49b7dcf5042fb51edb4a3} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!CalculateAverageCurvatureNormalSnap@{CalculateAverageCurvatureNormalSnap}}
\index{CalculateAverageCurvatureNormalSnap@{CalculateAverageCurvatureNormalSnap}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{CalculateAverageCurvatureNormalSnap()}{CalculateAverageCurvatureNormalSnap()}}
{\footnotesize\ttfamily void openphase\+::\+Stabilization\+Impl\+::\+Calculate\+Average\+Curvature\+Normal\+Snap (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classopenphase_1_1PhaseField}{Phase\+Field}} \&}]{Phase }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00843}{843}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00844\ \{}
\DoxyCodeLine{00845\ \ \ \ \ \textcolor{keyword}{auto}\&\ PF\ =\ (\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}}.\mbox{\hyperlink{classopenphase_1_1GridParameters_af0b28822d6a3aba3df4db780b51db71a}{Resolution}}\ ==\ \mbox{\hyperlink{namespaceopenphase_a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e}{Resolutions::Single}})?\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.Fields:\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.FieldsDR;}
\DoxyCodeLine{00846\ }
\DoxyCodeLine{00847\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,PF.Bcells(),)}
\DoxyCodeLine{00848\ \ \ \ \ \{}
\DoxyCodeLine{00849\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_abcb3da65d0437d93a0ffb25c3f5e71a8}{AverageCurvature}}(i,j,k).clear();}
\DoxyCodeLine{00850\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a23018d7acc8f9d117be93bd4e040aa85}{AverageCurvatureWeight}}(i,j,k).clear();}
\DoxyCodeLine{00851\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a135732ea710428502c6e1a99998f6b20}{AverageInterface}}(i,j,k).clear();}
\DoxyCodeLine{00852\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a17b62c9d05638005288801132ac70f7d}{AverageInterfaceWeight}}(i,j,k).clear();}
\DoxyCodeLine{00853\ \ \ \ \ \}}
\DoxyCodeLine{00854\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00855\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,PF.Bcells()-\/1,)}
\DoxyCodeLine{00856\ \ \ \ \ \{}
\DoxyCodeLine{00857\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i,j,k).wide\_interface())}
\DoxyCodeLine{00858\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00859\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ NodePF\&\ locPF\ =\ (\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}}.\mbox{\hyperlink{classopenphase_1_1GridParameters_af0b28822d6a3aba3df4db780b51db71a}{Resolution}}\ ==\ \mbox{\hyperlink{namespaceopenphase_a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e}{Resolutions::Single}})?\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.Fields(i,j,k):\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.FieldsDR(i,j,k);}
\DoxyCodeLine{00860\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ alpha\ \ =\ locPF.cbegin();}
\DoxyCodeLine{00861\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ !=\ locPF.cend();\ ++alpha)}
\DoxyCodeLine{00862\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \ beta\ \ =\ locPF.cbegin();}
\DoxyCodeLine{00863\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ beta\ !=\ locPF.cend();\ ++beta)}
\DoxyCodeLine{00864\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alpha\ !=\ beta)}
\DoxyCodeLine{00865\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00866\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dVector3\ normal\ =\ \mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.Normal(alpha,beta);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00867\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ r\ =\ -\/2;\ r\ <=\ 2;\ ++r)}
\DoxyCodeLine{00868\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00869\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ ii\ =\ round(i+0.5*r*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*normal[0]);}
\DoxyCodeLine{00870\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ jj\ =\ round(j+0.5*r*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*normal[1]);}
\DoxyCodeLine{00871\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ kk\ =\ round(k+0.5*r*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*normal[2]);}
\DoxyCodeLine{00872\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ii\ >=\ -\/PF.Bcells()+1\ \&\&\ ii\ <\ PF.sizeX()+PF.Bcells()-\/1)}
\DoxyCodeLine{00873\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (jj\ >=\ -\/PF.Bcells()+1\ \&\&\ jj\ <\ PF.sizeY()+PF.Bcells()-\/1)}
\DoxyCodeLine{00874\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (kk\ >=\ -\/PF.Bcells()+1\ \&\&\ kk\ <\ PF.sizeZ()+PF.Bcells()-\/1)}
\DoxyCodeLine{00875\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00876\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ weight\ =\ std::pow(PF.at(ii,jj,kk).get\_value(alpha-\/>index)*PF(ii,jj,kk).get\_value(beta-\/>index),\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a7861e796060fff81c6cc84c553e43b17}{exponent}});}
\DoxyCodeLine{00877\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_abcb3da65d0437d93a0ffb25c3f5e71a8}{AverageCurvature}}(i,j,k).add\_value(alpha-\/>index,\ weight*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a246515fab4f0968c8427b13aec75c737}{Curvature}}(ii,jj,kk).get\_value(alpha-\/>index));}
\DoxyCodeLine{00878\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a135732ea710428502c6e1a99998f6b20}{AverageInterface}}(i,j,k).add\_value(alpha-\/>index,\ weight*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a106646554b97f07c33196ab4104822ec}{Interface}}(ii,jj,kk).get\_value(alpha-\/>index));}
\DoxyCodeLine{00879\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a23018d7acc8f9d117be93bd4e040aa85}{AverageCurvatureWeight}}(i,j,k).add\_value(alpha-\/>index,\ weight);}
\DoxyCodeLine{00880\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a17b62c9d05638005288801132ac70f7d}{AverageInterfaceWeight}}(i,j,k).add\_value(alpha-\/>index,\ weight);}
\DoxyCodeLine{00881\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00882\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00883\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00884\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00885\ \ \ \ \ \}}
\DoxyCodeLine{00886\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00887\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,PF.Bcells(),)}
\DoxyCodeLine{00888\ \ \ \ \ \{}
\DoxyCodeLine{00889\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i,j,k).wide\_interface())}
\DoxyCodeLine{00890\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00891\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ alpha\ \ =\ PF(i,j,k).cbegin();}
\DoxyCodeLine{00892\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ !=\ PF(i,j,k).cend();\ ++alpha)}
\DoxyCodeLine{00893\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00894\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a23018d7acc8f9d117be93bd4e040aa85}{AverageCurvatureWeight}}(i,j,k).get\_value(alpha-\/>index)\ !=\ 0.0)}
\DoxyCodeLine{00895\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00896\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_abcb3da65d0437d93a0ffb25c3f5e71a8}{AverageCurvature}}(i,j,k).set\_value(alpha-\/>index,\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_abcb3da65d0437d93a0ffb25c3f5e71a8}{AverageCurvature}}(i,j,k).get\_value(alpha-\/>index)/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a23018d7acc8f9d117be93bd4e040aa85}{AverageCurvatureWeight}}(i,j,k).get\_value(alpha-\/>index));}
\DoxyCodeLine{00897\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00898\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a17b62c9d05638005288801132ac70f7d}{AverageInterfaceWeight}}(i,j,k).get\_value(alpha-\/>index)\ !=\ 0.0)}
\DoxyCodeLine{00899\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00900\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a135732ea710428502c6e1a99998f6b20}{AverageInterface}}(i,j,k).set\_value(alpha-\/>index,\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a135732ea710428502c6e1a99998f6b20}{AverageInterface}}(i,j,k).get\_value(alpha-\/>index)/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a17b62c9d05638005288801132ac70f7d}{AverageInterfaceWeight}}(i,j,k).get\_value(alpha-\/>index));}
\DoxyCodeLine{00901\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00902\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00903\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00904\ \ \ \ \ \}}
\DoxyCodeLine{00905\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00906\ \}}

\end{DoxyCode}
\Hypertarget{classopenphase_1_1StabilizationImpl_a42447a8f1f7777442fb8e62b6438e41e}\label{classopenphase_1_1StabilizationImpl_a42447a8f1f7777442fb8e62b6438e41e} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!CalculateAverageCurvatureRegularization@{CalculateAverageCurvatureRegularization}}
\index{CalculateAverageCurvatureRegularization@{CalculateAverageCurvatureRegularization}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{CalculateAverageCurvatureRegularization()}{CalculateAverageCurvatureRegularization()}}
{\footnotesize\ttfamily void openphase\+::\+Stabilization\+Impl\+::\+Calculate\+Average\+Curvature\+Regularization (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classopenphase_1_1PhaseField}{Phase\+Field}} \&}]{Phase }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00584}{584}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00585\ \{}
\DoxyCodeLine{00586\ \ \ \ \ \textcolor{keyword}{auto}\&\ PF\ =\ (\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}}.\mbox{\hyperlink{classopenphase_1_1GridParameters_af0b28822d6a3aba3df4db780b51db71a}{Resolution}}\ ==\ \mbox{\hyperlink{namespaceopenphase_a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e}{Resolutions::Single}})?\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.Fields:\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.FieldsDR;}
\DoxyCodeLine{00587\ }
\DoxyCodeLine{00588\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,PF.Bcells(),)}
\DoxyCodeLine{00589\ \ \ \ \ \{}
\DoxyCodeLine{00590\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_abcb3da65d0437d93a0ffb25c3f5e71a8}{AverageCurvature}}(i,j,k).clear();}
\DoxyCodeLine{00591\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a23018d7acc8f9d117be93bd4e040aa85}{AverageCurvatureWeight}}(i,j,k).clear();}
\DoxyCodeLine{00592\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a88de321d75e4df7048b19ba200c95a1d}{AverageCurvatureAux}}(i,j,k).clear();}
\DoxyCodeLine{00593\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a281828ecf220bcea9081aaa7b16d122a}{AverageCurvatureAuxWeight}}(i,j,k).clear();}
\DoxyCodeLine{00594\ \ \ \ \ \}}
\DoxyCodeLine{00595\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00596\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,0,)}
\DoxyCodeLine{00597\ \ \ \ \ \{}
\DoxyCodeLine{00598\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i,j,k).wide\_interface())}
\DoxyCodeLine{00599\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00600\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ alpha\ \ =\ PF(i,j,k).cbegin();}
\DoxyCodeLine{00601\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ !=\ PF(i,j,k).cend();\ ++alpha)}
\DoxyCodeLine{00602\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00603\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ii\ =\ -\/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNx();\ ii\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNx();\ ++ii)}
\DoxyCodeLine{00604\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ jj\ =\ -\/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNy();\ jj\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNy();\ ++jj)}
\DoxyCodeLine{00605\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ kk\ =\ -\/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNz();\ kk\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNz();\ ++kk)}
\DoxyCodeLine{00606\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ii*ii+jj*jj+kk*kk\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}})}
\DoxyCodeLine{00607\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ +\ ii\ >=\ -\/PF.Bcells()+1\ \&\&\ i+\ ii\ <\ PF.sizeX()+PF.Bcells()-\/1)}
\DoxyCodeLine{00608\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ +\ jj\ >=\ -\/PF.Bcells()+1\ \&\&\ j+\ jj\ <\ PF.sizeY()+PF.Bcells()-\/1)}
\DoxyCodeLine{00609\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (k\ +\ kk\ >=\ -\/PF.Bcells()+1\ \&\&\ k+\ kk\ <\ PF.sizeZ()+PF.Bcells()-\/1)}
\DoxyCodeLine{00610\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00611\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i+ii,j+jj,k+kk).wide\_interface()\ \ \&\&\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a246515fab4f0968c8427b13aec75c737}{Curvature}}(i+ii,j+jj,k+kk).get\_value(alpha-\/>index)\ !=\ 0.0)}
\DoxyCodeLine{00612\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00613\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ dist\ =\ sqrt(ii*ii\ +\ jj*jj\ +\ kk*kk);}
\DoxyCodeLine{00614\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ locPhiAlphaValue\ =\ PF(i+ii,j+jj,k+kk).get\_value(alpha-\/>index);}
\DoxyCodeLine{00615\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ weight\ =\ std::pow(locPhiAlphaValue\ *\ (1.0-\/locPhiAlphaValue),0.5)*(\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}-\/dist);}
\DoxyCodeLine{00616\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a88de321d75e4df7048b19ba200c95a1d}{AverageCurvatureAux}}(i,j,k).add\_value(alpha-\/>index,\ weight*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a246515fab4f0968c8427b13aec75c737}{Curvature}}(i+ii,j+jj,k+kk).get\_value(alpha-\/>index));}
\DoxyCodeLine{00617\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a281828ecf220bcea9081aaa7b16d122a}{AverageCurvatureAuxWeight}}(i,j,k).add\_value(alpha-\/>index,\ weight);}
\DoxyCodeLine{00618\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00619\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00620\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00621\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00622\ \ \ \ \ \}}
\DoxyCodeLine{00623\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00624\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,0,)}
\DoxyCodeLine{00625\ \ \ \ \ \{}
\DoxyCodeLine{00626\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i,j,k).wide\_interface())}
\DoxyCodeLine{00627\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00628\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ alpha\ \ =\ PF(i,j,k).cbegin();}
\DoxyCodeLine{00629\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ !=\ PF(i,j,k).cend();\ ++alpha)}
\DoxyCodeLine{00630\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00631\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a281828ecf220bcea9081aaa7b16d122a}{AverageCurvatureAuxWeight}}(i,j,k).get\_value(alpha-\/>index)\ !=\ 0.0)}
\DoxyCodeLine{00632\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00633\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a88de321d75e4df7048b19ba200c95a1d}{AverageCurvatureAux}}(i,j,k).set\_value(alpha-\/>index,\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a88de321d75e4df7048b19ba200c95a1d}{AverageCurvatureAux}}(i,j,k).get\_value(alpha-\/>index)/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a281828ecf220bcea9081aaa7b16d122a}{AverageCurvatureAuxWeight}}(i,j,k).get\_value(alpha-\/>index));}
\DoxyCodeLine{00634\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00635\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00636\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00637\ \ \ \ \ \}}
\DoxyCodeLine{00638\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00639\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,0,)}
\DoxyCodeLine{00640\ \ \ \ \ \{}
\DoxyCodeLine{00641\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i,j,k).wide\_interface())}
\DoxyCodeLine{00642\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00643\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ alpha\ \ =\ PF(i,j,k).cbegin();}
\DoxyCodeLine{00644\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ !=\ PF(i,j,k).cend();\ ++alpha)}
\DoxyCodeLine{00645\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00646\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ii\ =\ -\/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNx();\ ii\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNx();\ ++ii)}
\DoxyCodeLine{00647\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ jj\ =\ -\/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNy();\ jj\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNy();\ ++jj)}
\DoxyCodeLine{00648\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ kk\ =\ -\/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNz();\ kk\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNz();\ ++kk)}
\DoxyCodeLine{00649\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ii*ii+jj*jj+kk*kk\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}})}
\DoxyCodeLine{00650\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ +\ ii\ >=\ -\/PF.Bcells()+1\ \&\&\ i\ +\ ii\ <\ PF.sizeX()+PF.Bcells()\ -\/1)}
\DoxyCodeLine{00651\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ +\ jj\ >=\ -\/PF.Bcells()+1\ \&\&\ j\ +\ jj\ <\ PF.sizeY()+PF.Bcells()\ -\/1)}
\DoxyCodeLine{00652\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (k\ +\ kk\ >=\ -\/PF.Bcells()+1\ \&\&\ k\ +\ kk\ <\ PF.sizeZ()+PF.Bcells()\ -\/1)}
\DoxyCodeLine{00653\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00654\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i+ii,j+jj,k+kk).wide\_interface()\ \&\&\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a88de321d75e4df7048b19ba200c95a1d}{AverageCurvatureAux}}(i+ii,j+jj,k+kk).get\_value(alpha-\/>index)\ !=\ 0.0)}
\DoxyCodeLine{00655\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00656\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//double\ dist\ =\ sqrt(ii*ii\ +\ jj*jj\ +\ kk*kk);}}
\DoxyCodeLine{00657\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ locPhiAlphaValue\ =\ PF(i+ii,j+jj,k+kk).get\_value(alpha-\/>index);}
\DoxyCodeLine{00658\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ weight\ =\ std::pow(locPhiAlphaValue\ *\ (1.0-\/locPhiAlphaValue),0.5);}
\DoxyCodeLine{00659\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_abcb3da65d0437d93a0ffb25c3f5e71a8}{AverageCurvature}}(i,j,k).add\_value(alpha-\/>index,weight*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a88de321d75e4df7048b19ba200c95a1d}{AverageCurvatureAux}}(i+ii,j+jj,k+kk).get\_value(alpha-\/>index));}
\DoxyCodeLine{00660\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a23018d7acc8f9d117be93bd4e040aa85}{AverageCurvatureWeight}}(i,j,k).add\_value(alpha-\/>index,\ weight);}
\DoxyCodeLine{00661\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00662\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00663\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00664\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00665\ \ \ \ \ \}}
\DoxyCodeLine{00666\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00667\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,0,)}
\DoxyCodeLine{00668\ \ \ \ \ \{}
\DoxyCodeLine{00669\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i,j,k).wide\_interface())}
\DoxyCodeLine{00670\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00671\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ alpha\ \ =\ PF(i,j,k).cbegin();}
\DoxyCodeLine{00672\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ !=\ PF(i,j,k).cend();\ ++alpha)}
\DoxyCodeLine{00673\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00674\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a23018d7acc8f9d117be93bd4e040aa85}{AverageCurvatureWeight}}(i,j,k).get\_value(alpha-\/>index)\ !=\ 0.0)}
\DoxyCodeLine{00675\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00676\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_abcb3da65d0437d93a0ffb25c3f5e71a8}{AverageCurvature}}(i,j,k).set\_value(alpha-\/>index,\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_abcb3da65d0437d93a0ffb25c3f5e71a8}{AverageCurvature}}(i,j,k).get\_value(alpha-\/>index)/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a23018d7acc8f9d117be93bd4e040aa85}{AverageCurvatureWeight}}(i,j,k).get\_value(alpha-\/>index));}
\DoxyCodeLine{00677\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00678\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00679\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00680\ \ \ \ \ \}}
\DoxyCodeLine{00681\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00682\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,PF.Bcells(),)}
\DoxyCodeLine{00683\ \ \ \ \ \{}
\DoxyCodeLine{00684\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a135732ea710428502c6e1a99998f6b20}{AverageInterface}}(i,j,k).clear();}
\DoxyCodeLine{00685\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a17b62c9d05638005288801132ac70f7d}{AverageInterfaceWeight}}(i,j,k).clear();}
\DoxyCodeLine{00686\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a32f128b0714e28d3117de25afa3c3653}{AverageInterfaceAux}}(i,j,k).clear();}
\DoxyCodeLine{00687\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a30033c931fec65ad587d59b674b98541}{AverageInterfaceAuxWeight}}(i,j,k).clear();}
\DoxyCodeLine{00688\ \ \ \ \ \}}
\DoxyCodeLine{00689\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00690\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,0,)}
\DoxyCodeLine{00691\ \ \ \ \ \{}
\DoxyCodeLine{00692\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i,j,k).wide\_interface())}
\DoxyCodeLine{00693\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00694\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ alpha\ \ =\ PF(i,j,k).cbegin();}
\DoxyCodeLine{00695\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ !=\ PF(i,j,k).cend();\ ++alpha)}
\DoxyCodeLine{00696\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00697\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ii\ =\ -\/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNx();\ ii\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNx();\ ++ii)}
\DoxyCodeLine{00698\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ jj\ =\ -\/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNy();\ jj\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNy();\ ++jj)}
\DoxyCodeLine{00699\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ kk\ =\ -\/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNz();\ kk\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNz();\ ++kk)}
\DoxyCodeLine{00700\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ii*ii+jj*jj+kk*kk\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}})}
\DoxyCodeLine{00701\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ +\ ii\ >=\ -\/PF.Bcells()+1\ \&\&\ i+\ ii\ <\ PF.sizeX()+PF.Bcells()-\/1)}
\DoxyCodeLine{00702\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ +\ jj\ >=\ -\/PF.Bcells()+1\ \&\&\ j+\ jj\ <\ PF.sizeY()+PF.Bcells()-\/1)}
\DoxyCodeLine{00703\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (k\ +\ kk\ >=\ -\/PF.Bcells()+1\ \&\&\ k+\ kk\ <\ PF.sizeZ()+PF.Bcells()-\/1)}
\DoxyCodeLine{00704\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00705\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i+ii,j+jj,k+kk).wide\_interface())}
\DoxyCodeLine{00706\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00707\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ dist\ =\ sqrt(ii*ii\ +\ jj*jj\ +\ kk*kk);}
\DoxyCodeLine{00708\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ locPhiAlphaValue\ =\ PF(i+ii,j+jj,k+kk).get\_value(alpha-\/>index);}
\DoxyCodeLine{00709\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ weight\ =\ std::pow(locPhiAlphaValue\ *\ (1.-\/locPhiAlphaValue),0.5)*(\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}-\/dist);}
\DoxyCodeLine{00710\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a32f128b0714e28d3117de25afa3c3653}{AverageInterfaceAux}}(i,j,k).add\_value(alpha-\/>index,\ weight*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a106646554b97f07c33196ab4104822ec}{Interface}}(i+ii,j+jj,k+kk).get\_value(alpha-\/>index));}
\DoxyCodeLine{00711\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a30033c931fec65ad587d59b674b98541}{AverageInterfaceAuxWeight}}(i,j,k).add\_value(alpha-\/>index,\ weight);}
\DoxyCodeLine{00712\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00713\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00714\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00715\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00716\ \ \ \ \ \}}
\DoxyCodeLine{00717\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00718\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,0,)}
\DoxyCodeLine{00719\ \ \ \ \ \{}
\DoxyCodeLine{00720\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i,j,k).wide\_interface())}
\DoxyCodeLine{00721\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00722\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ alpha\ =\ PF(i,j,k).cbegin();}
\DoxyCodeLine{00723\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ !=\ PF(i,j,k).cend();\ ++alpha)}
\DoxyCodeLine{00724\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00725\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a30033c931fec65ad587d59b674b98541}{AverageInterfaceAuxWeight}}(i,j,k).get\_value(alpha-\/>index)\ !=\ 0.0)}
\DoxyCodeLine{00726\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00727\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a32f128b0714e28d3117de25afa3c3653}{AverageInterfaceAux}}(i,j,k).set\_value(alpha-\/>index,\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a32f128b0714e28d3117de25afa3c3653}{AverageInterfaceAux}}(i,j,k).get\_value(alpha-\/>index)/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a30033c931fec65ad587d59b674b98541}{AverageInterfaceAuxWeight}}(i,j,k).get\_value(alpha-\/>index));}
\DoxyCodeLine{00728\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00729\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00730\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00731\ \ \ \ \ \}}
\DoxyCodeLine{00732\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00733\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,0,)}
\DoxyCodeLine{00734\ \ \ \ \ \{}
\DoxyCodeLine{00735\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i,j,k).wide\_interface())}
\DoxyCodeLine{00736\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00737\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ alpha\ \ =\ PF(i,j,k).cbegin();}
\DoxyCodeLine{00738\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ !=\ PF(i,j,k).cend();\ ++alpha)}
\DoxyCodeLine{00739\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00740\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ii\ =\ -\/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNx();\ ii\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNx();\ ++ii)}
\DoxyCodeLine{00741\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ jj\ =\ -\/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNy();\ jj\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNy();\ ++jj)}
\DoxyCodeLine{00742\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ kk\ =\ -\/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNz();\ kk\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*PF.dNz();\ ++kk)}
\DoxyCodeLine{00743\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ii*ii+jj*jj+kk*kk\ <=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}})}
\DoxyCodeLine{00744\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ +\ ii\ >=\ -\/PF.Bcells()+1\ \&\&\ i+\ ii\ <\ PF.sizeX()+PF.Bcells()-\/1)}
\DoxyCodeLine{00745\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ +\ jj\ >=\ -\/PF.Bcells()+1\ \&\&\ j+\ jj\ <\ PF.sizeY()+PF.Bcells()-\/1)}
\DoxyCodeLine{00746\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (k\ +\ kk\ >=\ -\/PF.Bcells()+1\ \&\&\ k+\ kk\ <\ PF.sizeZ()+PF.Bcells()-\/1)}
\DoxyCodeLine{00747\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00748\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i+ii,j+jj,k+kk).wide\_interface())}
\DoxyCodeLine{00749\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00750\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//double\ dist\ =\ sqrt(ii*ii\ +\ jj*jj\ +\ kk*kk);}}
\DoxyCodeLine{00751\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ locPhiAlphaValue\ =\ PF(i+ii,j+jj,k+kk).get\_value(alpha-\/>index);}
\DoxyCodeLine{00752\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ weight\ =\ std::pow(locPhiAlphaValue\ *\ (1.0-\/locPhiAlphaValue),0.5);}
\DoxyCodeLine{00753\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a135732ea710428502c6e1a99998f6b20}{AverageInterface}}(i,j,k).add\_value(alpha-\/>index,weight*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a32f128b0714e28d3117de25afa3c3653}{AverageInterfaceAux}}(i+ii,j+jj,k+kk).get\_value(alpha-\/>index));}
\DoxyCodeLine{00754\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a17b62c9d05638005288801132ac70f7d}{AverageInterfaceWeight}}(i,j,k).add\_value(alpha-\/>index,\ weight);}
\DoxyCodeLine{00755\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00756\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00757\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00758\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00759\ \ \ \ \ \}}
\DoxyCodeLine{00760\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00761\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,0,)}
\DoxyCodeLine{00762\ \ \ \ \ \{}
\DoxyCodeLine{00763\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i,j,k).wide\_interface())}
\DoxyCodeLine{00764\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00765\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ alpha\ \ =\ PF(i,j,k).cbegin();}
\DoxyCodeLine{00766\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ !=\ PF(i,j,k).cend();\ ++alpha)}
\DoxyCodeLine{00767\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00768\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a17b62c9d05638005288801132ac70f7d}{AverageInterfaceWeight}}(i,j,k).get\_value(alpha-\/>index)\ !=\ 0.0)}
\DoxyCodeLine{00769\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00770\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a135732ea710428502c6e1a99998f6b20}{AverageInterface}}(i,j,k).set\_value(alpha-\/>index,\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a135732ea710428502c6e1a99998f6b20}{AverageInterface}}(i,j,k).get\_value(alpha-\/>index)/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a17b62c9d05638005288801132ac70f7d}{AverageInterfaceWeight}}(i,j,k).get\_value(alpha-\/>index));}
\DoxyCodeLine{00771\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00772\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00773\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00774\ \ \ \ \ \}}
\DoxyCodeLine{00775\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00776\ \}}

\end{DoxyCode}
\Hypertarget{classopenphase_1_1StabilizationImpl_a60753afd1767ebfb4aab9e6ce850a07a}\label{classopenphase_1_1StabilizationImpl_a60753afd1767ebfb4aab9e6ce850a07a} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!CalculateAverageCurvatureSimple@{CalculateAverageCurvatureSimple}}
\index{CalculateAverageCurvatureSimple@{CalculateAverageCurvatureSimple}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{CalculateAverageCurvatureSimple()}{CalculateAverageCurvatureSimple()}}
{\footnotesize\ttfamily void openphase\+::\+Stabilization\+Impl\+::\+Calculate\+Average\+Curvature\+Simple (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classopenphase_1_1PhaseField}{Phase\+Field}} \&}]{Phase }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00908}{908}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00909\ \{}
\DoxyCodeLine{00910\ \ \ \ \ \textcolor{keyword}{auto}\&\ PF\ =\ (\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}}.\mbox{\hyperlink{classopenphase_1_1GridParameters_af0b28822d6a3aba3df4db780b51db71a}{Resolution}}\ ==\ \mbox{\hyperlink{namespaceopenphase_a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e}{Resolutions::Single}})?\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.Fields:\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.FieldsDR;}
\DoxyCodeLine{00911\ }
\DoxyCodeLine{00912\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,PF.Bcells(),)}
\DoxyCodeLine{00913\ \ \ \ \ \{}
\DoxyCodeLine{00914\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_abcb3da65d0437d93a0ffb25c3f5e71a8}{AverageCurvature}}(i,j,k).clear();}
\DoxyCodeLine{00915\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a23018d7acc8f9d117be93bd4e040aa85}{AverageCurvatureWeight}}(i,j,k).clear();}
\DoxyCodeLine{00916\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a135732ea710428502c6e1a99998f6b20}{AverageInterface}}(i,j,k).clear();}
\DoxyCodeLine{00917\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a17b62c9d05638005288801132ac70f7d}{AverageInterfaceWeight}}(i,j,k).clear();}
\DoxyCodeLine{00918\ \ \ \ \ \}}
\DoxyCodeLine{00919\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00920\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,PF.Bcells(),)}
\DoxyCodeLine{00921\ \ \ \ \ \{}
\DoxyCodeLine{00922\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i,j,k).interface\_halo())}
\DoxyCodeLine{00923\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00924\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ alpha\ \ =\ PF(i,j,k).cbegin();}
\DoxyCodeLine{00925\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ !=\ PF(i,j,k).cend();\ ++alpha)}
\DoxyCodeLine{00926\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00927\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_abcb3da65d0437d93a0ffb25c3f5e71a8}{AverageCurvature}}(i,j,k).set\_value(alpha-\/>index,\ 0.0);}
\DoxyCodeLine{00928\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a135732ea710428502c6e1a99998f6b20}{AverageInterface}}(i,j,k).set\_value(alpha-\/>index,\ 0.0);}
\DoxyCodeLine{00929\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00930\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00931\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i,j,k).interface())}
\DoxyCodeLine{00932\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00933\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ alpha\ \ =\ PF(i,j,k).cbegin();}
\DoxyCodeLine{00934\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ !=\ PF(i,j,k).cend();\ ++alpha)}
\DoxyCodeLine{00935\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00936\ }
\DoxyCodeLine{00937\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_abcb3da65d0437d93a0ffb25c3f5e71a8}{AverageCurvature}}(i,j,k).set\_value(alpha-\/>index,\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a246515fab4f0968c8427b13aec75c737}{Curvature}}(i,j,k).get\_value(alpha-\/>index));}
\DoxyCodeLine{00938\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a135732ea710428502c6e1a99998f6b20}{AverageInterface}}(i,j,k).set\_value(alpha-\/>index,\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a106646554b97f07c33196ab4104822ec}{Interface}}(i,j,k).get\_value(alpha-\/>index));}
\DoxyCodeLine{00939\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00940\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00941\ \ \ \ \ \}}
\DoxyCodeLine{00942\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00943\ \}}

\end{DoxyCode}
\Hypertarget{classopenphase_1_1StabilizationImpl_a458c5fa7b6665d0e03729fac788cf0ea}\label{classopenphase_1_1StabilizationImpl_a458c5fa7b6665d0e03729fac788cf0ea} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!CalculateCurvature@{CalculateCurvature}}
\index{CalculateCurvature@{CalculateCurvature}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{CalculateCurvature()}{CalculateCurvature()}}
{\footnotesize\ttfamily void openphase\+::\+Stabilization\+Impl\+::\+Calculate\+Curvature (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classopenphase_1_1PhaseField}{Phase\+Field}} \&}]{Phase }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00310}{310}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00311\ \{}
\DoxyCodeLine{00312\ \ \ \ \ \textcolor{comment}{//Phase.CalculateDerivativesSR();}}
\DoxyCodeLine{00313\ }
\DoxyCodeLine{00314\ \ \ \ \ \textcolor{keyword}{auto}\&\ PF\ =\ (\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}}.\mbox{\hyperlink{classopenphase_1_1GridParameters_af0b28822d6a3aba3df4db780b51db71a}{Resolution}}\ ==\ \mbox{\hyperlink{namespaceopenphase_a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e}{Resolutions::Single}})?\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.Fields:\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.FieldsDR;}
\DoxyCodeLine{00315\ }
\DoxyCodeLine{00316\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,PF.Bcells(),)}
\DoxyCodeLine{00317\ \ \ \ \ \{}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a246515fab4f0968c8427b13aec75c737}{Curvature}}(i,j,k).clear();}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a106646554b97f07c33196ab4104822ec}{Interface}}(i,j,k).clear();}
\DoxyCodeLine{00320\ \ \ \ \ \}}
\DoxyCodeLine{00321\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00322\ }
\DoxyCodeLine{00323\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Prefactor\ =\ \mbox{\hyperlink{namespaceopenphase_a2c26ef9422df111d9487d3d34cf3d613}{Pi}}*\mbox{\hyperlink{namespaceopenphase_a2c26ef9422df111d9487d3d34cf3d613}{Pi}}/(\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.Grid.Eta*\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.Grid.Eta);}
\DoxyCodeLine{00324\ }
\DoxyCodeLine{00325\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ bcells\ =\ std::max((\textcolor{keywordtype}{long}\ \textcolor{keywordtype}{int})0,PF.Bcells()-\/1);}
\DoxyCodeLine{00326\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,bcells,)}
\DoxyCodeLine{00327\ \ \ \ \ \{}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i,j,k).wide\_interface())}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \ \ \ \ NodePF\&\ locPF\ =\ (\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}}.\mbox{\hyperlink{classopenphase_1_1GridParameters_af0b28822d6a3aba3df4db780b51db71a}{Resolution}}\ ==\ \mbox{\hyperlink{namespaceopenphase_a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e}{Resolutions::Single}})?\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.Fields(i,j,k):\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.FieldsDR(i,j,k);}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ alpha\ \ =\ locPF.cbegin();}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ !=\ locPF.cend();\ ++alpha)}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ dPhi\_dt\ =\ (alpha-\/>laplacian\ +\ Prefactor*(alpha-\/>value-\/0.5));}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ norm\_alpha\ =\ alpha-\/>gradient.length();}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ curv\ =\ 0.;}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (std::fabs(norm\_alpha)\ >\ 1e-\/16*\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.Grid.dx)\ curv\ =\ dPhi\_dt/norm\_alpha;}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a246515fab4f0968c8427b13aec75c737}{Curvature}}(i,j,k).add\_value(alpha-\/>index,\ curv);}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a106646554b97f07c33196ab4104822ec}{Interface}}(i,j,k).add\_value(alpha-\/>index,\ dPhi\_dt);}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00342\ \ \ \ \ \}}
\DoxyCodeLine{00343\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00344\ \}}

\end{DoxyCode}
\Hypertarget{classopenphase_1_1StabilizationImpl_a5dfccaef919082beef95882b0d177fd6}\label{classopenphase_1_1StabilizationImpl_a5dfccaef919082beef95882b0d177fd6} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!CalculateCurvature\_SPF@{CalculateCurvature\_SPF}}
\index{CalculateCurvature\_SPF@{CalculateCurvature\_SPF}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{CalculateCurvature\_SPF()}{CalculateCurvature\_SPF()}}
{\footnotesize\ttfamily void openphase\+::\+Stabilization\+Impl\+::\+Calculate\+Curvature\+\_\+\+SPF (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classopenphase_1_1PhaseField}{Phase\+Field}} \&}]{Phase }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00346}{346}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00347\ \{}
\DoxyCodeLine{00348\ \ \ \ \ \textcolor{keyword}{auto}\&\ PF\ =\ (\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}}.\mbox{\hyperlink{classopenphase_1_1GridParameters_af0b28822d6a3aba3df4db780b51db71a}{Resolution}}\ ==\ \mbox{\hyperlink{namespaceopenphase_a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e}{Resolutions::Single}})?\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.Fields:\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.FieldsDR;}
\DoxyCodeLine{00349\ }
\DoxyCodeLine{00350\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,PF.Bcells(),)}
\DoxyCodeLine{00351\ \ \ \ \ \{}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a246515fab4f0968c8427b13aec75c737}{Curvature}}(i,j,k).clear();}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a106646554b97f07c33196ab4104822ec}{Interface}}(i,j,k).clear();}
\DoxyCodeLine{00354\ \ \ \ \ \}}
\DoxyCodeLine{00355\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00356\ \ \ \ \ }
\DoxyCodeLine{00357\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ bcells\ =\ std::max((\textcolor{keywordtype}{long}\ \textcolor{keywordtype}{int})0,PF.Bcells()-\/1);}
\DoxyCodeLine{00358\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,bcells,)}
\DoxyCodeLine{00359\ \ \ \ \ \{}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i,j,k).wide\_interface())}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \ \ \ \ NodePF\&\ locPF\ =\ (\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}}.\mbox{\hyperlink{classopenphase_1_1GridParameters_af0b28822d6a3aba3df4db780b51db71a}{Resolution}}\ ==\ \mbox{\hyperlink{namespaceopenphase_a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e}{Resolutions::Single}})?\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.Fields(i,j,k):\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.FieldsDR(i,j,k);}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ alpha\ \ =\ locPF.cbegin();}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ !=\ locPF.cend();\ ++alpha)}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ pot\_term\ =\ 0;}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ StDir\ =\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a4cdea978e722c0bee973f487f92514f7}{StencilDirections}}.begin()\ ;\ StDir\ !=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a4cdea978e722c0bee973f487f92514f7}{StencilDirections}}.end()\ ;\ StDir++)}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ fik\_term\ =\ 0;}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(StDir-\/>scal\_prod\ <\ 0\ \&\&\ alpha-\/>value\ >\ StDir-\/>phi\_tu\ )}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fik\_term\ =\ 1;}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(StDir-\/>scal\_prod\ >\ 0\ \&\&\ alpha-\/>value\ <\ StDir-\/>phi\_tl\ )}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fik\_term\ =\ 0;}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fik\_term\ =\ 0.5\ +\ StDir-\/>alpha*(alpha-\/>value\ -\/\ 0.5\ )\ -\/\ StDir-\/>beta\ *std::sqrt(\ alpha-\/>value\ *(1.0\ -\/\ alpha-\/>value)\ );}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pot\_term\ +=\ -\/StDir-\/>stencil\_weight\ *\ (fik\_term\ -\/\ alpha-\/>value);}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ dPhi\_dt\ =\ (alpha-\/>laplacian\ +\ pot\_term);}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ norm\_alpha\ =\ alpha-\/>gradient.length();}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ curv\ =\ 0.;}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (std::fabs(norm\_alpha)\ >\ 1e-\/16*\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.Grid.dx)\ curv\ =\ dPhi\_dt/norm\_alpha;}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a246515fab4f0968c8427b13aec75c737}{Curvature}}(i,j,k).add\_value(alpha-\/>index,\ curv);}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a106646554b97f07c33196ab4104822ec}{Interface}}(i,j,k).add\_value(alpha-\/>index,\ dPhi\_dt);}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00392\ \ \ \ \ \}}
\DoxyCodeLine{00393\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00394\ \}}

\end{DoxyCode}
\Hypertarget{classopenphase_1_1StabilizationImpl_a3615aa9c3294a85283d978de8fdb3294}\label{classopenphase_1_1StabilizationImpl_a3615aa9c3294a85283d978de8fdb3294} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!ComputeUpdate@{ComputeUpdate}}
\index{ComputeUpdate@{ComputeUpdate}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{ComputeUpdate()}{ComputeUpdate()}}
{\footnotesize\ttfamily void openphase\+::\+Stabilization\+Impl\+::\+Compute\+Update (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classopenphase_1_1PhaseField}{Phase\+Field}} \&}]{Phase,  }\item[{\mbox{\hyperlink{classopenphase_1_1DrivingForce}{Driving\+Force}} \&}]{dG,  }\item[{double}]{dt }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l01031}{1031}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01033\ \{}
\DoxyCodeLine{01034\ \ \ \ \ \textcolor{keyword}{auto}\&\ PF\ \ =\ (\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}}.\mbox{\hyperlink{classopenphase_1_1GridParameters_af0b28822d6a3aba3df4db780b51db71a}{Resolution}}\ ==\ \mbox{\hyperlink{namespaceopenphase_a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e}{Resolutions::Single}})?\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.Fields:\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.FieldsDR;}
\DoxyCodeLine{01035\ \ \ \ \ \textcolor{keyword}{auto}\&\ PFD\ =\ (\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}}.\mbox{\hyperlink{classopenphase_1_1GridParameters_af0b28822d6a3aba3df4db780b51db71a}{Resolution}}\ ==\ \mbox{\hyperlink{namespaceopenphase_a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e}{Resolutions::Single}})?\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.FieldsDot:\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.FieldsDotDR;}
\DoxyCodeLine{01036\ \ \ \ \ }
\DoxyCodeLine{01037\ \ \ \ \ \textcolor{keywordflow}{if}\ (dt\ >\ 0)}
\DoxyCodeLine{01038\ \ \ \ \ \{}
\DoxyCodeLine{01039\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ eta\ =\ \mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.Grid.Eta;}
\DoxyCodeLine{01040\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ pi\ =\ \mbox{\hyperlink{namespaceopenphase_a2c26ef9422df111d9487d3d34cf3d613}{Pi}};}
\DoxyCodeLine{01041\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,\ j,\ k,\ PF,\ 0,\ )}
\DoxyCodeLine{01042\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01043\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i,\ j,\ k).wide\_interface())}
\DoxyCodeLine{01044\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01045\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NodePF\ NodePFDR;}
\DoxyCodeLine{01046\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}}.\mbox{\hyperlink{classopenphase_1_1GridParameters_af0b28822d6a3aba3df4db780b51db71a}{Resolution}}\ ==\ \mbox{\hyperlink{namespaceopenphase_a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a}{Resolutions::Dual}})}
\DoxyCodeLine{01047\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01048\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NodePFDR\ =\ \mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.FieldsDR(i,j,k);}
\DoxyCodeLine{01049\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01050\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NodePF\&\ locPF\ =\ (\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}}.\mbox{\hyperlink{classopenphase_1_1GridParameters_af0b28822d6a3aba3df4db780b51db71a}{Resolution}}\ ==\ \mbox{\hyperlink{namespaceopenphase_a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e}{Resolutions::Single}})?\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.Fields(i,j,k):NodePFDR;}
\DoxyCodeLine{01051\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ alpha\ \ =\ locPF.cbegin();}
\DoxyCodeLine{01052\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ !=\ locPF.cend()-\/1;\ ++alpha)}
\DoxyCodeLine{01053\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \ beta\ \ =\ alpha+1;}
\DoxyCodeLine{01054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ beta\ !=\ locPF.cend();\ ++beta)}
\DoxyCodeLine{01055\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01056\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ velocity\ =\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_aba3c1835d0779921de0474313c8aeecc}{Velocity}}(i,\ j,\ k).get\_asym1(alpha-\/>index,\ beta-\/>index);}
\DoxyCodeLine{01057\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ locSTAB\ =\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a50c82db68405e2180be417ad58df0f22}{STAB}}\ /\ dt;}
\DoxyCodeLine{01058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ norm\_1\ =\ 1.0/PF(i,j,k).size();}
\DoxyCodeLine{01059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ prefactor\ =\ pi\ /\ eta\ *\ sqrt(alpha-\/>value*beta-\/>value);}
\DoxyCodeLine{01060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.FieldsProperties[alpha-\/>index].Stage\ ==\ \mbox{\hyperlink{namespaceopenphase_af71cd9b36fd77e1eb90f17b95c04e52eadba005190e58b252f9b5375cdf5655d9}{GrainStages::Seed}}\ or}
\DoxyCodeLine{01061\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.FieldsProperties[\ beta-\/>index].Stage\ ==\ \mbox{\hyperlink{namespaceopenphase_af71cd9b36fd77e1eb90f17b95c04e52eadba005190e58b252f9b5375cdf5655d9}{GrainStages::Seed}})}
\DoxyCodeLine{01062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ prefactor\ =\ std::max(prefactor,\ pi\ /\ eta\ *\ sqrt(1e-\/4));}
\DoxyCodeLine{01064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01065\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ dPhi\_dt1\ =\ (norm\_1*locSTAB*(eta*eta*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a106646554b97f07c33196ab4104822ec}{Interface}}(i,\ j,\ k).get\_value(alpha-\/>index)\ -\/\ eta*eta*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a135732ea710428502c6e1a99998f6b20}{AverageInterface}}(i,\ j,\ k).get\_value(alpha-\/>index))}
\DoxyCodeLine{01066\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/\ \ norm\_1*locSTAB*(eta*eta*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a106646554b97f07c33196ab4104822ec}{Interface}}(i,\ j,\ k).get\_value(beta-\/>index)\ \ -\/\ eta*eta*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a135732ea710428502c6e1a99998f6b20}{AverageInterface}}(i,\ j,\ k).get\_value(beta-\/>index)))}
\DoxyCodeLine{01067\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *std::min((\textcolor{keywordtype}{long}\ \textcolor{keywordtype}{double})1.,\ std::min((\textcolor{keywordtype}{long}\ \textcolor{keywordtype}{double})\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.FieldsProperties[alpha-\/>index].Volume\ /\ (\textcolor{keywordtype}{long}\ \textcolor{keywordtype}{double})\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.FieldsProperties[alpha-\/>index].RefVolume,}
\DoxyCodeLine{01068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{long}\ \textcolor{keywordtype}{double})\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.FieldsProperties[beta-\/>index].Volume\ /\ (\textcolor{keywordtype}{long}\ \textcolor{keywordtype}{double})\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.FieldsProperties[beta-\/>index].RefVolume));}
\DoxyCodeLine{01069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ dPhi\_dt2\ =\ prefactor\ *\ velocity;}
\DoxyCodeLine{01070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PFD(i,\ j,\ k).add\_asym1(alpha-\/>index,\ beta-\/>index,\ dPhi\_dt1+dPhi\_dt2);}
\DoxyCodeLine{01071\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01072\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01073\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01074\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{01075\ \ \ \ \ \}}
\DoxyCodeLine{01076\ \}}

\end{DoxyCode}
\Hypertarget{classopenphase_1_1StabilizationImpl_abce5a0c9dc868eb3cc4304b4bad0beec}\label{classopenphase_1_1StabilizationImpl_abce5a0c9dc868eb3cc4304b4bad0beec} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!ComputeVelocity@{ComputeVelocity}}
\index{ComputeVelocity@{ComputeVelocity}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{ComputeVelocity()}{ComputeVelocity()}}
{\footnotesize\ttfamily void openphase\+::\+Stabilization\+Impl\+::\+Compute\+Velocity (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classopenphase_1_1PhaseField}{Phase\+Field}} \&}]{Phase,  }\item[{\mbox{\hyperlink{classopenphase_1_1InterfaceProperties}{Interface\+Properties}} \&}]{IP,  }\item[{\mbox{\hyperlink{classopenphase_1_1DrivingForce}{Driving\+Force}} \&}]{dG }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00944}{944}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00946\ \{}
\DoxyCodeLine{00947\ \ \ \ \ \textcolor{keyword}{auto}\&\ PF\ \ =\ (\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}}.\mbox{\hyperlink{classopenphase_1_1GridParameters_af0b28822d6a3aba3df4db780b51db71a}{Resolution}}\ ==\ \mbox{\hyperlink{namespaceopenphase_a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e}{Resolutions::Single}})\ ?\ \mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.Fields\ :\ \mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.FieldsDR;}
\DoxyCodeLine{00948\ \ \ \ \ \textcolor{keyword}{auto}\&\ IPP\ =\ (\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}}.\mbox{\hyperlink{classopenphase_1_1GridParameters_af0b28822d6a3aba3df4db780b51db71a}{Resolution}}\ ==\ \mbox{\hyperlink{namespaceopenphase_a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e}{Resolutions::Single}})\ ?\ IP.Properties\ :\ IP.PropertiesDR;}
\DoxyCodeLine{00949\ \ \ \ \ }
\DoxyCodeLine{00950\ \ \ \ \ \textcolor{keywordtype}{double}\ maxv\ =\ 0.;}
\DoxyCodeLine{00951\ \ \ \ \ \textcolor{keywordtype}{double}\ maxdG\ =\ 0.;}
\DoxyCodeLine{00952\ \ \ \ \ \textcolor{keywordtype}{double}\ maxSigma\ =\ 0.;}
\DoxyCodeLine{00953\ \ \ \ \ \textcolor{keywordtype}{int}\ divisor\ =\ (\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}}.\mbox{\hyperlink{classopenphase_1_1GridParameters_af0b28822d6a3aba3df4db780b51db71a}{Resolution}}\ ==\ \mbox{\hyperlink{namespaceopenphase_a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e}{Resolutions::Single}})?1:2;}
\DoxyCodeLine{00954\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,0,reduction(max:maxv,maxdG,maxSigma))}
\DoxyCodeLine{00955\ \ \ \ \ \{}
\DoxyCodeLine{00956\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_aba3c1835d0779921de0474313c8aeecc}{Velocity}}(i,j,k).clear();}
\DoxyCodeLine{00957\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i,j,k).wide\_interface())}
\DoxyCodeLine{00958\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00959\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ alpha\ \ =\ PF(i,j,k).cbegin();}
\DoxyCodeLine{00960\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ !=\ PF(i,j,k).cend()\ -\/\ 1;\ ++alpha)}
\DoxyCodeLine{00961\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ \ beta\ \ =\ alpha\ +\ 1;}
\DoxyCodeLine{00962\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ beta\ !=\ PF(i,j,k).cend();\ ++beta)}
\DoxyCodeLine{00963\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00964\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00965\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ Sigma\ =\ IPP(i,j,k).get\_energy(alpha-\/>index,\ beta-\/>index);}
\DoxyCodeLine{00966\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ Mu\ =\ IPP(i,j,k).get\_mobility(alpha-\/>index,\ beta-\/>index);}
\DoxyCodeLine{00967\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ locdG\ =\ dG.Force(i/divisor,j/divisor,k/divisor).get\_average(alpha-\/>index,\ beta-\/>index);}
\DoxyCodeLine{00968\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ norm\_1\ =\ 1.0/PF(i,j,k).size();}
\DoxyCodeLine{00969\ }
\DoxyCodeLine{00970\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ avgCurvA\ =\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_abcb3da65d0437d93a0ffb25c3f5e71a8}{AverageCurvature}}(i,\ j,\ k).get\_value(alpha-\/>index);}
\DoxyCodeLine{00971\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ avgCurvB\ =\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_abcb3da65d0437d93a0ffb25c3f5e71a8}{AverageCurvature}}(i,\ j,\ k).get\_value(beta-\/>index);}
\DoxyCodeLine{00972\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ kappa\_alpha\ =\ avgCurvA;}
\DoxyCodeLine{00973\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ kappa\_beta\ \ =\ avgCurvB;}
\DoxyCodeLine{00974\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ dPhi\_dt\ =\ Mu*(norm\_1*Sigma*(kappa\_alpha\ -\/\ kappa\_beta)\ \ +\ locdG);}
\DoxyCodeLine{00975\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ gamma\ \ =\ PF(i,j,k).cbegin();}
\DoxyCodeLine{00976\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ gamma\ !=\ PF(i,j,k).cend();\ ++gamma)}
\DoxyCodeLine{00977\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (gamma\ !=\ alpha\ \&\&\ gamma\ !=\ beta\ and\ \mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.FieldsProperties[gamma-\/>index].Stage\ ==\ \mbox{\hyperlink{namespaceopenphase_af71cd9b36fd77e1eb90f17b95c04e52eafa3aff3c185c6dc7754235f397c2099a}{GrainStages::Stable}})}
\DoxyCodeLine{00978\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00979\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ avgCurvC\ =\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_abcb3da65d0437d93a0ffb25c3f5e71a8}{AverageCurvature}}(i,\ j,\ k).get\_value(gamma-\/>index);}
\DoxyCodeLine{00980\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ kappa\_gamma\ =\ avgCurvC;}
\DoxyCodeLine{00981\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dPhi\_dt\ +=\ norm\_1*Mu*(IPP(i,j,k).get\_energy(gamma-\/>index,\ \ beta-\/>index)\ -\/}
\DoxyCodeLine{00982\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ IPP(i,j,k).get\_energy(alpha-\/>index,\ gamma-\/>index))*kappa\_gamma;}
\DoxyCodeLine{00983\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00984\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_aba3c1835d0779921de0474313c8aeecc}{Velocity}}(i,j,k).add\_asym1(alpha-\/>index,\ beta-\/>index,\ \ dPhi\_dt);}
\DoxyCodeLine{00985\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ maxv\ \ =\ std::max(maxv,\ std::fabs(dPhi\_dt));}
\DoxyCodeLine{00986\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ maxdG\ =\ std::max(maxdG,std::fabs(locdG));}
\DoxyCodeLine{00987\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ maxSigma\ =\ std::max(maxSigma,\ std::fabs(dPhi\_dt-\/norm\_1*Mu*locdG));}
\DoxyCodeLine{00988\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00989\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00990\ \ \ \ \ \}}
\DoxyCodeLine{00991\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{00992\ \ \ \ \ \textcolor{keywordflow}{if}\ (maxv\ >\ 0)}
\DoxyCodeLine{00993\ \ \ \ \ \{}
\DoxyCodeLine{00994\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_addd3d5ec1cf53f50a7991ef63d989044}{maxdt}}\ =\ 16\ *\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a50c82db68405e2180be417ad58df0f22}{STAB}}*\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.Grid.dx\ /\ maxv;}
\DoxyCodeLine{00995\ \ \ \ \ \}}
\DoxyCodeLine{00996\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00997\ \ \ \ \ \{}
\DoxyCodeLine{00998\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_addd3d5ec1cf53f50a7991ef63d989044}{maxdt}}\ =\ 16\ *\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a50c82db68405e2180be417ad58df0f22}{STAB}};}
\DoxyCodeLine{00999\ \ \ \ \ \}}
\DoxyCodeLine{01000\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a071e83a8af60c35d4813698976d2b0cc}{maxvelocity}}\ =\ maxv;}
\DoxyCodeLine{01001\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_addd3d5ec1cf53f50a7991ef63d989044}{maxdt}}\ <\ 1e-\/6*\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.Grid.dx)}
\DoxyCodeLine{01002\ \ \ \ \ \{}
\DoxyCodeLine{01003\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_addd3d5ec1cf53f50a7991ef63d989044}{maxdt}}\ =\ 1e-\/6*\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.Grid.dx;}
\DoxyCodeLine{01004\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,0,)}
\DoxyCodeLine{01005\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01006\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_aba3c1835d0779921de0474313c8aeecc}{Velocity}}(i,j,k).clear();}
\DoxyCodeLine{01007\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i,j,k).wide\_interface())}
\DoxyCodeLine{01008\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01009\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ alpha\ \ =\ PF(i,j,k).cbegin();}
\DoxyCodeLine{01010\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ !=\ PF(i,j,k).cend()\ -\/\ 1;\ ++alpha)}
\DoxyCodeLine{01011\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ \ beta\ \ =\ alpha\ +\ 1;}
\DoxyCodeLine{01012\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ beta\ !=\ PF(i,j,k).cend();\ ++beta)}
\DoxyCodeLine{01013\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01014\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ vel\ =\ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_aba3c1835d0779921de0474313c8aeecc}{Velocity}}(i,j,k).get\_asym1(alpha-\/>index,\ beta-\/>index);}
\DoxyCodeLine{01015\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (std::fabs(vel)\ >\ 16*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a50c82db68405e2180be417ad58df0f22}{STAB}}*\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.Grid.dx/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_addd3d5ec1cf53f50a7991ef63d989044}{maxdt}})}
\DoxyCodeLine{01016\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01017\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_aba3c1835d0779921de0474313c8aeecc}{Velocity}}(i,j,k).set\_asym1(alpha-\/>index,\ beta-\/>index,\ \ ((vel>0)-\/(vel<0))*16*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a50c82db68405e2180be417ad58df0f22}{STAB}}*\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.Grid.dx/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_addd3d5ec1cf53f50a7991ef63d989044}{maxdt}});}
\DoxyCodeLine{01018\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01019\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01020\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01021\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01022\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{01023\ \ \ \ \ \}}
\DoxyCodeLine{01024\ \}}

\end{DoxyCode}
\Hypertarget{classopenphase_1_1OPObject_af6910712da7e1d8d4df869a36cc41fb1}\label{classopenphase_1_1OPObject_af6910712da7e1d8d4df869a36cc41fb1} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!FindObject@{FindObject}}
\index{FindObject@{FindObject}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{FindObject()}{FindObject()}}
{\footnotesize\ttfamily static \mbox{\hyperlink{classopenphase_1_1OPObject}{OPObject}} \texorpdfstring{$\ast$}{*} openphase\+::\+OPObject\+::\+Find\+Object (\begin{DoxyParamCaption}\item[{std\+::vector$<$ \mbox{\hyperlink{classopenphase_1_1OPObject}{OPObject}} \texorpdfstring{$\ast$}{*} $>$}]{Object\+List,  }\item[{std\+::string}]{Object\+Name,  }\item[{std\+::string}]{thisclassname,  }\item[{std\+::string}]{thisfunctionname,  }\item[{bool}]{necessary,  }\item[{bool}]{verbose = {\ttfamily true} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}, {\ttfamily [inherited]}}



Definition at line \mbox{\hyperlink{OPObject_8h_source_l00130}{130}} of file \mbox{\hyperlink{OPObject_8h_source}{OPObject.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00138\ \ \ \ \ \{}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ ObjectList.size();\ i++)}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(ObjectList[i]-\/>\mbox{\hyperlink{classopenphase_1_1OPObject_a9006e8f49762d851b52708b363ba14f2}{thisclassname}}.size()\ >=\ ObjectName.size())}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::string\ locObjectName\ =\ ObjectList[i]-\/>thisclassname;}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ locObjectName.resize(ObjectName.size());}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(locObjectName\ ==\ ObjectName)}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ObjectList[i];}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (verbose)}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}No\ "{}}\ <<\ ObjectName\ <<\ \textcolor{stringliteral}{"{}\ object\ found!\ "{}}\ <<\ \mbox{\hyperlink{classopenphase_1_1OPObject_a9006e8f49762d851b52708b363ba14f2}{thisclassname}}}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}."{}}\ <<\ thisfunctionname\ <<\ \textcolor{stringliteral}{"{}()"{}}\ <<\ std::endl;}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(necessary)}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceopenphase_a4d6fed4ab71c6edf2a0bd5dabecc6ec6}{OP\_Exit}}(13);}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00162\ }
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00164\ \ \ \ \ \}}

\end{DoxyCode}
\Hypertarget{classopenphase_1_1OPObject_aa710a4052d686aac0b3f38a9a615682e}\label{classopenphase_1_1OPObject_aa710a4052d686aac0b3f38a9a615682e} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!FindObjects@{FindObjects}}
\index{FindObjects@{FindObjects}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{FindObjects()}{FindObjects()}}
{\footnotesize\ttfamily static std\+::vector$<$ \mbox{\hyperlink{classopenphase_1_1OPObject}{OPObject}} \texorpdfstring{$\ast$}{*} $>$ openphase\+::\+OPObject\+::\+Find\+Objects (\begin{DoxyParamCaption}\item[{std\+::vector$<$ \mbox{\hyperlink{classopenphase_1_1OPObject}{OPObject}} \texorpdfstring{$\ast$}{*} $>$}]{Object\+List,  }\item[{std\+::string}]{Object\+Name,  }\item[{std\+::string}]{thisclassname,  }\item[{std\+::string}]{thisfunctionname,  }\item[{bool}]{necessary,  }\item[{bool}]{verbose = {\ttfamily true} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}, {\ttfamily [inherited]}}



Definition at line \mbox{\hyperlink{OPObject_8h_source_l00166}{166}} of file \mbox{\hyperlink{OPObject_8h_source}{OPObject.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00175\ \ \ \ \ \{}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ std::vector<OPObject*>\ result;}
\DoxyCodeLine{00177\ }
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ ObjectList.size();\ i++)}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(ObjectList[i]-\/>\mbox{\hyperlink{classopenphase_1_1OPObject_a9006e8f49762d851b52708b363ba14f2}{thisclassname}}.size()\ >=\ ObjectName.size())}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::string\ locObjectName\ =\ ObjectList[i]-\/>thisclassname;}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ locObjectName.resize(ObjectName.size());}
\DoxyCodeLine{00184\ }
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(locObjectName\ ==\ ObjectName)}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ result.push\_back(ObjectList[i]);}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00191\ }
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(result.size()\ ==\ 0)}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (verbose)}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}No\ "{}}\ <<\ ObjectName\ <<\ \textcolor{stringliteral}{"{}\ objects\ found!\ "{}}\ <<\ \mbox{\hyperlink{classopenphase_1_1OPObject_a9006e8f49762d851b52708b363ba14f2}{thisclassname}}}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ thisfunctionname\ <<\ std::endl;}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(necessary)}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceopenphase_a4d6fed4ab71c6edf2a0bd5dabecc6ec6}{OP\_Exit}}(13);}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00205\ \ \ \ \ \}}

\end{DoxyCode}
\Hypertarget{classopenphase_1_1StabilizationImpl_a5c0667db3e15eece5b44f3232d18b58a}\label{classopenphase_1_1StabilizationImpl_a5c0667db3e15eece5b44f3232d18b58a} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!GetMaxDT@{GetMaxDT}}
\index{GetMaxDT@{GetMaxDT}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{GetMaxDT()}{GetMaxDT()}}
{\footnotesize\ttfamily double openphase\+::\+Stabilization\+Impl\+::\+Get\+Max\+DT (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l01026}{1026}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01027\ \{}
\DoxyCodeLine{01028\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_addd3d5ec1cf53f50a7991ef63d989044}{maxdt}};}
\DoxyCodeLine{01029\ \}}

\end{DoxyCode}
\Hypertarget{classopenphase_1_1StabilizationImpl_a720007b30873ce5a645b0e553bb26ebc}\label{classopenphase_1_1StabilizationImpl_a720007b30873ce5a645b0e553bb26ebc} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!Initialize@{Initialize}}
\index{Initialize@{Initialize}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{Initialize()}{Initialize()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily void openphase\+::\+Stabilization\+Impl\+::\+Initialize (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classopenphase_1_1Settings}{Settings}} \&}]{loc\+Settings }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00197}{197}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00198\ \{}
\DoxyCodeLine{00199\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1OPObject_a9006e8f49762d851b52708b363ba14f2}{thisclassname}}\ =\ \textcolor{stringliteral}{"{}Stabilization"{}};}
\DoxyCodeLine{00200\ }
\DoxyCodeLine{00201\ \ \ \ \ \textcolor{keywordtype}{int}\ Bcells\ =\ 0;}
\DoxyCodeLine{00202\ }
\DoxyCodeLine{00203\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}}.\mbox{\hyperlink{classopenphase_1_1GridParameters_af0b28822d6a3aba3df4db780b51db71a}{Resolution}}\ ==\ \mbox{\hyperlink{namespaceopenphase_a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a}{Resolutions::Dual}})}
\DoxyCodeLine{00204\ \ \ \ \ \{}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}}\ =\ locSettings.Grid.\mbox{\hyperlink{classopenphase_1_1GridParameters_aa24687417304e06716da10e732d708af}{DoubleResolution}}();}
\DoxyCodeLine{00206\ }
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ Bcells\ =\ 2\ *\ std::max(locSettings.Grid.Bcells,\ \textcolor{keywordtype}{int}(\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}}.\mbox{\hyperlink{classopenphase_1_1GridParameters_a6b4e77f0fe736794ab56285960cd7a1e}{iWidth}}/2));}
\DoxyCodeLine{00208\ \ \ \ \ \}}
\DoxyCodeLine{00209\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00210\ \ \ \ \ \{}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}}\ =\ locSettings.Grid;}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ Bcells\ =\ std::max(locSettings.Grid.Bcells,\ \textcolor{keywordtype}{int}(\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}}.\mbox{\hyperlink{classopenphase_1_1GridParameters_a6b4e77f0fe736794ab56285960cd7a1e}{iWidth}})-\/1);}
\DoxyCodeLine{00214\ \ \ \ \ \}}
\DoxyCodeLine{00215\ }
\DoxyCodeLine{00216\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a246515fab4f0968c8427b13aec75c737}{Curvature}}.Allocate(\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}},\ Bcells);}
\DoxyCodeLine{00217\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_abcb3da65d0437d93a0ffb25c3f5e71a8}{AverageCurvature}}.Allocate(\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}},\ Bcells);}
\DoxyCodeLine{00218\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a23018d7acc8f9d117be93bd4e040aa85}{AverageCurvatureWeight}}.Allocate(\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}},\ Bcells);}
\DoxyCodeLine{00219\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a88de321d75e4df7048b19ba200c95a1d}{AverageCurvatureAux}}.Allocate(\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}},\ Bcells);}
\DoxyCodeLine{00220\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a281828ecf220bcea9081aaa7b16d122a}{AverageCurvatureAuxWeight}}.Allocate(\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}},\ Bcells);}
\DoxyCodeLine{00221\ }
\DoxyCodeLine{00222\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a106646554b97f07c33196ab4104822ec}{Interface}}.Allocate(\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}},\ Bcells);}
\DoxyCodeLine{00223\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a135732ea710428502c6e1a99998f6b20}{AverageInterface}}.Allocate(\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}},\ Bcells);}
\DoxyCodeLine{00224\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a17b62c9d05638005288801132ac70f7d}{AverageInterfaceWeight}}.Allocate(\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}},\ Bcells);}
\DoxyCodeLine{00225\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a32f128b0714e28d3117de25afa3c3653}{AverageInterfaceAux}}.Allocate(\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}},\ Bcells);}
\DoxyCodeLine{00226\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a30033c931fec65ad587d59b674b98541}{AverageInterfaceAuxWeight}}.Allocate(\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}},\ Bcells);}
\DoxyCodeLine{00227\ }
\DoxyCodeLine{00228\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_aba3c1835d0779921de0474313c8aeecc}{Velocity}}.Allocate(\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}},\ Bcells);}
\DoxyCodeLine{00229\ }
\DoxyCodeLine{00230\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1OPObject_aa112048d179026f359161b1f20e5e98e}{initialized}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00231\ }
\DoxyCodeLine{00232\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_addd3d5ec1cf53f50a7991ef63d989044}{maxdt}}\ =\ 1.;}
\DoxyCodeLine{00233\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1ConsoleOutput_ae2753bb70e817b1bdd5ae2b99adf6e0f}{ConsoleOutput::WriteStandard}}(\mbox{\hyperlink{classopenphase_1_1OPObject_a9006e8f49762d851b52708b363ba14f2}{thisclassname}},\ \textcolor{stringliteral}{"{}Initialized"{}});}
\DoxyCodeLine{00234\ \}}

\end{DoxyCode}
\Hypertarget{classopenphase_1_1StabilizationImpl_a0d52d878b467d8e4a87b096f3c229034}\label{classopenphase_1_1StabilizationImpl_a0d52d878b467d8e4a87b096f3c229034} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!Initialize@{Initialize}}
\index{Initialize@{Initialize}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{Initialize()}{Initialize()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily void openphase\+::\+Stabilization\+Impl\+::\+Initialize (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classopenphase_1_1Settings}{Settings}} \&}]{loc\+Settings,  }\item[{\mbox{\hyperlink{classopenphase_1_1LaplacianStencil}{Laplacian\+Stencil}}}]{\+\_\+\+DStencil }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00236}{236}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00237\ \{}
\DoxyCodeLine{00238\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a720007b30873ce5a645b0e553bb26ebc}{Initialize}}(locSettings);}
\DoxyCodeLine{00239\ }
\DoxyCodeLine{00240\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a4d0ae7e8e12a38a3cdbaa8582e9a9f8a}{DStencil}}\ =\ \_DStencil;}
\DoxyCodeLine{00241\ \ \ \ \ \textcolor{keywordtype}{double}\ dx\ =\ locSettings.Grid.dx;}
\DoxyCodeLine{00242\ \ \ \ \ \textcolor{keywordtype}{double}\ Eta\ =\ locSettings.Grid.iWidth\ *\ dx;}
\DoxyCodeLine{00243\ }
\DoxyCodeLine{00244\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a4cdea978e722c0bee973f487f92514f7}{StencilDirections}}\ =\ std::vector<StencilDirection>();}
\DoxyCodeLine{00245\ }
\DoxyCodeLine{00246\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_ad9f96040f8b817329567ddd4fa708717}{n\_vector}}.resize(3);}
\DoxyCodeLine{00247\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_ad9f96040f8b817329567ddd4fa708717}{n\_vector}}[0]\ =\ 1.0;}
\DoxyCodeLine{00248\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_ad9f96040f8b817329567ddd4fa708717}{n\_vector}}[1]\ =\ 0.0;}
\DoxyCodeLine{00249\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_ad9f96040f8b817329567ddd4fa708717}{n\_vector}}[2]\ =\ 0.0;}
\DoxyCodeLine{00250\ }
\DoxyCodeLine{00251\ \ \ \ \ \textcolor{keywordtype}{double}\ norm\ =\ std::sqrt(\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_ad9f96040f8b817329567ddd4fa708717}{n\_vector}}[0]*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_ad9f96040f8b817329567ddd4fa708717}{n\_vector}}[0]\ +\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_ad9f96040f8b817329567ddd4fa708717}{n\_vector}}[1]*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_ad9f96040f8b817329567ddd4fa708717}{n\_vector}}[1]\ +\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_ad9f96040f8b817329567ddd4fa708717}{n\_vector}}[2]*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_ad9f96040f8b817329567ddd4fa708717}{n\_vector}}[2]\ );}
\DoxyCodeLine{00252\ }
\DoxyCodeLine{00253\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_ad9f96040f8b817329567ddd4fa708717}{n\_vector}}[0]\ /=\ norm\ ;}
\DoxyCodeLine{00254\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_ad9f96040f8b817329567ddd4fa708717}{n\_vector}}[1]\ /=\ norm\ ;}
\DoxyCodeLine{00255\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_ad9f96040f8b817329567ddd4fa708717}{n\_vector}}[2]\ /=\ norm\ ;}
\DoxyCodeLine{00256\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ ds\ =\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a4d0ae7e8e12a38a3cdbaa8582e9a9f8a}{DStencil}}.\mbox{\hyperlink{classopenphase_1_1LaplacianStencil_aa7848d05a5add465c455ebf8e6ba52bd}{begin}}();\ ds\ !=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a4d0ae7e8e12a38a3cdbaa8582e9a9f8a}{DStencil}}.\mbox{\hyperlink{classopenphase_1_1LaplacianStencil_a656abbf0ad1128585d1c91c37e6314ff}{end}}();\ ds++)}
\DoxyCodeLine{00257\ \ \ \ \ \{}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ d\_x\ =\ ds-\/>di;}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ d\_y\ =\ ds-\/>dj;}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ d\_z\ =\ ds-\/>dk;}
\DoxyCodeLine{00261\ }
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ StencilDirection*\ dirNew\ =\ \textcolor{keyword}{new}\ StencilDirection();}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ dirNew-\/>d\_x\ =\ d\_x;}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ dirNew-\/>d\_y\ =\ d\_y;}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ dirNew-\/>d\_z\ =\ d\_z;}
\DoxyCodeLine{00266\ }
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ dirNew-\/>stencil\_weight\ =\ ds-\/>weight;}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ dirNew-\/>scal\_prod\ \ \ =\ (d\_x\ *\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_ad9f96040f8b817329567ddd4fa708717}{n\_vector}}[0]\ +\ \ d\_y*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_ad9f96040f8b817329567ddd4fa708717}{n\_vector}}[1]\ +\ \ d\_z*\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_ad9f96040f8b817329567ddd4fa708717}{n\_vector}}[2])*dx\ ;}
\DoxyCodeLine{00270\ }
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ dirNew-\/>alpha\ \ \ \ \ \ \ \ =\ std::cos(\mbox{\hyperlink{namespaceopenphase_a2c26ef9422df111d9487d3d34cf3d613}{Pi}}*(dirNew-\/>scal\_prod)/Eta)\ \ \ ;}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ dirNew-\/>beta\ \ \ \ \ \ \ \ \ =\ std::sin(\mbox{\hyperlink{namespaceopenphase_a2c26ef9422df111d9487d3d34cf3d613}{Pi}}*(dirNew-\/>scal\_prod)/Eta)\ \ \ ;}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ dirNew-\/>phi\_tl\ \ \ \ \ \ \ =\ 0.5*std::cos(\mbox{\hyperlink{namespaceopenphase_a2c26ef9422df111d9487d3d34cf3d613}{Pi}}*(1-\/(dirNew-\/>scal\_prod)/Eta\ ))\ +\ 0.5\ \ ;}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ dirNew-\/>phi\_tu\ \ \ \ \ \ \ =\ 0.5*std::cos(\mbox{\hyperlink{namespaceopenphase_a2c26ef9422df111d9487d3d34cf3d613}{Pi}}*(dirNew-\/>scal\_prod)/Eta)\ +\ 0.5\ \ ;}
\DoxyCodeLine{00275\ }
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a4cdea978e722c0bee973f487f92514f7}{StencilDirections}}.push\_back(*dirNew);}
\DoxyCodeLine{00277\ \ \ \ \ \}}
\DoxyCodeLine{00278\ \}}

\end{DoxyCode}
\Hypertarget{classopenphase_1_1OPObject_ab7b5d4fd526d189f269fade8896a789c}\label{classopenphase_1_1OPObject_ab7b5d4fd526d189f269fade8896a789c} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!Initialize@{Initialize}}
\index{Initialize@{Initialize}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{Initialize()}{Initialize()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily virtual void openphase\+::\+OPObject\+::\+Initialize (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classopenphase_1_1Settings}{Settings}} \&}]{loc\+Settings,  }\item[{std\+::string}]{Object\+Name\+Suffix = {\ttfamily "{}"{}} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}


\begin{DoxyParams}{Parameters}
{\em Object\+Name\+Suffix} & Initializes internal variables and storages \\
\hline
\end{DoxyParams}


Reimplemented in \mbox{\hyperlink{classopenphase_1_1Composition_a49a052989b244d02f4e7a3c5bb67092a}{openphase\+::\+Composition}}, \mbox{\hyperlink{classopenphase_1_1Crystallography_af20107edb2201a79d70680e9d7174596}{openphase\+::\+Crystallography}}, \mbox{\hyperlink{classopenphase_1_1DoubleObstacle_adcd90ecff5b0e5d4febcfa432daa52ea}{openphase\+::\+Double\+Obstacle}}, \mbox{\hyperlink{classopenphase_1_1DrivingForce_ad186444347389c20f2a9c82c57d88549}{openphase\+::\+Driving\+Force}}, \mbox{\hyperlink{classopenphase_1_1ElasticitySolverSpectral_a7b248f75d2cf27f20f9c9d9f7723aa2a}{openphase\+::\+Elasticity\+Solver\+Spectral}}, \mbox{\hyperlink{classopenphase_1_1ElasticProperties_acb72c6046f8e161f94b73c4ba05f467f}{openphase\+::\+Elastic\+Properties}}, \mbox{\hyperlink{classopenphase_1_1ElectricalPotential_ac0368e52f1e9835ddd5342b07fea228e}{openphase\+::\+Electrical\+Potential}}, \mbox{\hyperlink{classopenphase_1_1ElectricProperties_a5de3d1c2a8847b03163ce5ec290f593c}{openphase\+::\+Electric\+Properties}}, \mbox{\hyperlink{classopenphase_1_1ElectricSolverSpectral_a4425ccd6f78a8edfa3f8e42571f8ec5b}{openphase\+::\+Electric\+Solver\+Spectral}}, \mbox{\hyperlink{classopenphase_1_1EquilibriumPartitionDiffusionBinary_a9bae35a2a934d2c997b7738ea9925b05}{openphase\+::\+Equilibrium\+Partition\+Diffusion\+Binary}}, \mbox{\hyperlink{structopenphase_1_1InteractionSolidFluid_a18a309fc3778f9d0114f2d26bd040b43}{openphase\+::\+Interaction\+Solid\+Fluid}}, \mbox{\hyperlink{classopenphase_1_1InteractionSolidSolid_aa6fe570401a6b945f487bdf68b31f045}{openphase\+::\+Interaction\+Solid\+Solid}}, \mbox{\hyperlink{classopenphase_1_1FractureField_a8fa33a3219e9bf0af58faf4dccd750c6}{openphase\+::\+Fracture\+Field}}, \mbox{\hyperlink{classopenphase_1_1GrandPotentialSolver_acc03072fe701231002c064b73f9dc050}{openphase\+::\+Grand\+Potential\+Solver}}, \mbox{\hyperlink{classopenphase_1_1HeatDiffusion_abd10629914789085fcabad8e5cd641dd}{openphase\+::\+Heat\+Diffusion}}, \mbox{\hyperlink{classopenphase_1_1HeatSources_a8fca668ab93199ee60061bf3d3ea2dc8}{openphase\+::\+Heat\+Sources}}, \mbox{\hyperlink{classopenphase_1_1InterfaceDiffusion_abed8e07372aad102952101ef0030921b}{openphase\+::\+Interface\+Diffusion}}, \mbox{\hyperlink{classopenphase_1_1InterfaceDiffusionAnisotropic_a9edfc3929fd61ed8466b358f90de06ef}{openphase\+::\+Interface\+Diffusion\+Anisotropic}}, \mbox{\hyperlink{classopenphase_1_1InterfaceProperties_a1dca55259333b1d1280691692d14dde4}{openphase\+::\+Interface\+Properties}}, \mbox{\hyperlink{classopenphase_1_1InterfaceRegularization_ae8f5ba4990e07d09bf7f220d571a702f}{openphase\+::\+Interface\+Regularization}}, \mbox{\hyperlink{classopenphase_1_1LinearMagneticSolver_a11b72b1623d9b9600416b5fa5d8a49bb}{openphase\+::\+Linear\+Magnetic\+Solver}}, \mbox{\hyperlink{classopenphase_1_1MagneticProperties_aaffccd142d12fe802f6ed3eb9a719898}{openphase\+::\+Magnetic\+Properties}}, \mbox{\hyperlink{classopenphase_1_1MassDensity_a0aeb220f70fa37233d2b6fe757e80c1b}{openphase\+::\+Mass\+Density}}, \mbox{\hyperlink{classopenphase_1_1MechanicalLoads_ad8c9b1bbe6a631acd6ae0591e2c32a8c}{openphase\+::\+Mechanical\+Loads}}, \mbox{\hyperlink{classopenphase_1_1MovingFrame_a8a5b5653a8cc6d9b0baafca837509dfc}{openphase\+::\+Moving\+Frame}}, \mbox{\hyperlink{classopenphase_1_1Noise_a998972377ed4a97de0ce07aa0d9968f4}{openphase\+::\+Noise}}, \mbox{\hyperlink{classopenphase_1_1Nucleation_a9940921a3a1f67a671cf3c6e0b91b06a}{openphase\+::\+Nucleation}}, \mbox{\hyperlink{classopenphase_1_1Orientations_afd4048102db0bb2327e278413e8d3270}{openphase\+::\+Orientations}}, \mbox{\hyperlink{classopenphase_1_1PhaseField_a657703c88fcc2adf92532ffc1955661a}{openphase\+::\+Phase\+Field}}, \mbox{\hyperlink{classopenphase_1_1SymmetryVariants_a6e8cf1fbe023a2f79779913a514aa702}{openphase\+::\+Symmetry\+Variants}}, \mbox{\hyperlink{classopenphase_1_1Temperature_a0dbb5ff491305d07ef9516359d0558ef}{openphase\+::\+Temperature}}, \mbox{\hyperlink{structopenphase_1_1AnalysisSintering_a3eaa83e6c8b4937571db8028760dc509}{openphase\+::\+Analysis\+Sintering}}, \mbox{\hyperlink{classopenphase_1_1UserDrivingForce_aea31591d26508762639faf5ceb1635f2}{openphase\+::\+User\+Driving\+Force}}, \mbox{\hyperlink{classopenphase_1_1Velocities_a0c0dc3bfaa326fbef879a39ad0dd77a5}{openphase\+::\+Velocities}}, \mbox{\hyperlink{classopenphase_1_1ElasticitySolverSpectralImpl_a00c9b7fc79ab00d34826af308beb9043}{openphase\+::\+Elasticity\+Solver\+Spectral\+Impl}}, \mbox{\hyperlink{classopenphase_1_1AdvectionHR_ac09c3411e89753c7e4d1e111e77efd10}{openphase\+::\+Advection\+HR}}, and \mbox{\hyperlink{classopenphase_1_1BoundaryConditions_a2043150542ebbb8ffbe1fcdf12731146}{openphase\+::\+Boundary\+Conditions}}.



Definition at line \mbox{\hyperlink{OPObject_8h_source_l00064}{64}} of file \mbox{\hyperlink{OPObject_8h_source}{OPObject.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00065\ \ \ \ \ \{}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ (void)\ locSettings;\ \textcolor{comment}{//unused}}
\DoxyCodeLine{00067\ \ \ \ \ \}}

\end{DoxyCode}
\Hypertarget{classopenphase_1_1OPObject_a2dbefda68bf2a6123a095d4776f67cab}\label{classopenphase_1_1OPObject_a2dbefda68bf2a6123a095d4776f67cab} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!MoveFrame@{MoveFrame}}
\index{MoveFrame@{MoveFrame}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{MoveFrame()}{MoveFrame()}}
{\footnotesize\ttfamily virtual void openphase\+::\+OPObject\+::\+Move\+Frame (\begin{DoxyParamCaption}\item[{const int}]{dx,  }\item[{const int}]{dy,  }\item[{const int}]{dz,  }\item[{const \mbox{\hyperlink{classopenphase_1_1BoundaryConditions}{Boundary\+Conditions}} \&}]{BC }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}


\begin{DoxyParams}{Parameters}
{\em BC} & Shifts the data in 3D storages by dx, dy and dz (they should be 0, -\/1 or +1) in x, y or z direction, correspondingly. \\
\hline
\end{DoxyParams}


Reimplemented in \mbox{\hyperlink{classopenphase_1_1MassDensity_a6fdd87ac8552c0050bd83b4c6620c180}{openphase\+::\+Mass\+Density}}, \mbox{\hyperlink{classopenphase_1_1Composition_ada44a6da5a526c3eaff543c91b964b1c}{openphase\+::\+Composition}}, \mbox{\hyperlink{classopenphase_1_1Nucleation_a66356950cae6def1bda83d894bca859d}{openphase\+::\+Nucleation}}, \mbox{\hyperlink{classopenphase_1_1PhaseField_aac075854614724322a8b23dfb874ea2f}{openphase\+::\+Phase\+Field}}, \mbox{\hyperlink{classopenphase_1_1Temperature_a3ca9a283c031d7f260265252bc5db839}{openphase\+::\+Temperature}}, and \mbox{\hyperlink{classopenphase_1_1Velocities_ae69458aeb8a6ffe849ee05253a7b77ad}{openphase\+::\+Velocities}}.



Definition at line \mbox{\hyperlink{OPObject_8h_source_l00079}{79}} of file \mbox{\hyperlink{OPObject_8h_source}{OPObject.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00081\ \ \ \ \ \{}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \ \ \ \ (void)\ dx;\ \textcolor{comment}{//unused}}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \ \ \ \ (void)\ dy;\ \textcolor{comment}{//unused}}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \ \ \ \ (void)\ dz;\ \textcolor{comment}{//unused}}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \ \ \ \ (void)\ BC;\ \textcolor{comment}{//unused}}
\DoxyCodeLine{00086\ \ \ \ \ \}}

\end{DoxyCode}
\Hypertarget{classopenphase_1_1OPObject_adbd36cc2fee5c391f60f52ecd6114d2c}\label{classopenphase_1_1OPObject_adbd36cc2fee5c391f60f52ecd6114d2c} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!Read@{Read}}
\index{Read@{Read}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{Read()}{Read()}}
{\footnotesize\ttfamily virtual bool openphase\+::\+OPObject\+::\+Read (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classopenphase_1_1Settings}{Settings}} \&}]{loc\+Settings,  }\item[{const \mbox{\hyperlink{classopenphase_1_1BoundaryConditions}{Boundary\+Conditions}} \&}]{BC,  }\item[{const int}]{t\+Step }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}


\begin{DoxyParams}{Parameters}
{\em t\+Step} & Reads binary input \\
\hline
\end{DoxyParams}


Reimplemented in \mbox{\hyperlink{classopenphase_1_1ElasticProperties_a39c3b97727ff24d3841a555815e8323e}{openphase\+::\+Elastic\+Properties}}, \mbox{\hyperlink{classopenphase_1_1FractureField_adfb75954aa45993908a8ac3dfc58a965}{openphase\+::\+Fracture\+Field}}, \mbox{\hyperlink{classopenphase_1_1HeatSources_a91d91d975d8bd4332187e02232e833c4}{openphase\+::\+Heat\+Sources}}, \mbox{\hyperlink{classopenphase_1_1MassDensity_aba832dfdec9389986c41e8ee060044a8}{openphase\+::\+Mass\+Density}}, \mbox{\hyperlink{classopenphase_1_1MechanicalLoads_a59a62d952286c1d0ab9596ab4f606dfd}{openphase\+::\+Mechanical\+Loads}}, \mbox{\hyperlink{classopenphase_1_1MovingFrame_aa39e0d1f06c1d1d0d3ef4068827fbbba}{openphase\+::\+Moving\+Frame}}, \mbox{\hyperlink{classopenphase_1_1Nucleation_ab4be52cad9e10d0721311e86f7ddd2f0}{openphase\+::\+Nucleation}}, \mbox{\hyperlink{classopenphase_1_1Orientations_a7b80f9edb9f782b2647a4f9d05f039be}{openphase\+::\+Orientations}}, \mbox{\hyperlink{classopenphase_1_1PhaseField_aa2130b8b55885da8bfe082c1ec1021b0}{openphase\+::\+Phase\+Field}}, \mbox{\hyperlink{classopenphase_1_1Velocities_a897280405e088d44748106fa0e496320}{openphase\+::\+Velocities}}, \mbox{\hyperlink{classopenphase_1_1Composition_aa1c8e286282f87a3fabe8a9331046731}{openphase\+::\+Composition}}, \mbox{\hyperlink{classopenphase_1_1FlowSolverLBM_a297a77842a22e3f115c9b9a43979ff05}{openphase\+::\+Flow\+Solver\+LBM}}, and \mbox{\hyperlink{classopenphase_1_1Temperature_aca03bb9cbe27c3e15517975a6e34a75c}{openphase\+::\+Temperature}}.



Definition at line \mbox{\hyperlink{OPObject_8h_source_l00109}{109}} of file \mbox{\hyperlink{OPObject_8h_source}{OPObject.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00111\ \ \ \ \ \{}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ (void)\ locSettings;\ \textcolor{comment}{//unused}}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ (void)\ BC;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//unused}}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ (void)\ tStep;\ \ \ \ \ \ \ \textcolor{comment}{//unused}}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00116\ \ \ \ \ \}}

\end{DoxyCode}
\Hypertarget{classopenphase_1_1StabilizationImpl_aaaed9390e70d7c8f511a249604cfc749}\label{classopenphase_1_1StabilizationImpl_aaaed9390e70d7c8f511a249604cfc749} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!ReadInput@{ReadInput}}
\index{ReadInput@{ReadInput}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{ReadInput()}{ReadInput()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void openphase\+::\+Stabilization\+Impl\+::\+Read\+Input (\begin{DoxyParamCaption}\item[{const std\+::string}]{File\+Name }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{classopenphase_1_1OPObject_a9c766ff0ddd3866b7c2f2f83ebebcf31}{openphase\+::\+OPObject}}.



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00280}{280}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00281\ \{}
\DoxyCodeLine{00282\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1ConsoleOutput_ae2753bb70e817b1bdd5ae2b99adf6e0f}{ConsoleOutput::WriteStandard}}(\textcolor{stringliteral}{"{}Source"{}},\ InputFileName.c\_str());}
\DoxyCodeLine{00283\ \ \ \ \ std::fstream\ inpF(InputFileName.c\_str(),\ std::ios::in\ |\ std::ios\_base::binary);}
\DoxyCodeLine{00284\ \ \ \ \ \textcolor{keywordflow}{if}\ (!inpF)}
\DoxyCodeLine{00285\ \ \ \ \ \{}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1ConsoleOutput_a421faa2fe5d86991328b2b06041a326d}{ConsoleOutput::WriteExit}}(\textcolor{stringliteral}{"{}File\ \(\backslash\)"{}"{}}\ +\ InputFileName\ +\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\ could\ not\ be\ opened"{}},\ \mbox{\hyperlink{classopenphase_1_1OPObject_a9006e8f49762d851b52708b363ba14f2}{thisclassname}},\ \textcolor{stringliteral}{"{}ReadInput()"{}});}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ exit(EXIT\_FAILURE);}
\DoxyCodeLine{00288\ \ \ \ \ \};}
\DoxyCodeLine{00289\ }
\DoxyCodeLine{00290\ \ \ \ \ std::stringstream\ inp;}
\DoxyCodeLine{00291\ \ \ \ \ inp\ <<\ inpF.rdbuf();}
\DoxyCodeLine{00292\ \ \ \ \ inpF.close();}
\DoxyCodeLine{00293\ }
\DoxyCodeLine{00294\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_aaaed9390e70d7c8f511a249604cfc749}{ReadInput}}(inp);}
\DoxyCodeLine{00295\ \}}

\end{DoxyCode}
\Hypertarget{classopenphase_1_1StabilizationImpl_a6ebce2b982b011038ea5061d9ad800db}\label{classopenphase_1_1StabilizationImpl_a6ebce2b982b011038ea5061d9ad800db} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!ReadInput@{ReadInput}}
\index{ReadInput@{ReadInput}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{ReadInput()}{ReadInput()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void openphase\+::\+Stabilization\+Impl\+::\+Read\+Input (\begin{DoxyParamCaption}\item[{std\+::stringstream \&}]{inp }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{classopenphase_1_1OPObject_a9a7696bf13bb3e6b88a6965937aafdbb}{openphase\+::\+OPObject}}.



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00297}{297}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00298\ \{}
\DoxyCodeLine{00299\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1ConsoleOutput_a3adb3c1b74bf9ac814922b7a8283707e}{ConsoleOutput::WriteLineInsert}}(\textcolor{stringliteral}{"{}Stabilization\ input"{}});}
\DoxyCodeLine{00300\ \ \ \ \ \textcolor{keywordtype}{int}\ moduleLocation\ =\ \mbox{\hyperlink{classopenphase_1_1FileInterface_afbaeccd98923fc3babc30e1e7b3eed62}{FileInterface::FindModuleLocation}}(inp,\ \mbox{\hyperlink{classopenphase_1_1OPObject_a9006e8f49762d851b52708b363ba14f2}{thisclassname}});}
\DoxyCodeLine{00301\ \ \ \ \ }
\DoxyCodeLine{00302\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}{range}}\ =\ \mbox{\hyperlink{classopenphase_1_1FileInterface_a8077611f56a17832ac4d22d604df6dcd}{FileInterface::ReadParameterD}}(inp,\ moduleLocation,\ std::string(\textcolor{stringliteral}{"{}Range"{}}),\ \textcolor{keyword}{false},\ 2.5);}
\DoxyCodeLine{00303\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a7861e796060fff81c6cc84c553e43b17}{exponent}}\ =\ \mbox{\hyperlink{classopenphase_1_1FileInterface_a8077611f56a17832ac4d22d604df6dcd}{FileInterface::ReadParameterD}}(inp,\ moduleLocation,\ std::string(\textcolor{stringliteral}{"{}Exponent"{}}),\ \textcolor{keyword}{false},\ 4.);}
\DoxyCodeLine{00304\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a50c82db68405e2180be417ad58df0f22}{STAB}}\ =\ \mbox{\hyperlink{classopenphase_1_1FileInterface_a8077611f56a17832ac4d22d604df6dcd}{FileInterface::ReadParameterD}}(inp,\ moduleLocation,\ std::string(\textcolor{stringliteral}{"{}STAB"{}}),\ \textcolor{keyword}{false},\ 1./(10.*\mbox{\hyperlink{namespaceopenphase_a2c26ef9422df111d9487d3d34cf3d613}{Pi}}*\mbox{\hyperlink{namespaceopenphase_a2c26ef9422df111d9487d3d34cf3d613}{Pi}}));}
\DoxyCodeLine{00305\ \ \ \ \ }
\DoxyCodeLine{00306\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1ConsoleOutput_ad86f674a75177eed4dd6cd8c06fcba47}{ConsoleOutput::WriteLine}}();}
\DoxyCodeLine{00307\ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1ConsoleOutput_acf973fcf791b7ed17177550d8a7175e9}{ConsoleOutput::WriteBlankLine}}();}
\DoxyCodeLine{00308\ \}}

\end{DoxyCode}
\Hypertarget{classopenphase_1_1OPObject_af421c7d819be4718f586fb3f97c34583}\label{classopenphase_1_1OPObject_af421c7d819be4718f586fb3f97c34583} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!Remesh@{Remesh}}
\index{Remesh@{Remesh}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{Remesh()}{Remesh()}}
{\footnotesize\ttfamily virtual void openphase\+::\+OPObject\+::\+Remesh (\begin{DoxyParamCaption}\item[{int}]{new\+Nx,  }\item[{int}]{new\+Ny,  }\item[{int}]{new\+Nz,  }\item[{const \mbox{\hyperlink{classopenphase_1_1BoundaryConditions}{Boundary\+Conditions}} \&}]{BC }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}


\begin{DoxyParams}{Parameters}
{\em BC} & Remeshes the storages \\
\hline
\end{DoxyParams}


Reimplemented in \mbox{\hyperlink{classopenphase_1_1Temperature_a4f468ad73bf630f66285e07bffac1180}{openphase\+::\+Temperature}}, \mbox{\hyperlink{classopenphase_1_1Composition_a50cb9f0303b50d9be87a042338de9b38}{openphase\+::\+Composition}}, \mbox{\hyperlink{classopenphase_1_1DrivingForce_a6a31593f97b24ef93c92263e4b494d6c}{openphase\+::\+Driving\+Force}}, \mbox{\hyperlink{classopenphase_1_1ElasticitySolverSpectral_a0f43cb0cd646cd949207dc11504079a0}{openphase\+::\+Elasticity\+Solver\+Spectral}}, \mbox{\hyperlink{classopenphase_1_1ElasticProperties_a555343a7fc792704f3327dcb175c13c0}{openphase\+::\+Elastic\+Properties}}, \mbox{\hyperlink{classopenphase_1_1EquilibriumPartitionDiffusionBinary_a4d423f214e0007c6e5687a0f57639f52}{openphase\+::\+Equilibrium\+Partition\+Diffusion\+Binary}}, \mbox{\hyperlink{classopenphase_1_1FlowSolverLBM_a4e6f273f5ed0752225c0060c9e044a18}{openphase\+::\+Flow\+Solver\+LBM}}, \mbox{\hyperlink{classopenphase_1_1FractureField_a1221b1fa875c250991ae2cd0e3ea97af}{openphase\+::\+Fracture\+Field}}, \mbox{\hyperlink{classopenphase_1_1HeatDiffusion_a0050a095ec6ae76c07c12b9873b7da0e}{openphase\+::\+Heat\+Diffusion}}, \mbox{\hyperlink{classopenphase_1_1InterfaceProperties_afc0b700a4304af3f7b4ba00a8ace8c7d}{openphase\+::\+Interface\+Properties}}, \mbox{\hyperlink{classopenphase_1_1InterfaceRegularization_a0e0b8d0248dc43b4965436d77488fdc6}{openphase\+::\+Interface\+Regularization}}, \mbox{\hyperlink{classopenphase_1_1MassDensity_aef9628bb442caf724deb579d6461bf9b}{openphase\+::\+Mass\+Density}}, \mbox{\hyperlink{classopenphase_1_1Nucleation_a3ff6f0d72311e580559dd1251806d209}{openphase\+::\+Nucleation}}, \mbox{\hyperlink{classopenphase_1_1Orientations_a7fb68dadae179da5dd2342a81c456f40}{openphase\+::\+Orientations}}, \mbox{\hyperlink{classopenphase_1_1PhaseField_a0f305e969f2b5970684ccf9f8752a669}{openphase\+::\+Phase\+Field}}, \mbox{\hyperlink{classopenphase_1_1Velocities_a3509815f20fc4cf008b43d803a52a691}{openphase\+::\+Velocities}}, and \mbox{\hyperlink{classopenphase_1_1ElasticitySolverSpectralImpl_af3aabadeb9bb14d37395dd1ff056e2bc}{openphase\+::\+Elasticity\+Solver\+Spectral\+Impl}}.



Definition at line \mbox{\hyperlink{OPObject_8h_source_l00088}{88}} of file \mbox{\hyperlink{OPObject_8h_source}{OPObject.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00090\ \ \ \ \ \{}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ (void)\ newNx;\ \textcolor{comment}{//unused}}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ (void)\ newNy;\ \textcolor{comment}{//unused}}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ (void)\ newNz;\ \textcolor{comment}{//unused}}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ (void)\ BC;\ \ \ \ \textcolor{comment}{//unused}}
\DoxyCodeLine{00095\ \ \ \ \ \}}

\end{DoxyCode}
\Hypertarget{classopenphase_1_1OPObject_a098bf706cf87cf06361ec9bca1c7d32c}\label{classopenphase_1_1OPObject_a098bf706cf87cf06361ec9bca1c7d32c} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!SetBoundaryConditions@{SetBoundaryConditions}}
\index{SetBoundaryConditions@{SetBoundaryConditions}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{SetBoundaryConditions()}{SetBoundaryConditions()}}
{\footnotesize\ttfamily virtual void openphase\+::\+OPObject\+::\+Set\+Boundary\+Conditions (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classopenphase_1_1BoundaryConditions}{Boundary\+Conditions}} \&}]{BC }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}



Reimplemented in \mbox{\hyperlink{classopenphase_1_1Composition_a73ba3e2fa9a409f6864f0c2299e50751}{openphase\+::\+Composition}}, \mbox{\hyperlink{classopenphase_1_1DrivingForce_a8a6d98362bb758bd9db818aee7932d3c}{openphase\+::\+Driving\+Force}}, \mbox{\hyperlink{classopenphase_1_1ElasticProperties_abbc1ab2b73dfa443a229d29f1cfd1fed}{openphase\+::\+Elastic\+Properties}}, \mbox{\hyperlink{classopenphase_1_1ElectricProperties_a9d700aa910a329460ff84769bbcfd609}{openphase\+::\+Electric\+Properties}}, \mbox{\hyperlink{classopenphase_1_1FlowSolverLBM_aac503798c87d57cd342e2d56063f481b}{openphase\+::\+Flow\+Solver\+LBM}}, \mbox{\hyperlink{classopenphase_1_1FractureField_aef219f624f3b81f6468a02e971b7a256}{openphase\+::\+Fracture\+Field}}, \mbox{\hyperlink{classopenphase_1_1GrandPotentialSolver_abc96d1d43d31ce138389284b8c602d6b}{openphase\+::\+Grand\+Potential\+Solver}}, \mbox{\hyperlink{classopenphase_1_1InterfaceProperties_af984180c4030714991b47987ce376fc2}{openphase\+::\+Interface\+Properties}}, \mbox{\hyperlink{classopenphase_1_1InterfaceRegularization_a3521ac6756876c9f942a0a2eb57ac5aa}{openphase\+::\+Interface\+Regularization}}, \mbox{\hyperlink{classopenphase_1_1MagneticProperties_a750a5b42048942a811048a123d1f1c7c}{openphase\+::\+Magnetic\+Properties}}, \mbox{\hyperlink{classopenphase_1_1MassDensity_a8852264055d73f458fc159a2a398c105}{openphase\+::\+Mass\+Density}}, \mbox{\hyperlink{classopenphase_1_1Orientations_a82404c971c69a49de0e33e50ab547eea}{openphase\+::\+Orientations}}, \mbox{\hyperlink{classopenphase_1_1PhaseField_a825ae7162676d2a690c3e072d0a49581}{openphase\+::\+Phase\+Field}}, \mbox{\hyperlink{classopenphase_1_1Temperature_a24586483bcb5fc254b7541fd8ff79c87}{openphase\+::\+Temperature}}, and \mbox{\hyperlink{classopenphase_1_1Velocities_a1e2a94e2f48b36eb25554fcd50bf5170}{openphase\+::\+Velocities}}.



Definition at line \mbox{\hyperlink{OPObject_8h_source_l00125}{125}} of file \mbox{\hyperlink{OPObject_8h_source}{OPObject.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00126\ \ \ \ \ \{}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ (void)\ BC;\ \textcolor{comment}{//unused}}
\DoxyCodeLine{00128\ \ \ \ \ \}}

\end{DoxyCode}
\Hypertarget{classopenphase_1_1StabilizationImpl_a0c3f92b617405dcc60a7799b50641baf}\label{classopenphase_1_1StabilizationImpl_a0c3f92b617405dcc60a7799b50641baf} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!Smooth@{Smooth}}
\index{Smooth@{Smooth}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{Smooth()}{Smooth()}}
{\footnotesize\ttfamily void openphase\+::\+Stabilization\+Impl\+::\+Smooth (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classopenphase_1_1PhaseField}{Phase\+Field}} \&}]{Phase }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l01106}{1106}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01107\ \{}
\DoxyCodeLine{01108\ \ \ \ \ \textcolor{keyword}{auto}\&\ PF\ =\ (\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}{Grid}}.\mbox{\hyperlink{classopenphase_1_1GridParameters_af0b28822d6a3aba3df4db780b51db71a}{Resolution}}\ ==\ \mbox{\hyperlink{namespaceopenphase_a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e}{Resolutions::Single}})?\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.Fields:\mbox{\hyperlink{namespaceopenphase_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3}{Phase}}.FieldsDR;}
\DoxyCodeLine{01109\ }
\DoxyCodeLine{01110\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ bcells\ =\ std::max(\textcolor{keywordtype}{long}(0),PF.Bcells()-\/1);}
\DoxyCodeLine{01111\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,bcells,)}
\DoxyCodeLine{01112\ \ \ \ \ \{}
\DoxyCodeLine{01113\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i,j,k).wide\_interface())}
\DoxyCodeLine{01114\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01115\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ alpha\ \ =\ PF(i,j,k).cbegin();}
\DoxyCodeLine{01116\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ !=\ PF(i,j,k).cend();\ ++alpha)}
\DoxyCodeLine{01117\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01118\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ii\ =\ -\/1;\ ii\ <=\ 1;\ ++ii)}
\DoxyCodeLine{01119\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ jj\ =\ -\/1;\ jj\ <=\ 1;\ ++jj)}
\DoxyCodeLine{01120\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ kk\ =\ -\/1;\ kk\ <=\ 1;\ ++kk)}
\DoxyCodeLine{01121\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01122\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a135732ea710428502c6e1a99998f6b20}{AverageInterface}}(i,j,k).add\_value(alpha-\/>index,PF(i+ii,j+jj,k+kk).get\_value(alpha-\/>index));}
\DoxyCodeLine{01123\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a17b62c9d05638005288801132ac70f7d}{AverageInterfaceWeight}}(i,j,k).add\_value(alpha-\/>index,\ 1);}
\DoxyCodeLine{01124\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01125\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01126\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01127\ \ \ \ \ \}}
\DoxyCodeLine{01128\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{01129\ \ \ \ \ \mbox{\hyperlink{Macros_8h_a62927f995b0bd1de2eba0c018173118a}{OMP\_PARALLEL\_STORAGE\_LOOP\_BEGIN}}(i,j,k,PF,bcells,)}
\DoxyCodeLine{01130\ \ \ \ \ \{}
\DoxyCodeLine{01131\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PF(i,j,k).wide\_interface())}
\DoxyCodeLine{01132\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01133\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ alpha\ \ =\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a135732ea710428502c6e1a99998f6b20}{AverageInterface}}(i,j,k).cbegin();}
\DoxyCodeLine{01134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ !=\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a135732ea710428502c6e1a99998f6b20}{AverageInterface}}(i,j,k).cend();\ ++alpha)}
\DoxyCodeLine{01135\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PF(i,j,k).set\_value(alpha-\/>index,\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a135732ea710428502c6e1a99998f6b20}{AverageInterface}}(i,j,k).get\_value(alpha-\/>index)/\mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a17b62c9d05638005288801132ac70f7d}{AverageInterfaceWeight}}(i,j,k).get\_value(alpha-\/>index));}
\DoxyCodeLine{01137\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01138\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01139\ \ \ \ \ \}}
\DoxyCodeLine{01140\ \ \ \ \ \mbox{\hyperlink{Macros_8h_aeb62b2001f34442764a83858492dcff3}{OMP\_PARALLEL\_STORAGE\_LOOP\_END}}}
\DoxyCodeLine{01141\ \}}

\end{DoxyCode}
\Hypertarget{classopenphase_1_1OPObject_a2b2d60f99c90b6fc30f52b516ee0df2b}\label{classopenphase_1_1OPObject_a2b2d60f99c90b6fc30f52b516ee0df2b} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!Write@{Write}}
\index{Write@{Write}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{Write()}{Write()}}
{\footnotesize\ttfamily virtual bool openphase\+::\+OPObject\+::\+Write (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classopenphase_1_1Settings}{Settings}} \&}]{loc\+Settings,  }\item[{const int}]{t\+Step }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}



\texorpdfstring{$<$}{<} Writes binary output 



Reimplemented in \mbox{\hyperlink{classopenphase_1_1ElasticProperties_a7aabf341be293f2d314e1500481bad09}{openphase\+::\+Elastic\+Properties}}, \mbox{\hyperlink{classopenphase_1_1Composition_aa59772cf25ef88cbc83d611c8ec844eb}{openphase\+::\+Composition}}, \mbox{\hyperlink{classopenphase_1_1FlowSolverLBM_a7cdecb6b85ec910f609c81c816482972}{openphase\+::\+Flow\+Solver\+LBM}}, \mbox{\hyperlink{classopenphase_1_1FractureField_a53f22bc42b3dfca71c7ff041d277a407}{openphase\+::\+Fracture\+Field}}, \mbox{\hyperlink{classopenphase_1_1GrandPotentialSolver_a3d5346070d07748e29dfa70149728d0d}{openphase\+::\+Grand\+Potential\+Solver}}, \mbox{\hyperlink{classopenphase_1_1HeatSources_a5a5a8fcedae5b862c9bf4e432bc738d2}{openphase\+::\+Heat\+Sources}}, \mbox{\hyperlink{classopenphase_1_1MassDensity_aaa9e7a289b944816449df64b3ca7dfad}{openphase\+::\+Mass\+Density}}, \mbox{\hyperlink{classopenphase_1_1MechanicalLoads_a62e3d5c01f6d2c96c2f3287d9f4ea159}{openphase\+::\+Mechanical\+Loads}}, \mbox{\hyperlink{classopenphase_1_1MovingFrame_a24e792b1862b27024e9144b3db9dd057}{openphase\+::\+Moving\+Frame}}, \mbox{\hyperlink{classopenphase_1_1Nucleation_a15cf07a79ba1a9af6d3e3c229a140cfe}{openphase\+::\+Nucleation}}, \mbox{\hyperlink{classopenphase_1_1Orientations_ae4b0f1a8a79484984092bfdd35ccccc7}{openphase\+::\+Orientations}}, \mbox{\hyperlink{classopenphase_1_1PhaseField_a939d4b51c2e44fc256f73da1f592d60d}{openphase\+::\+Phase\+Field}}, \mbox{\hyperlink{classopenphase_1_1Temperature_acadd91be5e410bfa5ff84680ff1e4b8c}{openphase\+::\+Temperature}}, and \mbox{\hyperlink{classopenphase_1_1Velocities_a4185092dbac2ec8554e41bd6eeeb5c9e}{openphase\+::\+Velocities}}.



Definition at line \mbox{\hyperlink{OPObject_8h_source_l00118}{118}} of file \mbox{\hyperlink{OPObject_8h_source}{OPObject.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00119\ \ \ \ \ \{}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ (void)\ locSettings;\ \textcolor{comment}{//unused}}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ (void)\ tStep;\ \ \ \ \ \ \ \textcolor{comment}{//unused}}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00123\ \ \ \ \ \}}

\end{DoxyCode}
\Hypertarget{classopenphase_1_1StabilizationImpl_ae1b22babe0ee2f7697d48dd5b966e417}\label{classopenphase_1_1StabilizationImpl_ae1b22babe0ee2f7697d48dd5b966e417} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!WriteVTK@{WriteVTK}}
\index{WriteVTK@{WriteVTK}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{WriteVTK()}{WriteVTK()}}
{\footnotesize\ttfamily void openphase\+::\+Stabilization\+Impl\+::\+Write\+VTK (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classopenphase_1_1Settings}{Settings}} \&}]{loc\+Settings,  }\item[{const int}]{t\+Step,  }\item[{const size\+\_\+t}]{indexA,  }\item[{const size\+\_\+t}]{indexB,  }\item[{const int}]{precision }\end{DoxyParamCaption}) const}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l01078}{1078}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01081\ \{}
\DoxyCodeLine{01082\ \ \ \ \ std::vector<VTK::Field\_t>\ ListOfFields;}
\DoxyCodeLine{01083\ \ \ \ \ \{}
\DoxyCodeLine{01084\ \ \ \ \ \ \ \ \ std::stringstream\ converter;}
\DoxyCodeLine{01085\ \ \ \ \ \ \ \ \ converter\ <<\ indexA;}
\DoxyCodeLine{01086\ \ \ \ \ \ \ \ \ std::string\ phase\ =\ converter.str();}
\DoxyCodeLine{01087\ }
\DoxyCodeLine{01088\ \ \ \ \ \ \ \ \ ListOfFields.push\_back((VTK::Field\_t)\ \{\textcolor{stringliteral}{"{}Interface("{}}\ +\ phase\ +\ \textcolor{stringliteral}{"{})"{}},\ [indexA,\textcolor{keyword}{this}](\textcolor{keywordtype}{int}\ i,\textcolor{keywordtype}{int}\ j,\textcolor{keywordtype}{int}\ k)\{\textcolor{keywordflow}{return}\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a106646554b97f07c33196ab4104822ec}{Interface}}(i,j,k).get\_value(indexA);\}\});}
\DoxyCodeLine{01089\ \ \ \ \ \ \ \ \ ListOfFields.push\_back((VTK::Field\_t)\ \{\textcolor{stringliteral}{"{}AverageInterface("{}}\ +\ phase\ +\ \textcolor{stringliteral}{"{})"{}},\ [indexA,\textcolor{keyword}{this}](\textcolor{keywordtype}{int}\ i,\textcolor{keywordtype}{int}\ j,\textcolor{keywordtype}{int}\ k)\{\textcolor{keywordflow}{return}\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a135732ea710428502c6e1a99998f6b20}{AverageInterface}}(i,j,k).get\_value(indexA);\}\});}
\DoxyCodeLine{01090\ \ \ \ \ \ \ \ \ ListOfFields.push\_back((VTK::Field\_t)\ \{\textcolor{stringliteral}{"{}Curvature("{}}\ +\ phase\ +\ \textcolor{stringliteral}{"{})"{}},\ [indexA,\textcolor{keyword}{this}](\textcolor{keywordtype}{int}\ i,\textcolor{keywordtype}{int}\ j,\textcolor{keywordtype}{int}\ k)\{\textcolor{keywordflow}{return}\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_a246515fab4f0968c8427b13aec75c737}{Curvature}}(i,j,k).get\_value(indexA);\}\});}
\DoxyCodeLine{01091\ \ \ \ \ \ \ \ \ ListOfFields.push\_back((VTK::Field\_t)\ \{\textcolor{stringliteral}{"{}AverageCurvature("{}}\ +\ phase\ +\ \textcolor{stringliteral}{"{})"{}},\ [indexA,\textcolor{keyword}{this}](\textcolor{keywordtype}{int}\ i,\textcolor{keywordtype}{int}\ j,\textcolor{keywordtype}{int}\ k)\{\textcolor{keywordflow}{return}\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_abcb3da65d0437d93a0ffb25c3f5e71a8}{AverageCurvature}}(i,j,k).get\_value(indexA);\}\});}
\DoxyCodeLine{01092\ \ \ \ \ \}}
\DoxyCodeLine{01093\ \ \ \ \ \{}
\DoxyCodeLine{01094\ \ \ \ \ }
\DoxyCodeLine{01095\ \ \ \ \ \ \ \ \ std::stringstream\ converter;}
\DoxyCodeLine{01096\ \ \ \ \ \ \ \ \ converter\ <<\ indexA\ <<\ \textcolor{stringliteral}{"{},"{}}\ <<\ indexB;}
\DoxyCodeLine{01097\ \ \ \ \ \ \ \ \ std::string\ phases\ =\ converter.str();}
\DoxyCodeLine{01098\ }
\DoxyCodeLine{01099\ \ \ \ \ \ \ \ \ ListOfFields.push\_back((VTK::Field\_t)\ \{\textcolor{stringliteral}{"{}Velocity("{}}\ +\ phases\ +\ \textcolor{stringliteral}{"{})"{}},\ [indexA,indexB,\textcolor{keyword}{this}](\textcolor{keywordtype}{int}\ i,\textcolor{keywordtype}{int}\ j,\textcolor{keywordtype}{int}\ k)\{\textcolor{keywordflow}{return}\ \mbox{\hyperlink{classopenphase_1_1StabilizationImpl_aba3c1835d0779921de0474313c8aeecc}{Velocity}}(i,j,k).get\_asym1(indexA,\ indexB);\}\});}
\DoxyCodeLine{01100\ \ \ \ \ \}}
\DoxyCodeLine{01101\ \ \ \ \ std::string\ Filename\ =\ \mbox{\hyperlink{classopenphase_1_1FileInterface_a19ed8803c3eb456f4708ccc6c6edd995}{FileInterface::MakeFileName}}(locSettings.VTKDir,\ \textcolor{stringliteral}{"{}Stabilization\_"{}},\ tStep,\ \textcolor{stringliteral}{"{}.vts"{}});}
\DoxyCodeLine{01102\ }
\DoxyCodeLine{01103\ \ \ \ \ \mbox{\hyperlink{structopenphase_1_1VTK_a7617ede48a3aded40ba2eb72d60447f1}{VTK::Write}}(Filename,\ locSettings,\ ListOfFields,\ precision);}
\DoxyCodeLine{01104\ \}}

\end{DoxyCode}


\doxysubsection{Member Data Documentation}
\Hypertarget{classopenphase_1_1OPObject_a7f54d22dc59afcace6359f599fabcaac}\label{classopenphase_1_1OPObject_a7f54d22dc59afcace6359f599fabcaac} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!advectable@{advectable}}
\index{advectable@{advectable}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{advectable}{advectable}}
{\footnotesize\ttfamily bool openphase\+::\+OPObject\+::advectable = false\hspace{0.3cm}{\ttfamily [inherited]}}



True if the object has non-\/empty \doxylink{classopenphase_1_1OPObject_afd82ead485f6d9695aa733729100614c}{Advect()} method. 



Definition at line \mbox{\hyperlink{OPObject_8h_source_l00060}{60}} of file \mbox{\hyperlink{OPObject_8h_source}{OPObject.\+h}}.

\Hypertarget{classopenphase_1_1StabilizationImpl_abcb3da65d0437d93a0ffb25c3f5e71a8}\label{classopenphase_1_1StabilizationImpl_abcb3da65d0437d93a0ffb25c3f5e71a8} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!AverageCurvature@{AverageCurvature}}
\index{AverageCurvature@{AverageCurvature}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{AverageCurvature}{AverageCurvature}}
{\footnotesize\ttfamily \mbox{\hyperlink{classopenphase_1_1Storage3D}{Storage3D}}$<$\mbox{\hyperlink{classopenphase_1_1NodePF}{Node\+PF}}, 0$>$ openphase\+::\+Stabilization\+Impl\+::\+Average\+Curvature}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00086}{86}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.

\Hypertarget{classopenphase_1_1StabilizationImpl_a88de321d75e4df7048b19ba200c95a1d}\label{classopenphase_1_1StabilizationImpl_a88de321d75e4df7048b19ba200c95a1d} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!AverageCurvatureAux@{AverageCurvatureAux}}
\index{AverageCurvatureAux@{AverageCurvatureAux}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{AverageCurvatureAux}{AverageCurvatureAux}}
{\footnotesize\ttfamily \mbox{\hyperlink{classopenphase_1_1Storage3D}{Storage3D}}$<$\mbox{\hyperlink{classopenphase_1_1NodePF}{Node\+PF}}, 0$>$ openphase\+::\+Stabilization\+Impl\+::\+Average\+Curvature\+Aux}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00088}{88}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.

\Hypertarget{classopenphase_1_1StabilizationImpl_a281828ecf220bcea9081aaa7b16d122a}\label{classopenphase_1_1StabilizationImpl_a281828ecf220bcea9081aaa7b16d122a} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!AverageCurvatureAuxWeight@{AverageCurvatureAuxWeight}}
\index{AverageCurvatureAuxWeight@{AverageCurvatureAuxWeight}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{AverageCurvatureAuxWeight}{AverageCurvatureAuxWeight}}
{\footnotesize\ttfamily \mbox{\hyperlink{classopenphase_1_1Storage3D}{Storage3D}}$<$\mbox{\hyperlink{classopenphase_1_1NodePF}{Node\+PF}}, 0$>$ openphase\+::\+Stabilization\+Impl\+::\+Average\+Curvature\+Aux\+Weight}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00089}{89}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.

\Hypertarget{classopenphase_1_1StabilizationImpl_a23018d7acc8f9d117be93bd4e040aa85}\label{classopenphase_1_1StabilizationImpl_a23018d7acc8f9d117be93bd4e040aa85} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!AverageCurvatureWeight@{AverageCurvatureWeight}}
\index{AverageCurvatureWeight@{AverageCurvatureWeight}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{AverageCurvatureWeight}{AverageCurvatureWeight}}
{\footnotesize\ttfamily \mbox{\hyperlink{classopenphase_1_1Storage3D}{Storage3D}}$<$\mbox{\hyperlink{classopenphase_1_1NodePF}{Node\+PF}}, 0$>$ openphase\+::\+Stabilization\+Impl\+::\+Average\+Curvature\+Weight}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00087}{87}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.

\Hypertarget{classopenphase_1_1StabilizationImpl_a135732ea710428502c6e1a99998f6b20}\label{classopenphase_1_1StabilizationImpl_a135732ea710428502c6e1a99998f6b20} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!AverageInterface@{AverageInterface}}
\index{AverageInterface@{AverageInterface}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{AverageInterface}{AverageInterface}}
{\footnotesize\ttfamily \mbox{\hyperlink{classopenphase_1_1Storage3D}{Storage3D}}$<$\mbox{\hyperlink{classopenphase_1_1NodePF}{Node\+PF}}, 0$>$ openphase\+::\+Stabilization\+Impl\+::\+Average\+Interface}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00091}{91}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.

\Hypertarget{classopenphase_1_1StabilizationImpl_a32f128b0714e28d3117de25afa3c3653}\label{classopenphase_1_1StabilizationImpl_a32f128b0714e28d3117de25afa3c3653} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!AverageInterfaceAux@{AverageInterfaceAux}}
\index{AverageInterfaceAux@{AverageInterfaceAux}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{AverageInterfaceAux}{AverageInterfaceAux}}
{\footnotesize\ttfamily \mbox{\hyperlink{classopenphase_1_1Storage3D}{Storage3D}}$<$\mbox{\hyperlink{classopenphase_1_1NodePF}{Node\+PF}}, 0$>$ openphase\+::\+Stabilization\+Impl\+::\+Average\+Interface\+Aux}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00093}{93}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.

\Hypertarget{classopenphase_1_1StabilizationImpl_a30033c931fec65ad587d59b674b98541}\label{classopenphase_1_1StabilizationImpl_a30033c931fec65ad587d59b674b98541} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!AverageInterfaceAuxWeight@{AverageInterfaceAuxWeight}}
\index{AverageInterfaceAuxWeight@{AverageInterfaceAuxWeight}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{AverageInterfaceAuxWeight}{AverageInterfaceAuxWeight}}
{\footnotesize\ttfamily \mbox{\hyperlink{classopenphase_1_1Storage3D}{Storage3D}}$<$\mbox{\hyperlink{classopenphase_1_1NodePF}{Node\+PF}}, 0$>$ openphase\+::\+Stabilization\+Impl\+::\+Average\+Interface\+Aux\+Weight}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00094}{94}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.

\Hypertarget{classopenphase_1_1StabilizationImpl_a17b62c9d05638005288801132ac70f7d}\label{classopenphase_1_1StabilizationImpl_a17b62c9d05638005288801132ac70f7d} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!AverageInterfaceWeight@{AverageInterfaceWeight}}
\index{AverageInterfaceWeight@{AverageInterfaceWeight}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{AverageInterfaceWeight}{AverageInterfaceWeight}}
{\footnotesize\ttfamily \mbox{\hyperlink{classopenphase_1_1Storage3D}{Storage3D}}$<$\mbox{\hyperlink{classopenphase_1_1NodePF}{Node\+PF}}, 0$>$ openphase\+::\+Stabilization\+Impl\+::\+Average\+Interface\+Weight}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00092}{92}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.

\Hypertarget{classopenphase_1_1OPObject_a49a9d1e352e5dafc93f493012d527ee1}\label{classopenphase_1_1OPObject_a49a9d1e352e5dafc93f493012d527ee1} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!boundary\_conditions@{boundary\_conditions}}
\index{boundary\_conditions@{boundary\_conditions}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{boundary\_conditions}{boundary\_conditions}}
{\footnotesize\ttfamily bool openphase\+::\+OPObject\+::boundary\+\_\+conditions = false\hspace{0.3cm}{\ttfamily [inherited]}}



True if the object has non-\/empty \doxylink{classopenphase_1_1OPObject_a098bf706cf87cf06361ec9bca1c7d32c}{Set\+Boundary\+Conditions()} 



Definition at line \mbox{\hyperlink{OPObject_8h_source_l00062}{62}} of file \mbox{\hyperlink{OPObject_8h_source}{OPObject.\+h}}.

\Hypertarget{classopenphase_1_1StabilizationImpl_a246515fab4f0968c8427b13aec75c737}\label{classopenphase_1_1StabilizationImpl_a246515fab4f0968c8427b13aec75c737} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!Curvature@{Curvature}}
\index{Curvature@{Curvature}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{Curvature}{Curvature}}
{\footnotesize\ttfamily \mbox{\hyperlink{classopenphase_1_1Storage3D}{Storage3D}}$<$\mbox{\hyperlink{classopenphase_1_1NodePF}{Node\+PF}}, 0$>$ openphase\+::\+Stabilization\+Impl\+::\+Curvature}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00090}{90}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.

\Hypertarget{classopenphase_1_1StabilizationImpl_a4d0ae7e8e12a38a3cdbaa8582e9a9f8a}\label{classopenphase_1_1StabilizationImpl_a4d0ae7e8e12a38a3cdbaa8582e9a9f8a} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!DStencil@{DStencil}}
\index{DStencil@{DStencil}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{DStencil}{DStencil}}
{\footnotesize\ttfamily \mbox{\hyperlink{classopenphase_1_1LaplacianStencil}{Laplacian\+Stencil}} openphase\+::\+Stabilization\+Impl\+::\+DStencil\hspace{0.3cm}{\ttfamily [private]}}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00103}{103}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.

\Hypertarget{classopenphase_1_1StabilizationImpl_a7861e796060fff81c6cc84c553e43b17}\label{classopenphase_1_1StabilizationImpl_a7861e796060fff81c6cc84c553e43b17} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!exponent@{exponent}}
\index{exponent@{exponent}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{exponent}{exponent}}
{\footnotesize\ttfamily double openphase\+::\+Stabilization\+Impl\+::exponent\hspace{0.3cm}{\ttfamily [private]}}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00104}{104}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.

\Hypertarget{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94}\label{classopenphase_1_1StabilizationImpl_a2f2e1a62769811116054957f9836ad94} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!Grid@{Grid}}
\index{Grid@{Grid}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{Grid}{Grid}}
{\footnotesize\ttfamily \mbox{\hyperlink{classopenphase_1_1GridParameters}{Grid\+Parameters}} openphase\+::\+Stabilization\+Impl\+::\+Grid}



Simulation grid parameters. 



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00099}{99}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.

\Hypertarget{classopenphase_1_1OPObject_aa112048d179026f359161b1f20e5e98e}\label{classopenphase_1_1OPObject_aa112048d179026f359161b1f20e5e98e} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!initialized@{initialized}}
\index{initialized@{initialized}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{initialized}{initialized}}
{\footnotesize\ttfamily bool openphase\+::\+OPObject\+::initialized = false\hspace{0.3cm}{\ttfamily [inherited]}}



True if obect\textquotesingle{}s Initialize has been executed. 



Definition at line \mbox{\hyperlink{OPObject_8h_source_l00057}{57}} of file \mbox{\hyperlink{OPObject_8h_source}{OPObject.\+h}}.

\Hypertarget{classopenphase_1_1OPObject_a65ef7d7ae73be8f9a7fa626762c4937d}\label{classopenphase_1_1OPObject_a65ef7d7ae73be8f9a7fa626762c4937d} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!input\_read@{input\_read}}
\index{input\_read@{input\_read}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{input\_read}{input\_read}}
{\footnotesize\ttfamily bool openphase\+::\+OPObject\+::input\+\_\+read = false\hspace{0.3cm}{\ttfamily [inherited]}}



True if obect\textquotesingle{}s \doxylink{classopenphase_1_1StabilizationImpl_aaaed9390e70d7c8f511a249604cfc749}{Read\+Input()} has been executed. 



Definition at line \mbox{\hyperlink{OPObject_8h_source_l00058}{58}} of file \mbox{\hyperlink{OPObject_8h_source}{OPObject.\+h}}.

\Hypertarget{classopenphase_1_1StabilizationImpl_a106646554b97f07c33196ab4104822ec}\label{classopenphase_1_1StabilizationImpl_a106646554b97f07c33196ab4104822ec} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!Interface@{Interface}}
\index{Interface@{Interface}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{Interface}{Interface}}
{\footnotesize\ttfamily \mbox{\hyperlink{classopenphase_1_1Storage3D}{Storage3D}}$<$\mbox{\hyperlink{classopenphase_1_1NodePF}{Node\+PF}}, 0$>$ openphase\+::\+Stabilization\+Impl\+::\+Interface}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00095}{95}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.

\Hypertarget{classopenphase_1_1StabilizationImpl_addd3d5ec1cf53f50a7991ef63d989044}\label{classopenphase_1_1StabilizationImpl_addd3d5ec1cf53f50a7991ef63d989044} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!maxdt@{maxdt}}
\index{maxdt@{maxdt}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{maxdt}{maxdt}}
{\footnotesize\ttfamily double openphase\+::\+Stabilization\+Impl\+::maxdt}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00098}{98}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.

\Hypertarget{classopenphase_1_1StabilizationImpl_a071e83a8af60c35d4813698976d2b0cc}\label{classopenphase_1_1StabilizationImpl_a071e83a8af60c35d4813698976d2b0cc} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!maxvelocity@{maxvelocity}}
\index{maxvelocity@{maxvelocity}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{maxvelocity}{maxvelocity}}
{\footnotesize\ttfamily double openphase\+::\+Stabilization\+Impl\+::maxvelocity}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00097}{97}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.

\Hypertarget{classopenphase_1_1StabilizationImpl_ad9f96040f8b817329567ddd4fa708717}\label{classopenphase_1_1StabilizationImpl_ad9f96040f8b817329567ddd4fa708717} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!n\_vector@{n\_vector}}
\index{n\_vector@{n\_vector}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{n\_vector}{n\_vector}}
{\footnotesize\ttfamily std\+::vector$<$double$>$ openphase\+::\+Stabilization\+Impl\+::n\+\_\+vector\hspace{0.3cm}{\ttfamily [private]}}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00107}{107}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.

\Hypertarget{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a}\label{classopenphase_1_1StabilizationImpl_a16605c945051a5f128692a881215259a} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!range@{range}}
\index{range@{range}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{range}{range}}
{\footnotesize\ttfamily double openphase\+::\+Stabilization\+Impl\+::range\hspace{0.3cm}{\ttfamily [private]}}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00105}{105}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.

\Hypertarget{classopenphase_1_1OPObject_aa5b7ff7b56e2d266c2fd59b620a1603b}\label{classopenphase_1_1OPObject_aa5b7ff7b56e2d266c2fd59b620a1603b} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!readable@{readable}}
\index{readable@{readable}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{readable}{readable}}
{\footnotesize\ttfamily bool openphase\+::\+OPObject\+::readable = false\hspace{0.3cm}{\ttfamily [inherited]}}



True if the object has non-\/empty \doxylink{classopenphase_1_1OPObject_adbd36cc2fee5c391f60f52ecd6114d2c}{Read()} method. 



Definition at line \mbox{\hyperlink{OPObject_8h_source_l00061}{61}} of file \mbox{\hyperlink{OPObject_8h_source}{OPObject.\+h}}.

\Hypertarget{classopenphase_1_1OPObject_a44d40bc5a3ef87d7c461b457e01091dd}\label{classopenphase_1_1OPObject_a44d40bc5a3ef87d7c461b457e01091dd} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!remeshable@{remeshable}}
\index{remeshable@{remeshable}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{remeshable}{remeshable}}
{\footnotesize\ttfamily bool openphase\+::\+OPObject\+::remeshable = false\hspace{0.3cm}{\ttfamily [inherited]}}



True if the object has non-\/empty \doxylink{classopenphase_1_1OPObject_af421c7d819be4718f586fb3f97c34583}{Remesh()} method. 



Definition at line \mbox{\hyperlink{OPObject_8h_source_l00059}{59}} of file \mbox{\hyperlink{OPObject_8h_source}{OPObject.\+h}}.

\Hypertarget{classopenphase_1_1StabilizationImpl_a50c82db68405e2180be417ad58df0f22}\label{classopenphase_1_1StabilizationImpl_a50c82db68405e2180be417ad58df0f22} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!STAB@{STAB}}
\index{STAB@{STAB}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{STAB}{STAB}}
{\footnotesize\ttfamily double openphase\+::\+Stabilization\+Impl\+::\+STAB\hspace{0.3cm}{\ttfamily [private]}}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00106}{106}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.

\Hypertarget{classopenphase_1_1StabilizationImpl_a4cdea978e722c0bee973f487f92514f7}\label{classopenphase_1_1StabilizationImpl_a4cdea978e722c0bee973f487f92514f7} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!StencilDirections@{StencilDirections}}
\index{StencilDirections@{StencilDirections}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{StencilDirections}{StencilDirections}}
{\footnotesize\ttfamily std\+::vector$<$\mbox{\hyperlink{classopenphase_1_1StencilDirection}{Stencil\+Direction}}$>$ openphase\+::\+Stabilization\+Impl\+::\+Stencil\+Directions\hspace{0.3cm}{\ttfamily [private]}}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00108}{108}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.

\Hypertarget{classopenphase_1_1OPObject_a9006e8f49762d851b52708b363ba14f2}\label{classopenphase_1_1OPObject_a9006e8f49762d851b52708b363ba14f2} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!thisclassname@{thisclassname}}
\index{thisclassname@{thisclassname}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{thisclassname}{thisclassname}}
{\footnotesize\ttfamily std\+::string openphase\+::\+OPObject\+::thisclassname\hspace{0.3cm}{\ttfamily [inherited]}}



Object\textquotesingle{}s implementation class name. 



Definition at line \mbox{\hyperlink{OPObject_8h_source_l00054}{54}} of file \mbox{\hyperlink{OPObject_8h_source}{OPObject.\+h}}.

\Hypertarget{classopenphase_1_1OPObject_ac8c040bdc306f76b58d5a79201e5df66}\label{classopenphase_1_1OPObject_ac8c040bdc306f76b58d5a79201e5df66} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!thisobjectname@{thisobjectname}}
\index{thisobjectname@{thisobjectname}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{thisobjectname}{thisobjectname}}
{\footnotesize\ttfamily std\+::string openphase\+::\+OPObject\+::thisobjectname\hspace{0.3cm}{\ttfamily [inherited]}}



Object\textquotesingle{}s name. 



Definition at line \mbox{\hyperlink{OPObject_8h_source_l00055}{55}} of file \mbox{\hyperlink{OPObject_8h_source}{OPObject.\+h}}.

\Hypertarget{classopenphase_1_1StabilizationImpl_aba3c1835d0779921de0474313c8aeecc}\label{classopenphase_1_1StabilizationImpl_aba3c1835d0779921de0474313c8aeecc} 
\index{openphase::StabilizationImpl@{openphase::StabilizationImpl}!Velocity@{Velocity}}
\index{Velocity@{Velocity}!openphase::StabilizationImpl@{openphase::StabilizationImpl}}
\doxysubsubsection{\texorpdfstring{Velocity}{Velocity}}
{\footnotesize\ttfamily \mbox{\hyperlink{classopenphase_1_1Storage3D}{Storage3D}}$<$\mbox{\hyperlink{classopenphase_1_1NodeAB}{Node\+AB}}$<$double,double$>$, 0$>$ openphase\+::\+Stabilization\+Impl\+::\+Velocity}



Definition at line \mbox{\hyperlink{Stabilization_8cpp_source_l00096}{96}} of file \mbox{\hyperlink{Stabilization_8cpp_source}{Stabilization.\+cpp}}.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{Stabilization_8cpp}{Stabilization.\+cpp}}\end{DoxyCompactItemize}
