<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenPhase: openphase::FlowSolverLBM Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">OpenPhase
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d0/d6c/namespaceopenphase.html">openphase</a></li><li class="navelem"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html">FlowSolverLBM</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="../../d5/d6b/classopenphase_1_1FlowSolverLBM-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">openphase::FlowSolverLBM Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>&lt; Calculation of fluid flow and advective solute transport  
 <a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#details">More...</a></p>

<p><code>#include &quot;<a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>&quot;</code></p>
<div class="dynheader">
Inheritance diagram for openphase::FlowSolverLBM:</div>
<div class="dyncontent">
 <div class="center">
  <img src="../../d4/db8/classopenphase_1_1FlowSolverLBM.png" usemap="#openphase::FlowSolverLBM_map" alt=""/>
  <map id="openphase::FlowSolverLBM_map" name="openphase::FlowSolverLBM_map">
<area href="../../d6/dcd/classopenphase_1_1OPObject.html" alt="openphase::OPObject" shape="rect" coords="0,0,170,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:afebf06002ce5030ed63c9d64df1e8cc7" id="r_afebf06002ce5030ed63c9d64df1e8cc7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afebf06002ce5030ed63c9d64df1e8cc7">FlowSolverLBM</a> (void)</td></tr>
<tr class="separator:afebf06002ce5030ed63c9d64df1e8cc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0ccac09fe97154b69ea71d6d7de1f08" id="r_ae0ccac09fe97154b69ea71d6d7de1f08"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0ccac09fe97154b69ea71d6d7de1f08">FlowSolverLBM</a> (<a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;locSettings, double in_dt, const std::string InputFileName=<a class="el" href="../../d0/d6c/namespaceopenphase.html#a9e087efe4525895243a5c0d3a7fb07c6">DefaultInputFileName</a>)</td></tr>
<tr class="memdesc:ae0ccac09fe97154b69ea71d6d7de1f08"><td class="mdescLeft">&#160;</td><td class="mdescRight">Empty constructor.  <br /></td></tr>
<tr class="separator:ae0ccac09fe97154b69ea71d6d7de1f08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a383e16d0cc86147dd7fab19dfe18755f" id="r_a383e16d0cc86147dd7fab19dfe18755f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a383e16d0cc86147dd7fab19dfe18755f">Initialize</a> (<a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;locSettings, std::stringstream &amp;inp, double in_dt)</td></tr>
<tr class="memdesc:a383e16d0cc86147dd7fab19dfe18755f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates memory and initializes global settings.  <br /></td></tr>
<tr class="separator:a383e16d0cc86147dd7fab19dfe18755f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7ec322c63819b51ebd5912de9c9d09d" id="r_ab7ec322c63819b51ebd5912de9c9d09d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab7ec322c63819b51ebd5912de9c9d09d">ReadInput</a> (const std::string InputFileName) override</td></tr>
<tr class="memdesc:ab7ec322c63819b51ebd5912de9c9d09d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads input parameters from a file.  <br /></td></tr>
<tr class="separator:ab7ec322c63819b51ebd5912de9c9d09d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a415f95242a02f3ea284dccf408614be2" id="r_a415f95242a02f3ea284dccf408614be2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a415f95242a02f3ea284dccf408614be2">ReadInput</a> (std::stringstream &amp;inp) override</td></tr>
<tr class="memdesc:a415f95242a02f3ea284dccf408614be2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads input parameters from a stringstream.  <br /></td></tr>
<tr class="separator:a415f95242a02f3ea284dccf408614be2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e6f273f5ed0752225c0060c9e044a18" id="r_a4e6f273f5ed0752225c0060c9e044a18"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a4e6f273f5ed0752225c0060c9e044a18">Remesh</a> (int newNx, int newNy, int newNz, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC) override</td></tr>
<tr class="separator:a4e6f273f5ed0752225c0060c9e044a18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18b272ba83cdc1a9f64800b8479149f8" id="r_a18b272ba83cdc1a9f64800b8479149f8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a18b272ba83cdc1a9f64800b8479149f8">DensityProfile</a> (const double x, const size_t n=0) const</td></tr>
<tr class="memdesc:a18b272ba83cdc1a9f64800b8479149f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simple tangent hyperbolic for the liquid-vapor interface.  <br /></td></tr>
<tr class="separator:a18b272ba83cdc1a9f64800b8479149f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59bb2f04263441de9c1e65b8555e53f1" id="r_a59bb2f04263441de9c1e65b8555e53f1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a59bb2f04263441de9c1e65b8555e53f1">PressureTensor</a> (const int i, const int j, const int k) const</td></tr>
<tr class="memdesc:a59bb2f04263441de9c1e65b8555e53f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the pressure tensor at the point (i,j,k)  <br /></td></tr>
<tr class="separator:a59bb2f04263441de9c1e65b8555e53f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52684844a9f0909ee6cb44de43dd5d47" id="r_a52684844a9f0909ee6cb44de43dd5d47"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a52684844a9f0909ee6cb44de43dd5d47">CalculateFluidMomentum</a> (const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>) const</td></tr>
<tr class="memdesc:a52684844a9f0909ee6cb44de43dd5d47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the momentum of the entire fluid in the system.  <br /></td></tr>
<tr class="separator:a52684844a9f0909ee6cb44de43dd5d47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaaecdbf57d1375053d64613f53c5e7f7" id="r_aaaecdbf57d1375053d64613f53c5e7f7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aaaecdbf57d1375053d64613f53c5e7f7">BounceBack</a> (const int i, const int j, const int k, const int ii, const int jj, const int kk, const size_t n, <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, double &amp;lbDensityChange)</td></tr>
<tr class="separator:aaaecdbf57d1375053d64613f53c5e7f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae707969f20e943c0db6228ad2e1af981" id="r_ae707969f20e943c0db6228ad2e1af981"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae707969f20e943c0db6228ad2e1af981">SecondOrderBounceBack</a> (const int i, const int j, const int k, const int ii, const int jj, const int kk, const size_t n, <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, double &amp;lbDensityChange)</td></tr>
<tr class="memdesc:ae707969f20e943c0db6228ad2e1af981"><td class="mdescLeft">&#160;</td><td class="mdescRight">BounceBack at Solid Interfaces.  <br /></td></tr>
<tr class="separator:ae707969f20e943c0db6228ad2e1af981"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a286f1c691a57f5d5c8b1b217f86cd328" id="r_a286f1c691a57f5d5c8b1b217f86cd328"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a286f1c691a57f5d5c8b1b217f86cd328">Pressure</a> (const int i, const int j, const int k) const</td></tr>
<tr class="memdesc:a286f1c691a57f5d5c8b1b217f86cd328"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the pressure at the point (i,j,k)  <br /></td></tr>
<tr class="separator:a286f1c691a57f5d5c8b1b217f86cd328"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c5d878b830d47f88531ce6a496ce5f4" id="r_a7c5d878b830d47f88531ce6a496ce5f4"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7c5d878b830d47f88531ce6a496ce5f4">CountFluidNodes</a> (void) const</td></tr>
<tr class="memdesc:a7c5d878b830d47f88531ce6a496ce5f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Counts the number of fluid nodes.  <br /></td></tr>
<tr class="separator:a7c5d878b830d47f88531ce6a496ce5f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fddca310c5c0171d9a67b39fc9f167a" id="r_a0fddca310c5c0171d9a67b39fc9f167a"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0fddca310c5c0171d9a67b39fc9f167a">CountObstacleNodes</a> (void) const</td></tr>
<tr class="memdesc:a0fddca310c5c0171d9a67b39fc9f167a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Counts the number of obstacle nodes.  <br /></td></tr>
<tr class="separator:a0fddca310c5c0171d9a67b39fc9f167a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a331be5fb7f4939bbc29d69c8f6937a15" id="r_a331be5fb7f4939bbc29d69c8f6937a15"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a331be5fb7f4939bbc29d69c8f6937a15">CalculateFluidMass</a> (void) const</td></tr>
<tr class="memdesc:a331be5fb7f4939bbc29d69c8f6937a15"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates mass of fluid components.  <br /></td></tr>
<tr class="separator:a331be5fb7f4939bbc29d69c8f6937a15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb24f230254d7c0ef8352b818dd9b848" id="r_abb24f230254d7c0ef8352b818dd9b848"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#abb24f230254d7c0ef8352b818dd9b848">CalculateLiquidVolume</a> (size_t Fluid_Comp)</td></tr>
<tr class="memdesc:abb24f230254d7c0ef8352b818dd9b848"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates volume of liquid phase.  <br /></td></tr>
<tr class="separator:abb24f230254d7c0ef8352b818dd9b848"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4419d54f170e56c84e5c358f1b9c0034" id="r_a4419d54f170e56c84e5c358f1b9c0034"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a4419d54f170e56c84e5c358f1b9c0034">CalculateLiquidMass</a> (size_t Fluid_Comp)</td></tr>
<tr class="memdesc:a4419d54f170e56c84e5c358f1b9c0034"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates mass of liquid phase.  <br /></td></tr>
<tr class="separator:a4419d54f170e56c84e5c358f1b9c0034"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a562269673ef282d404657a4d98e491" id="r_a9a562269673ef282d404657a4d98e491"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9a562269673ef282d404657a4d98e491">CalculateVaporVolume</a> (size_t Fluid_Comp)</td></tr>
<tr class="memdesc:a9a562269673ef282d404657a4d98e491"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates volume of vapor phase.  <br /></td></tr>
<tr class="separator:a9a562269673ef282d404657a4d98e491"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af659ba6c265813f90f7f1d6cc93ce81d" id="r_af659ba6c265813f90f7f1d6cc93ce81d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#af659ba6c265813f90f7f1d6cc93ce81d">CalculateVapordMass</a> (size_t Fluid_Comp)</td></tr>
<tr class="memdesc:af659ba6c265813f90f7f1d6cc93ce81d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates mass of vapor phase.  <br /></td></tr>
<tr class="separator:af659ba6c265813f90f7f1d6cc93ce81d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78015631ab46781aeba17f0e7af47473" id="r_a78015631ab46781aeba17f0e7af47473"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a78015631ab46781aeba17f0e7af47473">SetObstacleNodes</a> (const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, const <a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;Vel)</td></tr>
<tr class="memdesc:a78015631ab46781aeba17f0e7af47473"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets density and momentum in obstacles to be used when solid moves.  <br /></td></tr>
<tr class="separator:a78015631ab46781aeba17f0e7af47473"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe6c94036f18a00f2ebd751c3014d5b6" id="r_afe6c94036f18a00f2ebd751c3014d5b6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afe6c94036f18a00f2ebd751c3014d5b6">ApplyForces</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, const <a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;Vel, const <a class="el" href="../../d8/da6/classopenphase_1_1Composition.html">Composition</a> &amp;Cx)</td></tr>
<tr class="memdesc:afe6c94036f18a00f2ebd751c3014d5b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies forces.  <br /></td></tr>
<tr class="separator:afe6c94036f18a00f2ebd751c3014d5b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdd615b8cae1c2a91204cd5477080606" id="r_afdd615b8cae1c2a91204cd5477080606"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afdd615b8cae1c2a91204cd5477080606">ApplyForces</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, const <a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;Vel)</td></tr>
<tr class="memdesc:afdd615b8cae1c2a91204cd5477080606"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies force without composition.  <br /></td></tr>
<tr class="separator:afdd615b8cae1c2a91204cd5477080606"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6e8285978dabe6066bd291c5674ffdb" id="r_af6e8285978dabe6066bd291c5674ffdb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#af6e8285978dabe6066bd291c5674ffdb">CalculateDensityAndMomentum</a> (void)</td></tr>
<tr class="memdesc:af6e8285978dabe6066bd291c5674ffdb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates Density and momentum from lbDensity.  <br /></td></tr>
<tr class="separator:af6e8285978dabe6066bd291c5674ffdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a863645b683596db07ac439b417656210" id="r_a863645b683596db07ac439b417656210"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a863645b683596db07ac439b417656210">CalculateFluidVelocities</a> (<a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;Vel, const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC) const</td></tr>
<tr class="memdesc:a863645b683596db07ac439b417656210"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates Fluid velocities.  <br /></td></tr>
<tr class="separator:a863645b683596db07ac439b417656210"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb92a3e90b859cbb71f0cc255f739173" id="r_afb92a3e90b859cbb71f0cc255f739173"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afb92a3e90b859cbb71f0cc255f739173">CalculateForceDrag</a> (const int i, const int j, const int k, <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, const <a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;Vel)</td></tr>
<tr class="memdesc:afb92a3e90b859cbb71f0cc255f739173"><td class="mdescLeft">&#160;</td><td class="mdescRight">Force contribution of surface drag.  <br /></td></tr>
<tr class="separator:afb92a3e90b859cbb71f0cc255f739173"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b4be0ef726f5618713559356e9906f1" id="r_a1b4be0ef726f5618713559356e9906f1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1b4be0ef726f5618713559356e9906f1">CalculateForceGravity</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>)</td></tr>
<tr class="memdesc:a1b4be0ef726f5618713559356e9906f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Force contribution of Gravitation.  <br /></td></tr>
<tr class="separator:a1b4be0ef726f5618713559356e9906f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d8606713546bacf639e3b0d5f05e7b0" id="r_a5d8606713546bacf639e3b0d5f05e7b0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5d8606713546bacf639e3b0d5f05e7b0">CalculateForceGravity</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, const <a class="el" href="../../d8/da6/classopenphase_1_1Composition.html">Composition</a> &amp;Cx)</td></tr>
<tr class="memdesc:a5d8606713546bacf639e3b0d5f05e7b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Force contribution of Gravitation considering liquid composition.  <br /></td></tr>
<tr class="separator:a5d8606713546bacf639e3b0d5f05e7b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1147e2da1b27379c3eb33439d4e1d21d" id="r_a1147e2da1b27379c3eb33439d4e1d21d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1147e2da1b27379c3eb33439d4e1d21d">CalculateForceTwoPhase</a> (const int i, const int j, const int k, <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>)</td></tr>
<tr class="memdesc:a1147e2da1b27379c3eb33439d4e1d21d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Force contribution according to Benzi.  <br /></td></tr>
<tr class="separator:a1147e2da1b27379c3eb33439d4e1d21d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc7171d532ae567e7d10d3cab5397cab" id="r_acc7171d532ae567e7d10d3cab5397cab"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#acc7171d532ae567e7d10d3cab5397cab">CalculateLocalIncomingSolidDensityChange</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, int i, int j, int k)</td></tr>
<tr class="separator:acc7171d532ae567e7d10d3cab5397cab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0f8900290b87df30e19b94a77fc0afb" id="r_ae0f8900290b87df30e19b94a77fc0afb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0f8900290b87df30e19b94a77fc0afb">AcountForAndLimitPhaseTransformation</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, int tStep)</td></tr>
<tr class="memdesc:ae0f8900290b87df30e19b94a77fc0afb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add/Removes fluid mass according to phase changes.  <br /></td></tr>
<tr class="separator:ae0f8900290b87df30e19b94a77fc0afb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3c9d0663c6ceed9329730b5e7035430" id="r_af3c9d0663c6ceed9329730b5e7035430"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#af3c9d0663c6ceed9329730b5e7035430">Collision</a> ()</td></tr>
<tr class="memdesc:af3c9d0663c6ceed9329730b5e7035430"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes the collisions. Adjusts center of mass properties of colliding particles.  <br /></td></tr>
<tr class="separator:af3c9d0663c6ceed9329730b5e7035430"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ba35f98a851e32c156d6430787f28e5" id="r_a6ba35f98a851e32c156d6430787f28e5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a6ba35f98a851e32c156d6430787f28e5">DetectObstaclesAdvection</a> (const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, const <a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;Vel, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="memdesc:a6ba35f98a851e32c156d6430787f28e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Detects Obstacles (Detects change of obstacles for advection)  <br /></td></tr>
<tr class="separator:a6ba35f98a851e32c156d6430787f28e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5517e657c322b841aeb9732f8b8e035" id="r_ac5517e657c322b841aeb9732f8b8e035"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac5517e657c322b841aeb9732f8b8e035">DetectObstacles</a> (const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>)</td></tr>
<tr class="memdesc:ac5517e657c322b841aeb9732f8b8e035"><td class="mdescLeft">&#160;</td><td class="mdescRight">Detects Obstacles.  <br /></td></tr>
<tr class="separator:ac5517e657c322b841aeb9732f8b8e035"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85c894c1477deaf9def49df64f42a35e" id="r_a85c894c1477deaf9def49df64f42a35e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a85c894c1477deaf9def49df64f42a35e">EnforceMassConservation</a> (void)</td></tr>
<tr class="memdesc:a85c894c1477deaf9def49df64f42a35e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enforces fluid mass conservation for advectional problems.  <br /></td></tr>
<tr class="separator:a85c894c1477deaf9def49df64f42a35e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bc0c19bc5b4cc91e7bd1e7dd9b0cf9b" id="r_a5bc0c19bc5b4cc91e7bd1e7dd9b0cf9b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5bc0c19bc5b4cc91e7bd1e7dd9b0cf9b">EnforceTotalMassConservation</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>)</td></tr>
<tr class="memdesc:a5bc0c19bc5b4cc91e7bd1e7dd9b0cf9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enforces total mass conservation (solid and fluid)  <br /></td></tr>
<tr class="separator:a5bc0c19bc5b4cc91e7bd1e7dd9b0cf9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1dff5ac2790864dbdcac5ac7d06038f" id="r_ad1dff5ac2790864dbdcac5ac7d06038f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad1dff5ac2790864dbdcac5ac7d06038f">EnforceSolidMomentum</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, const <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> value)</td></tr>
<tr class="memdesc:ad1dff5ac2790864dbdcac5ac7d06038f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enforces solid momentum conservation.  <br /></td></tr>
<tr class="separator:ad1dff5ac2790864dbdcac5ac7d06038f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeba3442a2b798b5a17d27ad07e7e23dc" id="r_aeba3442a2b798b5a17d27ad07e7e23dc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aeba3442a2b798b5a17d27ad07e7e23dc">FixPopulations</a> (void)</td></tr>
<tr class="memdesc:aeba3442a2b798b5a17d27ad07e7e23dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ensures positive lbPopulations.  <br /></td></tr>
<tr class="separator:aeba3442a2b798b5a17d27ad07e7e23dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a733647bb9863ddba4791eab6854cb519" id="r_a733647bb9863ddba4791eab6854cb519"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a733647bb9863ddba4791eab6854cb519">Propagation</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="memdesc:a733647bb9863ddba4791eab6854cb519"><td class="mdescLeft">&#160;</td><td class="mdescRight">Propagates Populations.  <br /></td></tr>
<tr class="separator:a733647bb9863ddba4791eab6854cb519"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1608caa47f9df10552e4a3d4b2bd4f34" id="r_a1608caa47f9df10552e4a3d4b2bd4f34"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1608caa47f9df10552e4a3d4b2bd4f34">PropagationSecondOrderBB</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="memdesc:a1608caa47f9df10552e4a3d4b2bd4f34"><td class="mdescLeft">&#160;</td><td class="mdescRight">Propagates Populations.  <br /></td></tr>
<tr class="separator:a1608caa47f9df10552e4a3d4b2bd4f34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a297a77842a22e3f115c9b9a43979ff05" id="r_a297a77842a22e3f115c9b9a43979ff05"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a297a77842a22e3f115c9b9a43979ff05">Read</a> (const <a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;locSettings, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, const int tStep=-1) override</td></tr>
<tr class="memdesc:a297a77842a22e3f115c9b9a43979ff05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read raw (binary) fields from file.  <br /></td></tr>
<tr class="separator:a297a77842a22e3f115c9b9a43979ff05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac503798c87d57cd342e2d56063f481b" id="r_aac503798c87d57cd342e2d56063f481b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aac503798c87d57cd342e2d56063f481b">SetBoundaryConditions</a> (const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC) override</td></tr>
<tr class="memdesc:aac503798c87d57cd342e2d56063f481b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets boundary conditions for the particle distribution functions and flow velocities.  <br /></td></tr>
<tr class="separator:aac503798c87d57cd342e2d56063f481b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4aa7134220bdc3b0d46435789e484955" id="r_a4aa7134220bdc3b0d46435789e484955"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a4aa7134220bdc3b0d46435789e484955">SetFluidNodesNearObstacle</a> ()</td></tr>
<tr class="memdesc:a4aa7134220bdc3b0d46435789e484955"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets lbPoblulations of vanishing Obstacles and of appearing Obstacles.  <br /></td></tr>
<tr class="separator:a4aa7134220bdc3b0d46435789e484955"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2859ca456f78f88aff04b8b320b06a27" id="r_a2859ca456f78f88aff04b8b320b06a27"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2859ca456f78f88aff04b8b320b06a27">SetUniformVelocity</a> (const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, const <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> U0)</td></tr>
<tr class="memdesc:a2859ca456f78f88aff04b8b320b06a27"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the initial values of particle distribution functions.  <br /></td></tr>
<tr class="separator:a2859ca456f78f88aff04b8b320b06a27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a696288540747efec80dc3f4866b33e88" id="r_a696288540747efec80dc3f4866b33e88"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a696288540747efec80dc3f4866b33e88">Solve</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, <a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;Vel, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="memdesc:a696288540747efec80dc3f4866b33e88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates one time step of the Navier-Stokes solver.  <br /></td></tr>
<tr class="separator:a696288540747efec80dc3f4866b33e88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ce2bd921984e5a35136ee434328d1b4" id="r_a6ce2bd921984e5a35136ee434328d1b4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a6ce2bd921984e5a35136ee434328d1b4">Solve</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, const <a class="el" href="../../d8/da6/classopenphase_1_1Composition.html">Composition</a> &amp;Cx, <a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;Vel, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="memdesc:a6ce2bd921984e5a35136ee434328d1b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates one time step of the Navier-Stokes solver.  <br /></td></tr>
<tr class="separator:a6ce2bd921984e5a35136ee434328d1b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ab7011ac0eafbbd995e46445026ef4f" id="r_a1ab7011ac0eafbbd995e46445026ef4f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1ab7011ac0eafbbd995e46445026ef4f">SolveTC3D</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, <a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;Vel, <a class="el" href="../../d8/da6/classopenphase_1_1Composition.html">Composition</a> &amp;Cx, <a class="el" href="../../d4/d35/classopenphase_1_1Temperature.html">Temperature</a> &amp;Tx, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="separator:a1ab7011ac0eafbbd995e46445026ef4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cdecb6b85ec910f609c81c816482972" id="r_a7cdecb6b85ec910f609c81c816482972"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7cdecb6b85ec910f609c81c816482972">Write</a> (const <a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;locSettings, const int tStep) const override</td></tr>
<tr class="memdesc:a7cdecb6b85ec910f609c81c816482972"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes raw (binary) fields to file.  <br /></td></tr>
<tr class="separator:a7cdecb6b85ec910f609c81c816482972"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3563ba006c5c86f62ca1cc920835c183" id="r_a3563ba006c5c86f62ca1cc920835c183"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3563ba006c5c86f62ca1cc920835c183">WriteVTK</a> (const <a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;locSettings, const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, const int tStep, const int precision=16) const</td></tr>
<tr class="memdesc:a3563ba006c5c86f62ca1cc920835c183"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes physical fields values into file with <a class="el" href="../../d3/d89/structopenphase_1_1VTK.html" title="&lt; static class to write VTK data in xml format">VTK</a> format.  <br /></td></tr>
<tr class="separator:a3563ba006c5c86f62ca1cc920835c183"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4ec54c388c612d6a3e22d224ec5106e" id="r_ac4ec54c388c612d6a3e22d224ec5106e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac4ec54c388c612d6a3e22d224ec5106e">lbWriteVTK</a> (const <a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;locSettings, const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, const int tStep, const int precision=16) const</td></tr>
<tr class="memdesc:ac4ec54c388c612d6a3e22d224ec5106e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes physical fields values into file with <a class="el" href="../../d3/d89/structopenphase_1_1VTK.html" title="&lt; static class to write VTK data in xml format">VTK</a> format.  <br /></td></tr>
<tr class="separator:ac4ec54c388c612d6a3e22d224ec5106e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3e5d4e6932a05fb66627854b90cfcd6" id="r_af3e5d4e6932a05fb66627854b90cfcd6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#af3e5d4e6932a05fb66627854b90cfcd6">SingleSolid</a> (const int i, const int j, const int k, const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>) const</td></tr>
<tr class="memdesc:af3e5d4e6932a05fb66627854b90cfcd6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if single solid is present at (i,j,k)  <br /></td></tr>
<tr class="separator:af3e5d4e6932a05fb66627854b90cfcd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90657b1ab921a0b66ebe8201a939dddf" id="r_a90657b1ab921a0b66ebe8201a939dddf"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a90657b1ab921a0b66ebe8201a939dddf">SolidFraction</a> (const int i, const int j, const int k, const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>) const</td></tr>
<tr class="memdesc:a90657b1ab921a0b66ebe8201a939dddf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns if solid fraction at (i,j,k)  <br /></td></tr>
<tr class="separator:a90657b1ab921a0b66ebe8201a939dddf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa33850567674314633589a61d1714cbe" id="r_aa33850567674314633589a61d1714cbe"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa33850567674314633589a61d1714cbe">LocalObstacle</a> (const int i, const int j, const int k, const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>) const</td></tr>
<tr class="memdesc:aa33850567674314633589a61d1714cbe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if obstacle has been detected at (i,j,k)  <br /></td></tr>
<tr class="separator:aa33850567674314633589a61d1714cbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39b0afff7e320e23788a0e7db47a4b19" id="r_a39b0afff7e320e23788a0e7db47a4b19"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a39b0afff7e320e23788a0e7db47a4b19">Update_dt</a> (double _dt)</td></tr>
<tr class="memdesc:a39b0afff7e320e23788a0e7db47a4b19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates one time step of the Navier-Stokes solver.  <br /></td></tr>
<tr class="separator:a39b0afff7e320e23788a0e7db47a4b19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d6be591a43c1cc03fd88b92ab3242eb" id="r_a7d6be591a43c1cc03fd88b92ab3242eb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7d6be591a43c1cc03fd88b92ab3242eb">SetInitialPopulationsTC</a> (<a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, <a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;Vel)</td></tr>
<tr class="memdesc:a7d6be591a43c1cc03fd88b92ab3242eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializing the populations when thermal compressibility considered.  <br /></td></tr>
<tr class="separator:a7d6be591a43c1cc03fd88b92ab3242eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3da233ff9f88648f2916c0520c0f89b" id="r_ac3da233ff9f88648f2916c0520c0f89b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac3da233ff9f88648f2916c0520c0f89b">CollisionTC</a> (<a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;Vel)</td></tr>
<tr class="separator:ac3da233ff9f88648f2916c0520c0f89b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7862b78a602256015591ce53119331aa" id="r_a7862b78a602256015591ce53119331aa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7862b78a602256015591ce53119331aa">CalculateHydrodynamicPressureAndMomentum</a> (<a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;Vel)</td></tr>
<tr class="separator:a7862b78a602256015591ce53119331aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a444b058991aa61bfdb85e99db8b80705" id="r_a444b058991aa61bfdb85e99db8b80705"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a444b058991aa61bfdb85e99db8b80705">CalculateDensityTC</a> (<a class="el" href="../../d4/d35/classopenphase_1_1Temperature.html">Temperature</a> &amp;Tx, <a class="el" href="../../d8/da6/classopenphase_1_1Composition.html">Composition</a> &amp;Cx, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="memdesc:a444b058991aa61bfdb85e99db8b80705"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates Density from ideal gas law.  <br /></td></tr>
<tr class="separator:a444b058991aa61bfdb85e99db8b80705"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a627879285e493481ee046182cd93bc30" id="r_a627879285e493481ee046182cd93bc30"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a627879285e493481ee046182cd93bc30">SetOutFlow</a> (int order)</td></tr>
<tr class="separator:a627879285e493481ee046182cd93bc30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af531a270a7f9829fa0eb8b68eeef3ba2" id="r_af531a270a7f9829fa0eb8b68eeef3ba2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#af531a270a7f9829fa0eb8b68eeef3ba2">SetPressureOutlet</a> (<a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;Vel, const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, double KMaxv)</td></tr>
<tr class="separator:af531a270a7f9829fa0eb8b68eeef3ba2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addcb972c15f9da5af57db5294d24f582" id="r_addcb972c15f9da5af57db5294d24f582"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#addcb972c15f9da5af57db5294d24f582">SetDivUnearObstZero</a> ()</td></tr>
<tr class="separator:addcb972c15f9da5af57db5294d24f582"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a819951dc89737ee6638dd87373e81ac0" id="r_a819951dc89737ee6638dd87373e81ac0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a819951dc89737ee6638dd87373e81ac0">SetDivVelBCNXZero</a> ()</td></tr>
<tr class="separator:a819951dc89737ee6638dd87373e81ac0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8634cfcc3c329c853ca93f586922d121" id="r_a8634cfcc3c329c853ca93f586922d121"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a8634cfcc3c329c853ca93f586922d121">SetDivUnearBCsZeroXZPlane</a> ()</td></tr>
<tr class="separator:a8634cfcc3c329c853ca93f586922d121"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbda519d20462824db04d7ba55f1b880" id="r_abbda519d20462824db04d7ba55f1b880"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#abbda519d20462824db04d7ba55f1b880">SetVelocityInletUniform</a> (const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>)</td></tr>
<tr class="separator:abbda519d20462824db04d7ba55f1b880"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06a19a74bb3b814f2cebd8b8eacbdec8" id="r_a06a19a74bb3b814f2cebd8b8eacbdec8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a06a19a74bb3b814f2cebd8b8eacbdec8">SetCornerCorrection</a> (const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>)</td></tr>
<tr class="separator:a06a19a74bb3b814f2cebd8b8eacbdec8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bfe793fe9c76800a12f0a4249657268" id="r_a9bfe793fe9c76800a12f0a4249657268"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9bfe793fe9c76800a12f0a4249657268">Set1DNonReflectingPressureOutletatBCXN</a> (<a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;Vel, const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>)</td></tr>
<tr class="separator:a9bfe793fe9c76800a12f0a4249657268"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4837462af4b27139e46bf0f02e40bbd5" id="r_a4837462af4b27139e46bf0f02e40bbd5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a4837462af4b27139e46bf0f02e40bbd5">CalculateDivergenceVelocity</a> (<a class="el" href="../../d4/d35/classopenphase_1_1Temperature.html">Temperature</a> &amp;Tx, <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, <a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;Vel, <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, double <a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>)</td></tr>
<tr class="separator:a4837462af4b27139e46bf0f02e40bbd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfa1ada44d5ad2ecb7b53dc43c26f61b" id="r_acfa1ada44d5ad2ecb7b53dc43c26f61b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#acfa1ada44d5ad2ecb7b53dc43c26f61b">FinalizeInitialiation</a> (const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, const <a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;Vel, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="memdesc:acfa1ada44d5ad2ecb7b53dc43c26f61b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Needs to be called after the microstructure has been initialized.  <br /></td></tr>
<tr class="separator:acfa1ada44d5ad2ecb7b53dc43c26f61b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acaa0558757ce5f46303dca296d469030" id="r_acaa0558757ce5f46303dca296d469030"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d5/d57/classopenphase_1_1D3Q27.html">D3Q27</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#acaa0558757ce5f46303dca296d469030">EquilibriumDistributionTC</a> (<a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> lbvel, double lbph, double lbnut, double lbDivVel, <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> lbFb, const double weights[3][3][3], double lbrho, <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> lbGradRho, size_t n)</td></tr>
<tr class="separator:acaa0558757ce5f46303dca296d469030"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3e30eed17ce084572cf7aec2070c084" id="r_aa3e30eed17ce084572cf7aec2070c084"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa3e30eed17ce084572cf7aec2070c084">CalculateSutherlandViscosity</a> (double p, double mw, double Temp)</td></tr>
<tr class="separator:aa3e30eed17ce084572cf7aec2070c084"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4268e5da472b3b485593472b9cb2111f" id="r_a4268e5da472b3b485593472b9cb2111f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a4268e5da472b3b485593472b9cb2111f">CalculateIdealGasDensity</a> (double p, double Rm, double Temp)</td></tr>
<tr class="separator:a4268e5da472b3b485593472b9cb2111f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae32801d85c7c703bc2d27ebef7d59d60" id="r_ae32801d85c7c703bc2d27ebef7d59d60"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae32801d85c7c703bc2d27ebef7d59d60">CalculateDensityGradient</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, <a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;Vel)</td></tr>
<tr class="separator:ae32801d85c7c703bc2d27ebef7d59d60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a972e7a0a07746093679516d1bfd0970e" id="r_a972e7a0a07746093679516d1bfd0970e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a972e7a0a07746093679516d1bfd0970e">FluidVelocity</a> (const int i, const int j, const int k, const size_t comp) const</td></tr>
<tr class="memdesc:a972e7a0a07746093679516d1bfd0970e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns local fluid velocity of component comp.  <br /></td></tr>
<tr class="separator:a972e7a0a07746093679516d1bfd0970e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8c5e37335dfc6d5022bd769dc4c6e1a" id="r_ae8c5e37335dfc6d5022bd769dc4c6e1a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae8c5e37335dfc6d5022bd769dc4c6e1a">FluidVelocity</a> (const int i, const int j, const int k) const</td></tr>
<tr class="memdesc:ae8c5e37335dfc6d5022bd769dc4c6e1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns local fluid velocity summed over all components.  <br /></td></tr>
<tr class="separator:ae8c5e37335dfc6d5022bd769dc4c6e1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b0e69ba33a9e732b37f59f1f97763d3" id="r_a5b0e69ba33a9e732b37f59f1f97763d3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5b0e69ba33a9e732b37f59f1f97763d3">FluidDensity</a> (const int i, const int j, const int k, const size_t comp) const</td></tr>
<tr class="memdesc:a5b0e69ba33a9e732b37f59f1f97763d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns local fluid mass density of component comp.  <br /></td></tr>
<tr class="separator:a5b0e69ba33a9e732b37f59f1f97763d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a276b6c67c853abfc3b0efba1d1b1ace3" id="r_a276b6c67c853abfc3b0efba1d1b1ace3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a276b6c67c853abfc3b0efba1d1b1ace3">FluidDensity</a> (const int i, const int j, const int k) const</td></tr>
<tr class="memdesc:a276b6c67c853abfc3b0efba1d1b1ace3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns local fluid mass density summed over all components.  <br /></td></tr>
<tr class="separator:a276b6c67c853abfc3b0efba1d1b1ace3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa47e5e7286c14822bf4c30efecfecf6a" id="r_aa47e5e7286c14822bf4c30efecfecf6a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa47e5e7286c14822bf4c30efecfecf6a">Density</a> (const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, const int i, const int j, const int k) const</td></tr>
<tr class="memdesc:aa47e5e7286c14822bf4c30efecfecf6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns local mass density including solids.  <br /></td></tr>
<tr class="separator:aa47e5e7286c14822bf4c30efecfecf6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7b5d4fd526d189f269fade8896a789c" id="r_ab7b5d4fd526d189f269fade8896a789c"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#ab7b5d4fd526d189f269fade8896a789c">Initialize</a> (<a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;locSettings, std::string ObjectNameSuffix=&quot;&quot;)</td></tr>
<tr class="separator:ab7b5d4fd526d189f269fade8896a789c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dbefda68bf2a6123a095d4776f67cab" id="r_a2dbefda68bf2a6123a095d4776f67cab"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#a2dbefda68bf2a6123a095d4776f67cab">MoveFrame</a> (const int dx, const int dy, const int dz, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="separator:a2dbefda68bf2a6123a095d4776f67cab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd82ead485f6d9695aa733729100614c" id="r_afd82ead485f6d9695aa733729100614c"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#afd82ead485f6d9695aa733729100614c">Advect</a> (<a class="el" href="../../dd/d95/classopenphase_1_1AdvectionHR.html">AdvectionHR</a> &amp;Adv, const <a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;Vel, <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a44913b19d54d780a4b9e00fcab11cbb6">Phi</a>, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, const double <a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>, const double tStep)</td></tr>
<tr class="separator:afd82ead485f6d9695aa733729100614c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:acbf6f50e003944ed8daced249b20ee6e" id="r_acbf6f50e003944ed8daced249b20ee6e"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d5/d57/classopenphase_1_1D3Q27.html">D3Q27</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#acbf6f50e003944ed8daced249b20ee6e">EquilibriumDistribution</a> (double lbDensity, const double weights[3][3][3], <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> lbMomentum={0.0, 0.0, 0.0})</td></tr>
<tr class="separator:acbf6f50e003944ed8daced249b20ee6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba4b86e4e17ee5fd4e9afca6855b1719" id="r_aba4b86e4e17ee5fd4e9afca6855b1719"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aba4b86e4e17ee5fd4e9afca6855b1719">OptimalParaKuper</a> (const double ReducedTemperature, const double GasPrameter=0.01)</td></tr>
<tr class="memdesc:aba4b86e4e17ee5fd4e9afca6855b1719"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the optimal Parameter ParaKuper.  <br /></td></tr>
<tr class="separator:aba4b86e4e17ee5fd4e9afca6855b1719"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6910712da7e1d8d4df869a36cc41fb1" id="r_af6910712da7e1d8d4df869a36cc41fb1"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html">OPObject</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#af6910712da7e1d8d4df869a36cc41fb1">FindObject</a> (std::vector&lt; <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html">OPObject</a> * &gt; ObjectList, std::string ObjectName, std::string <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, std::string thisfunctionname, bool necessary, bool verbose=true)</td></tr>
<tr class="separator:af6910712da7e1d8d4df869a36cc41fb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa710a4052d686aac0b3f38a9a615682e" id="r_aa710a4052d686aac0b3f38a9a615682e"><td class="memItemLeft" align="right" valign="top">static std::vector&lt; <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html">OPObject</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#aa710a4052d686aac0b3f38a9a615682e">FindObjects</a> (std::vector&lt; <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html">OPObject</a> * &gt; ObjectList, std::string ObjectName, std::string <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, std::string thisfunctionname, bool necessary, bool verbose=true)</td></tr>
<tr class="separator:aa710a4052d686aac0b3f38a9a615682e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a7ae0f2b577b9a7525d84e110ed21e047" id="r_a7ae0f2b577b9a7525d84e110ed21e047"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; <a class="el" href="../../d5/d57/classopenphase_1_1D3Q27.html">D3Q27</a>, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a></td></tr>
<tr class="memdesc:a7ae0f2b577b9a7525d84e110ed21e047"><td class="mdescLeft">&#160;</td><td class="mdescRight">Populations (discretized particle distribution functions) PDF)  <br /></td></tr>
<tr class="separator:a7ae0f2b577b9a7525d84e110ed21e047"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ab90fa6fd8a7c36d86144281f5b0caa" id="r_a2ab90fa6fd8a7c36d86144281f5b0caa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; <a class="el" href="../../d5/d57/classopenphase_1_1D3Q27.html">D3Q27</a>, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2ab90fa6fd8a7c36d86144281f5b0caa">lbPopulationsTMP</a></td></tr>
<tr class="memdesc:a2ab90fa6fd8a7c36d86144281f5b0caa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Temporary array for Populations PDF propagation.  <br /></td></tr>
<tr class="separator:a2ab90fa6fd8a7c36d86144281f5b0caa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add3ce72d4d4ffd34781bac8b0f7a6673" id="r_add3ce72d4d4ffd34781bac8b0f7a6673"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; int, 0 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a></td></tr>
<tr class="memdesc:add3ce72d4d4ffd34781bac8b0f7a6673"><td class="mdescLeft">&#160;</td><td class="mdescRight">1 if Node is solid  <br /></td></tr>
<tr class="separator:add3ce72d4d4ffd34781bac8b0f7a6673"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23b20c6aaa054e65abc78e1783f1a595" id="r_a23b20c6aaa054e65abc78e1783f1a595"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; int, 0 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a23b20c6aaa054e65abc78e1783f1a595">ObstacleAppeared</a></td></tr>
<tr class="memdesc:a23b20c6aaa054e65abc78e1783f1a595"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if obstacle node appeared.  <br /></td></tr>
<tr class="separator:a23b20c6aaa054e65abc78e1783f1a595"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e20990385a07ac85eb89928bc78158c" id="r_a9e20990385a07ac85eb89928bc78158c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; int, 0 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9e20990385a07ac85eb89928bc78158c">ObstacleChangedDensity</a></td></tr>
<tr class="memdesc:a9e20990385a07ac85eb89928bc78158c"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if nearby obstacle changed local density.  <br /></td></tr>
<tr class="separator:a9e20990385a07ac85eb89928bc78158c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee9af090b2f8092c793ae13a596403f7" id="r_aee9af090b2f8092c793ae13a596403f7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; int, 0 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aee9af090b2f8092c793ae13a596403f7">ObstacleVanished</a></td></tr>
<tr class="memdesc:aee9af090b2f8092c793ae13a596403f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if obstacle node vanished.  <br /></td></tr>
<tr class="separator:aee9af090b2f8092c793ae13a596403f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c3ab22cfd49f007f6c0289f093dcd8b" id="r_a1c3ab22cfd49f007f6c0289f093dcd8b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a>, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a></td></tr>
<tr class="memdesc:a1c3ab22cfd49f007f6c0289f093dcd8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Force density.  <br /></td></tr>
<tr class="separator:a1c3ab22cfd49f007f6c0289f093dcd8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0a0f10cae3f3b764b4fa994a842f3a5" id="r_ae0a0f10cae3f3b764b4fa994a842f3a5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a>, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a></td></tr>
<tr class="memdesc:ae0a0f10cae3f3b764b4fa994a842f3a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Momentum density.  <br /></td></tr>
<tr class="separator:ae0a0f10cae3f3b764b4fa994a842f3a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5001f5c5e9e2aa3f12640ce3f31614a" id="r_ad5001f5c5e9e2aa3f12640ce3f31614a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; double, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a></td></tr>
<tr class="memdesc:ad5001f5c5e9e2aa3f12640ce3f31614a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fluid density / Solid wetting parameter.  <br /></td></tr>
<tr class="separator:ad5001f5c5e9e2aa3f12640ce3f31614a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62faa8027eaa45caa436c65f032bc584" id="r_a62faa8027eaa45caa436c65f032bc584"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; double, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a62faa8027eaa45caa436c65f032bc584">nut</a></td></tr>
<tr class="memdesc:a62faa8027eaa45caa436c65f032bc584"><td class="mdescLeft">&#160;</td><td class="mdescRight">kinematic viscosity in lattice units when thermal compressibility considered  <br /></td></tr>
<tr class="separator:a62faa8027eaa45caa436c65f032bc584"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa690789441704b411b9252d930c2363" id="r_afa690789441704b411b9252d930c2363"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; double, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afa690789441704b411b9252d930c2363">HydroPressure</a></td></tr>
<tr class="memdesc:afa690789441704b411b9252d930c2363"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hydrolic Pressure for each lattice when thermal compressibility considered.  <br /></td></tr>
<tr class="separator:afa690789441704b411b9252d930c2363"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b6d93798b295d1969521ba48bdc9af1" id="r_a2b6d93798b295d1969521ba48bdc9af1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; double, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2b6d93798b295d1969521ba48bdc9af1">DivVel</a></td></tr>
<tr class="memdesc:a2b6d93798b295d1969521ba48bdc9af1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Divergence of velocity when thermal compressibility considered.  <br /></td></tr>
<tr class="separator:a2b6d93798b295d1969521ba48bdc9af1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2357615d61b1d4d4bb027c1dfa67260c" id="r_a2357615d61b1d4d4bb027c1dfa67260c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a>, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2357615d61b1d4d4bb027c1dfa67260c">GradRho</a></td></tr>
<tr class="memdesc:a2357615d61b1d4d4bb027c1dfa67260c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gradient of density when thermal compressibility considered.  <br /></td></tr>
<tr class="separator:a2357615d61b1d4d4bb027c1dfa67260c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab45097494cc01fa93c7420778061d7ed" id="r_ab45097494cc01fa93c7420778061d7ed"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab45097494cc01fa93c7420778061d7ed">Do_Benzi</a></td></tr>
<tr class="memdesc:ab45097494cc01fa93c7420778061d7ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set to "true" if Benzi force should be calculated.  <br /></td></tr>
<tr class="separator:ab45097494cc01fa93c7420778061d7ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dc5ba2dfe7ff199c4e6b625c57b4001" id="r_a2dc5ba2dfe7ff199c4e6b625c57b4001"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2dc5ba2dfe7ff199c4e6b625c57b4001">Do_BounceBack</a></td></tr>
<tr class="memdesc:a2dc5ba2dfe7ff199c4e6b625c57b4001"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set to "true" for the fluid bounce back at the interface (not energy conserving with mobile solids)  <br /></td></tr>
<tr class="separator:a2dc5ba2dfe7ff199c4e6b625c57b4001"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a359a5b0d89af4a527bb3d9cfdba32f85" id="r_a359a5b0d89af4a527bb3d9cfdba32f85"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a359a5b0d89af4a527bb3d9cfdba32f85">Do_BounceBackElastic</a></td></tr>
<tr class="memdesc:a359a5b0d89af4a527bb3d9cfdba32f85"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set to "true" for the elastic fluid bounce back (energy conserving with mobile solids)  <br /></td></tr>
<tr class="separator:a359a5b0d89af4a527bb3d9cfdba32f85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a570918ac5d77ab38b6f92f9a31e401e0" id="r_a570918ac5d77ab38b6f92f9a31e401e0"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a570918ac5d77ab38b6f92f9a31e401e0">Do_Drag</a></td></tr>
<tr class="memdesc:a570918ac5d77ab38b6f92f9a31e401e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set to "true" if drag force at the interfaces should be calculated.  <br /></td></tr>
<tr class="separator:a570918ac5d77ab38b6f92f9a31e401e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06f6913d390fd7e3e2174b6a82506b4b" id="r_a06f6913d390fd7e3e2174b6a82506b4b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a06f6913d390fd7e3e2174b6a82506b4b">Do_EDForcing</a></td></tr>
<tr class="memdesc:a06f6913d390fd7e3e2174b6a82506b4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set to "true" if exact difference method should be used to apply the calculated force.  <br /></td></tr>
<tr class="separator:a06f6913d390fd7e3e2174b6a82506b4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad85e2131812f1bb919f547226d6a6a3a" id="r_ad85e2131812f1bb919f547226d6a6a3a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad85e2131812f1bb919f547226d6a6a3a">Do_FixPopulations</a></td></tr>
<tr class="memdesc:ad85e2131812f1bb919f547226d6a6a3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set to "true" if negative Densities and Populations should be fixes.  <br /></td></tr>
<tr class="separator:ad85e2131812f1bb919f547226d6a6a3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2254d3b9f9dab0e6a6917590f020879d" id="r_a2254d3b9f9dab0e6a6917590f020879d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2254d3b9f9dab0e6a6917590f020879d">Do_Gravity</a></td></tr>
<tr class="memdesc:a2254d3b9f9dab0e6a6917590f020879d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set to "true" if gravitational force should be calculated.  <br /></td></tr>
<tr class="separator:a2254d3b9f9dab0e6a6917590f020879d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5ba4a4e507c7d80c6268bb41e4f3c2a" id="r_ab5ba4a4e507c7d80c6268bb41e4f3c2a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab5ba4a4e507c7d80c6268bb41e4f3c2a">Do_GuoForcing</a></td></tr>
<tr class="separator:ab5ba4a4e507c7d80c6268bb41e4f3c2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9bc290fd900003e6984f319eb544269" id="r_ae9bc290fd900003e6984f319eb544269"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae9bc290fd900003e6984f319eb544269">Do_Kupershtokh</a></td></tr>
<tr class="memdesc:ae9bc290fd900003e6984f319eb544269"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set to "true" if Kupershtokh's method for two phase fluid flow should be used.  <br /></td></tr>
<tr class="separator:ae9bc290fd900003e6984f319eb544269"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a147890b1c75d4b407881212ea40ecf05" id="r_a147890b1c75d4b407881212ea40ecf05"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a147890b1c75d4b407881212ea40ecf05">Do_TwoPhase</a></td></tr>
<tr class="memdesc:a147890b1c75d4b407881212ea40ecf05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set to "true" if two phase flow should be calculated.  <br /></td></tr>
<tr class="separator:a147890b1c75d4b407881212ea40ecf05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c63a86b32c4126fb329829acf6af13c" id="r_a7c63a86b32c4126fb329829acf6af13c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7c63a86b32c4126fb329829acf6af13c">Do_ThermalComp</a></td></tr>
<tr class="memdesc:a7c63a86b32c4126fb329829acf6af13c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set to "true" if thermal compressibility considered.  <br /></td></tr>
<tr class="separator:a7c63a86b32c4126fb329829acf6af13c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92c22f0dfe11f8b261391b7e73fdc2f4" id="r_a92c22f0dfe11f8b261391b7e73fdc2f4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92c22f0dfe11f8b261391b7e73fdc2f4">Do_DI</a></td></tr>
<tr class="memdesc:a92c22f0dfe11f8b261391b7e73fdc2f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set to "true" if the interface considered diffuse.  <br /></td></tr>
<tr class="separator:a92c22f0dfe11f8b261391b7e73fdc2f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c0dc555248064b06b4d1795657c5026" id="r_a6c0dc555248064b06b4d1795657c5026"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a6c0dc555248064b06b4d1795657c5026">ObstaclesChanged</a></td></tr>
<tr class="memdesc:a6c0dc555248064b06b4d1795657c5026"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if an obstacle changed.  <br /></td></tr>
<tr class="separator:a6c0dc555248064b06b4d1795657c5026"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd420cebecad62af1b472379f9b05663" id="r_afd420cebecad62af1b472379f9b05663"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afd420cebecad62af1b472379f9b05663">GradRho_Upwind</a></td></tr>
<tr class="separator:afd420cebecad62af1b472379f9b05663"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac26558dc3c1f0f921a771ceedbc474e2" id="r_ac26558dc3c1f0f921a771ceedbc474e2"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac26558dc3c1f0f921a771ceedbc474e2">GradRho_Central</a></td></tr>
<tr class="separator:ac26558dc3c1f0f921a771ceedbc474e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a911943c5a05841969b913c12c1d4921c" id="r_a911943c5a05841969b913c12c1d4921c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a911943c5a05841969b913c12c1d4921c">GradRho_VanLeer</a></td></tr>
<tr class="separator:a911943c5a05841969b913c12c1d4921c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad56f87a52b427bb6a4646208d54574c1" id="r_ad56f87a52b427bb6a4646208d54574c1"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad56f87a52b427bb6a4646208d54574c1">Pth</a></td></tr>
<tr class="memdesc:ad56f87a52b427bb6a4646208d54574c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Thermodynamic Pressure [Pa].  <br /></td></tr>
<tr class="separator:ad56f87a52b427bb6a4646208d54574c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62404913cee1f48eebbf6afbeb13b5d0" id="r_a62404913cee1f48eebbf6afbeb13b5d0"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a62404913cee1f48eebbf6afbeb13b5d0">PthOld</a></td></tr>
<tr class="memdesc:a62404913cee1f48eebbf6afbeb13b5d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Thermodynamic Pressure for previous time step [Pa].  <br /></td></tr>
<tr class="separator:a62404913cee1f48eebbf6afbeb13b5d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39e6431910d6e1d9558b91d0a59f6828" id="r_a39e6431910d6e1d9558b91d0a59f6828"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a39e6431910d6e1d9558b91d0a59f6828">Pth0</a></td></tr>
<tr class="memdesc:a39e6431910d6e1d9558b91d0a59f6828"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initial Thermodynamic Pressure [Pa].  <br /></td></tr>
<tr class="separator:a39e6431910d6e1d9558b91d0a59f6828"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b542beebb14e3182c7948b30f3eefd8" id="r_a1b542beebb14e3182c7948b30f3eefd8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1b542beebb14e3182c7948b30f3eefd8">Poutlet</a></td></tr>
<tr class="memdesc:a1b542beebb14e3182c7948b30f3eefd8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Outlet Hydrodynamic Pressure [Pa].  <br /></td></tr>
<tr class="separator:a1b542beebb14e3182c7948b30f3eefd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad6241df3842eb309a60fd8d55888559" id="r_aad6241df3842eb309a60fd8d55888559"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aad6241df3842eb309a60fd8d55888559">U0X</a></td></tr>
<tr class="memdesc:aad6241df3842eb309a60fd8d55888559"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inlet Velocity in x direction [m/s].  <br /></td></tr>
<tr class="separator:aad6241df3842eb309a60fd8d55888559"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d8f89a8680b20a5f22438db5dacbfc8" id="r_a3d8f89a8680b20a5f22438db5dacbfc8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3d8f89a8680b20a5f22438db5dacbfc8">U0Y</a></td></tr>
<tr class="memdesc:a3d8f89a8680b20a5f22438db5dacbfc8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inlet Velocity in y direction [m/s].  <br /></td></tr>
<tr class="separator:a3d8f89a8680b20a5f22438db5dacbfc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85853583f9b71927e8de8fb66cb4fb09" id="r_a85853583f9b71927e8de8fb66cb4fb09"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a85853583f9b71927e8de8fb66cb4fb09">U0Z</a></td></tr>
<tr class="memdesc:a85853583f9b71927e8de8fb66cb4fb09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inlet Velocity in z direction [m/s].  <br /></td></tr>
<tr class="separator:a85853583f9b71927e8de8fb66cb4fb09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0041741e7a61b58755ac052871ccc47a" id="r_a0041741e7a61b58755ac052871ccc47a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0041741e7a61b58755ac052871ccc47a">GA</a></td></tr>
<tr class="memdesc:a0041741e7a61b58755ac052871ccc47a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gravity acceleration in true units [m/s^2].  <br /></td></tr>
<tr class="separator:a0041741e7a61b58755ac052871ccc47a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa6a4778188230a23cbbf10d21a33219" id="r_aaa6a4778188230a23cbbf10d21a33219"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aaa6a4778188230a23cbbf10d21a33219">ParaKuper</a></td></tr>
<tr class="memdesc:aaa6a4778188230a23cbbf10d21a33219"><td class="mdescLeft">&#160;</td><td class="mdescRight">Kupershtokh parameter (to tune numerical accuracy!)  <br /></td></tr>
<tr class="separator:aaa6a4778188230a23cbbf10d21a33219"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad61619206ef9c5955004f3ff0186687a" id="r_ad61619206ef9c5955004f3ff0186687a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad61619206ef9c5955004f3ff0186687a">h_star</a></td></tr>
<tr class="memdesc:ad61619206ef9c5955004f3ff0186687a"><td class="mdescLeft">&#160;</td><td class="mdescRight">dimensionless drag force parameter  <br /></td></tr>
<tr class="separator:ad61619206ef9c5955004f3ff0186687a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f3275be19efcce0234470fdc88d77fd" id="r_a3f3275be19efcce0234470fdc88d77fd"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a></td></tr>
<tr class="memdesc:a3f3275be19efcce0234470fdc88d77fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Coefficient to calculate physical density from lattice density [Kg/m^3].  <br /></td></tr>
<tr class="separator:a3f3275be19efcce0234470fdc88d77fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83cd87469986a195f9a42c9fbff2f523" id="r_a83cd87469986a195f9a42c9fbff2f523"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a83cd87469986a195f9a42c9fbff2f523">dP</a></td></tr>
<tr class="memdesc:a83cd87469986a195f9a42c9fbff2f523"><td class="mdescLeft">&#160;</td><td class="mdescRight">Coefficient to calculate physical pressure from lattice pressure [Pa].  <br /></td></tr>
<tr class="separator:a83cd87469986a195f9a42c9fbff2f523"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e7cad672eea608ab7c5ea5ed6946138" id="r_a0e7cad672eea608ab7c5ea5ed6946138"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0e7cad672eea608ab7c5ea5ed6946138">dm</a></td></tr>
<tr class="memdesc:a0e7cad672eea608ab7c5ea5ed6946138"><td class="mdescLeft">&#160;</td><td class="mdescRight">Coefficient to calculate physical momentum density from lattice momentum density [Kg/(m^2 s)].  <br /></td></tr>
<tr class="separator:a0e7cad672eea608ab7c5ea5ed6946138"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b6d8de9f278b56d9346a2adb823a4e2" id="r_a3b6d8de9f278b56d9346a2adb823a4e2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3b6d8de9f278b56d9346a2adb823a4e2">df</a></td></tr>
<tr class="memdesc:a3b6d8de9f278b56d9346a2adb823a4e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Coefficient to calculate physical force density from lattice force density [Kg/(m^2 s^2)].  <br /></td></tr>
<tr class="separator:a3b6d8de9f278b56d9346a2adb823a4e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74ae26b9feb1666e9c177e5e88558d8a" id="r_a74ae26b9feb1666e9c177e5e88558d8a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a74ae26b9feb1666e9c177e5e88558d8a">dnu</a></td></tr>
<tr class="memdesc:a74ae26b9feb1666e9c177e5e88558d8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Coefficient to calculate physical kinematic viscosity from lattice kinematic viscosity [m^2/s].  <br /></td></tr>
<tr class="separator:a74ae26b9feb1666e9c177e5e88558d8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c24d4bdb6833cf83827eb7ae9629f47" id="r_a9c24d4bdb6833cf83827eb7ae9629f47"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9c24d4bdb6833cf83827eb7ae9629f47">dv</a></td></tr>
<tr class="separator:a9c24d4bdb6833cf83827eb7ae9629f47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab04d9d80bea5a4114c3c31eed361db5c" id="r_ab04d9d80bea5a4114c3c31eed361db5c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a></td></tr>
<tr class="memdesc:ab04d9d80bea5a4114c3c31eed361db5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Coefficient to calculate physical time from lattice time [s].  <br /></td></tr>
<tr class="separator:ab04d9d80bea5a4114c3c31eed361db5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5421bde5029b801f847f4ec190b3a5dc" id="r_a5421bde5029b801f847f4ec190b3a5dc"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5421bde5029b801f847f4ec190b3a5dc">dM</a></td></tr>
<tr class="memdesc:a5421bde5029b801f847f4ec190b3a5dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Coefficient to calculate physical mass from lattice mass [Kg].  <br /></td></tr>
<tr class="separator:a5421bde5029b801f847f4ec190b3a5dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92539bf6d5ed043520c0bdbc47c334a9" id="r_a92539bf6d5ed043520c0bdbc47c334a9"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92539bf6d5ed043520c0bdbc47c334a9">lbWeights</a> [3][3][3]</td></tr>
<tr class="memdesc:a92539bf6d5ed043520c0bdbc47c334a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lattice Boltzmann stencil weights.  <br /></td></tr>
<tr class="separator:a92539bf6d5ed043520c0bdbc47c334a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3682fba50989e5b7ab0df48763a889d3" id="r_a3682fba50989e5b7ab0df48763a889d3"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3682fba50989e5b7ab0df48763a889d3">Ncomp</a></td></tr>
<tr class="memdesc:a3682fba50989e5b7ab0df48763a889d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of chemical components.  <br /></td></tr>
<tr class="separator:a3682fba50989e5b7ab0df48763a889d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0c2cd11db03f22d554529d296ba08f6" id="r_ac0c2cd11db03f22d554529d296ba08f6"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a></td></tr>
<tr class="memdesc:ac0c2cd11db03f22d554529d296ba08f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of fluid components.  <br /></td></tr>
<tr class="separator:ac0c2cd11db03f22d554529d296ba08f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c5fb9cd4952a23292b686140a250279" id="r_a9c5fb9cd4952a23292b686140a250279"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9c5fb9cd4952a23292b686140a250279">Nphases</a></td></tr>
<tr class="memdesc:a9c5fb9cd4952a23292b686140a250279"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of thermodynamic phases per grain.  <br /></td></tr>
<tr class="separator:a9c5fb9cd4952a23292b686140a250279"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9adff9295d5ffac6ed4be9bb59ab8070" id="r_a9adff9295d5ffac6ed4be9bb59ab8070"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d18/classopenphase_1_1GridParameters.html">GridParameters</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a></td></tr>
<tr class="memdesc:a9adff9295d5ffac6ed4be9bb59ab8070"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simulation grid parameters.  <br /></td></tr>
<tr class="separator:a9adff9295d5ffac6ed4be9bb59ab8070"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a852ebebddbd520319bcc8b65bffad2a3" id="r_a852ebebddbd520319bcc8b65bffad2a3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a852ebebddbd520319bcc8b65bffad2a3">Bcells</a></td></tr>
<tr class="memdesc:a852ebebddbd520319bcc8b65bffad2a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of boundary cells.  <br /></td></tr>
<tr class="separator:a852ebebddbd520319bcc8b65bffad2a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad91501a0b7baf58043f1c744d858816d" id="r_ad91501a0b7baf58043f1c744d858816d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a></td></tr>
<tr class="memdesc:ad91501a0b7baf58043f1c744d858816d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fluid distribution range in case of 2 phase flow.  <br /></td></tr>
<tr class="separator:ad91501a0b7baf58043f1c744d858816d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5284a4950dae747d84ce23d74fd5963e" id="r_a5284a4950dae747d84ce23d74fd5963e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5284a4950dae747d84ce23d74fd5963e">cs2</a></td></tr>
<tr class="memdesc:a5284a4950dae747d84ce23d74fd5963e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Speed of sound squared [m/s].  <br /></td></tr>
<tr class="separator:a5284a4950dae747d84ce23d74fd5963e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e9e538e60ba43e77acb1cc88b20a316" id="r_a5e9e538e60ba43e77acb1cc88b20a316"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5e9e538e60ba43e77acb1cc88b20a316">InitialTotalMass</a></td></tr>
<tr class="memdesc:a5e9e538e60ba43e77acb1cc88b20a316"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solid mass (used for mass conservation)  <br /></td></tr>
<tr class="separator:a5e9e538e60ba43e77acb1cc88b20a316"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11c6271193ddf1f694f1bfc4227bf617" id="r_a11c6271193ddf1f694f1bfc4227bf617"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a11c6271193ddf1f694f1bfc4227bf617">GasParameter</a></td></tr>
<tr class="memdesc:a11c6271193ddf1f694f1bfc4227bf617"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gas parameter for Kupersthok (interface width)  <br /></td></tr>
<tr class="separator:a11c6271193ddf1f694f1bfc4227bf617"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d68fa3e9c3b4dc37721947295a7507f" id="r_a7d68fa3e9c3b4dc37721947295a7507f"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7d68fa3e9c3b4dc37721947295a7507f">InterfaceWidth</a></td></tr>
<tr class="memdesc:a7d68fa3e9c3b4dc37721947295a7507f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Equilibrium interface width [TODO].  <br /></td></tr>
<tr class="separator:a7d68fa3e9c3b4dc37721947295a7507f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa03483eba53de530daf4d2dbd62a8985" id="r_aa03483eba53de530daf4d2dbd62a8985"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa03483eba53de530daf4d2dbd62a8985">SurfaceTension</a></td></tr>
<tr class="memdesc:aa03483eba53de530daf4d2dbd62a8985"><td class="mdescLeft">&#160;</td><td class="mdescRight">Surface tension (physical units) [kg/s^2].  <br /></td></tr>
<tr class="separator:aa03483eba53de530daf4d2dbd62a8985"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addfc8e9e14301fe577dac27985c8e294" id="r_addfc8e9e14301fe577dac27985c8e294"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#addfc8e9e14301fe577dac27985c8e294">dDensity_dc</a></td></tr>
<tr class="memdesc:addfc8e9e14301fe577dac27985c8e294"><td class="mdescLeft">&#160;</td><td class="mdescRight">Density change according to the change of concentration [Kg/(mol/mol)].  <br /></td></tr>
<tr class="separator:addfc8e9e14301fe577dac27985c8e294"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66544929ec9e15f973b2d349787a5993" id="r_a66544929ec9e15f973b2d349787a5993"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a66544929ec9e15f973b2d349787a5993">CriticalDensity</a></td></tr>
<tr class="memdesc:a66544929ec9e15f973b2d349787a5993"><td class="mdescLeft">&#160;</td><td class="mdescRight">Critical density of phase separation (Two phase flow)  <br /></td></tr>
<tr class="separator:a66544929ec9e15f973b2d349787a5993"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8df6700e0802a129069281b338313d7" id="r_ab8df6700e0802a129069281b338313d7"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab8df6700e0802a129069281b338313d7">lbCriticalPressure</a></td></tr>
<tr class="memdesc:ab8df6700e0802a129069281b338313d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Critical Pressure for Kupersthok (Van der Waal)  <br /></td></tr>
<tr class="separator:ab8df6700e0802a129069281b338313d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a405aa37be090a3d967abab6df1f941ba" id="r_a405aa37be090a3d967abab6df1f941ba"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a405aa37be090a3d967abab6df1f941ba">lbCriticalTemperature</a></td></tr>
<tr class="memdesc:a405aa37be090a3d967abab6df1f941ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Critical temperature of phase separation (Two phase flow)  <br /></td></tr>
<tr class="separator:a405aa37be090a3d967abab6df1f941ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acaf39436ee81673b389cf19247734fca" id="r_acaf39436ee81673b389cf19247734fca"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#acaf39436ee81673b389cf19247734fca">FluidMass</a></td></tr>
<tr class="memdesc:acaf39436ee81673b389cf19247734fca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fluid mass (used for mass conservation)  <br /></td></tr>
<tr class="separator:acaf39436ee81673b389cf19247734fca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6aa8fda060bc8571b4b0a95464abd04" id="r_aa6aa8fda060bc8571b4b0a95464abd04"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa6aa8fda060bc8571b4b0a95464abd04">LiquidDensity</a></td></tr>
<tr class="memdesc:aa6aa8fda060bc8571b4b0a95464abd04"><td class="mdescLeft">&#160;</td><td class="mdescRight">Equilibrium density of the liquid phase.  <br /></td></tr>
<tr class="separator:aa6aa8fda060bc8571b4b0a95464abd04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a135999305b00dce046d03db79817e69e" id="r_a135999305b00dce046d03db79817e69e"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a135999305b00dce046d03db79817e69e">lbTemperature</a></td></tr>
<tr class="memdesc:a135999305b00dce046d03db79817e69e"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="../../d4/d35/classopenphase_1_1Temperature.html" title="&lt; Storage for the temperature">Temperature</a> (Two phase flow)  <br /></td></tr>
<tr class="separator:a135999305b00dce046d03db79817e69e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6720e11af1b05213fbba7af7e7047848" id="r_a6720e11af1b05213fbba7af7e7047848"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a6720e11af1b05213fbba7af7e7047848">VaporDensity</a></td></tr>
<tr class="memdesc:a6720e11af1b05213fbba7af7e7047848"><td class="mdescLeft">&#160;</td><td class="mdescRight">Equilibrium density of the solid phase.  <br /></td></tr>
<tr class="separator:a6720e11af1b05213fbba7af7e7047848"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79b3ebcd11696e18f2db1079356829e3" id="r_a79b3ebcd11696e18f2db1079356829e3"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a79b3ebcd11696e18f2db1079356829e3">nu</a></td></tr>
<tr class="memdesc:a79b3ebcd11696e18f2db1079356829e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Kinematic viscosity [m^2/s].  <br /></td></tr>
<tr class="separator:a79b3ebcd11696e18f2db1079356829e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cd6cc5ca27add2432f5809f9d45ca03" id="r_a7cd6cc5ca27add2432f5809f9d45ca03"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7cd6cc5ca27add2432f5809f9d45ca03">rho_0</a></td></tr>
<tr class="memdesc:a7cd6cc5ca27add2432f5809f9d45ca03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reference density (Parameter for Benzi) [Kg/m^3].  <br /></td></tr>
<tr class="separator:a7cd6cc5ca27add2432f5809f9d45ca03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8ae2a30dc85638b1a377cc2919200fe" id="r_ad8ae2a30dc85638b1a377cc2919200fe"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad8ae2a30dc85638b1a377cc2919200fe">lbtau</a></td></tr>
<tr class="memdesc:ad8ae2a30dc85638b1a377cc2919200fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Relaxation time for BGK collision operator.  <br /></td></tr>
<tr class="separator:ad8ae2a30dc85638b1a377cc2919200fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4faa1708afdfd505f7648f1a063d80b" id="r_aa4faa1708afdfd505f7648f1a063d80b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa4faa1708afdfd505f7648f1a063d80b">ElementNames</a></td></tr>
<tr class="memdesc:aa4faa1708afdfd505f7648f1a063d80b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Names of chemical elements.  <br /></td></tr>
<tr class="separator:aa4faa1708afdfd505f7648f1a063d80b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a587965ea13dcb7fddac42b87da1df7cf" id="r_a587965ea13dcb7fddac42b87da1df7cf"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a587965ea13dcb7fddac42b87da1df7cf">Gb</a></td></tr>
<tr class="memdesc:a587965ea13dcb7fddac42b87da1df7cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parameter for Benzi-force [Kg/(m^3)].  <br /></td></tr>
<tr class="separator:a587965ea13dcb7fddac42b87da1df7cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a733d0ed28089ce96e664da9b2508c692" id="r_a733d0ed28089ce96e664da9b2508c692"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a733d0ed28089ce96e664da9b2508c692">Wetting</a></td></tr>
<tr class="memdesc:a733d0ed28089ce96e664da9b2508c692"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wetting Parameter [Kg/m^3].  <br /></td></tr>
<tr class="separator:a733d0ed28089ce96e664da9b2508c692"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d614141e8c6298e8b39f8b7d67fe8da" id="r_a0d614141e8c6298e8b39f8b7d67fe8da"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0d614141e8c6298e8b39f8b7d67fe8da">lbGK</a></td></tr>
<tr class="memdesc:a0d614141e8c6298e8b39f8b7d67fe8da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parameter for Kupershtohk.  <br /></td></tr>
<tr class="separator:a0d614141e8c6298e8b39f8b7d67fe8da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9006e8f49762d851b52708b363ba14f2" id="r_a9006e8f49762d851b52708b363ba14f2"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a></td></tr>
<tr class="memdesc:a9006e8f49762d851b52708b363ba14f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Object's implementation class name.  <br /></td></tr>
<tr class="separator:a9006e8f49762d851b52708b363ba14f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8c040bdc306f76b58d5a79201e5df66" id="r_ac8c040bdc306f76b58d5a79201e5df66"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#ac8c040bdc306f76b58d5a79201e5df66">thisobjectname</a></td></tr>
<tr class="memdesc:ac8c040bdc306f76b58d5a79201e5df66"><td class="mdescLeft">&#160;</td><td class="mdescRight">Object's name.  <br /></td></tr>
<tr class="separator:ac8c040bdc306f76b58d5a79201e5df66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa112048d179026f359161b1f20e5e98e" id="r_aa112048d179026f359161b1f20e5e98e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#aa112048d179026f359161b1f20e5e98e">initialized</a> = false</td></tr>
<tr class="memdesc:aa112048d179026f359161b1f20e5e98e"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if obect's Initialize has been executed.  <br /></td></tr>
<tr class="separator:aa112048d179026f359161b1f20e5e98e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65ef7d7ae73be8f9a7fa626762c4937d" id="r_a65ef7d7ae73be8f9a7fa626762c4937d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#a65ef7d7ae73be8f9a7fa626762c4937d">input_read</a> = false</td></tr>
<tr class="memdesc:a65ef7d7ae73be8f9a7fa626762c4937d"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if obect's <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9c766ff0ddd3866b7c2f2f83ebebcf31">ReadInput()</a> has been executed.  <br /></td></tr>
<tr class="separator:a65ef7d7ae73be8f9a7fa626762c4937d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44d40bc5a3ef87d7c461b457e01091dd" id="r_a44d40bc5a3ef87d7c461b457e01091dd"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#a44d40bc5a3ef87d7c461b457e01091dd">remeshable</a> = false</td></tr>
<tr class="memdesc:a44d40bc5a3ef87d7c461b457e01091dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if the object has non-empty <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#af421c7d819be4718f586fb3f97c34583">Remesh()</a> method.  <br /></td></tr>
<tr class="separator:a44d40bc5a3ef87d7c461b457e01091dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f54d22dc59afcace6359f599fabcaac" id="r_a7f54d22dc59afcace6359f599fabcaac"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#a7f54d22dc59afcace6359f599fabcaac">advectable</a> = false</td></tr>
<tr class="memdesc:a7f54d22dc59afcace6359f599fabcaac"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if the object has non-empty <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#afd82ead485f6d9695aa733729100614c">Advect()</a> method.  <br /></td></tr>
<tr class="separator:a7f54d22dc59afcace6359f599fabcaac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5b7ff7b56e2d266c2fd59b620a1603b" id="r_aa5b7ff7b56e2d266c2fd59b620a1603b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#aa5b7ff7b56e2d266c2fd59b620a1603b">readable</a> = false</td></tr>
<tr class="memdesc:aa5b7ff7b56e2d266c2fd59b620a1603b"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if the object has non-empty <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#adbd36cc2fee5c391f60f52ecd6114d2c">Read()</a> method.  <br /></td></tr>
<tr class="separator:aa5b7ff7b56e2d266c2fd59b620a1603b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49a9d1e352e5dafc93f493012d527ee1" id="r_a49a9d1e352e5dafc93f493012d527ee1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#a49a9d1e352e5dafc93f493012d527ee1">boundary_conditions</a> = false</td></tr>
<tr class="memdesc:a49a9d1e352e5dafc93f493012d527ee1"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if the object has non-empty <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#a098bf706cf87cf06361ec9bca1c7d32c">SetBoundaryConditions()</a>  <br /></td></tr>
<tr class="separator:a49a9d1e352e5dafc93f493012d527ee1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>&lt; Calculation of fluid flow and advective solute transport </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00048">48</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="afebf06002ce5030ed63c9d64df1e8cc7" name="afebf06002ce5030ed63c9d64df1e8cc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afebf06002ce5030ed63c9d64df1e8cc7">&#9670;&#160;</a></span>FlowSolverLBM() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">openphase::FlowSolverLBM::FlowSolverLBM </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00051">51</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   51</span>{};                                                      </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae0ccac09fe97154b69ea71d6d7de1f08" name="ae0ccac09fe97154b69ea71d6d7de1f08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0ccac09fe97154b69ea71d6d7de1f08">&#9670;&#160;</a></span>FlowSolverLBM() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">openphase::FlowSolverLBM::FlowSolverLBM </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;&#160;</td>
          <td class="paramname"><em>locSettings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>in_dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>InputFileName</em> = <code><a class="el" href="../../d0/d6c/namespaceopenphase.html#a9e087efe4525895243a5c0d3a7fb07c6">DefaultInputFileName</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Empty constructor. </p>
<p>Read <a class="el" href="../../d1/d40/classopenphase_1_1Settings.html" title="&lt; System settings module. Reads and stores system settings">Settings</a> and InputFile with constructor </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00076">76</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   77</span>{</div>
<div class="line"><span class="lineno">   78</span>    </div>
<div class="line"><span class="lineno">   79</span>    fstream inpF(InputFileName.c_str(), ios::in | ios_base::binary);</div>
<div class="line"><span class="lineno">   80</span> </div>
<div class="line"><span class="lineno">   81</span>    <span class="keywordflow">if</span> (!inpF)</div>
<div class="line"><span class="lineno">   82</span>    {</div>
<div class="line"><span class="lineno">   83</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a421faa2fe5d86991328b2b06041a326d">ConsoleOutput::WriteExit</a>(<span class="stringliteral">&quot;File \&quot;&quot;</span> + InputFileName + <span class="stringliteral">&quot;\&quot; could not be opened&quot;</span>, <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>,<span class="stringliteral">&quot;ReadInput()&quot;</span>);</div>
<div class="line"><span class="lineno">   84</span>        std::exit(EXIT_FAILURE);</div>
<div class="line"><span class="lineno">   85</span>    };</div>
<div class="line"><span class="lineno">   86</span>    stringstream inp;</div>
<div class="line"><span class="lineno">   87</span>    inp &lt;&lt; inpF.rdbuf();</div>
<div class="line"><span class="lineno">   88</span> </div>
<div class="line"><span class="lineno">   89</span>    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a383e16d0cc86147dd7fab19dfe18755f">Initialize</a>(locSettings,inp,in_dt);</div>
<div class="line"><span class="lineno">   90</span>    <span class="comment">//ReadInput(InputFileName); // NOTE will be calles in Initialize</span></div>
<div class="line"><span class="lineno">   91</span>}</div>
<div class="ttc" id="aclassopenphase_1_1ConsoleOutput_html_a421faa2fe5d86991328b2b06041a326d"><div class="ttname"><a href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a421faa2fe5d86991328b2b06041a326d">openphase::ConsoleOutput::WriteExit</a></div><div class="ttdeci">static void WriteExit(const std::string Message, const std::string Instance=&quot;&quot;, const std::string Method=&quot;&quot;)</div><div class="ttdef"><b>Definition</b> <a href="../../da/da0/ConsoleOutput_8cpp_source.html#l00196">ConsoleOutput.cpp:196</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a383e16d0cc86147dd7fab19dfe18755f"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a383e16d0cc86147dd7fab19dfe18755f">openphase::FlowSolverLBM::Initialize</a></div><div class="ttdeci">void Initialize(Settings &amp;locSettings, std::stringstream &amp;inp, double in_dt)</div><div class="ttdoc">Allocates memory and initializes global settings.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00093">FlowSolverLBM.cpp:93</a></div></div>
<div class="ttc" id="aclassopenphase_1_1OPObject_html_a9006e8f49762d851b52708b363ba14f2"><div class="ttname"><a href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">openphase::OPObject::thisclassname</a></div><div class="ttdeci">std::string thisclassname</div><div class="ttdoc">Object's implementation class name.</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d1c/OPObject_8h_source.html#l00054">OPObject.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ae0f8900290b87df30e19b94a77fc0afb" name="ae0f8900290b87df30e19b94a77fc0afb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0f8900290b87df30e19b94a77fc0afb">&#9670;&#160;</a></span>AcountForAndLimitPhaseTransformation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::AcountForAndLimitPhaseTransformation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tStep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add/Removes fluid mass according to phase changes. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00790">790</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  791</span>{</div>
<div class="line"><span class="lineno">  792</span>    <span class="comment">// This method calculates the fluid density change according to phase-</span></div>
<div class="line"><span class="lineno">  793</span>    <span class="comment">// transformations like solidification. Further it limits the</span></div>
<div class="line"><span class="lineno">  794</span>    <span class="comment">// phase-transformation if not enough liquid is present.</span></div>
<div class="line"><span class="lineno">  795</span>    <span class="comment">// It only needs to be calculated if the fluid density is assumed to be</span></div>
<div class="line"><span class="lineno">  796</span>    <span class="comment">// inhomogeneous.</span></div>
<div class="line"><span class="lineno">  797</span>  </div>
<div class="line"><span class="lineno">  798</span>    <span class="keywordflow">if</span> (tStep == 0)</div>
<div class="line"><span class="lineno">  799</span>    {</div>
<div class="line"><span class="lineno">  800</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">ConsoleOutput::WriteWarning</a>(<span class="stringliteral">&quot;Simulation of a two phase fluid and Solidification and Melting is still experimental&quot;</span>, <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, <span class="stringliteral">&quot;AcountForAndLimitPhaseTransformation&quot;</span>);</div>
<div class="line"><span class="lineno">  801</span>    }</div>
<div class="line"><span class="lineno">  802</span> </div>
<div class="line"><span class="lineno">  803</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a147890b1c75d4b407881212ea40ecf05">Do_TwoPhase</a>)</div>
<div class="line"><span class="lineno">  804</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields,0,)</div>
<div class="line"><span class="lineno">  805</span>    if(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).wide_interface())</div>
<div class="line"><span class="lineno">  806</span>    {</div>
<div class="line"><span class="lineno">  807</span>        <span class="keywordtype">double</span> locDensity = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{0});</div>
<div class="line"><span class="lineno">  808</span>        <span class="keywordtype">double</span> locIncomingDensityChange = <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#acc7171d532ae567e7d10d3cab5397cab">CalculateLocalIncomingSolidDensityChange</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>,i,j,k);</div>
<div class="line"><span class="lineno">  809</span>        <span class="keywordtype">double</span> locDensityChange = locIncomingDensityChange;</div>
<div class="line"><span class="lineno">  810</span> </div>
<div class="line"><span class="lineno">  811</span>        <span class="comment">// Limit incoming density change</span></div>
<div class="line"><span class="lineno">  812</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> locDensityMinium = 2*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a6720e11af1b05213fbba7af7e7047848">VaporDensity</a>[0];</div>
<div class="line"><span class="lineno">  813</span>        <span class="keywordflow">if</span> (locIncomingDensityChange &gt; 0.0) <span class="comment">// TODO also consider melting</span></div>
<div class="line"><span class="lineno">  814</span>        {</div>
<div class="line"><span class="lineno">  815</span>            <span class="keywordtype">double</span> Limiter = 1.0;</div>
<div class="line"><span class="lineno">  816</span>            <span class="keywordflow">if</span> (locDensity &lt; locDensityMinium)</div>
<div class="line"><span class="lineno">  817</span>            {</div>
<div class="line"><span class="lineno">  818</span>                locDensityChange = 0.0;</div>
<div class="line"><span class="lineno">  819</span>                Limiter = 0.0;</div>
<div class="line"><span class="lineno">  820</span>            }</div>
<div class="line"><span class="lineno">  821</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (locDensity - locIncomingDensityChange &lt; locDensityMinium)</div>
<div class="line"><span class="lineno">  822</span>            {</div>
<div class="line"><span class="lineno">  823</span>                locDensityChange = locDensityMinium-locDensity;</div>
<div class="line"><span class="lineno">  824</span>                Limiter = locDensityChange/locIncomingDensityChange;</div>
<div class="line"><span class="lineno">  825</span>            }</div>
<div class="line"><span class="lineno">  826</span> </div>
<div class="line"><span class="lineno">  827</span>            <span class="comment">// Limit phase-transformation to ensure mass conservation</span></div>
<div class="line"><span class="lineno">  828</span>            <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a> : <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsDot(i,j,k))</div>
<div class="line"><span class="lineno">  829</span>            {</div>
<div class="line"><span class="lineno">  830</span>                <span class="keyword">const</span> Grain GrainA = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>.indexA];</div>
<div class="line"><span class="lineno">  831</span>                <span class="keyword">const</span> Grain GrainB = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>.indexB];</div>
<div class="line"><span class="lineno">  832</span>                <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>.value1 != 0.0)</div>
<div class="line"><span class="lineno">  833</span>                <span class="keywordflow">if</span> ((GrainA.is_solid() and GrainB.is_fluid()) or</div>
<div class="line"><span class="lineno">  834</span>                    (GrainB.is_solid() and GrainA.is_fluid()))</div>
<div class="line"><span class="lineno">  835</span>                {</div>
<div class="line"><span class="lineno">  836</span>                    <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>.value1 *= Limiter;</div>
<div class="line"><span class="lineno">  837</span>                }</div>
<div class="line"><span class="lineno">  838</span>            }</div>
<div class="line"><span class="lineno">  839</span>        }</div>
<div class="line"><span class="lineno">  840</span> </div>
<div class="line"><span class="lineno">  841</span>        <span class="comment">// Apply density change</span></div>
<div class="line"><span class="lineno">  842</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{0}) -= locDensityChange;</div>
<div class="line"><span class="lineno">  843</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a> (i,j,k,{0}) = <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#acbf6f50e003944ed8daced249b20ee6e">EquilibriumDistribution</a>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{0})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92539bf6d5ed043520c0bdbc47c334a9">lbWeights</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a>(i,j,k,{0})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0e7cad672eea608ab7c5ea5ed6946138">dm</a>);</div>
<div class="line"><span class="lineno">  844</span>    }</div>
<div class="line"><span class="lineno">  845</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  846</span>}</div>
<div class="ttc" id="aMacros_8h_html_a62927f995b0bd1de2eba0c018173118a"><div class="ttname"><a href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a></div><div class="ttdeci">#define OMP_PARALLEL_STORAGE_LOOP_BEGIN(i, j, k, T__, op_loop_bcells__,...)</div><div class="ttdef"><b>Definition</b> <a href="../../df/d0a/Macros_8h_source.html#l00090">Macros.h:90</a></div></div>
<div class="ttc" id="aMacros_8h_html_aeb62b2001f34442764a83858492dcff3"><div class="ttname"><a href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div><div class="ttdeci">#define OMP_PARALLEL_STORAGE_LOOP_END</div><div class="ttdef"><b>Definition</b> <a href="../../df/d0a/Macros_8h_source.html#l00112">Macros.h:112</a></div></div>
<div class="ttc" id="aclassopenphase_1_1ConsoleOutput_html_a3d39f6f01e37b75d360090aa734bc1bd"><div class="ttname"><a href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">openphase::ConsoleOutput::WriteWarning</a></div><div class="ttdeci">static void WriteWarning(const std::string Message, const std::string Instance=&quot;&quot;, const std::string Method=&quot;&quot;)</div><div class="ttdef"><b>Definition</b> <a href="../../da/da0/ConsoleOutput_8cpp_source.html#l00176">ConsoleOutput.cpp:176</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a0e7cad672eea608ab7c5ea5ed6946138"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0e7cad672eea608ab7c5ea5ed6946138">openphase::FlowSolverLBM::dm</a></div><div class="ttdeci">double dm</div><div class="ttdoc">Coefficient to calculate physical momentum density from lattice momentum density [Kg/(m^2 s)].</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00216">FlowSolverLBM.h:216</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a147890b1c75d4b407881212ea40ecf05"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a147890b1c75d4b407881212ea40ecf05">openphase::FlowSolverLBM::Do_TwoPhase</a></div><div class="ttdeci">bool Do_TwoPhase</div><div class="ttdoc">Set to &quot;true&quot; if two phase flow should be calculated.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00191">FlowSolverLBM.h:191</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a3f3275be19efcce0234470fdc88d77fd"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">openphase::FlowSolverLBM::dRho</a></div><div class="ttdeci">double dRho</div><div class="ttdoc">Coefficient to calculate physical density from lattice density [Kg/m^3].</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00214">FlowSolverLBM.h:214</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a6720e11af1b05213fbba7af7e7047848"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a6720e11af1b05213fbba7af7e7047848">openphase::FlowSolverLBM::VaporDensity</a></div><div class="ttdeci">std::vector&lt; double &gt; VaporDensity</div><div class="ttdoc">Equilibrium density of the solid phase.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00248">FlowSolverLBM.h:248</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a7ae0f2b577b9a7525d84e110ed21e047"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">openphase::FlowSolverLBM::lbPopulations</a></div><div class="ttdeci">Storage3D&lt; D3Q27, 1 &gt; lbPopulations</div><div class="ttdoc">Populations (discretized particle distribution functions) PDF)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00168">FlowSolverLBM.h:168</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a92539bf6d5ed043520c0bdbc47c334a9"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92539bf6d5ed043520c0bdbc47c334a9">openphase::FlowSolverLBM::lbWeights</a></div><div class="ttdeci">double lbWeights[3][3][3]</div><div class="ttdoc">Lattice Boltzmann stencil weights.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00224">FlowSolverLBM.h:224</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_acbf6f50e003944ed8daced249b20ee6e"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#acbf6f50e003944ed8daced249b20ee6e">openphase::FlowSolverLBM::EquilibriumDistribution</a></div><div class="ttdeci">static D3Q27 EquilibriumDistribution(double lbDensity, const double weights[3][3][3], dVector3 lbMomentum={0.0, 0.0, 0.0})</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l03077">FlowSolverLBM.cpp:3077</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_acc7171d532ae567e7d10d3cab5397cab"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#acc7171d532ae567e7d10d3cab5397cab">openphase::FlowSolverLBM::CalculateLocalIncomingSolidDensityChange</a></div><div class="ttdeci">double CalculateLocalIncomingSolidDensityChange(PhaseField &amp;Phase, int i, int j, int k)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00775">FlowSolverLBM.cpp:775</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_ad5001f5c5e9e2aa3f12640ce3f31614a"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">openphase::FlowSolverLBM::DensityWetting</a></div><div class="ttdeci">Storage3D&lt; double, 1 &gt; DensityWetting</div><div class="ttdoc">Fluid density / Solid wetting parameter.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00176">FlowSolverLBM.h:176</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_ae0a0f10cae3f3b764b4fa994a842f3a5"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">openphase::FlowSolverLBM::MomentumDensity</a></div><div class="ttdeci">Storage3D&lt; dVector3, 1 &gt; MomentumDensity</div><div class="ttdoc">Momentum density.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00175">FlowSolverLBM.h:175</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_a00cfeac3044187955c0b5786f4b6eb3f"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">openphase::psi</a></div><div class="ttdeci">double psi(double rho, double rho0)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00046">FlowSolverLBM.cpp:46</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">openphase::HeatSourceTypes::Phase</a></div><div class="ttdeci">@ Phase</div><div class="ttdoc">Selected phase will act as a heat source.</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afd82ead485f6d9695aa733729100614c" name="afd82ead485f6d9695aa733729100614c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd82ead485f6d9695aa733729100614c">&#9670;&#160;</a></span>Advect()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void openphase::OPObject::Advect </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d95/classopenphase_1_1AdvectionHR.html">AdvectionHR</a> &amp;&#160;</td>
          <td class="paramname"><em>Adv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;&#160;</td>
          <td class="paramname"><em>Vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>tStep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tStep</td><td>Advects relevant fields </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="../../d8/da6/classopenphase_1_1Composition.html#a6ee3785e72c0180118ef05c83e490bbf">openphase::Composition</a>, <a class="el" href="../../d2/de8/classopenphase_1_1ElasticProperties.html#af1d84be6585c0737a194d465054d4a56">openphase::ElasticProperties</a>, <a class="el" href="../../d4/d77/classopenphase_1_1FractureField.html#a02f3075805d6c88aac380c8e64edb476">openphase::FractureField</a>, <a class="el" href="../../d8/dba/classopenphase_1_1GrandPotentialSolver.html#a06d388daf0eb61ee202ddd036c1711f4">openphase::GrandPotentialSolver</a>, <a class="el" href="../../d0/df3/classopenphase_1_1Orientations.html#a9dde57a361a724f5cd7f73a6589bc75b">openphase::Orientations</a>, <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#aca24a7b03b7fba39de79695ef541937e">openphase::PhaseField</a>, <a class="el" href="../../d4/d35/classopenphase_1_1Temperature.html#a066369acadd4bf1555850a255a70e211">openphase::Temperature</a>, and <a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html#ac7b998d9b85443c730de36d54fb1a8cc">openphase::Velocities</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d5/d1c/OPObject_8h_source.html#l00097">97</a> of file <a class="el" href="../../d5/d1c/OPObject_8h_source.html">OPObject.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  100</span>    {</div>
<div class="line"><span class="lineno">  101</span>        (void) Adv;   <span class="comment">//unused</span></div>
<div class="line"><span class="lineno">  102</span>        (void) Vel;   <span class="comment">//unused</span></div>
<div class="line"><span class="lineno">  103</span>        (void) <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a44913b19d54d780a4b9e00fcab11cbb6">Phi</a>;   <span class="comment">//unused</span></div>
<div class="line"><span class="lineno">  104</span>        (void) BC;    <span class="comment">//unused</span></div>
<div class="line"><span class="lineno">  105</span>        (void) dt;    <span class="comment">//unused</span></div>
<div class="line"><span class="lineno">  106</span>        (void) tStep; <span class="comment">//unused</span></div>
<div class="line"><span class="lineno">  107</span>    }</div>
<div class="ttc" id="anamespaceopenphase_html_a44913b19d54d780a4b9e00fcab11cbb6"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a44913b19d54d780a4b9e00fcab11cbb6">openphase::Phi</a></div><div class="ttdeci">double Phi(const double lbDensity, const double ReducedPressure, const double GasParameter)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00052">FlowSolverLBM.cpp:52</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afdd615b8cae1c2a91204cd5477080606" name="afdd615b8cae1c2a91204cd5477080606"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afdd615b8cae1c2a91204cd5477080606">&#9670;&#160;</a></span>ApplyForces() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::ApplyForces </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;&#160;</td>
          <td class="paramname"><em>Vel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies force without composition. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l01835">1835</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1836</span>{</div>
<div class="line"><span class="lineno"> 1837</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>,0,)</div>
<div class="line"><span class="lineno"> 1838</span>    for (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 1839</span>    {</div>
<div class="line"><span class="lineno"> 1840</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>(i,j,k,{n}).set_to_zero();</div>
<div class="line"><span class="lineno"> 1841</span>    }</div>
<div class="line"><span class="lineno"> 1842</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1843</span> </div>
<div class="line"><span class="lineno"> 1844</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>,0,)</div>
<div class="line"><span class="lineno"> 1845</span>    if (!<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k))</div>
<div class="line"><span class="lineno"> 1846</span>    {</div>
<div class="line"><span class="lineno"> 1847</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a147890b1c75d4b407881212ea40ecf05">Do_TwoPhase</a>) <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1147e2da1b27379c3eb33439d4e1d21d">CalculateForceTwoPhase</a>(i,j,k, <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>);</div>
<div class="line"><span class="lineno"> 1848</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a570918ac5d77ab38b6f92f9a31e401e0">Do_Drag</a> and <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).interface())</div>
<div class="line"><span class="lineno"> 1849</span>        {</div>
<div class="line"><span class="lineno"> 1850</span>            <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afb92a3e90b859cbb71f0cc255f739173">CalculateForceDrag</a>(i,j,k, <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, Vel);</div>
<div class="line"><span class="lineno"> 1851</span>        }</div>
<div class="line"><span class="lineno"> 1852</span>    }</div>
<div class="line"><span class="lineno"> 1853</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1854</span> </div>
<div class="line"><span class="lineno"> 1855</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2254d3b9f9dab0e6a6917590f020879d">Do_Gravity</a>) <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1b4be0ef726f5618713559356e9906f1">CalculateForceGravity</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>);</div>
<div class="line"><span class="lineno"> 1856</span>}</div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a1147e2da1b27379c3eb33439d4e1d21d"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1147e2da1b27379c3eb33439d4e1d21d">openphase::FlowSolverLBM::CalculateForceTwoPhase</a></div><div class="ttdeci">void CalculateForceTwoPhase(const int i, const int j, const int k, PhaseField &amp;Phase)</div><div class="ttdoc">Force contribution according to Benzi.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00710">FlowSolverLBM.cpp:710</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a1b4be0ef726f5618713559356e9906f1"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1b4be0ef726f5618713559356e9906f1">openphase::FlowSolverLBM::CalculateForceGravity</a></div><div class="ttdeci">void CalculateForceGravity(PhaseField &amp;Phase)</div><div class="ttdoc">Force contribution of Gravitation.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00848">FlowSolverLBM.cpp:848</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a1c3ab22cfd49f007f6c0289f093dcd8b"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">openphase::FlowSolverLBM::ForceDensity</a></div><div class="ttdeci">Storage3D&lt; dVector3, 1 &gt; ForceDensity</div><div class="ttdoc">Force density.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00174">FlowSolverLBM.h:174</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a2254d3b9f9dab0e6a6917590f020879d"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2254d3b9f9dab0e6a6917590f020879d">openphase::FlowSolverLBM::Do_Gravity</a></div><div class="ttdeci">bool Do_Gravity</div><div class="ttdoc">Set to &quot;true&quot; if gravitational force should be calculated.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00188">FlowSolverLBM.h:188</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a570918ac5d77ab38b6f92f9a31e401e0"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a570918ac5d77ab38b6f92f9a31e401e0">openphase::FlowSolverLBM::Do_Drag</a></div><div class="ttdeci">bool Do_Drag</div><div class="ttdoc">Set to &quot;true&quot; if drag force at the interfaces should be calculated.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00185">FlowSolverLBM.h:185</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_ac0c2cd11db03f22d554529d296ba08f6"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">openphase::FlowSolverLBM::N_Fluid_Comp</a></div><div class="ttdeci">size_t N_Fluid_Comp</div><div class="ttdoc">Number of fluid components.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00227">FlowSolverLBM.h:227</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_add3ce72d4d4ffd34781bac8b0f7a6673"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">openphase::FlowSolverLBM::Obstacle</a></div><div class="ttdeci">Storage3D&lt; int, 0 &gt; Obstacle</div><div class="ttdoc">1 if Node is solid</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00170">FlowSolverLBM.h:170</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_afb92a3e90b859cbb71f0cc255f739173"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afb92a3e90b859cbb71f0cc255f739173">openphase::FlowSolverLBM::CalculateForceDrag</a></div><div class="ttdeci">void CalculateForceDrag(const int i, const int j, const int k, PhaseField &amp;Phase, const Velocities &amp;Vel)</div><div class="ttdoc">Force contribution of surface drag.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l01507">FlowSolverLBM.cpp:1507</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afe6c94036f18a00f2ebd751c3014d5b6" name="afe6c94036f18a00f2ebd751c3014d5b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe6c94036f18a00f2ebd751c3014d5b6">&#9670;&#160;</a></span>ApplyForces() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::ApplyForces </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;&#160;</td>
          <td class="paramname"><em>Vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d8/da6/classopenphase_1_1Composition.html">Composition</a> &amp;&#160;</td>
          <td class="paramname"><em>Cx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies forces. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l01858">1858</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1860</span>{</div>
<div class="line"><span class="lineno"> 1861</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>,0,)</div>
<div class="line"><span class="lineno"> 1862</span>    for (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 1863</span>    {</div>
<div class="line"><span class="lineno"> 1864</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>(i,j,k,{n}).set_to_zero();</div>
<div class="line"><span class="lineno"> 1865</span>    }</div>
<div class="line"><span class="lineno"> 1866</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1867</span> </div>
<div class="line"><span class="lineno"> 1868</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>,0,)</div>
<div class="line"><span class="lineno"> 1869</span>    if (!<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k))</div>
<div class="line"><span class="lineno"> 1870</span>    {</div>
<div class="line"><span class="lineno"> 1871</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a147890b1c75d4b407881212ea40ecf05">Do_TwoPhase</a>) <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1147e2da1b27379c3eb33439d4e1d21d">CalculateForceTwoPhase</a>(i,j,k, <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>);</div>
<div class="line"><span class="lineno"> 1872</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a570918ac5d77ab38b6f92f9a31e401e0">Do_Drag</a> and <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).interface())</div>
<div class="line"><span class="lineno"> 1873</span>        {</div>
<div class="line"><span class="lineno"> 1874</span>            <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afb92a3e90b859cbb71f0cc255f739173">CalculateForceDrag</a>(i,j,k, <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, Vel);</div>
<div class="line"><span class="lineno"> 1875</span>        }</div>
<div class="line"><span class="lineno"> 1876</span>    }</div>
<div class="line"><span class="lineno"> 1877</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1878</span> </div>
<div class="line"><span class="lineno"> 1879</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2254d3b9f9dab0e6a6917590f020879d">Do_Gravity</a>)</div>
<div class="line"><span class="lineno"> 1880</span>    {</div>
<div class="line"><span class="lineno"> 1881</span>        <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1b4be0ef726f5618713559356e9906f1">CalculateForceGravity</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>);</div>
<div class="line"><span class="lineno"> 1882</span>        <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1b4be0ef726f5618713559356e9906f1">CalculateForceGravity</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, Cx);</div>
<div class="line"><span class="lineno"> 1883</span>    }</div>
<div class="line"><span class="lineno"> 1884</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aaaecdbf57d1375053d64613f53c5e7f7" name="aaaecdbf57d1375053d64613f53c5e7f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaaecdbf57d1375053d64613f53c5e7f7">&#9670;&#160;</a></span>BounceBack()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::BounceBack </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ii</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>jj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>kk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>lbDensityChange</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l01543">1543</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1546</span>{</div>
<div class="line"><span class="lineno"> 1547</span>    <span class="keywordtype">double</span> dx3 = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_function" href="../../dc/d18/classopenphase_1_1GridParameters.html#a9e96c156b3c12ba0bb402d5188dbf1c6">CellVolume</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1548</span> </div>
<div class="line"><span class="lineno"> 1549</span>    <span class="keywordtype">double</span> NewPopulation = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n})(-ii,-jj,-kk);</div>
<div class="line"><span class="lineno"> 1550</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2dc5ba2dfe7ff199c4e6b625c57b4001">Do_BounceBack</a>)</div>
<div class="line"><span class="lineno"> 1551</span>    {</div>
<div class="line"><span class="lineno"> 1552</span>        <span class="keywordflow">for</span>(<span class="keyword">auto</span> it : <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i-ii,j-jj,k-kk))</div>
<div class="line"><span class="lineno"> 1553</span>        {</div>
<div class="line"><span class="lineno"> 1554</span>            Grain&amp; grain = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[it.index];</div>
<div class="line"><span class="lineno"> 1555</span>            <span class="keywordflow">if</span>(grain.State == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a545a7e1c8dca42c00f8f139a1913c61cae41480b6bbfbf7407974a88d3d34f4fa">AggregateStates::Solid</a>)</div>
<div class="line"><span class="lineno"> 1556</span>            {</div>
<div class="line"><span class="lineno"> 1557</span>                dMatrix3x3 W;</div>
<div class="line"><span class="lineno"> 1558</span>                W(0,0) = 0.0;</div>
<div class="line"><span class="lineno"> 1559</span>                W(1,1) = 0.0;</div>
<div class="line"><span class="lineno"> 1560</span>                W(2,2) = 0.0;</div>
<div class="line"><span class="lineno"> 1561</span>                W(0,1) = -grain.aVel[2];</div>
<div class="line"><span class="lineno"> 1562</span>                W(0,2) =  grain.aVel[1];</div>
<div class="line"><span class="lineno"> 1563</span>                W(1,2) = -grain.aVel[0];</div>
<div class="line"><span class="lineno"> 1564</span>                W(1,0) =  grain.aVel[2];</div>
<div class="line"><span class="lineno"> 1565</span>                W(2,0) = -grain.aVel[1];</div>
<div class="line"><span class="lineno"> 1566</span>                W(2,1) =  grain.aVel[0];</div>
<div class="line"><span class="lineno"> 1567</span> </div>
<div class="line"><span class="lineno"> 1568</span>                <span class="keyword">const</span> dVector3 pos = {double(i-0.5*ii), double(j-0.5*jj), double(k-0.5*kk)};</div>
<div class="line"><span class="lineno"> 1569</span>                dVector3 distanceCM;</div>
<div class="line"><span class="lineno"> 1570</span>                <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a8c0f8b77e0d42687ea8c78fb3f9b6d88">CalculateDistancePeriodic</a>(pos, grain.Rcm, distanceCM, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>);</div>
<div class="line"><span class="lineno"> 1571</span>                <span class="keyword">const</span> dVector3 locR = distanceCM * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>;</div>
<div class="line"><span class="lineno"> 1572</span>                <span class="keyword">const</span> dVector3 Vel = grain.Vcm + W * locR;</div>
<div class="line"><span class="lineno"> 1573</span> </div>
<div class="line"><span class="lineno"> 1574</span>                <span class="keyword">const</span> <span class="keywordtype">double</span> tmp = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92539bf6d5ed043520c0bdbc47c334a9">lbWeights</a>[ii+1][jj+1][kk+1] *</div>
<div class="line"><span class="lineno"> 1575</span>                    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a> * (Vel[0]*ii + Vel[1]*jj + Vel[2]*kk) * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>;</div>
<div class="line"><span class="lineno"> 1576</span> </div>
<div class="line"><span class="lineno"> 1577</span>                <span class="keyword">const</span> <span class="keywordtype">double</span> lbBBDensity =</div>
<div class="line"><span class="lineno"> 1578</span>                    2.0 * (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n})(-ii,-jj,-kk) + 3.0 * tmp);</div>
<div class="line"><span class="lineno"> 1579</span> </div>
<div class="line"><span class="lineno"> 1580</span>                NewPopulation += it.value * 6.0 * tmp;</div>
<div class="line"><span class="lineno"> 1581</span> </div>
<div class="line"><span class="lineno"> 1582</span>                <span class="comment">// NOTE: Bounce Back Momentum Density is now in physical units</span></div>
<div class="line"><span class="lineno"> 1583</span>                dVector3 lbBounceBackForceDensity;</div>
<div class="line"><span class="lineno"> 1584</span>                lbBounceBackForceDensity[0] = - ii * lbBBDensity * it.value;</div>
<div class="line"><span class="lineno"> 1585</span>                lbBounceBackForceDensity[1] = - jj * lbBBDensity * it.value;</div>
<div class="line"><span class="lineno"> 1586</span>                lbBounceBackForceDensity[2] = - kk * lbBBDensity * it.value;</div>
<div class="line"><span class="lineno"> 1587</span> </div>
<div class="line"><span class="lineno"> 1588</span>                <span class="keyword">const</span> dVector3 BounceBackForceDensity = lbBounceBackForceDensity * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3b6d8de9f278b56d9346a2adb823a4e2">df</a>;</div>
<div class="line"><span class="lineno"> 1589</span> </div>
<div class="line"><span class="lineno"> 1590</span><span class="preprocessor">                #ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1591</span><span class="preprocessor">                #pragma omp critical</span></div>
<div class="line"><span class="lineno"> 1592</span><span class="preprocessor">                #endif</span></div>
<div class="line"><span class="lineno"> 1593</span>                {</div>
<div class="line"><span class="lineno"> 1594</span>                    grain.Force  += BounceBackForceDensity * dx3;</div>
<div class="line"><span class="lineno"> 1595</span>                    grain.Torque += locR.cross(BounceBackForceDensity) * dx3;</div>
<div class="line"><span class="lineno"> 1596</span>                }</div>
<div class="line"><span class="lineno"> 1597</span>            }</div>
<div class="line"><span class="lineno"> 1598</span>        }</div>
<div class="line"><span class="lineno"> 1599</span>    }</div>
<div class="line"><span class="lineno"> 1600</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a359a5b0d89af4a527bb3d9cfdba32f85">Do_BounceBackElastic</a>)</div>
<div class="line"><span class="lineno"> 1601</span>    {</div>
<div class="line"><span class="lineno"> 1602</span>        <span class="comment">// Author: raphael.schiedung@rub.de</span></div>
<div class="line"><span class="lineno"> 1603</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> rho1    = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n})(-ii,-jj,-kk);</div>
<div class="line"><span class="lineno"> 1604</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> ci      = std::sqrt(ii*ii+jj*jj+kk*kk);</div>
<div class="line"><span class="lineno"> 1605</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> ici     = 1.0/ci;</div>
<div class="line"><span class="lineno"> 1606</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> p1      = rho1*ci;</div>
<div class="line"><span class="lineno"> 1607</span>        <span class="keyword">const</span> dVector3 nn    = {-ii*ici, -jj*ici, -kk*ici};</div>
<div class="line"><span class="lineno"> 1608</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> Elastic = 1.00;  <span class="comment">// 0.0 models fully inelastic impact</span></div>
<div class="line"><span class="lineno"> 1609</span> </div>
<div class="line"><span class="lineno"> 1610</span>        NewPopulation = 0.0;</div>
<div class="line"><span class="lineno"> 1611</span>        <span class="keywordflow">for</span>(<span class="keyword">auto</span> it : <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i-ii,j-jj,k-kk))</div>
<div class="line"><span class="lineno"> 1612</span>        {</div>
<div class="line"><span class="lineno"> 1613</span>            Grain&amp; grain = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[it.index];</div>
<div class="line"><span class="lineno"> 1614</span>            <span class="keywordflow">if</span>(grain.State == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a545a7e1c8dca42c00f8f139a1913c61cae41480b6bbfbf7407974a88d3d34f4fa">AggregateStates::Solid</a>)</div>
<div class="line"><span class="lineno"> 1615</span>            {</div>
<div class="line"><span class="lineno"> 1616</span>                dMatrix3x3 W;</div>
<div class="line"><span class="lineno"> 1617</span>                W(0,0) = 0.0;</div>
<div class="line"><span class="lineno"> 1618</span>                W(1,1) = 0.0;</div>
<div class="line"><span class="lineno"> 1619</span>                W(2,2) = 0.0;</div>
<div class="line"><span class="lineno"> 1620</span>                W(0,1) = -grain.aVel[2];</div>
<div class="line"><span class="lineno"> 1621</span>                W(0,2) =  grain.aVel[1];</div>
<div class="line"><span class="lineno"> 1622</span>                W(1,2) = -grain.aVel[0];</div>
<div class="line"><span class="lineno"> 1623</span>                W(1,0) =  grain.aVel[2];</div>
<div class="line"><span class="lineno"> 1624</span>                W(2,0) = -grain.aVel[1];</div>
<div class="line"><span class="lineno"> 1625</span>                W(2,1) =  grain.aVel[0];</div>
<div class="line"><span class="lineno"> 1626</span> </div>
<div class="line"><span class="lineno"> 1627</span>                <span class="keyword">const</span> dVector3 pos = {double(i-0.5*ii), double(j-0.5*jj), double(k-0.5*kk)};</div>
<div class="line"><span class="lineno"> 1628</span>                dVector3 distanceCM;</div>
<div class="line"><span class="lineno"> 1629</span>                <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a8c0f8b77e0d42687ea8c78fb3f9b6d88">CalculateDistancePeriodic</a>(pos, grain.Rcm,distanceCM, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>);</div>
<div class="line"><span class="lineno"> 1630</span>                <span class="keyword">const</span> dVector3 locR   = distanceCM * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>;</div>
<div class="line"><span class="lineno"> 1631</span>                <span class="keyword">const</span> dVector3 Vel = grain.Vcm + W * locR;</div>
<div class="line"><span class="lineno"> 1632</span> </div>
<div class="line"><span class="lineno"> 1633</span>                <span class="keyword">const</span> <span class="keywordtype">double</span> v2   = Vel*nn*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>;</div>
<div class="line"><span class="lineno"> 1634</span>                <span class="keyword">const</span> <span class="keywordtype">double</span> rho2 = grain.Density/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>;</div>
<div class="line"><span class="lineno"> 1635</span>                <span class="keyword">const</span> <span class="keywordtype">double</span> p2   = rho2*v2;</div>
<div class="line"><span class="lineno"> 1636</span>                <span class="keyword">const</span> <span class="keywordtype">double</span> p1p  = (p1*(rho1-rho2*Elastic) + p2*(rho1+rho1*Elastic))/(rho1+rho2);</div>
<div class="line"><span class="lineno"> 1637</span>                <span class="keyword">const</span> <span class="keywordtype">double</span> p2p  = (p1*(rho2+rho2*Elastic) + p2*(rho2-rho1*Elastic))/(rho1+rho2);</div>
<div class="line"><span class="lineno"> 1638</span> </div>
<div class="line"><span class="lineno"> 1639</span>                <span class="keywordflow">if</span> (p1p &lt; 0)</div>
<div class="line"><span class="lineno"> 1640</span>                {</div>
<div class="line"><span class="lineno"> 1641</span>                    NewPopulation -= it.value*p1p*ici;</div>
<div class="line"><span class="lineno"> 1642</span>                }</div>
<div class="line"><span class="lineno"> 1643</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1644</span>                {</div>
<div class="line"><span class="lineno"> 1645</span>                    <span class="comment">// The solid bounce back from the fluid (locally).</span></div>
<div class="line"><span class="lineno"> 1646</span>                    <span class="comment">// Check grain Densities !</span></div>
<div class="line"><span class="lineno"> 1647</span>                    std::cerr &lt;&lt; <span class="stringliteral">&quot;Warning fluid momentum is too high!&quot;</span></div>
<div class="line"><span class="lineno"> 1648</span>                              &lt;&lt; <span class="stringliteral">&quot;Check parameter (eg. Densities).\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1649</span>                }</div>
<div class="line"><span class="lineno"> 1650</span> </div>
<div class="line"><span class="lineno"> 1651</span>                dVector3 BounceBackForceDensity = {0,0,0};</div>
<div class="line"><span class="lineno"> 1652</span>                BounceBackForceDensity += nn*it.value*(p2p-p2)*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3b6d8de9f278b56d9346a2adb823a4e2">df</a>;</div>
<div class="line"><span class="lineno"> 1653</span><span class="preprocessor">                #ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1654</span><span class="preprocessor">                #pragma omp critical</span></div>
<div class="line"><span class="lineno"> 1655</span><span class="preprocessor">                #endif</span></div>
<div class="line"><span class="lineno"> 1656</span>                {</div>
<div class="line"><span class="lineno"> 1657</span>                    grain.Force  += BounceBackForceDensity * dx3;</div>
<div class="line"><span class="lineno"> 1658</span>                    grain.Torque += locR.cross(BounceBackForceDensity) * dx3;</div>
<div class="line"><span class="lineno"> 1659</span>                }</div>
<div class="line"><span class="lineno"> 1660</span>            }</div>
<div class="line"><span class="lineno"> 1661</span>        }</div>
<div class="line"><span class="lineno"> 1662</span>    }</div>
<div class="line"><span class="lineno"> 1663</span>    lbDensityChange += NewPopulation - <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n})(-ii,-jj,-kk);</div>
<div class="line"><span class="lineno"> 1664</span>    <span class="keywordflow">return</span> NewPopulation;</div>
<div class="line"><span class="lineno"> 1665</span>}</div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a2dc5ba2dfe7ff199c4e6b625c57b4001"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2dc5ba2dfe7ff199c4e6b625c57b4001">openphase::FlowSolverLBM::Do_BounceBack</a></div><div class="ttdeci">bool Do_BounceBack</div><div class="ttdoc">Set to &quot;true&quot; for the fluid bounce back at the interface (not energy conserving with mobile solids)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00183">FlowSolverLBM.h:183</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a359a5b0d89af4a527bb3d9cfdba32f85"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a359a5b0d89af4a527bb3d9cfdba32f85">openphase::FlowSolverLBM::Do_BounceBackElastic</a></div><div class="ttdeci">bool Do_BounceBackElastic</div><div class="ttdoc">Set to &quot;true&quot; for the elastic fluid bounce back (energy conserving with mobile solids)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00184">FlowSolverLBM.h:184</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a3b6d8de9f278b56d9346a2adb823a4e2"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3b6d8de9f278b56d9346a2adb823a4e2">openphase::FlowSolverLBM::df</a></div><div class="ttdeci">double df</div><div class="ttdoc">Coefficient to calculate physical force density from lattice force density [Kg/(m^2 s^2)].</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00217">FlowSolverLBM.h:217</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a9adff9295d5ffac6ed4be9bb59ab8070"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">openphase::FlowSolverLBM::Grid</a></div><div class="ttdeci">GridParameters Grid</div><div class="ttdoc">Simulation grid parameters.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00230">FlowSolverLBM.h:230</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_ab04d9d80bea5a4114c3c31eed361db5c"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">openphase::FlowSolverLBM::dt</a></div><div class="ttdeci">double dt</div><div class="ttdoc">Coefficient to calculate physical time from lattice time [s].</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00221">FlowSolverLBM.h:221</a></div></div>
<div class="ttc" id="aclassopenphase_1_1GridParameters_html_a0f169f4652c06b6e4328e31778885e9b"><div class="ttname"><a href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">openphase::GridParameters::Nz</a></div><div class="ttdeci">int Nz</div><div class="ttdoc">Number of grid cells in Z direction.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d68/GridParameters_8h_source.html#l00141">GridParameters.h:141</a></div></div>
<div class="ttc" id="aclassopenphase_1_1GridParameters_html_a1b2728d875d39b6eed2284849e95956c"><div class="ttname"><a href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">openphase::GridParameters::dx</a></div><div class="ttdeci">double dx</div><div class="ttdoc">Grid spacing in true units.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d68/GridParameters_8h_source.html#l00165">GridParameters.h:165</a></div></div>
<div class="ttc" id="aclassopenphase_1_1GridParameters_html_a5c1aae2c50ac8d4553575e73bea08105"><div class="ttname"><a href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">openphase::GridParameters::Nx</a></div><div class="ttdeci">int Nx</div><div class="ttdoc">Number of grid cells in X direction.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d68/GridParameters_8h_source.html#l00139">GridParameters.h:139</a></div></div>
<div class="ttc" id="aclassopenphase_1_1GridParameters_html_a6dc623672d1966056e21a45e859178b7"><div class="ttname"><a href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">openphase::GridParameters::Ny</a></div><div class="ttdeci">int Ny</div><div class="ttdoc">Number of grid cells in Y direction.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d68/GridParameters_8h_source.html#l00140">GridParameters.h:140</a></div></div>
<div class="ttc" id="aclassopenphase_1_1GridParameters_html_a9e96c156b3c12ba0bb402d5188dbf1c6"><div class="ttname"><a href="../../dc/d18/classopenphase_1_1GridParameters.html#a9e96c156b3c12ba0bb402d5188dbf1c6">openphase::GridParameters::CellVolume</a></div><div class="ttdeci">double CellVolume(bool ignore_active_dimensions=false) const</div><div class="ttdoc">&lt; Volume in 3D, area in 2D and length in 1D of a single grid cell unless ignore_active_dimensions == ...</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d68/GridParameters_8h_source.html#l00085">GridParameters.h:85</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_a545a7e1c8dca42c00f8f139a1913c61cae41480b6bbfbf7407974a88d3d34f4fa"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a545a7e1c8dca42c00f8f139a1913c61cae41480b6bbfbf7407974a88d3d34f4fa">openphase::AggregateStates::Solid</a></div><div class="ttdeci">@ Solid</div></div>
<div class="ttc" id="anamespaceopenphase_html_a8c0f8b77e0d42687ea8c78fb3f9b6d88"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a8c0f8b77e0d42687ea8c78fb3f9b6d88">openphase::CalculateDistancePeriodic</a></div><div class="ttdeci">void CalculateDistancePeriodic(dVector3 A, dVector3 B, dVector3 &amp;dist, double Nx, double Ny, double Nz)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00062">FlowSolverLBM.cpp:62</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af6e8285978dabe6066bd291c5674ffdb" name="af6e8285978dabe6066bd291c5674ffdb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6e8285978dabe6066bd291c5674ffdb">&#9670;&#160;</a></span>CalculateDensityAndMomentum()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::CalculateDensityAndMomentum </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates Density and momentum from lbDensity. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02858">2858</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2859</span>{</div>
<div class="line"><span class="lineno"> 2860</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#af665bb9655e7117ac70af33f7c40ef9f">Bcells</a>(),)</div>
<div class="line"><span class="lineno"> 2861</span>    for (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 2862</span>    {</div>
<div class="line"><span class="lineno"> 2863</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a> (i,j,k,{n}) = 0.0;</div>
<div class="line"><span class="lineno"> 2864</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a>(i,j,k,{n}).set_to_zero();</div>
<div class="line"><span class="lineno"> 2865</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii++)</div>
<div class="line"><span class="lineno"> 2866</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj++)</div>
<div class="line"><span class="lineno"> 2867</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk++)</div>
<div class="line"><span class="lineno"> 2868</span>        {</div>
<div class="line"><span class="lineno"> 2869</span>            <span class="keyword">const</span> dVector3 vel {ii*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>,jj*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>,kk*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>};</div>
<div class="line"><span class="lineno"> 2870</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a> (i,j,k,{n}) +=     <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n})(ii,jj,kk)*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>;</div>
<div class="line"><span class="lineno"> 2871</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a>(i,j,k,{n}) += vel*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n})(ii,jj,kk)*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>;</div>
<div class="line"><span class="lineno"> 2872</span>        }</div>
<div class="line"><span class="lineno"> 2873</span>    }</div>
<div class="line"><span class="lineno"> 2874</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 2875</span> </div>
<div class="line"><span class="lineno"> 2876</span>    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aeba3442a2b798b5a17d27ad07e7e23dc">FixPopulations</a>();</div>
<div class="line"><span class="lineno"> 2877</span>}</div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_aeba3442a2b798b5a17d27ad07e7e23dc"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aeba3442a2b798b5a17d27ad07e7e23dc">openphase::FlowSolverLBM::FixPopulations</a></div><div class="ttdeci">void FixPopulations(void)</div><div class="ttdoc">Ensures positive lbPopulations.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02417">FlowSolverLBM.cpp:2417</a></div></div>
<div class="ttc" id="aclassopenphase_1_1GridParameters_html_a439e45fff271a1abab42efa02e9e3f1e"><div class="ttname"><a href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">openphase::GridParameters::dNz</a></div><div class="ttdeci">int dNz</div><div class="ttdoc">Stencil step in Z direction for reduced dimensions simulations.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d68/GridParameters_8h_source.html#l00146">GridParameters.h:146</a></div></div>
<div class="ttc" id="aclassopenphase_1_1GridParameters_html_ab1b588e300d68e6b4ae6307136a11b18"><div class="ttname"><a href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">openphase::GridParameters::dNx</a></div><div class="ttdeci">int dNx</div><div class="ttdoc">Stencil step in X direction for reduced dimensions simulations.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d68/GridParameters_8h_source.html#l00144">GridParameters.h:144</a></div></div>
<div class="ttc" id="aclassopenphase_1_1GridParameters_html_afa4d2acbf1237f1a1e3ca3511aed10fc"><div class="ttname"><a href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">openphase::GridParameters::dNy</a></div><div class="ttdeci">int dNy</div><div class="ttdoc">Stencil step in Y direction for reduced dimensions simulations.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d68/GridParameters_8h_source.html#l00145">GridParameters.h:145</a></div></div>
<div class="ttc" id="aclassopenphase_1_1Storage3D_html_af665bb9655e7117ac70af33f7c40ef9f"><div class="ttname"><a href="../../da/d19/classopenphase_1_1Storage3D.html#af665bb9655e7117ac70af33f7c40ef9f">openphase::Storage3D::Bcells</a></div><div class="ttdeci">long int Bcells() const</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d8e/Storage3D_8h_source.html#l01058">Storage3D.h:1058</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae32801d85c7c703bc2d27ebef7d59d60" name="ae32801d85c7c703bc2d27ebef7d59d60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae32801d85c7c703bc2d27ebef7d59d60">&#9670;&#160;</a></span>CalculateDensityGradient()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::CalculateDensityGradient </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;&#160;</td>
          <td class="paramname"><em>Vel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00949">949</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  950</span>{</div>
<div class="line"><span class="lineno">  951</span>    <span class="keywordtype">double</span> eps=1e-10;</div>
<div class="line"><span class="lineno">  952</span>    std::vector&lt;int&gt; dir(3);</div>
<div class="line"><span class="lineno">  953</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>,0,)</div>
<div class="line"><span class="lineno">  954</span>    {</div>
<div class="line"><span class="lineno">  955</span>        <span class="keywordflow">if</span>(!<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k))</div>
<div class="line"><span class="lineno">  956</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> direction=0; direction&lt;3; ++direction)</div>
<div class="line"><span class="lineno">  957</span>        {</div>
<div class="line"><span class="lineno">  958</span>            dir[0] = (direction == 0)?1*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>:0;</div>
<div class="line"><span class="lineno">  959</span>            dir[1] = (direction == 1)?1*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>:0;</div>
<div class="line"><span class="lineno">  960</span>            dir[2] = (direction == 2)?1*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>:0;</div>
<div class="line"><span class="lineno">  961</span>            <span class="keywordtype">int</span> ip=i+dir[0];</div>
<div class="line"><span class="lineno">  962</span>            <span class="keywordtype">int</span> jp=j+dir[1];</div>
<div class="line"><span class="lineno">  963</span>            <span class="keywordtype">int</span> kp=k+dir[2];</div>
<div class="line"><span class="lineno">  964</span>            <span class="keywordtype">int</span> im=i-dir[0];</div>
<div class="line"><span class="lineno">  965</span>            <span class="keywordtype">int</span> jm=j-dir[1];</div>
<div class="line"><span class="lineno">  966</span>            <span class="keywordtype">int</span> km=k-dir[2];</div>
<div class="line"><span class="lineno">  967</span> </div>
<div class="line"><span class="lineno">  968</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno">  969</span>            {</div>
<div class="line"><span class="lineno">  970</span>                <span class="keywordtype">double</span> v = 0.0;</div>
<div class="line"><span class="lineno">  971</span>                <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).cbegin(); it != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).cend(); it++)</div>
<div class="line"><span class="lineno">  972</span>                <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[it-&gt;index].State != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a545a7e1c8dca42c00f8f139a1913c61cae41480b6bbfbf7407974a88d3d34f4fa">AggregateStates::Solid</a>)</div>
<div class="line"><span class="lineno">  973</span>                {</div>
<div class="line"><span class="lineno">  974</span>                    <span class="keywordtype">size_t</span> PhaseIdx = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[it-&gt;index].Phase;</div>
<div class="line"><span class="lineno">  975</span>                    v = Vel.Phase(i,j,k,{PhaseIdx})[direction] ;</div>
<div class="line"><span class="lineno">  976</span>                }</div>
<div class="line"><span class="lineno">  977</span>                <span class="keywordtype">double</span> Rho   = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n});</div>
<div class="line"><span class="lineno">  978</span>                <span class="keywordtype">double</span> Rhop  = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(ip,jp,kp,{n});</div>
<div class="line"><span class="lineno">  979</span>                <span class="keywordtype">double</span> Rhom  = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(im,jm,km,{n});</div>
<div class="line"><span class="lineno">  980</span> </div>
<div class="line"><span class="lineno">  981</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afd420cebecad62af1b472379f9b05663">GradRho_Upwind</a>)</div>
<div class="line"><span class="lineno">  982</span>                {</div>
<div class="line"><span class="lineno">  983</span>                    <span class="keywordflow">if</span>(v&gt;=0)</div>
<div class="line"><span class="lineno">  984</span>                    {</div>
<div class="line"><span class="lineno">  985</span>                        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2357615d61b1d4d4bb027c1dfa67260c">GradRho</a>(i,j,k,{n})[direction] = (Rho-Rhom)/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>;</div>
<div class="line"><span class="lineno">  986</span>                    }</div>
<div class="line"><span class="lineno">  987</span>                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  988</span>                    {</div>
<div class="line"><span class="lineno">  989</span>                        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2357615d61b1d4d4bb027c1dfa67260c">GradRho</a>(i,j,k,{n})[direction] = (Rhop-Rho)/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>;</div>
<div class="line"><span class="lineno">  990</span>                    }</div>
<div class="line"><span class="lineno">  991</span>                }</div>
<div class="line"><span class="lineno">  992</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a911943c5a05841969b913c12c1d4921c">GradRho_VanLeer</a>)</div>
<div class="line"><span class="lineno">  993</span>                {</div>
<div class="line"><span class="lineno">  994</span>                    <span class="keywordtype">double</span> Rhohp = (Rho+Rhop)/2.0;</div>
<div class="line"><span class="lineno">  995</span>                    <span class="keywordtype">double</span> Rhohm = (Rho+Rhom)/2.0;</div>
<div class="line"><span class="lineno">  996</span>                    <span class="keywordflow">if</span>(v&gt;=0)</div>
<div class="line"><span class="lineno">  997</span>                    {</div>
<div class="line"><span class="lineno">  998</span>                        <span class="keywordtype">int</span> imm=i-2.0*dir[0];</div>
<div class="line"><span class="lineno">  999</span>                        <span class="keywordtype">int</span> jmm=j-2.0*dir[1];</div>
<div class="line"><span class="lineno"> 1000</span>                        <span class="keywordtype">int</span> kmm=k-2.0*dir[2];</div>
<div class="line"><span class="lineno"> 1001</span> </div>
<div class="line"><span class="lineno"> 1002</span>                        <span class="keywordtype">double</span> Rhomm  = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(imm,jmm,kmm,{n});</div>
<div class="line"><span class="lineno"> 1003</span>                        <span class="keywordtype">double</span> r  = (Rho-Rhom)/(Rhop-Rho+eps);</div>
<div class="line"><span class="lineno"> 1004</span>                        <span class="keywordtype">double</span> phi=(r+fabs(r))/(1.0+fabs(r));</div>
<div class="line"><span class="lineno"> 1005</span>                        Rhohp=Rho+0.5*phi*(Rhop-Rho);</div>
<div class="line"><span class="lineno"> 1006</span> </div>
<div class="line"><span class="lineno"> 1007</span>                        <span class="keywordtype">double</span> rm  = (Rhom-Rhomm)/(Rho-Rhom+eps);</div>
<div class="line"><span class="lineno"> 1008</span>                        <span class="keywordtype">double</span> phim=(rm+fabs(rm))/(1.0+fabs(rm));</div>
<div class="line"><span class="lineno"> 1009</span>                        Rhohm=Rhom+0.5*phim*(Rho-Rhom);</div>
<div class="line"><span class="lineno"> 1010</span>                        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2357615d61b1d4d4bb027c1dfa67260c">GradRho</a>(i,j,k,{n})[direction] =  (Rhohp-Rhohm)/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>;</div>
<div class="line"><span class="lineno"> 1011</span>                    }</div>
<div class="line"><span class="lineno"> 1012</span>                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1013</span>                    {</div>
<div class="line"><span class="lineno"> 1014</span>                        <span class="keywordtype">int</span> ipp=i+2.0*dir[0];</div>
<div class="line"><span class="lineno"> 1015</span>                        <span class="keywordtype">int</span> jpp=j+2.0*dir[1];</div>
<div class="line"><span class="lineno"> 1016</span>                        <span class="keywordtype">int</span> kpp=k+2.0*dir[2];</div>
<div class="line"><span class="lineno"> 1017</span>                        <span class="keywordtype">double</span> Rhopp  = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(ipp,jpp,kpp,{n});</div>
<div class="line"><span class="lineno"> 1018</span> </div>
<div class="line"><span class="lineno"> 1019</span>                        <span class="keywordtype">double</span> r  = (Rhopp-Rhop)/(Rhop-Rho+eps);</div>
<div class="line"><span class="lineno"> 1020</span>                        <span class="keywordtype">double</span> phi=(r+fabs(r))/(1.0+fabs(r));</div>
<div class="line"><span class="lineno"> 1021</span>                        Rhohp=Rhop-0.5*phi*(Rhop-Rho);</div>
<div class="line"><span class="lineno"> 1022</span> </div>
<div class="line"><span class="lineno"> 1023</span>                        <span class="keywordtype">double</span> rm  = (Rhop-Rho)/(Rho-Rhom+eps);</div>
<div class="line"><span class="lineno"> 1024</span>                        <span class="keywordtype">double</span> phim=(rm+fabs(rm))/(1.0+fabs(rm));</div>
<div class="line"><span class="lineno"> 1025</span>                        Rhohm=Rho-0.5*phim*(Rho-Rhom);</div>
<div class="line"><span class="lineno"> 1026</span>                        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2357615d61b1d4d4bb027c1dfa67260c">GradRho</a>(i,j,k,{n})[direction] =  (Rhohp-Rhohm)/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>;</div>
<div class="line"><span class="lineno"> 1027</span>                    }</div>
<div class="line"><span class="lineno"> 1028</span>                }</div>
<div class="line"><span class="lineno"> 1029</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac26558dc3c1f0f921a771ceedbc474e2">GradRho_Central</a>)</div>
<div class="line"><span class="lineno"> 1030</span>                {</div>
<div class="line"><span class="lineno"> 1031</span>                    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2357615d61b1d4d4bb027c1dfa67260c">GradRho</a>(i,j,k,{n})[direction] =  (Rhop-Rhom)/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>/2.0;</div>
<div class="line"><span class="lineno"> 1032</span>                }</div>
<div class="line"><span class="lineno"> 1033</span>            }</div>
<div class="line"><span class="lineno"> 1034</span>        }</div>
<div class="line"><span class="lineno"> 1035</span>    }</div>
<div class="line"><span class="lineno"> 1036</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1037</span>}</div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a2357615d61b1d4d4bb027c1dfa67260c"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2357615d61b1d4d4bb027c1dfa67260c">openphase::FlowSolverLBM::GradRho</a></div><div class="ttdeci">Storage3D&lt; dVector3, 1 &gt; GradRho</div><div class="ttdoc">Gradient of density when thermal compressibility considered.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00180">FlowSolverLBM.h:180</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a911943c5a05841969b913c12c1d4921c"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a911943c5a05841969b913c12c1d4921c">openphase::FlowSolverLBM::GradRho_VanLeer</a></div><div class="ttdeci">bool GradRho_VanLeer</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00198">FlowSolverLBM.h:198</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_ac26558dc3c1f0f921a771ceedbc474e2"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac26558dc3c1f0f921a771ceedbc474e2">openphase::FlowSolverLBM::GradRho_Central</a></div><div class="ttdeci">bool GradRho_Central</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00197">FlowSolverLBM.h:197</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_afd420cebecad62af1b472379f9b05663"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afd420cebecad62af1b472379f9b05663">openphase::FlowSolverLBM::GradRho_Upwind</a></div><div class="ttdeci">bool GradRho_Upwind</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00196">FlowSolverLBM.h:196</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a444b058991aa61bfdb85e99db8b80705" name="a444b058991aa61bfdb85e99db8b80705"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a444b058991aa61bfdb85e99db8b80705">&#9670;&#160;</a></span>CalculateDensityTC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::CalculateDensityTC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/d35/classopenphase_1_1Temperature.html">Temperature</a> &amp;&#160;</td>
          <td class="paramname"><em>Tx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/da6/classopenphase_1_1Composition.html">Composition</a> &amp;&#160;</td>
          <td class="paramname"><em>Cx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates Density from ideal gas law. </p>
<p>&lt; Universal gas constant j/mol k</p>
<p>&lt; gas constant for air j/kg k</p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00889">889</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  890</span>{</div>
<div class="line"><span class="lineno">  891</span>    <span class="keywordtype">double</span> Ts=273.0;</div>
<div class="line"><span class="lineno">  892</span>    <span class="keywordtype">double</span> mus=1.68e-05; <span class="comment">//it&#39;s for air</span></div>
<div class="line"><span class="lineno">  893</span>    <span class="keywordtype">double</span> S=110.5;</div>
<div class="line"><span class="lineno">  894</span>    <span class="keywordtype">double</span> AW_air = Cx.AtomicWeightMixture;</div>
<div class="line"><span class="lineno">  895</span>    <span class="keywordtype">double</span> R= <a class="code hl_variable" href="../../d1/d9b/structopenphase_1_1PhysicalConstants.html#a9716a64c0a3b257867aca3e94e88bf95">PhysicalConstants::R</a>;     </div>
<div class="line"><span class="lineno">  896</span>    <span class="keywordtype">double</span> Rm=R/AW_air;             </div>
<div class="line"><span class="lineno">  897</span> </div>
<div class="line"><span class="lineno">  898</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#af665bb9655e7117ac70af33f7c40ef9f">Bcells</a>(),)</div>
<div class="line"><span class="lineno">  899</span>    for (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno">  900</span>    {</div>
<div class="line"><span class="lineno">  901</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n}) = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad56f87a52b427bb6a4646208d54574c1">Pth</a>/(Rm * Tx.Tx(i,j,k));</div>
<div class="line"><span class="lineno">  902</span>        <span class="keywordtype">double</span> mu=mus*(Tx.Tx(i,j,k)/Ts)*sqrt(Tx.Tx(i,j,k)/Ts)*(Ts+S)/(Tx.Tx(i,j,k)+S);</div>
<div class="line"><span class="lineno">  903</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a62faa8027eaa45caa436c65f032bc584">nut</a>(i,j,k,{n}) = mu/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n});</div>
<div class="line"><span class="lineno">  904</span>    }</div>
<div class="line"><span class="lineno">  905</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  906</span>}</div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a62faa8027eaa45caa436c65f032bc584"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a62faa8027eaa45caa436c65f032bc584">openphase::FlowSolverLBM::nut</a></div><div class="ttdeci">Storage3D&lt; double, 1 &gt; nut</div><div class="ttdoc">kinematic viscosity in lattice units when thermal compressibility considered</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00177">FlowSolverLBM.h:177</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_ad56f87a52b427bb6a4646208d54574c1"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad56f87a52b427bb6a4646208d54574c1">openphase::FlowSolverLBM::Pth</a></div><div class="ttdeci">double Pth</div><div class="ttdoc">Thermodynamic Pressure [Pa].</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00200">FlowSolverLBM.h:200</a></div></div>
<div class="ttc" id="astructopenphase_1_1PhysicalConstants_html_a9716a64c0a3b257867aca3e94e88bf95"><div class="ttname"><a href="../../d1/d9b/structopenphase_1_1PhysicalConstants.html#a9716a64c0a3b257867aca3e94e88bf95">openphase::PhysicalConstants::R</a></div><div class="ttdeci">static constexpr double R</div><div class="ttdoc">Universal gas constant [J/mol/K].</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d09/PhysicalConstants_8h_source.html#l00034">PhysicalConstants.h:34</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4837462af4b27139e46bf0f02e40bbd5" name="a4837462af4b27139e46bf0f02e40bbd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4837462af4b27139e46bf0f02e40bbd5">&#9670;&#160;</a></span>CalculateDivergenceVelocity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::CalculateDivergenceVelocity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/d35/classopenphase_1_1Temperature.html">Temperature</a> &amp;&#160;</td>
          <td class="paramname"><em>Tx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;&#160;</td>
          <td class="paramname"><em>Vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a331be5fb7f4939bbc29d69c8f6937a15" name="a331be5fb7f4939bbc29d69c8f6937a15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a331be5fb7f4939bbc29d69c8f6937a15">&#9670;&#160;</a></span>CalculateFluidMass()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; double &gt; openphase::FlowSolverLBM::CalculateFluidMass </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates mass of fluid components. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02809">2809</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2810</span>{</div>
<div class="line"><span class="lineno"> 2811</span>    std::vector&lt;double&gt; Mass(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>);</div>
<div class="line"><span class="lineno"> 2812</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 2813</span>    {</div>
<div class="line"><span class="lineno"> 2814</span>        std::vector&lt;double&gt; tmpMass;</div>
<div class="line"><span class="lineno"> 2815</span>        <span class="comment">// Calculate fluid momentum</span></div>
<div class="line"><span class="lineno"> 2816</span><span class="preprocessor">        #pragma omp parallel</span></div>
<div class="line"><span class="lineno"> 2817</span>        {</div>
<div class="line"><span class="lineno"> 2818</span>            std::vector&lt;double&gt; tmplocMass;</div>
<div class="line"><span class="lineno"> 2819</span><span class="preprocessor">            #pragma omp for collapse(OMP_COLLAPSE_LOOPS)\</span></div>
<div class="line"><span class="lineno"> 2820</span><span class="preprocessor">            schedule(OMP_SCHEDULING_TYPE,OMP_CHUNKSIZE)</span></div>
<div class="line"><span class="lineno"> 2821</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>; i++)</div>
<div class="line"><span class="lineno"> 2822</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>; j++)</div>
<div class="line"><span class="lineno"> 2823</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>; k++)</div>
<div class="line"><span class="lineno"> 2824</span>            <span class="keywordflow">if</span> (not <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k))</div>
<div class="line"><span class="lineno"> 2825</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii++)</div>
<div class="line"><span class="lineno"> 2826</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj++)</div>
<div class="line"><span class="lineno"> 2827</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk++)</div>
<div class="line"><span class="lineno"> 2828</span>            {</div>
<div class="line"><span class="lineno"> 2829</span>                <span class="keywordtype">double</span> rr = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n})(ii,jj,kk);</div>
<div class="line"><span class="lineno"> 2830</span>                tmplocMass.push_back(rr);</div>
<div class="line"><span class="lineno"> 2831</span>            }</div>
<div class="line"><span class="lineno"> 2832</span> </div>
<div class="line"><span class="lineno"> 2833</span>            std::sort(tmplocMass.begin(),tmplocMass.end(), [] (<span class="keywordtype">double</span> a, <span class="keywordtype">double</span> b) { return a &lt; b;});</div>
<div class="line"><span class="lineno"> 2834</span> </div>
<div class="line"><span class="lineno"> 2835</span>            <span class="keywordtype">double</span> locMass = 0.0;</div>
<div class="line"><span class="lineno"> 2836</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> value : tmplocMass) locMass += value;</div>
<div class="line"><span class="lineno"> 2837</span> </div>
<div class="line"><span class="lineno"> 2838</span><span class="preprocessor">            #pragma omp critical</span></div>
<div class="line"><span class="lineno"> 2839</span>            {</div>
<div class="line"><span class="lineno"> 2840</span>                tmpMass.push_back(locMass);</div>
<div class="line"><span class="lineno"> 2841</span>            }</div>
<div class="line"><span class="lineno"> 2842</span>        }</div>
<div class="line"><span class="lineno"> 2843</span> </div>
<div class="line"><span class="lineno"> 2844</span>        std::sort(tmpMass.begin(),tmpMass.end(), [] (<span class="keywordtype">double</span> a, <span class="keywordtype">double</span> b) { return a &lt; b;});</div>
<div class="line"><span class="lineno"> 2845</span> </div>
<div class="line"><span class="lineno"> 2846</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> value : tmpMass) Mass[n] += value;</div>
<div class="line"><span class="lineno"> 2847</span> </div>
<div class="line"><span class="lineno"> 2848</span><span class="preprocessor">        #ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 2849</span>        <span class="keyword">auto</span> tmp = Mass[n];</div>
<div class="line"><span class="lineno"> 2850</span>        OP_MPI_Allreduce(&amp;tmp, &amp;(Mass[n]), 1, OP_MPI_DOUBLE, OP_MPI_SUM, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 2851</span><span class="preprocessor">        #endif</span></div>
<div class="line"><span class="lineno"> 2852</span> </div>
<div class="line"><span class="lineno"> 2853</span>        Mass[n] *= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_function" href="../../dc/d18/classopenphase_1_1GridParameters.html#a9e96c156b3c12ba0bb402d5188dbf1c6">CellVolume</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2854</span>    }</div>
<div class="line"><span class="lineno"> 2855</span>    <span class="keywordflow">return</span> Mass;</div>
<div class="line"><span class="lineno"> 2856</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a52684844a9f0909ee6cb44de43dd5d47" name="a52684844a9f0909ee6cb44de43dd5d47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52684844a9f0909ee6cb44de43dd5d47">&#9670;&#160;</a></span>CalculateFluidMomentum()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> &gt; openphase::FlowSolverLBM::CalculateFluidMomentum </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the momentum of the entire fluid in the system. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02210">2210</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2211</span>{</div>
<div class="line"><span class="lineno"> 2212</span>    std::vector&lt;dVector3&gt; Momentum(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>);</div>
<div class="line"><span class="lineno"> 2213</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 2214</span>    {</div>
<div class="line"><span class="lineno"> 2215</span>        std::vector&lt;double&gt; tmpMomentumX;</div>
<div class="line"><span class="lineno"> 2216</span>        std::vector&lt;double&gt; tmpMomentumY;</div>
<div class="line"><span class="lineno"> 2217</span>        std::vector&lt;double&gt; tmpMomentumZ;</div>
<div class="line"><span class="lineno"> 2218</span> </div>
<div class="line"><span class="lineno"> 2219</span>        <span class="comment">// Calculate fluid momentum</span></div>
<div class="line"><span class="lineno"> 2220</span><span class="preprocessor">        #pragma omp parallel</span></div>
<div class="line"><span class="lineno"> 2221</span>        {</div>
<div class="line"><span class="lineno"> 2222</span>            std::vector&lt;double&gt; tmplocMomentumX;</div>
<div class="line"><span class="lineno"> 2223</span>            std::vector&lt;double&gt; tmplocMomentumY;</div>
<div class="line"><span class="lineno"> 2224</span>            std::vector&lt;double&gt; tmplocMomentumZ;</div>
<div class="line"><span class="lineno"> 2225</span><span class="preprocessor">            #pragma omp for collapse(OMP_COLLAPSE_LOOPS)\</span></div>
<div class="line"><span class="lineno"> 2226</span><span class="preprocessor">            schedule(OMP_SCHEDULING_TYPE,OMP_CHUNKSIZE)</span></div>
<div class="line"><span class="lineno"> 2227</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>; i++)</div>
<div class="line"><span class="lineno"> 2228</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>; j++)</div>
<div class="line"><span class="lineno"> 2229</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>; k++)</div>
<div class="line"><span class="lineno"> 2230</span>            <span class="keywordflow">if</span> (not <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k))</div>
<div class="line"><span class="lineno"> 2231</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii++)</div>
<div class="line"><span class="lineno"> 2232</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj++)</div>
<div class="line"><span class="lineno"> 2233</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; kk++)</div>
<div class="line"><span class="lineno"> 2234</span>            {</div>
<div class="line"><span class="lineno"> 2235</span>                <span class="keywordtype">double</span> rr = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n})(ii,jj,kk);</div>
<div class="line"><span class="lineno"> 2236</span>                tmplocMomentumX.push_back(rr*ii);</div>
<div class="line"><span class="lineno"> 2237</span>                tmplocMomentumY.push_back(rr*jj);</div>
<div class="line"><span class="lineno"> 2238</span>                tmplocMomentumZ.push_back(rr*kk);</div>
<div class="line"><span class="lineno"> 2239</span>            }</div>
<div class="line"><span class="lineno"> 2240</span> </div>
<div class="line"><span class="lineno"> 2241</span>            std::sort(tmplocMomentumX.begin(),tmplocMomentumX.end(), [] (<span class="keywordtype">double</span> a, <span class="keywordtype">double</span> b) { return a &lt; b;});</div>
<div class="line"><span class="lineno"> 2242</span>            std::sort(tmplocMomentumY.begin(),tmplocMomentumY.end(), [] (<span class="keywordtype">double</span> a, <span class="keywordtype">double</span> b) { return a &lt; b;});</div>
<div class="line"><span class="lineno"> 2243</span>            std::sort(tmplocMomentumZ.begin(),tmplocMomentumZ.end(), [] (<span class="keywordtype">double</span> a, <span class="keywordtype">double</span> b) { return a &lt; b;});</div>
<div class="line"><span class="lineno"> 2244</span> </div>
<div class="line"><span class="lineno"> 2245</span>            <span class="keywordtype">double</span> locMomentumX = 0.0;</div>
<div class="line"><span class="lineno"> 2246</span>            <span class="keywordtype">double</span> locMomentumY = 0.0;</div>
<div class="line"><span class="lineno"> 2247</span>            <span class="keywordtype">double</span> locMomentumZ = 0.0;</div>
<div class="line"><span class="lineno"> 2248</span> </div>
<div class="line"><span class="lineno"> 2249</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> value : tmplocMomentumX) locMomentumX += value;</div>
<div class="line"><span class="lineno"> 2250</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> value : tmplocMomentumY) locMomentumY += value;</div>
<div class="line"><span class="lineno"> 2251</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> value : tmplocMomentumZ) locMomentumZ += value;</div>
<div class="line"><span class="lineno"> 2252</span> </div>
<div class="line"><span class="lineno"> 2253</span><span class="preprocessor">            #pragma omp critical</span></div>
<div class="line"><span class="lineno"> 2254</span>            {</div>
<div class="line"><span class="lineno"> 2255</span>                tmpMomentumX.push_back(locMomentumX);</div>
<div class="line"><span class="lineno"> 2256</span>                tmpMomentumY.push_back(locMomentumY);</div>
<div class="line"><span class="lineno"> 2257</span>                tmpMomentumZ.push_back(locMomentumZ);</div>
<div class="line"><span class="lineno"> 2258</span>            }</div>
<div class="line"><span class="lineno"> 2259</span>        }</div>
<div class="line"><span class="lineno"> 2260</span> </div>
<div class="line"><span class="lineno"> 2261</span>        std::sort(tmpMomentumX.begin(),tmpMomentumX.end(), [] (<span class="keywordtype">double</span> a, <span class="keywordtype">double</span> b) { return a &lt; b;});</div>
<div class="line"><span class="lineno"> 2262</span>        std::sort(tmpMomentumY.begin(),tmpMomentumY.end(), [] (<span class="keywordtype">double</span> a, <span class="keywordtype">double</span> b) { return a &lt; b;});</div>
<div class="line"><span class="lineno"> 2263</span>        std::sort(tmpMomentumZ.begin(),tmpMomentumZ.end(), [] (<span class="keywordtype">double</span> a, <span class="keywordtype">double</span> b) { return a &lt; b;});</div>
<div class="line"><span class="lineno"> 2264</span> </div>
<div class="line"><span class="lineno"> 2265</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> value : tmpMomentumX) Momentum[n][0] += value;</div>
<div class="line"><span class="lineno"> 2266</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> value : tmpMomentumY) Momentum[n][1] += value;</div>
<div class="line"><span class="lineno"> 2267</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> value : tmpMomentumZ) Momentum[n][2] += value;</div>
<div class="line"><span class="lineno"> 2268</span> </div>
<div class="line"><span class="lineno"> 2269</span><span class="preprocessor">        #ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 2270</span>        <span class="keywordtype">double</span> tmpX = Momentum[n][0];</div>
<div class="line"><span class="lineno"> 2271</span>        <span class="keywordtype">double</span> tmpY = Momentum[n][1];</div>
<div class="line"><span class="lineno"> 2272</span>        <span class="keywordtype">double</span> tmpZ = Momentum[n][2];</div>
<div class="line"><span class="lineno"> 2273</span>        OP_MPI_Allreduce(&amp;tmpX, &amp;(Momentum[n][0]), 1, OP_MPI_DOUBLE, OP_MPI_SUM, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 2274</span>        OP_MPI_Allreduce(&amp;tmpY, &amp;(Momentum[n][1]), 1, OP_MPI_DOUBLE, OP_MPI_SUM, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 2275</span>        OP_MPI_Allreduce(&amp;tmpZ, &amp;(Momentum[n][2]), 1, OP_MPI_DOUBLE, OP_MPI_SUM, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 2276</span><span class="preprocessor">        #endif</span></div>
<div class="line"><span class="lineno"> 2277</span> </div>
<div class="line"><span class="lineno"> 2278</span>        Momentum[n] *= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a> /<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a> *<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_function" href="../../dc/d18/classopenphase_1_1GridParameters.html#a9e96c156b3c12ba0bb402d5188dbf1c6">CellVolume</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2279</span>    }</div>
<div class="line"><span class="lineno"> 2280</span>    <span class="keywordflow">return</span> Momentum;</div>
<div class="line"><span class="lineno"> 2281</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a863645b683596db07ac439b417656210" name="a863645b683596db07ac439b417656210"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a863645b683596db07ac439b417656210">&#9670;&#160;</a></span>CalculateFluidVelocities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::CalculateFluidVelocities </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;&#160;</td>
          <td class="paramname"><em>Vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates Fluid velocities. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02879">2879</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2881</span>{</div>
<div class="line"><span class="lineno"> 2882</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>,0,)</div>
<div class="line"><span class="lineno"> 2883</span>    for (auto it = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).cbegin(); it != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).cend(); it++)</div>
<div class="line"><span class="lineno"> 2884</span>    if (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[it-&gt;index].State != <a class="code hl_enumeration" href="../../d0/d6c/namespaceopenphase.html#a545a7e1c8dca42c00f8f139a1913c61c">AggregateStates</a>::<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a545a7e1c8dca42c00f8f139a1913c61cae41480b6bbfbf7407974a88d3d34f4fa">Solid</a>)</div>
<div class="line"><span class="lineno"> 2885</span>    {</div>
<div class="line"><span class="lineno"> 2886</span>        <span class="keywordtype">size_t</span> PhaseIdx = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[it-&gt;index].Phase;</div>
<div class="line"><span class="lineno"> 2887</span>        Vel.Phase(i,j,k,{PhaseIdx}) = <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a972e7a0a07746093679516d1bfd0970e">FluidVelocity</a>(i,j,k);</div>
<div class="line"><span class="lineno"> 2888</span>    }</div>
<div class="line"><span class="lineno"> 2889</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 2890</span>    Vel.CalculateAverage(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>);</div>
<div class="line"><span class="lineno"> 2891</span>    Vel.SetBoundaryConditions(BC);</div>
<div class="line"><span class="lineno"> 2892</span>}</div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a972e7a0a07746093679516d1bfd0970e"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a972e7a0a07746093679516d1bfd0970e">openphase::FlowSolverLBM::FluidVelocity</a></div><div class="ttdeci">dVector3 FluidVelocity(const int i, const int j, const int k, const size_t comp) const</div><div class="ttdoc">Returns local fluid velocity of component comp.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l03143">FlowSolverLBM.cpp:3143</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_a545a7e1c8dca42c00f8f139a1913c61c"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a545a7e1c8dca42c00f8f139a1913c61c">openphase::AggregateStates</a></div><div class="ttdeci">AggregateStates</div><div class="ttdef"><b>Definition</b> <a href="../../d9/df1/Globals_8h_source.html#l00145">Globals.h:146</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afb92a3e90b859cbb71f0cc255f739173" name="afb92a3e90b859cbb71f0cc255f739173"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb92a3e90b859cbb71f0cc255f739173">&#9670;&#160;</a></span>CalculateForceDrag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::CalculateForceDrag </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;&#160;</td>
          <td class="paramname"><em>Vel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Force contribution of surface drag. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l01507">1507</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1509</span>{</div>
<div class="line"><span class="lineno"> 1510</span>    <span class="keywordtype">double</span> dx3 = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_function" href="../../dc/d18/classopenphase_1_1GridParameters.html#a9e96c156b3c12ba0bb402d5188dbf1c6">CellVolume</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1511</span> </div>
<div class="line"><span class="lineno"> 1512</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 1513</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n}) != 0.0)</div>
<div class="line"><span class="lineno"> 1514</span>    {</div>
<div class="line"><span class="lineno"> 1515</span>        <span class="keywordtype">double</span> locSolidFraction = <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a90657b1ab921a0b66ebe8201a939dddf">SolidFraction</a>(i,j,k,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>);</div>
<div class="line"><span class="lineno"> 1516</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> mu = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a79b3ebcd11696e18f2db1079356829e3">nu</a>[n]*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n});  <span class="comment">//Dynamic viscosity [kg/m/s]</span></div>
<div class="line"><span class="lineno"> 1517</span>        <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; it : <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k))</div>
<div class="line"><span class="lineno"> 1518</span>        {</div>
<div class="line"><span class="lineno"> 1519</span>            Grain&amp; grain = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[it.index];</div>
<div class="line"><span class="lineno"> 1520</span>            <span class="keywordflow">if</span>(grain.State == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a545a7e1c8dca42c00f8f139a1913c61cae41480b6bbfbf7407974a88d3d34f4fa">AggregateStates::Solid</a>)</div>
<div class="line"><span class="lineno"> 1521</span>            {</div>
<div class="line"><span class="lineno"> 1522</span>                <span class="keyword">const</span> <span class="keywordtype">double</span> factor =</div>
<div class="line"><span class="lineno"> 1523</span>                    (it.value * it.value * (1.0 - locSolidFraction))/</div>
<div class="line"><span class="lineno"> 1524</span>                    (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth * <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth);</div>
<div class="line"><span class="lineno"> 1525</span>                <span class="keyword">const</span> dVector3 locSolidVelocity = Vel.Phase(i,j,k,{grain.Phase});</div>
<div class="line"><span class="lineno"> 1526</span>                <span class="keyword">const</span> dVector3 DragForceDensity = (<a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a972e7a0a07746093679516d1bfd0970e">FluidVelocity</a>(i,j,k,n) - locSolidVelocity) * mu * factor * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad61619206ef9c5955004f3ff0186687a">h_star</a>;</div>
<div class="line"><span class="lineno"> 1527</span>                <span class="keyword">const</span> dVector3 pos = {double(i), double(j), double(k)};</div>
<div class="line"><span class="lineno"> 1528</span>                dVector3 distanceCM;</div>
<div class="line"><span class="lineno"> 1529</span>                <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a8c0f8b77e0d42687ea8c78fb3f9b6d88">CalculateDistancePeriodic</a>(pos, grain.Rcm, distanceCM, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>);</div>
<div class="line"><span class="lineno"> 1530</span>                <span class="keyword">const</span> dVector3 locR = distanceCM * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>;</div>
<div class="line"><span class="lineno"> 1531</span><span class="preprocessor">                #ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1532</span><span class="preprocessor">                #pragma omp critical</span></div>
<div class="line"><span class="lineno"> 1533</span><span class="preprocessor">                #endif</span></div>
<div class="line"><span class="lineno"> 1534</span>                {</div>
<div class="line"><span class="lineno"> 1535</span>                    grain.Force  += DragForceDensity * dx3;</div>
<div class="line"><span class="lineno"> 1536</span>                    grain.Torque += locR.cross(DragForceDensity) * dx3;</div>
<div class="line"><span class="lineno"> 1537</span>                }</div>
<div class="line"><span class="lineno"> 1538</span>            }</div>
<div class="line"><span class="lineno"> 1539</span>        }</div>
<div class="line"><span class="lineno"> 1540</span>    }</div>
<div class="line"><span class="lineno"> 1541</span>}</div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a79b3ebcd11696e18f2db1079356829e3"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a79b3ebcd11696e18f2db1079356829e3">openphase::FlowSolverLBM::nu</a></div><div class="ttdeci">std::vector&lt; double &gt; nu</div><div class="ttdoc">Kinematic viscosity [m^2/s].</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00249">FlowSolverLBM.h:249</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a90657b1ab921a0b66ebe8201a939dddf"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a90657b1ab921a0b66ebe8201a939dddf">openphase::FlowSolverLBM::SolidFraction</a></div><div class="ttdeci">double SolidFraction(const int i, const int j, const int k, const PhaseField &amp;Phase) const</div><div class="ttdoc">Returns if solid fraction at (i,j,k)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02088">FlowSolverLBM.cpp:2088</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_ad61619206ef9c5955004f3ff0186687a"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad61619206ef9c5955004f3ff0186687a">openphase::FlowSolverLBM::h_star</a></div><div class="ttdeci">double h_star</div><div class="ttdoc">dimensionless drag force parameter</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00212">FlowSolverLBM.h:212</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1b4be0ef726f5618713559356e9906f1" name="a1b4be0ef726f5618713559356e9906f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b4be0ef726f5618713559356e9906f1">&#9670;&#160;</a></span>CalculateForceGravity() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::CalculateForceGravity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Force contribution of Gravitation. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00848">848</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  849</span>{</div>
<div class="line"><span class="lineno">  850</span>    <span class="comment">// Calculate gravity on solid bodies</span></div>
<div class="line"><span class="lineno">  851</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> idx = 0; idx &lt; <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties.size(); idx++)</div>
<div class="line"><span class="lineno">  852</span>    <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[idx].State == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a545a7e1c8dca42c00f8f139a1913c61cae41480b6bbfbf7407974a88d3d34f4fa">AggregateStates::Solid</a> and</div>
<div class="line"><span class="lineno">  853</span>        <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[idx].Mobile)</div>
<div class="line"><span class="lineno">  854</span>    {</div>
<div class="line"><span class="lineno">  855</span>        <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[idx].Acm += <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0041741e7a61b58755ac052871ccc47a">GA</a>;</div>
<div class="line"><span class="lineno">  856</span>    }</div>
<div class="line"><span class="lineno">  857</span> </div>
<div class="line"><span class="lineno">  858</span>    <span class="comment">// Calculate gravity on fluid nodes</span></div>
<div class="line"><span class="lineno">  859</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>,0,)</div>
<div class="line"><span class="lineno">  860</span>    if (not <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k))</div>
<div class="line"><span class="lineno">  861</span>    for (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno">  862</span>    {</div>
<div class="line"><span class="lineno">  863</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>(i,j,k,{n}) += <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0041741e7a61b58755ac052871ccc47a">GA</a> * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n});</div>
<div class="line"><span class="lineno">  864</span>    }</div>
<div class="line"><span class="lineno">  865</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  866</span>}</div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a0041741e7a61b58755ac052871ccc47a"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0041741e7a61b58755ac052871ccc47a">openphase::FlowSolverLBM::GA</a></div><div class="ttdeci">dVector3 GA</div><div class="ttdoc">Gravity acceleration in true units [m/s^2].</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00209">FlowSolverLBM.h:209</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5d8606713546bacf639e3b0d5f05e7b0" name="a5d8606713546bacf639e3b0d5f05e7b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d8606713546bacf639e3b0d5f05e7b0">&#9670;&#160;</a></span>CalculateForceGravity() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::CalculateForceGravity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d8/da6/classopenphase_1_1Composition.html">Composition</a> &amp;&#160;</td>
          <td class="paramname"><em>Cx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Force contribution of Gravitation considering liquid composition. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00868">868</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  870</span>{</div>
<div class="line"><span class="lineno">  871</span> </div>
<div class="line"><span class="lineno">  872</span>    <span class="comment">// Calculate force correction arising form compositional dependent density.</span></div>
<div class="line"><span class="lineno">  873</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>,0,)</div>
<div class="line"><span class="lineno">  874</span>    for(auto it = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).cbegin(); it != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).cend(); it++)</div>
<div class="line"><span class="lineno">  875</span>    {</div>
<div class="line"><span class="lineno">  876</span>        <span class="keywordtype">double</span> locDeltaDensity = 0.0;</div>
<div class="line"><span class="lineno">  877</span>        <span class="keyword">const</span> Grain&amp; grain = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[it-&gt;index];</div>
<div class="line"><span class="lineno">  878</span>        <span class="keywordflow">if</span>(grain.State == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a545a7e1c8dca42c00f8f139a1913c61ca5635bf596d97c1c2e7afe481ed060774">AggregateStates::Liquid</a>)</div>
<div class="line"><span class="lineno">  879</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno">  880</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> Comp = 0; Comp &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3682fba50989e5b7ab0df48763a889d3">Ncomp</a>; ++Comp)</div>
<div class="line"><span class="lineno">  881</span>        {</div>
<div class="line"><span class="lineno">  882</span>            locDeltaDensity += <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#addfc8e9e14301fe577dac27985c8e294">dDensity_dc</a>[Comp] * (Cx.MoleFractions(i,j,k,{grain.Phase, Comp}) - Cx.Initial({grain.Phase, Comp}));</div>
<div class="line"><span class="lineno">  883</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>(i,j,k,{n}) += <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0041741e7a61b58755ac052871ccc47a">GA</a> * locDeltaDensity;</div>
<div class="line"><span class="lineno">  884</span>        }</div>
<div class="line"><span class="lineno">  885</span>    }</div>
<div class="line"><span class="lineno">  886</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  887</span>}</div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a3682fba50989e5b7ab0df48763a889d3"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3682fba50989e5b7ab0df48763a889d3">openphase::FlowSolverLBM::Ncomp</a></div><div class="ttdeci">size_t Ncomp</div><div class="ttdoc">Number of chemical components.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00226">FlowSolverLBM.h:226</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_addfc8e9e14301fe577dac27985c8e294"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#addfc8e9e14301fe577dac27985c8e294">openphase::FlowSolverLBM::dDensity_dc</a></div><div class="ttdeci">std::vector&lt; double &gt; dDensity_dc</div><div class="ttdoc">Density change according to the change of concentration [Kg/(mol/mol)].</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00241">FlowSolverLBM.h:241</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_a545a7e1c8dca42c00f8f139a1913c61ca5635bf596d97c1c2e7afe481ed060774"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a545a7e1c8dca42c00f8f139a1913c61ca5635bf596d97c1c2e7afe481ed060774">openphase::AggregateStates::Liquid</a></div><div class="ttdeci">@ Liquid</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1147e2da1b27379c3eb33439d4e1d21d" name="a1147e2da1b27379c3eb33439d4e1d21d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1147e2da1b27379c3eb33439d4e1d21d">&#9670;&#160;</a></span>CalculateForceTwoPhase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::CalculateForceTwoPhase </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Force contribution according to Benzi. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00710">710</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  712</span>{</div>
<div class="line"><span class="lineno">  713</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ii = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ++ii)</div>
<div class="line"><span class="lineno">  714</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; ++jj)</div>
<div class="line"><span class="lineno">  715</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; ++kk)</div>
<div class="line"><span class="lineno">  716</span>    {</div>
<div class="line"><span class="lineno">  717</span>        <span class="keyword">const</span> dVector3 vel {ii*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>,jj*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>,kk*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>};</div>
<div class="line"><span class="lineno">  718</span> </div>
<div class="line"><span class="lineno">  719</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno">  720</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> m = 0; m &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++m)</div>
<div class="line"><span class="lineno">  721</span>        {</div>
<div class="line"><span class="lineno">  722</span>            <span class="keywordtype">double</span> tmp = 0.0;</div>
<div class="line"><span class="lineno">  723</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab45097494cc01fa93c7420778061d7ed">Do_Benzi</a>)</div>
<div class="line"><span class="lineno">  724</span>            {</div>
<div class="line"><span class="lineno">  725</span>                <span class="comment">// Benzi et. al. (2006) - Mesoscopic modeling of a two-phase flow</span></div>
<div class="line"><span class="lineno">  726</span>                <span class="comment">// in the presence of boundaries</span></div>
<div class="line"><span class="lineno">  727</span>                tmp = - <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a587965ea13dcb7fddac42b87da1df7cf">Gb</a>[n][m]/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a> * <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n}), <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7cd6cc5ca27add2432f5809f9d45ca03">rho_0</a>[n]) * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92539bf6d5ed043520c0bdbc47c334a9">lbWeights</a>[ii+1][jj+1][kk+1] * <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i+ii,j+jj,k+kk,{m}), <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7cd6cc5ca27add2432f5809f9d45ca03">rho_0</a>[m]);</div>
<div class="line"><span class="lineno">  728</span>            }</div>
<div class="line"><span class="lineno">  729</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae9bc290fd900003e6984f319eb544269">Do_Kupershtokh</a>)</div>
<div class="line"><span class="lineno">  730</span>            {</div>
<div class="line"><span class="lineno">  731</span>                <span class="comment">// Calculate phase sepration force according to:</span></div>
<div class="line"><span class="lineno">  732</span>                <span class="comment">// Kupershtokh, Medvedev and Karpov, 2009, On equations of state in a lattice Boltzmann method</span></div>
<div class="line"><span class="lineno">  733</span>                <span class="comment">// Kupershtokh, Medvedev and Gribanov, 2017, Thermal lattice Boltzmann method for multiphase flows</span></div>
<div class="line"><span class="lineno">  734</span> </div>
<div class="line"><span class="lineno">  735</span>                <span class="comment">// Evaluate equation of state (Van der Waals)</span></div>
<div class="line"><span class="lineno">  736</span>                <span class="keyword">const</span> <span class="keywordtype">double</span> p_000 = <a class="code hl_function" href="../../dc/dbb/structopenphase_1_1VanDerWaalsGas.html#a45f34eb35b2caf8f326acab3453ac5df">VanDerWaalsGas::ReducedPressure</a>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i   ,j   ,k   ,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a135999305b00dce046d03db79817e69e">lbTemperature</a>[n], <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a66544929ec9e15f973b2d349787a5993">CriticalDensity</a>[n]/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a405aa37be090a3d967abab6df1f941ba">lbCriticalTemperature</a>[n]);</div>
<div class="line"><span class="lineno">  737</span>                <span class="keyword">const</span> <span class="keywordtype">double</span> p_ijk = <a class="code hl_function" href="../../dc/dbb/structopenphase_1_1VanDerWaalsGas.html#a45f34eb35b2caf8f326acab3453ac5df">VanDerWaalsGas::ReducedPressure</a>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i+ii,j+jj,k+kk,{m})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a135999305b00dce046d03db79817e69e">lbTemperature</a>[m], <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a66544929ec9e15f973b2d349787a5993">CriticalDensity</a>[m]/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a405aa37be090a3d967abab6df1f941ba">lbCriticalTemperature</a>[m]);</div>
<div class="line"><span class="lineno">  738</span> </div>
<div class="line"><span class="lineno">  739</span>                <span class="comment">// Calculate interaction potential</span></div>
<div class="line"><span class="lineno">  740</span>                <span class="keyword">const</span> <span class="keywordtype">double</span> Phi_000 = <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a44913b19d54d780a4b9e00fcab11cbb6">Phi</a>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,   j,   k   ,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>, p_000, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a11c6271193ddf1f694f1bfc4227bf617">GasParameter</a>[n]);</div>
<div class="line"><span class="lineno">  741</span>                <span class="keyword">const</span> <span class="keywordtype">double</span> Phi_ijk = <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a44913b19d54d780a4b9e00fcab11cbb6">Phi</a>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i+ii,j+jj,k+kk,{m})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>, p_ijk, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a11c6271193ddf1f694f1bfc4227bf617">GasParameter</a>[m]);</div>
<div class="line"><span class="lineno">  742</span> </div>
<div class="line"><span class="lineno">  743</span>                <span class="comment">// Interpolate between both way</span></div>
<div class="line"><span class="lineno">  744</span>                tmp = 6.0*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92539bf6d5ed043520c0bdbc47c334a9">lbWeights</a>[ii+1][jj+1][kk+1]*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0d614141e8c6298e8b39f8b7d67fe8da">lbGK</a>[n][m]*(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aaa6a4778188230a23cbbf10d21a33219">ParaKuper</a>*(Phi_ijk*Phi_ijk) + (1.0-2.0*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aaa6a4778188230a23cbbf10d21a33219">ParaKuper</a>)*(Phi_000*Phi_ijk));</div>
<div class="line"><span class="lineno">  745</span>            }</div>
<div class="line"><span class="lineno">  746</span> </div>
<div class="line"><span class="lineno">  747</span>            <span class="keyword">const</span> dVector3 BenziForceDensity = {tmp*ii*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3b6d8de9f278b56d9346a2adb823a4e2">df</a>, tmp*jj*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3b6d8de9f278b56d9346a2adb823a4e2">df</a>, tmp*kk*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3b6d8de9f278b56d9346a2adb823a4e2">df</a>};</div>
<div class="line"><span class="lineno">  748</span> </div>
<div class="line"><span class="lineno">  749</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>(i,j,k,{n}) += BenziForceDensity;</div>
<div class="line"><span class="lineno">  750</span> </div>
<div class="line"><span class="lineno">  751</span>            <span class="keywordflow">if</span> (!<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k) &amp;&amp; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i+ii,j+jj,k+kk))</div>
<div class="line"><span class="lineno">  752</span>            <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; it : <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i+ii,j+jj,k+kk))</div>
<div class="line"><span class="lineno">  753</span>            {</div>
<div class="line"><span class="lineno">  754</span>                Grain&amp; grain = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[it.index];</div>
<div class="line"><span class="lineno">  755</span>                <span class="keywordflow">if</span>(grain.State == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a545a7e1c8dca42c00f8f139a1913c61cae41480b6bbfbf7407974a88d3d34f4fa">AggregateStates::Solid</a>)</div>
<div class="line"><span class="lineno">  756</span>                {</div>
<div class="line"><span class="lineno">  757</span>                    <span class="keyword">const</span> dVector3 pos = {double(i+ii), double(j+jj), double(k+kk)};</div>
<div class="line"><span class="lineno">  758</span>                    dVector3 distanceCM;</div>
<div class="line"><span class="lineno">  759</span>                    <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a8c0f8b77e0d42687ea8c78fb3f9b6d88">CalculateDistancePeriodic</a>(pos, grain.Rcm, distanceCM, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>);</div>
<div class="line"><span class="lineno">  760</span>                    <span class="keyword">const</span> dVector3 R = distanceCM * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>;</div>
<div class="line"><span class="lineno">  761</span> </div>
<div class="line"><span class="lineno">  762</span><span class="preprocessor">                    #ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  763</span><span class="preprocessor">                    #pragma omp critical</span></div>
<div class="line"><span class="lineno">  764</span><span class="preprocessor">                    #endif</span></div>
<div class="line"><span class="lineno">  765</span>                    {</div>
<div class="line"><span class="lineno">  766</span>                        grain.Force  -= BenziForceDensity * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_function" href="../../dc/d18/classopenphase_1_1GridParameters.html#a9e96c156b3c12ba0bb402d5188dbf1c6">CellVolume</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  767</span>                        grain.Torque -= R.cross(BenziForceDensity) * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_function" href="../../dc/d18/classopenphase_1_1GridParameters.html#a9e96c156b3c12ba0bb402d5188dbf1c6">CellVolume</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  768</span>                    }</div>
<div class="line"><span class="lineno">  769</span>                }</div>
<div class="line"><span class="lineno">  770</span>            }</div>
<div class="line"><span class="lineno">  771</span>        }</div>
<div class="line"><span class="lineno">  772</span>    }</div>
<div class="line"><span class="lineno">  773</span>}</div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a0d614141e8c6298e8b39f8b7d67fe8da"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0d614141e8c6298e8b39f8b7d67fe8da">openphase::FlowSolverLBM::lbGK</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; lbGK</div><div class="ttdoc">Parameter for Kupershtohk.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00256">FlowSolverLBM.h:256</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a11c6271193ddf1f694f1bfc4227bf617"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a11c6271193ddf1f694f1bfc4227bf617">openphase::FlowSolverLBM::GasParameter</a></div><div class="ttdeci">std::vector&lt; double &gt; GasParameter</div><div class="ttdoc">Gas parameter for Kupersthok (interface width)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00238">FlowSolverLBM.h:238</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a135999305b00dce046d03db79817e69e"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a135999305b00dce046d03db79817e69e">openphase::FlowSolverLBM::lbTemperature</a></div><div class="ttdeci">std::vector&lt; double &gt; lbTemperature</div><div class="ttdoc">Temperature (Two phase flow)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00247">FlowSolverLBM.h:247</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a405aa37be090a3d967abab6df1f941ba"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a405aa37be090a3d967abab6df1f941ba">openphase::FlowSolverLBM::lbCriticalTemperature</a></div><div class="ttdeci">std::vector&lt; double &gt; lbCriticalTemperature</div><div class="ttdoc">Critical temperature of phase separation (Two phase flow)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00244">FlowSolverLBM.h:244</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a587965ea13dcb7fddac42b87da1df7cf"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a587965ea13dcb7fddac42b87da1df7cf">openphase::FlowSolverLBM::Gb</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; Gb</div><div class="ttdoc">Parameter for Benzi-force [Kg/(m^3)].</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00254">FlowSolverLBM.h:254</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a66544929ec9e15f973b2d349787a5993"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a66544929ec9e15f973b2d349787a5993">openphase::FlowSolverLBM::CriticalDensity</a></div><div class="ttdeci">std::vector&lt; double &gt; CriticalDensity</div><div class="ttdoc">Critical density of phase separation (Two phase flow)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00242">FlowSolverLBM.h:242</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a7cd6cc5ca27add2432f5809f9d45ca03"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7cd6cc5ca27add2432f5809f9d45ca03">openphase::FlowSolverLBM::rho_0</a></div><div class="ttdeci">std::vector&lt; double &gt; rho_0</div><div class="ttdoc">Reference density (Parameter for Benzi) [Kg/m^3].</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00250">FlowSolverLBM.h:250</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_aaa6a4778188230a23cbbf10d21a33219"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aaa6a4778188230a23cbbf10d21a33219">openphase::FlowSolverLBM::ParaKuper</a></div><div class="ttdeci">double ParaKuper</div><div class="ttdoc">Kupershtokh parameter (to tune numerical accuracy!)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00211">FlowSolverLBM.h:211</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_ab45097494cc01fa93c7420778061d7ed"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab45097494cc01fa93c7420778061d7ed">openphase::FlowSolverLBM::Do_Benzi</a></div><div class="ttdeci">bool Do_Benzi</div><div class="ttdoc">Set to &quot;true&quot; if Benzi force should be calculated.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00182">FlowSolverLBM.h:182</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_ae9bc290fd900003e6984f319eb544269"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae9bc290fd900003e6984f319eb544269">openphase::FlowSolverLBM::Do_Kupershtokh</a></div><div class="ttdeci">bool Do_Kupershtokh</div><div class="ttdoc">Set to &quot;true&quot; if Kupershtokh's method for two phase fluid flow should be used.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00190">FlowSolverLBM.h:190</a></div></div>
<div class="ttc" id="astructopenphase_1_1VanDerWaalsGas_html_a45f34eb35b2caf8f326acab3453ac5df"><div class="ttname"><a href="../../dc/dbb/structopenphase_1_1VanDerWaalsGas.html#a45f34eb35b2caf8f326acab3453ac5df">openphase::VanDerWaalsGas::ReducedPressure</a></div><div class="ttdeci">static double ReducedPressure(const double Density, const double Temperature, const double CriticalDensity=1.0, const double CriticalTemperature=1.0)</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d3b/VanDerWaalsGas_8h_source.html#l00044">VanDerWaalsGas.h:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7862b78a602256015591ce53119331aa" name="a7862b78a602256015591ce53119331aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7862b78a602256015591ce53119331aa">&#9670;&#160;</a></span>CalculateHydrodynamicPressureAndMomentum()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::CalculateHydrodynamicPressureAndMomentum </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;&#160;</td>
          <td class="paramname"><em>Vel</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l01038">1038</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1039</span>{</div>
<div class="line"><span class="lineno"> 1040</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>,0,)</div>
<div class="line"><span class="lineno"> 1041</span>    if(!<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k))</div>
<div class="line"><span class="lineno"> 1042</span>    for (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 1043</span>    {</div>
<div class="line"><span class="lineno"> 1044</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afa690789441704b411b9252d930c2363">HydroPressure</a>(i,j,k,{n}) = 0.0;</div>
<div class="line"><span class="lineno"> 1045</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a>(i,j,k,{n}).set_to_zero();</div>
<div class="line"><span class="lineno"> 1046</span> </div>
<div class="line"><span class="lineno"> 1047</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ++ii)</div>
<div class="line"><span class="lineno"> 1048</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; ++jj)</div>
<div class="line"><span class="lineno"> 1049</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; ++kk)</div>
<div class="line"><span class="lineno"> 1050</span>        {</div>
<div class="line"><span class="lineno"> 1051</span>            <span class="keywordtype">double</span> rr = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n})(ii,jj,kk);</div>
<div class="line"><span class="lineno"> 1052</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afa690789441704b411b9252d930c2363">HydroPressure</a>  (i,j,k,{n})    += rr*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a83cd87469986a195f9a42c9fbff2f523">dP</a>;</div>
<div class="line"><span class="lineno"> 1053</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a>(i,j,k,{n})[0] += rr*ii;</div>
<div class="line"><span class="lineno"> 1054</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a>(i,j,k,{n})[1] += rr*jj;</div>
<div class="line"><span class="lineno"> 1055</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a>(i,j,k,{n})[2] += rr*kk;</div>
<div class="line"><span class="lineno"> 1056</span>        }</div>
<div class="line"><span class="lineno"> 1057</span>        </div>
<div class="line"><span class="lineno"> 1058</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a>(i,j,k,{n}) = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5284a4950dae747d84ce23d74fd5963e">cs2</a>*pow(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>,3)/pow(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>,3) + <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>(i,j,k,{n})*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/2.0;</div>
<div class="line"><span class="lineno"> 1059</span>        dVector3 vel = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a>(i,j,k,{n}) /<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n});</div>
<div class="line"><span class="lineno"> 1060</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afa690789441704b411b9252d930c2363">HydroPressure</a> (i,j,k,{n}) +=  <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5284a4950dae747d84ce23d74fd5963e">cs2</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/2.0 * ( (vel[0]*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2357615d61b1d4d4bb027c1dfa67260c">GradRho</a>(i,j,k,{n})[0] + vel[1]*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2357615d61b1d4d4bb027c1dfa67260c">GradRho</a>(i,j,k,{n})[1] + vel[2]*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2357615d61b1d4d4bb027c1dfa67260c">GradRho</a>(i,j,k,{n})[2]) + <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n}) * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2b6d93798b295d1969521ba48bdc9af1">DivVel</a>(i,j,k,{n}));</div>
<div class="line"><span class="lineno"> 1061</span>    }</div>
<div class="line"><span class="lineno"> 1062</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1063</span>}</div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a2b6d93798b295d1969521ba48bdc9af1"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2b6d93798b295d1969521ba48bdc9af1">openphase::FlowSolverLBM::DivVel</a></div><div class="ttdeci">Storage3D&lt; double, 1 &gt; DivVel</div><div class="ttdoc">Divergence of velocity when thermal compressibility considered.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00179">FlowSolverLBM.h:179</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a5284a4950dae747d84ce23d74fd5963e"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5284a4950dae747d84ce23d74fd5963e">openphase::FlowSolverLBM::cs2</a></div><div class="ttdeci">double cs2</div><div class="ttdoc">Speed of sound squared [m/s].</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00235">FlowSolverLBM.h:235</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a83cd87469986a195f9a42c9fbff2f523"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a83cd87469986a195f9a42c9fbff2f523">openphase::FlowSolverLBM::dP</a></div><div class="ttdeci">double dP</div><div class="ttdoc">Coefficient to calculate physical pressure from lattice pressure [Pa].</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00215">FlowSolverLBM.h:215</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_afa690789441704b411b9252d930c2363"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afa690789441704b411b9252d930c2363">openphase::FlowSolverLBM::HydroPressure</a></div><div class="ttdeci">Storage3D&lt; double, 1 &gt; HydroPressure</div><div class="ttdoc">Hydrolic Pressure for each lattice when thermal compressibility considered.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00178">FlowSolverLBM.h:178</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4268e5da472b3b485593472b9cb2111f" name="a4268e5da472b3b485593472b9cb2111f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4268e5da472b3b485593472b9cb2111f">&#9670;&#160;</a></span>CalculateIdealGasDensity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::CalculateIdealGasDensity </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00916">916</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  917</span>{</div>
<div class="line"><span class="lineno">  918</span>    <span class="keywordtype">double</span> rho= p/(Rm * Temp);</div>
<div class="line"><span class="lineno">  919</span>    <span class="keywordflow">return</span> rho;</div>
<div class="line"><span class="lineno">  920</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4419d54f170e56c84e5c358f1b9c0034" name="a4419d54f170e56c84e5c358f1b9c0034"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4419d54f170e56c84e5c358f1b9c0034">&#9670;&#160;</a></span>CalculateLiquidMass()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::CalculateLiquidMass </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>Fluid_Comp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates mass of liquid phase. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02724">2724</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2725</span>{</div>
<div class="line"><span class="lineno"> 2726</span>    <span class="keywordtype">double</span> MassLiquid = 0.0;</div>
<div class="line"><span class="lineno"> 2727</span> </div>
<div class="line"><span class="lineno"> 2728</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i, j, k, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>, 0, reduction(+:MassLiquid))</div>
<div class="line"><span class="lineno"> 2729</span>    if (not <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k))</div>
<div class="line"><span class="lineno"> 2730</span>    {</div>
<div class="line"><span class="lineno"> 2731</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> DistLiquid = abs(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{Fluid_Comp}) - <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa6aa8fda060bc8571b4b0a95464abd04">LiquidDensity</a>[Fluid_Comp]);</div>
<div class="line"><span class="lineno"> 2732</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> DistVapor  = abs(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{Fluid_Comp}) - <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a6720e11af1b05213fbba7af7e7047848">VaporDensity</a> [Fluid_Comp]);</div>
<div class="line"><span class="lineno"> 2733</span> </div>
<div class="line"><span class="lineno"> 2734</span>        <span class="keywordflow">if</span> (DistLiquid &lt; DistVapor)</div>
<div class="line"><span class="lineno"> 2735</span>        {</div>
<div class="line"><span class="lineno"> 2736</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii++)</div>
<div class="line"><span class="lineno"> 2737</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj++)</div>
<div class="line"><span class="lineno"> 2738</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk++)</div>
<div class="line"><span class="lineno"> 2739</span>            {</div>
<div class="line"><span class="lineno"> 2740</span>                MassLiquid += <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{Fluid_Comp})(ii,jj,kk);</div>
<div class="line"><span class="lineno"> 2741</span>            }</div>
<div class="line"><span class="lineno"> 2742</span>        }</div>
<div class="line"><span class="lineno"> 2743</span>    }</div>
<div class="line"><span class="lineno"> 2744</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 2745</span> </div>
<div class="line"><span class="lineno"> 2746</span><span class="preprocessor">    #ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 2747</span>    <span class="keyword">auto</span> tmp = MassLiquid;</div>
<div class="line"><span class="lineno"> 2748</span>    OP_MPI_Allreduce(&amp;tmp, &amp;(MassLiquid), 1, OP_MPI_DOUBLE, OP_MPI_SUM, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 2749</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno"> 2750</span> </div>
<div class="line"><span class="lineno"> 2751</span>    MassLiquid *= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_function" href="../../dc/d18/classopenphase_1_1GridParameters.html#a9e96c156b3c12ba0bb402d5188dbf1c6">CellVolume</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2752</span>    <span class="keywordflow">return</span> MassLiquid;</div>
<div class="line"><span class="lineno"> 2753</span>}</div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_aa6aa8fda060bc8571b4b0a95464abd04"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa6aa8fda060bc8571b4b0a95464abd04">openphase::FlowSolverLBM::LiquidDensity</a></div><div class="ttdeci">std::vector&lt; double &gt; LiquidDensity</div><div class="ttdoc">Equilibrium density of the liquid phase.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00246">FlowSolverLBM.h:246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abb24f230254d7c0ef8352b818dd9b848" name="abb24f230254d7c0ef8352b818dd9b848"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb24f230254d7c0ef8352b818dd9b848">&#9670;&#160;</a></span>CalculateLiquidVolume()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::CalculateLiquidVolume </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>Fluid_Comp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates volume of liquid phase. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02700">2700</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2701</span>{</div>
<div class="line"><span class="lineno"> 2702</span>    <span class="keywordtype">double</span> VolumeLiquid = 0.0;</div>
<div class="line"><span class="lineno"> 2703</span> </div>
<div class="line"><span class="lineno"> 2704</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i, j, k, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>, 0, reduction(+:VolumeLiquid))</div>
<div class="line"><span class="lineno"> 2705</span>    if (not <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k))</div>
<div class="line"><span class="lineno"> 2706</span>    {</div>
<div class="line"><span class="lineno"> 2707</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> DistLiquid = abs(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{Fluid_Comp}) - <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa6aa8fda060bc8571b4b0a95464abd04">LiquidDensity</a>[Fluid_Comp]);</div>
<div class="line"><span class="lineno"> 2708</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> DistVapor  = abs(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{Fluid_Comp}) - <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a6720e11af1b05213fbba7af7e7047848">VaporDensity</a> [Fluid_Comp]);</div>
<div class="line"><span class="lineno"> 2709</span> </div>
<div class="line"><span class="lineno"> 2710</span>        <span class="keywordflow">if</span> (DistLiquid &lt; DistVapor) VolumeLiquid += 1.0;</div>
<div class="line"><span class="lineno"> 2711</span>    }</div>
<div class="line"><span class="lineno"> 2712</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 2713</span> </div>
<div class="line"><span class="lineno"> 2714</span><span class="preprocessor">    #ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 2715</span>    <span class="keyword">auto</span> tmp = VolumeLiquid;</div>
<div class="line"><span class="lineno"> 2716</span>    OP_MPI_Allreduce(&amp;tmp, &amp;(VolumeLiquid), 1, OP_MPI_DOUBLE, OP_MPI_SUM, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 2717</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno"> 2718</span> </div>
<div class="line"><span class="lineno"> 2719</span>    VolumeLiquid *= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_function" href="../../dc/d18/classopenphase_1_1GridParameters.html#a9e96c156b3c12ba0bb402d5188dbf1c6">CellVolume</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2720</span> </div>
<div class="line"><span class="lineno"> 2721</span>    <span class="keywordflow">return</span> VolumeLiquid;</div>
<div class="line"><span class="lineno"> 2722</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="acc7171d532ae567e7d10d3cab5397cab" name="acc7171d532ae567e7d10d3cab5397cab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc7171d532ae567e7d10d3cab5397cab">&#9670;&#160;</a></span>CalculateLocalIncomingSolidDensityChange()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::CalculateLocalIncomingSolidDensityChange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00775">775</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  776</span>{</div>
<div class="line"><span class="lineno">  777</span>    <span class="keywordtype">double</span> locIncomingDensityChange = 0.0;</div>
<div class="line"><span class="lineno">  778</span>    NodeA&lt;double&gt; locPhiDot = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Dot(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>);</div>
<div class="line"><span class="lineno">  779</span>    <span class="keywordflow">for</span>(<span class="keyword">auto</span> alpha = locPhiDot.cbegin(); alpha &lt; locPhiDot.cend(); ++alpha)</div>
<div class="line"><span class="lineno">  780</span>    {</div>
<div class="line"><span class="lineno">  781</span>        <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[alpha-&gt;index].State  == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a545a7e1c8dca42c00f8f139a1913c61cae41480b6bbfbf7407974a88d3d34f4fa">AggregateStates::Solid</a>)</div>
<div class="line"><span class="lineno">  782</span>        {</div>
<div class="line"><span class="lineno">  783</span>            locIncomingDensityChange += alpha-&gt;value*<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[alpha-&gt;index].Density*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>;</div>
<div class="line"><span class="lineno">  784</span>        }</div>
<div class="line"><span class="lineno">  785</span>    }</div>
<div class="line"><span class="lineno">  786</span> </div>
<div class="line"><span class="lineno">  787</span>    <span class="keywordflow">return</span> locIncomingDensityChange;</div>
<div class="line"><span class="lineno">  788</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa3e30eed17ce084572cf7aec2070c084" name="aa3e30eed17ce084572cf7aec2070c084"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3e30eed17ce084572cf7aec2070c084">&#9670;&#160;</a></span>CalculateSutherlandViscosity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::CalculateSutherlandViscosity </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00908">908</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  909</span>{</div>
<div class="line"><span class="lineno">  910</span>    <span class="keywordtype">double</span> Ts=273.0;</div>
<div class="line"><span class="lineno">  911</span>    <span class="keywordtype">double</span> mus=1.68e-05; <span class="comment">//it&#39;s for air</span></div>
<div class="line"><span class="lineno">  912</span>    <span class="keywordtype">double</span> S=110.5;</div>
<div class="line"><span class="lineno">  913</span>    <span class="keywordtype">double</span> mu=mus*(Temp/Ts)*sqrt(Temp/Ts)*(Ts+S)/(Temp+S);</div>
<div class="line"><span class="lineno">  914</span>    <span class="keywordflow">return</span> mu;</div>
<div class="line"><span class="lineno">  915</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af659ba6c265813f90f7f1d6cc93ce81d" name="af659ba6c265813f90f7f1d6cc93ce81d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af659ba6c265813f90f7f1d6cc93ce81d">&#9670;&#160;</a></span>CalculateVapordMass()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::CalculateVapordMass </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>Fluid_Comp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates mass of vapor phase. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02778">2778</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2779</span>{</div>
<div class="line"><span class="lineno"> 2780</span>    <span class="keywordtype">double</span> MassVapor = 0.0;</div>
<div class="line"><span class="lineno"> 2781</span> </div>
<div class="line"><span class="lineno"> 2782</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i, j, k, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>, 0, reduction(+:MassVapor))</div>
<div class="line"><span class="lineno"> 2783</span>    if (not <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k))</div>
<div class="line"><span class="lineno"> 2784</span>    {</div>
<div class="line"><span class="lineno"> 2785</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> DistLiquid = abs(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{Fluid_Comp}) - <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa6aa8fda060bc8571b4b0a95464abd04">LiquidDensity</a>[Fluid_Comp]);</div>
<div class="line"><span class="lineno"> 2786</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> DistVapor  = abs(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{Fluid_Comp}) - <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a6720e11af1b05213fbba7af7e7047848">VaporDensity</a> [Fluid_Comp]);</div>
<div class="line"><span class="lineno"> 2787</span> </div>
<div class="line"><span class="lineno"> 2788</span>        <span class="keywordflow">if</span> (DistLiquid &gt; DistVapor)</div>
<div class="line"><span class="lineno"> 2789</span>        {</div>
<div class="line"><span class="lineno"> 2790</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii++)</div>
<div class="line"><span class="lineno"> 2791</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj++)</div>
<div class="line"><span class="lineno"> 2792</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk++)</div>
<div class="line"><span class="lineno"> 2793</span>            {</div>
<div class="line"><span class="lineno"> 2794</span>                MassVapor += <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{Fluid_Comp})(ii,jj,kk);</div>
<div class="line"><span class="lineno"> 2795</span>            }</div>
<div class="line"><span class="lineno"> 2796</span>        }</div>
<div class="line"><span class="lineno"> 2797</span>    }</div>
<div class="line"><span class="lineno"> 2798</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 2799</span> </div>
<div class="line"><span class="lineno"> 2800</span><span class="preprocessor">    #ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 2801</span>    <span class="keyword">auto</span> tmp = MassVapor;</div>
<div class="line"><span class="lineno"> 2802</span>    OP_MPI_Allreduce(&amp;tmp, &amp;(MassVapor), 1, OP_MPI_DOUBLE, OP_MPI_SUM, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 2803</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno"> 2804</span> </div>
<div class="line"><span class="lineno"> 2805</span>    MassVapor *= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_function" href="../../dc/d18/classopenphase_1_1GridParameters.html#a9e96c156b3c12ba0bb402d5188dbf1c6">CellVolume</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2806</span>    <span class="keywordflow">return</span> MassVapor;</div>
<div class="line"><span class="lineno"> 2807</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9a562269673ef282d404657a4d98e491" name="a9a562269673ef282d404657a4d98e491"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a562269673ef282d404657a4d98e491">&#9670;&#160;</a></span>CalculateVaporVolume()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::CalculateVaporVolume </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>Fluid_Comp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates volume of vapor phase. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02755">2755</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2756</span>{</div>
<div class="line"><span class="lineno"> 2757</span>    <span class="keywordtype">double</span> VolumeVapor = 0.0;</div>
<div class="line"><span class="lineno"> 2758</span> </div>
<div class="line"><span class="lineno"> 2759</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i, j, k, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>, 0, reduction(+:VolumeVapor))</div>
<div class="line"><span class="lineno"> 2760</span>    if (not <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k))</div>
<div class="line"><span class="lineno"> 2761</span>    {</div>
<div class="line"><span class="lineno"> 2762</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> DistLiquid = abs(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{Fluid_Comp}) - <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa6aa8fda060bc8571b4b0a95464abd04">LiquidDensity</a>[Fluid_Comp]);</div>
<div class="line"><span class="lineno"> 2763</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> DistVapor  = abs(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{Fluid_Comp}) - <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a6720e11af1b05213fbba7af7e7047848">VaporDensity</a> [Fluid_Comp]);</div>
<div class="line"><span class="lineno"> 2764</span> </div>
<div class="line"><span class="lineno"> 2765</span>        <span class="keywordflow">if</span> (DistLiquid &gt; DistVapor) VolumeVapor += 1.0;</div>
<div class="line"><span class="lineno"> 2766</span>    }</div>
<div class="line"><span class="lineno"> 2767</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 2768</span> </div>
<div class="line"><span class="lineno"> 2769</span><span class="preprocessor">    #ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 2770</span>    <span class="keyword">auto</span> tmp = VolumeVapor;</div>
<div class="line"><span class="lineno"> 2771</span>    OP_MPI_Allreduce(&amp;tmp, &amp;(VolumeVapor), 1, OP_MPI_DOUBLE, OP_MPI_SUM, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 2772</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno"> 2773</span> </div>
<div class="line"><span class="lineno"> 2774</span>    VolumeVapor *= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_function" href="../../dc/d18/classopenphase_1_1GridParameters.html#a9e96c156b3c12ba0bb402d5188dbf1c6">CellVolume</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2775</span>    <span class="keywordflow">return</span> VolumeVapor;</div>
<div class="line"><span class="lineno"> 2776</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af3c9d0663c6ceed9329730b5e7035430" name="af3c9d0663c6ceed9329730b5e7035430"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3c9d0663c6ceed9329730b5e7035430">&#9670;&#160;</a></span>Collision()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::Collision </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Processes the collisions. Adjusts center of mass properties of colliding particles. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l01886">1886</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1887</span>{</div>
<div class="line"><span class="lineno"> 1888</span>    <span class="comment">// Apply body force</span></div>
<div class="line"><span class="lineno"> 1889</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab5ba4a4e507c7d80c6268bb41e4f3c2a">Do_GuoForcing</a>) <span class="comment">// Guo, Zheng, and, Shi, Phy. Rev. E (2002)</span></div>
<div class="line"><span class="lineno"> 1890</span>    {</div>
<div class="line"><span class="lineno"> 1891</span>        <span class="comment">// Apply body force with force projection method</span></div>
<div class="line"><span class="lineno"> 1892</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>,0,)</div>
<div class="line"><span class="lineno"> 1893</span>        if (!<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k))</div>
<div class="line"><span class="lineno"> 1894</span>        for (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 1895</span>        {</div>
<div class="line"><span class="lineno"> 1896</span>            <span class="keyword">const</span> dVector3 EqMomentum = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a>(i,j,k,{n}) + <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>(i,j,k,{n})*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/2;</div>
<div class="line"><span class="lineno"> 1897</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n}) += (<a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#acbf6f50e003944ed8daced249b20ee6e">EquilibriumDistribution</a>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92539bf6d5ed043520c0bdbc47c334a9">lbWeights</a>, EqMomentum/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0e7cad672eea608ab7c5ea5ed6946138">dm</a>) - <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n}))/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad8ae2a30dc85638b1a377cc2919200fe">lbtau</a>[n];</div>
<div class="line"><span class="lineno"> 1898</span>        }</div>
<div class="line"><span class="lineno"> 1899</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1900</span> </div>
<div class="line"><span class="lineno"> 1901</span>        <span class="comment">// Apply body force with force projection method</span></div>
<div class="line"><span class="lineno"> 1902</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>,0,)</div>
<div class="line"><span class="lineno"> 1903</span>        if (!<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k))</div>
<div class="line"><span class="lineno"> 1904</span>        for (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 1905</span>        {</div>
<div class="line"><span class="lineno"> 1906</span>            assert(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a> &gt; DBL_EPSILON);</div>
<div class="line"><span class="lineno"> 1907</span>            assert(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n}) &lt; DBL_MAX);</div>
<div class="line"><span class="lineno"> 1908</span> </div>
<div class="line"><span class="lineno"> 1909</span>            dVector3 lbVel;</div>
<div class="line"><span class="lineno"> 1910</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7c63a86b32c4126fb329829acf6af13c">Do_ThermalComp</a>)</div>
<div class="line"><span class="lineno"> 1911</span>            {</div>
<div class="line"><span class="lineno"> 1912</span>                lbVel = (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a>(i,j,k,{n}) * 3.0 + <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>(i,j,k,{n})*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/2)/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n})*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>;</div>
<div class="line"><span class="lineno"> 1913</span>            }</div>
<div class="line"><span class="lineno"> 1914</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1915</span>            {</div>
<div class="line"><span class="lineno"> 1916</span>                lbVel = (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a>(i,j,k,{n}) + <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>(i,j,k,{n})*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/2)/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n})*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>;</div>
<div class="line"><span class="lineno"> 1917</span>            }</div>
<div class="line"><span class="lineno"> 1918</span> </div>
<div class="line"><span class="lineno"> 1919</span>            D3Q27 lblocForcing;</div>
<div class="line"><span class="lineno"> 1920</span>            lblocForcing.set_to_zero();</div>
<div class="line"><span class="lineno"> 1921</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ii = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ++ii)</div>
<div class="line"><span class="lineno"> 1922</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; ++jj)</div>
<div class="line"><span class="lineno"> 1923</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; ++kk)</div>
<div class="line"><span class="lineno"> 1924</span>            {</div>
<div class="line"><span class="lineno"> 1925</span>                lblocForcing(ii,jj,kk) =</div>
<div class="line"><span class="lineno"> 1926</span>                    (1.0-0.5/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad8ae2a30dc85638b1a377cc2919200fe">lbtau</a>[n]) * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92539bf6d5ed043520c0bdbc47c334a9">lbWeights</a>[ii+1][jj+1][kk+1]*</div>
<div class="line"><span class="lineno"> 1927</span>                    (3.0*((ii-lbVel[0])*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>(i,j,k,{n})[0]/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3b6d8de9f278b56d9346a2adb823a4e2">df</a> +</div>
<div class="line"><span class="lineno"> 1928</span>                          (jj-lbVel[1])*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>(i,j,k,{n})[1]/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3b6d8de9f278b56d9346a2adb823a4e2">df</a> +</div>
<div class="line"><span class="lineno"> 1929</span>                          (kk-lbVel[2])*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>(i,j,k,{n})[2]/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3b6d8de9f278b56d9346a2adb823a4e2">df</a>) +</div>
<div class="line"><span class="lineno"> 1930</span>                     9.0*(lbVel[0]*ii + lbVel[1]*jj + lbVel[2]*kk)*</div>
<div class="line"><span class="lineno"> 1931</span>                     (ii*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>(i,j,k,{n})[0]/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3b6d8de9f278b56d9346a2adb823a4e2">df</a> +</div>
<div class="line"><span class="lineno"> 1932</span>                      jj*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>(i,j,k,{n})[1]/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3b6d8de9f278b56d9346a2adb823a4e2">df</a> +</div>
<div class="line"><span class="lineno"> 1933</span>                      kk*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>(i,j,k,{n})[2]/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3b6d8de9f278b56d9346a2adb823a4e2">df</a>));</div>
<div class="line"><span class="lineno"> 1934</span>            }</div>
<div class="line"><span class="lineno"> 1935</span> </div>
<div class="line"><span class="lineno"> 1936</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n}) += lblocForcing;</div>
<div class="line"><span class="lineno"> 1937</span>        }</div>
<div class="line"><span class="lineno"> 1938</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1939</span>    }</div>
<div class="line"><span class="lineno"> 1940</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a06f6913d390fd7e3e2174b6a82506b4b">Do_EDForcing</a>)</div>
<div class="line"><span class="lineno"> 1941</span>    {</div>
<div class="line"><span class="lineno"> 1942</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>,0,)</div>
<div class="line"><span class="lineno"> 1943</span>        if (!<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k))</div>
<div class="line"><span class="lineno"> 1944</span>        for (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 1945</span>        {</div>
<div class="line"><span class="lineno"> 1946</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> q = 1.0 - 1.0/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad8ae2a30dc85638b1a377cc2919200fe">lbtau</a>[n];</div>
<div class="line"><span class="lineno"> 1947</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n}) = (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n}) -</div>
<div class="line"><span class="lineno"> 1948</span>                                        <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#acbf6f50e003944ed8daced249b20ee6e">EquilibriumDistribution</a>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92539bf6d5ed043520c0bdbc47c334a9">lbWeights</a>,  <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0e7cad672eea608ab7c5ea5ed6946138">dm</a>))*q +</div>
<div class="line"><span class="lineno"> 1949</span>                                        <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#acbf6f50e003944ed8daced249b20ee6e">EquilibriumDistribution</a>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92539bf6d5ed043520c0bdbc47c334a9">lbWeights</a>, (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0e7cad672eea608ab7c5ea5ed6946138">dm</a> + <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3b6d8de9f278b56d9346a2adb823a4e2">df</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>));</div>
<div class="line"><span class="lineno"> 1950</span>        }</div>
<div class="line"><span class="lineno"> 1951</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1952</span>    }</div>
<div class="line"><span class="lineno"> 1953</span>}</div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a06f6913d390fd7e3e2174b6a82506b4b"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a06f6913d390fd7e3e2174b6a82506b4b">openphase::FlowSolverLBM::Do_EDForcing</a></div><div class="ttdeci">bool Do_EDForcing</div><div class="ttdoc">Set to &quot;true&quot; if exact difference method should be used to apply the calculated force.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00186">FlowSolverLBM.h:186</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a7c63a86b32c4126fb329829acf6af13c"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7c63a86b32c4126fb329829acf6af13c">openphase::FlowSolverLBM::Do_ThermalComp</a></div><div class="ttdeci">bool Do_ThermalComp</div><div class="ttdoc">Set to &quot;true&quot; if thermal compressibility considered.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00192">FlowSolverLBM.h:192</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_ab5ba4a4e507c7d80c6268bb41e4f3c2a"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab5ba4a4e507c7d80c6268bb41e4f3c2a">openphase::FlowSolverLBM::Do_GuoForcing</a></div><div class="ttdeci">bool Do_GuoForcing</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00189">FlowSolverLBM.h:189</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_ad8ae2a30dc85638b1a377cc2919200fe"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad8ae2a30dc85638b1a377cc2919200fe">openphase::FlowSolverLBM::lbtau</a></div><div class="ttdeci">std::vector&lt; double &gt; lbtau</div><div class="ttdoc">Relaxation time for BGK collision operator.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00251">FlowSolverLBM.h:251</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac3da233ff9f88648f2916c0520c0f89b" name="ac3da233ff9f88648f2916c0520c0f89b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3da233ff9f88648f2916c0520c0f89b">&#9670;&#160;</a></span>CollisionTC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::CollisionTC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;&#160;</td>
          <td class="paramname"><em>Vel</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l01065">1065</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1066</span>{</div>
<div class="line"><span class="lineno"> 1067</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>,0,)</div>
<div class="line"><span class="lineno"> 1068</span>    if (!<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k))</div>
<div class="line"><span class="lineno"> 1069</span>    for (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 1070</span>    {</div>
<div class="line"><span class="lineno"> 1071</span>        dVector3 lbvel      = Vel.Phase(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9c24d4bdb6833cf83827eb7ae9629f47">dv</a>;</div>
<div class="line"><span class="lineno"> 1072</span>        dVector3 lbFb       = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3b6d8de9f278b56d9346a2adb823a4e2">df</a>;</div>
<div class="line"><span class="lineno"> 1073</span>        dVector3 lbGradRho  = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2357615d61b1d4d4bb027c1dfa67260c">GradRho</a>(i,j,k,{n})*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>;</div>
<div class="line"><span class="lineno"> 1074</span>        <span class="keywordtype">double</span> lbu2         = lbvel[0]*lbvel[0]+lbvel[1]*lbvel[1]+lbvel[2]*lbvel[2];</div>
<div class="line"><span class="lineno"> 1075</span>        <span class="keywordtype">double</span> lbnu         = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a62faa8027eaa45caa436c65f032bc584">nut</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a74ae26b9feb1666e9c177e5e88558d8a">dnu</a>;</div>
<div class="line"><span class="lineno"> 1076</span>        <span class="keywordtype">double</span> lbrho        = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>;</div>
<div class="line"><span class="lineno"> 1077</span>        <span class="keywordtype">double</span> lbph         = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afa690789441704b411b9252d930c2363">HydroPressure</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a83cd87469986a195f9a42c9fbff2f523">dP</a>;</div>
<div class="line"><span class="lineno"> 1078</span>        <span class="keywordtype">double</span> lbDivVel     = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2b6d93798b295d1969521ba48bdc9af1">DivVel</a>(i,j,k,{n})*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>;</div>
<div class="line"><span class="lineno"> 1079</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad8ae2a30dc85638b1a377cc2919200fe">lbtau</a> [n]            = lbnu/<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a> + 0.5; </div>
<div class="line"><span class="lineno"> 1080</span>        <span class="keywordtype">double</span> factor       = (1.0-1.0/(2.0*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad8ae2a30dc85638b1a377cc2919200fe">lbtau</a>[n]));</div>
<div class="line"><span class="lineno"> 1081</span> </div>
<div class="line"><span class="lineno"> 1082</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ii = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii++)</div>
<div class="line"><span class="lineno"> 1083</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj++)</div>
<div class="line"><span class="lineno"> 1084</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk++)</div>
<div class="line"><span class="lineno"> 1085</span>        {</div>
<div class="line"><span class="lineno"> 1086</span>            <span class="keywordtype">double</span> <a class="code hl_variable" href="../../d6/d0a/tinyxml2_8cpp.html#ad3136d2f1f34e592c66e09ba8a852812">CR</a> = (ii-lbvel[0])*lbGradRho[0]+(jj-lbvel[1])*lbGradRho[1]+(kk-lbvel[2])*lbGradRho[2];</div>
<div class="line"><span class="lineno"> 1087</span>            <span class="keywordtype">double</span> CF = (ii-lbvel[0])*lbFb[0]+(jj-lbvel[1])*lbFb[1]+(kk-lbvel[2])*lbFb[2];</div>
<div class="line"><span class="lineno"> 1088</span>            <span class="keywordtype">double</span> lbw  = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92539bf6d5ed043520c0bdbc47c334a9">lbWeights</a>[ii+1][jj+1][kk+1];</div>
<div class="line"><span class="lineno"> 1089</span>            <span class="keywordtype">double</span> lbcu = ii*lbvel[0] + jj*lbvel[1] + kk*lbvel[2];</div>
<div class="line"><span class="lineno"> 1090</span>            <span class="keywordtype">double</span> Feq  = lbrho * lbw *(1.0 + lbcu/<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>- lbu2/(2.0*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>) + lbcu*lbcu/(2.0*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>) );</div>
<div class="line"><span class="lineno"> 1091</span>            <span class="keywordtype">double</span> geq  = Feq*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a> + (lbph - lbrho * <a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a> ) * lbw; </div>
<div class="line"><span class="lineno"> 1092</span> </div>
<div class="line"><span class="lineno"> 1093</span>            <span class="keywordtype">double</span> geqb = geq - 0.5 * (lbrho * <a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a> * lbw * lbDivVel * factor  + <a class="code hl_variable" href="../../d6/d0a/tinyxml2_8cpp.html#ad3136d2f1f34e592c66e09ba8a852812">CR</a>*(Feq/lbrho-lbw)*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>*factor + CF*Feq/lbrho);</div>
<div class="line"><span class="lineno"> 1094</span>            <span class="keywordtype">double</span> gb  = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n})(ii,jj,kk);</div>
<div class="line"><span class="lineno"> 1095</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n})(ii,jj,kk) = gb + 1.0/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad8ae2a30dc85638b1a377cc2919200fe">lbtau</a>[n] * (geqb - gb) + <a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a> * lbw * lbrho * lbDivVel * factor + <a class="code hl_variable" href="../../d6/d0a/tinyxml2_8cpp.html#ad3136d2f1f34e592c66e09ba8a852812">CR</a>*(Feq/lbrho-lbw)*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>*factor + CF*Feq/lbrho;</div>
<div class="line"><span class="lineno"> 1096</span>        }</div>
<div class="line"><span class="lineno"> 1097</span>    }</div>
<div class="line"><span class="lineno"> 1098</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1099</span>}</div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a74ae26b9feb1666e9c177e5e88558d8a"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a74ae26b9feb1666e9c177e5e88558d8a">openphase::FlowSolverLBM::dnu</a></div><div class="ttdeci">double dnu</div><div class="ttdoc">Coefficient to calculate physical kinematic viscosity from lattice kinematic viscosity [m^2/s].</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00218">FlowSolverLBM.h:218</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a9c24d4bdb6833cf83827eb7ae9629f47"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9c24d4bdb6833cf83827eb7ae9629f47">openphase::FlowSolverLBM::dv</a></div><div class="ttdeci">double dv</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00219">FlowSolverLBM.h:219</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_a9cd858076e6d2d99fbae21404b46703e"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">openphase::lbcs2</a></div><div class="ttdeci">constexpr double lbcs2</div><div class="ttdoc">Speed of sound squared [lattice units].</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00044">FlowSolverLBM.cpp:44</a></div></div>
<div class="ttc" id="atinyxml2_8cpp_html_ad3136d2f1f34e592c66e09ba8a852812"><div class="ttname"><a href="../../d6/d0a/tinyxml2_8cpp.html#ad3136d2f1f34e592c66e09ba8a852812">CR</a></div><div class="ttdeci">static const char CR</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d0a/tinyxml2_8cpp_source.html#l00142">tinyxml2.cpp:142</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c5d878b830d47f88531ce6a496ce5f4" name="a7c5d878b830d47f88531ce6a496ce5f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c5d878b830d47f88531ce6a496ce5f4">&#9670;&#160;</a></span>CountFluidNodes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t openphase::FlowSolverLBM::CountFluidNodes </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Counts the number of fluid nodes. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l01974">1974</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1975</span>{</div>
<div class="line"><span class="lineno"> 1976</span>    <span class="keywordtype">size_t</span> locFluidNodes = 0;</div>
<div class="line"><span class="lineno"> 1977</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>,0, reduction(+:locFluidNodes))</div>
<div class="line"><span class="lineno"> 1978</span>    {</div>
<div class="line"><span class="lineno"> 1979</span>        <span class="keywordflow">if</span> (not <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k)) locFluidNodes++;</div>
<div class="line"><span class="lineno"> 1980</span>    }</div>
<div class="line"><span class="lineno"> 1981</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1982</span> </div>
<div class="line"><span class="lineno"> 1983</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 1984</span>    OP_MPI_Allreduce(OP_MPI_IN_PLACE, &amp;locFluidNodes, 1, OP_MPI_UNSIGNED_LONG, OP_MPI_SUM, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 1985</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1986</span> </div>
<div class="line"><span class="lineno"> 1987</span>    <span class="keywordflow">return</span> locFluidNodes;</div>
<div class="line"><span class="lineno"> 1988</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0fddca310c5c0171d9a67b39fc9f167a" name="a0fddca310c5c0171d9a67b39fc9f167a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fddca310c5c0171d9a67b39fc9f167a">&#9670;&#160;</a></span>CountObstacleNodes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t openphase::FlowSolverLBM::CountObstacleNodes </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Counts the number of obstacle nodes. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l01955">1955</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1956</span>{</div>
<div class="line"><span class="lineno"> 1957</span>    <span class="keywordtype">size_t</span> locObstacleNodes = 0;</div>
<div class="line"><span class="lineno"> 1958</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>,0, reduction(+:locObstacleNodes))</div>
<div class="line"><span class="lineno"> 1959</span>    {</div>
<div class="line"><span class="lineno"> 1960</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k))</div>
<div class="line"><span class="lineno"> 1961</span>        {</div>
<div class="line"><span class="lineno"> 1962</span>            locObstacleNodes++;</div>
<div class="line"><span class="lineno"> 1963</span>        }</div>
<div class="line"><span class="lineno"> 1964</span>    }</div>
<div class="line"><span class="lineno"> 1965</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1966</span> </div>
<div class="line"><span class="lineno"> 1967</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 1968</span>    OP_MPI_Allreduce(OP_MPI_IN_PLACE, &amp;locObstacleNodes, 1, OP_MPI_UNSIGNED_LONG, OP_MPI_SUM, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 1969</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1970</span> </div>
<div class="line"><span class="lineno"> 1971</span>    <span class="keywordflow">return</span> locObstacleNodes;</div>
<div class="line"><span class="lineno"> 1972</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa47e5e7286c14822bf4c30efecfecf6a" name="aa47e5e7286c14822bf4c30efecfecf6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa47e5e7286c14822bf4c30efecfecf6a">&#9670;&#160;</a></span>Density()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::Density </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns local mass density including solids. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l03125">3125</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3127</span>{</div>
<div class="line"><span class="lineno"> 3128</span> </div>
<div class="line"><span class="lineno"> 3129</span>    <span class="keywordtype">double</span> SolidDensity = 0.0;</div>
<div class="line"><span class="lineno"> 3130</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 3131</span>             it != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).cend(); it++)</div>
<div class="line"><span class="lineno"> 3132</span>    <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[it-&gt;index].State == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a545a7e1c8dca42c00f8f139a1913c61cae41480b6bbfbf7407974a88d3d34f4fa">AggregateStates::Solid</a>)</div>
<div class="line"><span class="lineno"> 3133</span>    {</div>
<div class="line"><span class="lineno"> 3134</span>        SolidDensity += it-&gt;value*<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[it-&gt;index].Density;</div>
<div class="line"><span class="lineno"> 3135</span>    }</div>
<div class="line"><span class="lineno"> 3136</span>    <span class="keywordtype">double</span> locSolidFraction = <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a90657b1ab921a0b66ebe8201a939dddf">SolidFraction</a>(i,j,k,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>);</div>
<div class="line"><span class="lineno"> 3137</span>    <span class="comment">//double Density = FluidDensity(i,j,k)*(1.0-locSolidFraction) + SolidDensity*locSolidFraction; //TODO this should be uses</span></div>
<div class="line"><span class="lineno"> 3138</span>    <span class="keywordtype">double</span> <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa47e5e7286c14822bf4c30efecfecf6a">Density</a> = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{0})*(1.0-locSolidFraction) + SolidDensity*locSolidFraction;</div>
<div class="line"><span class="lineno"> 3139</span> </div>
<div class="line"><span class="lineno"> 3140</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa47e5e7286c14822bf4c30efecfecf6a">Density</a>;</div>
<div class="line"><span class="lineno"> 3141</span>}</div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_aa47e5e7286c14822bf4c30efecfecf6a"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa47e5e7286c14822bf4c30efecfecf6a">openphase::FlowSolverLBM::Density</a></div><div class="ttdeci">double Density(const PhaseField &amp;Phase, const int i, const int j, const int k) const</div><div class="ttdoc">Returns local mass density including solids.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l03125">FlowSolverLBM.cpp:3125</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a18b272ba83cdc1a9f64800b8479149f8" name="a18b272ba83cdc1a9f64800b8479149f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18b272ba83cdc1a9f64800b8479149f8">&#9670;&#160;</a></span>DensityProfile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::DensityProfile </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>n</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simple tangent hyperbolic for the liquid-vapor interface. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l03101">3101</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3102</span>{</div>
<div class="line"><span class="lineno"> 3103</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a147890b1c75d4b407881212ea40ecf05">Do_TwoPhase</a>)</div>
<div class="line"><span class="lineno"> 3104</span>    {</div>
<div class="line"><span class="lineno"> 3105</span>        <span class="keywordflow">return</span> 0.5 * (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa6aa8fda060bc8571b4b0a95464abd04">LiquidDensity</a>[n]+<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a6720e11af1b05213fbba7af7e7047848">VaporDensity</a>[n]) -</div>
<div class="line"><span class="lineno"> 3106</span>               0.5 * (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa6aa8fda060bc8571b4b0a95464abd04">LiquidDensity</a>[n]-<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a6720e11af1b05213fbba7af7e7047848">VaporDensity</a>[n]) *</div>
<div class="line"><span class="lineno"> 3107</span>               std::tanh(x/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7d68fa3e9c3b4dc37721947295a7507f">InterfaceWidth</a>[n]);</div>
<div class="line"><span class="lineno"> 3108</span>    }</div>
<div class="line"><span class="lineno"> 3109</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3110</span>    {</div>
<div class="line"><span class="lineno"> 3111</span>        <span class="keywordflow">return</span> 1.0;</div>
<div class="line"><span class="lineno"> 3112</span>    }</div>
<div class="line"><span class="lineno"> 3113</span>}</div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a7d68fa3e9c3b4dc37721947295a7507f"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7d68fa3e9c3b4dc37721947295a7507f">openphase::FlowSolverLBM::InterfaceWidth</a></div><div class="ttdeci">std::vector&lt; double &gt; InterfaceWidth</div><div class="ttdoc">Equilibrium interface width [TODO].</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00239">FlowSolverLBM.h:239</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac5517e657c322b841aeb9732f8b8e035" name="ac5517e657c322b841aeb9732f8b8e035"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5517e657c322b841aeb9732f8b8e035">&#9670;&#160;</a></span>DetectObstacles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::DetectObstacles </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Detects Obstacles. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02106">2106</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2107</span>{</div>
<div class="line"><span class="lineno"> 2108</span>    <span class="keywordtype">bool</span> locObstaclesChanged = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2109</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#af665bb9655e7117ac70af33f7c40ef9f">Bcells</a>(), reduction(or:locObstaclesChanged))</div>
<div class="line"><span class="lineno"> 2110</span>    {</div>
<div class="line"><span class="lineno"> 2111</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa33850567674314633589a61d1714cbe">LocalObstacle</a>(i,j,k,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>))</div>
<div class="line"><span class="lineno"> 2112</span>        {</div>
<div class="line"><span class="lineno"> 2113</span>            <span class="keywordflow">if</span> (not <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k)) locObstaclesChanged = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2114</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k) = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2115</span>        }</div>
<div class="line"><span class="lineno"> 2116</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2117</span>        {</div>
<div class="line"><span class="lineno"> 2118</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k)) locObstaclesChanged = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2119</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k) = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2120</span>        }</div>
<div class="line"><span class="lineno"> 2121</span>    }</div>
<div class="line"><span class="lineno"> 2122</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 2123</span> </div>
<div class="line"><span class="lineno"> 2124</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 2125</span>    OP_MPI_Allreduce(OP_MPI_IN_PLACE, &amp;locObstaclesChanged, 1, OP_MPI_CXX_BOOL, OP_MPI_LOR, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 2126</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2127</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a6c0dc555248064b06b4d1795657c5026">ObstaclesChanged</a> = locObstaclesChanged;</div>
<div class="line"><span class="lineno"> 2128</span>}</div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a6c0dc555248064b06b4d1795657c5026"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a6c0dc555248064b06b4d1795657c5026">openphase::FlowSolverLBM::ObstaclesChanged</a></div><div class="ttdeci">bool ObstaclesChanged</div><div class="ttdoc">True if an obstacle changed.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00194">FlowSolverLBM.h:194</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_aa33850567674314633589a61d1714cbe"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa33850567674314633589a61d1714cbe">openphase::FlowSolverLBM::LocalObstacle</a></div><div class="ttdeci">bool LocalObstacle(const int i, const int j, const int k, const PhaseField &amp;Phase) const</div><div class="ttdoc">Returns true if obstacle has been detected at (i,j,k)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02100">FlowSolverLBM.cpp:2100</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6ba35f98a851e32c156d6430787f28e5" name="a6ba35f98a851e32c156d6430787f28e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ba35f98a851e32c156d6430787f28e5">&#9670;&#160;</a></span>DetectObstaclesAdvection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::DetectObstaclesAdvection </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;&#160;</td>
          <td class="paramname"><em>Vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Detects Obstacles (Detects change of obstacles for advection) </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02130">2130</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2132</span>{</div>
<div class="line"><span class="lineno"> 2133</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno"> 2134</span>    dVector3 FluidMomentumOld = <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a52684844a9f0909ee6cb44de43dd5d47">CalculateFluidMomentum</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>)[0];</div>
<div class="line"><span class="lineno"> 2135</span>    <span class="keywordtype">double</span> FluidMassOld = <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a331be5fb7f4939bbc29d69c8f6937a15">CalculateFluidMass</a>()[0];</div>
<div class="line"><span class="lineno"> 2136</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2137</span> </div>
<div class="line"><span class="lineno"> 2138</span>    <span class="keywordtype">size_t</span> locObstaclesAppeared = 0;</div>
<div class="line"><span class="lineno"> 2139</span>    <span class="keywordtype">size_t</span> locObstaclesVanished = 0;</div>
<div class="line"><span class="lineno"> 2140</span> </div>
<div class="line"><span class="lineno"> 2141</span>    <span class="keywordtype">bool</span> locObstaclesChanged = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2142</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#af665bb9655e7117ac70af33f7c40ef9f">Bcells</a>(), reduction (+:locObstaclesAppeared,locObstaclesVanished) reduction(or:locObstaclesChanged))</div>
<div class="line"><span class="lineno"> 2143</span>    {</div>
<div class="line"><span class="lineno"> 2144</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aee9af090b2f8092c793ae13a596403f7">ObstacleVanished</a>(i,j,k) = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2145</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a23b20c6aaa054e65abc78e1783f1a595">ObstacleAppeared</a>(i,j,k) = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2146</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa33850567674314633589a61d1714cbe">LocalObstacle</a>(i,j,k,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>))</div>
<div class="line"><span class="lineno"> 2147</span>        {</div>
<div class="line"><span class="lineno"> 2148</span>            <span class="keywordflow">if</span>(not <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k))</div>
<div class="line"><span class="lineno"> 2149</span>            {</div>
<div class="line"><span class="lineno"> 2150</span>                <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a23b20c6aaa054e65abc78e1783f1a595">ObstacleAppeared</a>(i,j,k) = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2151</span>                locObstaclesChanged = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2152</span>                locObstaclesAppeared++;</div>
<div class="line"><span class="lineno"> 2153</span>            }</div>
<div class="line"><span class="lineno"> 2154</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k) = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2155</span>        }</div>
<div class="line"><span class="lineno"> 2156</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2157</span>        {</div>
<div class="line"><span class="lineno"> 2158</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k))</div>
<div class="line"><span class="lineno"> 2159</span>            {</div>
<div class="line"><span class="lineno"> 2160</span>                <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aee9af090b2f8092c793ae13a596403f7">ObstacleVanished</a>(i,j,k) = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2161</span>                locObstaclesChanged = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2162</span>                locObstaclesVanished++;</div>
<div class="line"><span class="lineno"> 2163</span>            }</div>
<div class="line"><span class="lineno"> 2164</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k) = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2165</span>        }</div>
<div class="line"><span class="lineno"> 2166</span>    }</div>
<div class="line"><span class="lineno"> 2167</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 2168</span> </div>
<div class="line"><span class="lineno"> 2169</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 2170</span>    OP_MPI_Allreduce(OP_MPI_IN_PLACE, &amp;locObstaclesAppeared, 1, OP_MPI_UNSIGNED_LONG, OP_MPI_SUM, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 2171</span>    OP_MPI_Allreduce(OP_MPI_IN_PLACE, &amp;locObstaclesVanished, 1, OP_MPI_UNSIGNED_LONG, OP_MPI_SUM, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 2172</span>    OP_MPI_Allreduce(OP_MPI_IN_PLACE, &amp;locObstaclesChanged, 1, OP_MPI_CXX_BOOL, OP_MPI_LOR, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 2173</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2174</span> </div>
<div class="line"><span class="lineno"> 2175</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a6c0dc555248064b06b4d1795657c5026">ObstaclesChanged</a> = locObstaclesChanged;</div>
<div class="line"><span class="lineno"> 2176</span> </div>
<div class="line"><span class="lineno"> 2177</span>    <span class="keywordflow">if</span> (locObstaclesAppeared + locObstaclesVanished &gt; 0)</div>
<div class="line"><span class="lineno"> 2178</span>    {</div>
<div class="line"><span class="lineno"> 2179</span>        <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a4aa7134220bdc3b0d46435789e484955">SetFluidNodesNearObstacle</a>();</div>
<div class="line"><span class="lineno"> 2180</span>        <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a78015631ab46781aeba17f0e7af47473">SetObstacleNodes</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>,Vel);</div>
<div class="line"><span class="lineno"> 2181</span>        <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#af6e8285978dabe6066bd291c5674ffdb">CalculateDensityAndMomentum</a>();</div>
<div class="line"><span class="lineno"> 2182</span>        <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aac503798c87d57cd342e2d56063f481b">SetBoundaryConditions</a>(BC);</div>
<div class="line"><span class="lineno"> 2183</span> </div>
<div class="line"><span class="lineno"> 2184</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno"> 2185</span>        dVector3 FluidMomentumNew = <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a52684844a9f0909ee6cb44de43dd5d47">CalculateFluidMomentum</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>)[0];</div>
<div class="line"><span class="lineno"> 2186</span>        dVector3 FluidMomentumDelta = FluidMomentumNew-FluidMomentumOld;</div>
<div class="line"><span class="lineno"> 2187</span>        <span class="keywordtype">double</span> FluidMomentumDeltaMag = FluidMomentumDelta.abs();</div>
<div class="line"><span class="lineno"> 2188</span>        <span class="keywordtype">double</span> FluidMassNew = <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a331be5fb7f4939bbc29d69c8f6937a15">CalculateFluidMass</a>()[0];</div>
<div class="line"><span class="lineno"> 2189</span>        <span class="keywordtype">double</span> FluidMassDelta = FluidMassNew - FluidMassOld;</div>
<div class="line"><span class="lineno"> 2190</span>        <span class="keywordflow">if</span> (std::abs(FluidMassDelta)/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a> &gt; 1.0e-10)<span class="comment">//DBL_EPSILON)</span></div>
<div class="line"><span class="lineno"> 2191</span>        {</div>
<div class="line"><span class="lineno"> 2192</span>            <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">ConsoleOutput::WriteWarning</a>(<span class="stringliteral">&quot;Mass conservation violated! Method needs to be debugged.&quot;</span>, <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, <span class="stringliteral">&quot;DetectObstaclesAdvection&quot;</span>);</div>
<div class="line"><span class="lineno"> 2193</span>            <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a41683f616ffa4631340cb0de41cad70f">ConsoleOutput::Write</a>(<span class="stringliteral">&quot;Obstacles Appeared&quot;</span>, locObstaclesAppeared);</div>
<div class="line"><span class="lineno"> 2194</span>            <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a41683f616ffa4631340cb0de41cad70f">ConsoleOutput::Write</a>(<span class="stringliteral">&quot;Obstacles Vanished&quot;</span>, locObstaclesVanished);</div>
<div class="line"><span class="lineno"> 2195</span>            <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a41683f616ffa4631340cb0de41cad70f">ConsoleOutput::Write</a>(<span class="stringliteral">&quot;Flud Mass Change [Kg]&quot;</span>, FluidMassDelta);</div>
<div class="line"><span class="lineno"> 2196</span>            <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a41683f616ffa4631340cb0de41cad70f">ConsoleOutput::Write</a>(<span class="stringliteral">&quot;Flud Mass Change  [1]&quot;</span>, FluidMassDelta/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>);</div>
<div class="line"><span class="lineno"> 2197</span>        }</div>
<div class="line"><span class="lineno"> 2198</span>        <span class="keywordflow">if</span> (FluidMomentumDeltaMag/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0e7cad672eea608ab7c5ea5ed6946138">dm</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_function" href="../../dc/d18/classopenphase_1_1GridParameters.html#a9e96c156b3c12ba0bb402d5188dbf1c6">CellVolume</a>(<span class="keyword">true</span>) &gt; 1.0e-10)<span class="comment">//DBL_EPSILON)</span></div>
<div class="line"><span class="lineno"> 2199</span>        {</div>
<div class="line"><span class="lineno"> 2200</span>            <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">ConsoleOutput::WriteWarning</a>(<span class="stringliteral">&quot;Momentum conservation violated! Method may needs to be debugged.&quot;</span>, <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, <span class="stringliteral">&quot;DetectObstaclesAdvection&quot;</span>);</div>
<div class="line"><span class="lineno"> 2201</span>            <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a41683f616ffa4631340cb0de41cad70f">ConsoleOutput::Write</a>(<span class="stringliteral">&quot;Obstacles Appeared&quot;</span>,locObstaclesAppeared);</div>
<div class="line"><span class="lineno"> 2202</span>            <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a41683f616ffa4631340cb0de41cad70f">ConsoleOutput::Write</a>(<span class="stringliteral">&quot;Obstacles Vanished&quot;</span>,locObstaclesVanished);</div>
<div class="line"><span class="lineno"> 2203</span>            <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a41683f616ffa4631340cb0de41cad70f">ConsoleOutput::Write</a>(<span class="stringliteral">&quot;Fluid Momentum Change [Kg m/s]&quot;</span>,FluidMomentumDeltaMag);</div>
<div class="line"><span class="lineno"> 2204</span>            <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a41683f616ffa4631340cb0de41cad70f">ConsoleOutput::Write</a>(<span class="stringliteral">&quot;Fluid Momentum Change      [1]&quot;</span>,FluidMomentumDeltaMag/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0e7cad672eea608ab7c5ea5ed6946138">dm</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_function" href="../../dc/d18/classopenphase_1_1GridParameters.html#a9e96c156b3c12ba0bb402d5188dbf1c6">CellVolume</a>(<span class="keyword">true</span>));</div>
<div class="line"><span class="lineno"> 2205</span>        }</div>
<div class="line"><span class="lineno"> 2206</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2207</span>    }</div>
<div class="line"><span class="lineno"> 2208</span>}</div>
<div class="ttc" id="aclassopenphase_1_1ConsoleOutput_html_a41683f616ffa4631340cb0de41cad70f"><div class="ttname"><a href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a41683f616ffa4631340cb0de41cad70f">openphase::ConsoleOutput::Write</a></div><div class="ttdeci">static void Write(const std::string message)</div><div class="ttdoc">Writes a Message, Blank Line, or Line of char to screen.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/dfe/ConsoleOutput_8h_source.html#l00079">ConsoleOutput.h:79</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a23b20c6aaa054e65abc78e1783f1a595"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a23b20c6aaa054e65abc78e1783f1a595">openphase::FlowSolverLBM::ObstacleAppeared</a></div><div class="ttdeci">Storage3D&lt; int, 0 &gt; ObstacleAppeared</div><div class="ttdoc">True if obstacle node appeared.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00171">FlowSolverLBM.h:171</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a331be5fb7f4939bbc29d69c8f6937a15"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a331be5fb7f4939bbc29d69c8f6937a15">openphase::FlowSolverLBM::CalculateFluidMass</a></div><div class="ttdeci">std::vector&lt; double &gt; CalculateFluidMass(void) const</div><div class="ttdoc">Calculates mass of fluid components.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02809">FlowSolverLBM.cpp:2809</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a4aa7134220bdc3b0d46435789e484955"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a4aa7134220bdc3b0d46435789e484955">openphase::FlowSolverLBM::SetFluidNodesNearObstacle</a></div><div class="ttdeci">void SetFluidNodesNearObstacle()</div><div class="ttdoc">Sets lbPoblulations of vanishing Obstacles and of appearing Obstacles.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02283">FlowSolverLBM.cpp:2283</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a52684844a9f0909ee6cb44de43dd5d47"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a52684844a9f0909ee6cb44de43dd5d47">openphase::FlowSolverLBM::CalculateFluidMomentum</a></div><div class="ttdeci">std::vector&lt; dVector3 &gt; CalculateFluidMomentum(const PhaseField &amp;Phase) const</div><div class="ttdoc">Calculates the momentum of the entire fluid in the system.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02210">FlowSolverLBM.cpp:2210</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a78015631ab46781aeba17f0e7af47473"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a78015631ab46781aeba17f0e7af47473">openphase::FlowSolverLBM::SetObstacleNodes</a></div><div class="ttdeci">virtual void SetObstacleNodes(const PhaseField &amp;Phase, const Velocities &amp;Vel)</div><div class="ttdoc">Sets density and momentum in obstacles to be used when solid moves.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02453">FlowSolverLBM.cpp:2453</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_aac503798c87d57cd342e2d56063f481b"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aac503798c87d57cd342e2d56063f481b">openphase::FlowSolverLBM::SetBoundaryConditions</a></div><div class="ttdeci">void SetBoundaryConditions(const BoundaryConditions &amp;BC) override</div><div class="ttdoc">Sets boundary conditions for the particle distribution functions and flow velocities.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00695">FlowSolverLBM.cpp:695</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_aee9af090b2f8092c793ae13a596403f7"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aee9af090b2f8092c793ae13a596403f7">openphase::FlowSolverLBM::ObstacleVanished</a></div><div class="ttdeci">Storage3D&lt; int, 0 &gt; ObstacleVanished</div><div class="ttdoc">True if obstacle node vanished.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00173">FlowSolverLBM.h:173</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_af6e8285978dabe6066bd291c5674ffdb"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#af6e8285978dabe6066bd291c5674ffdb">openphase::FlowSolverLBM::CalculateDensityAndMomentum</a></div><div class="ttdeci">void CalculateDensityAndMomentum(void)</div><div class="ttdoc">Calculates Density and momentum from lbDensity.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02858">FlowSolverLBM.cpp:2858</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a85c894c1477deaf9def49df64f42a35e" name="a85c894c1477deaf9def49df64f42a35e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85c894c1477deaf9def49df64f42a35e">&#9670;&#160;</a></span>EnforceMassConservation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::EnforceMassConservation </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enforces fluid mass conservation for advectional problems. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l01990">1990</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1991</span>{</div>
<div class="line"><span class="lineno"> 1992</span>    <span class="comment">// Calculate Fluid mass</span></div>
<div class="line"><span class="lineno"> 1993</span>    std::vector&lt;double&gt; DeltaDensity = <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a331be5fb7f4939bbc29d69c8f6937a15">CalculateFluidMass</a>();</div>
<div class="line"><span class="lineno"> 1994</span>    <span class="keywordtype">size_t</span> FluidNodes = <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7c5d878b830d47f88531ce6a496ce5f4">CountFluidNodes</a>();</div>
<div class="line"><span class="lineno"> 1995</span> </div>
<div class="line"><span class="lineno"> 1996</span>    <span class="keywordflow">if</span> (FluidNodes &gt; 0)</div>
<div class="line"><span class="lineno"> 1997</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 1998</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#acaf39436ee81673b389cf19247734fca">FluidMass</a>[n] != 0)</div>
<div class="line"><span class="lineno"> 1999</span>    {</div>
<div class="line"><span class="lineno"> 2000</span>        DeltaDensity[n] -= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#acaf39436ee81673b389cf19247734fca">FluidMass</a>[n];</div>
<div class="line"><span class="lineno"> 2001</span>        DeltaDensity[n] /= FluidNodes;</div>
<div class="line"><span class="lineno"> 2002</span> </div>
<div class="line"><span class="lineno"> 2003</span>        <span class="comment">// Fix density</span></div>
<div class="line"><span class="lineno"> 2004</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>,0,)</div>
<div class="line"><span class="lineno"> 2005</span>        {</div>
<div class="line"><span class="lineno"> 2006</span>            <span class="keywordflow">if</span> (not <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k))</div>
<div class="line"><span class="lineno"> 2007</span>            {</div>
<div class="line"><span class="lineno"> 2008</span>                <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n}) = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n}) -</div>
<div class="line"><span class="lineno"> 2009</span>                    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#acbf6f50e003944ed8daced249b20ee6e">EquilibriumDistribution</a>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a> + DeltaDensity[n], <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92539bf6d5ed043520c0bdbc47c334a9">lbWeights</a>) +</div>
<div class="line"><span class="lineno"> 2010</span>                    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#acbf6f50e003944ed8daced249b20ee6e">EquilibriumDistribution</a>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92539bf6d5ed043520c0bdbc47c334a9">lbWeights</a>);</div>
<div class="line"><span class="lineno"> 2011</span>            }</div>
<div class="line"><span class="lineno"> 2012</span>        }</div>
<div class="line"><span class="lineno"> 2013</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 2014</span>    }</div>
<div class="line"><span class="lineno"> 2015</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#acaf39436ee81673b389cf19247734fca">FluidMass</a> = <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a331be5fb7f4939bbc29d69c8f6937a15">CalculateFluidMass</a>();</div>
<div class="line"><span class="lineno"> 2016</span>}</div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a7c5d878b830d47f88531ce6a496ce5f4"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7c5d878b830d47f88531ce6a496ce5f4">openphase::FlowSolverLBM::CountFluidNodes</a></div><div class="ttdeci">size_t CountFluidNodes(void) const</div><div class="ttdoc">Counts the number of fluid nodes.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l01974">FlowSolverLBM.cpp:1974</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_acaf39436ee81673b389cf19247734fca"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#acaf39436ee81673b389cf19247734fca">openphase::FlowSolverLBM::FluidMass</a></div><div class="ttdeci">std::vector&lt; double &gt; FluidMass</div><div class="ttdoc">Fluid mass (used for mass conservation)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00245">FlowSolverLBM.h:245</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad1dff5ac2790864dbdcac5ac7d06038f" name="ad1dff5ac2790864dbdcac5ac7d06038f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1dff5ac2790864dbdcac5ac7d06038f">&#9670;&#160;</a></span>EnforceSolidMomentum()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::EnforceSolidMomentum </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a>&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enforces solid momentum conservation. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02049">2049</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2050</span>{</div>
<div class="line"><span class="lineno"> 2051</span>    <span class="comment">// Fix Solid momentum</span></div>
<div class="line"><span class="lineno"> 2052</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> dx = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.dx;</div>
<div class="line"><span class="lineno"> 2053</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> dV = dx*dx*dx;</div>
<div class="line"><span class="lineno"> 2054</span> </div>
<div class="line"><span class="lineno"> 2055</span>    dVector3 SolidMomentum = {0.0,0.0,0.0};</div>
<div class="line"><span class="lineno"> 2056</span>    <span class="keywordtype">double</span> SolidMass = 0.0;</div>
<div class="line"><span class="lineno"> 2057</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> idx = 0; idx &lt; <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties.size(); idx++)</div>
<div class="line"><span class="lineno"> 2058</span>    <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[idx].State == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a545a7e1c8dca42c00f8f139a1913c61cae41480b6bbfbf7407974a88d3d34f4fa">AggregateStates::Solid</a> and</div>
<div class="line"><span class="lineno"> 2059</span>        <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[idx].Mobile)</div>
<div class="line"><span class="lineno"> 2060</span>    {</div>
<div class="line"><span class="lineno"> 2061</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> GrainMass = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[idx].Volume*dV*</div>
<div class="line"><span class="lineno"> 2062</span>                                 <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[idx].Density;</div>
<div class="line"><span class="lineno"> 2063</span>        SolidMass     += GrainMass;</div>
<div class="line"><span class="lineno"> 2064</span>        SolidMomentum += <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[idx].Vcm * GrainMass;</div>
<div class="line"><span class="lineno"> 2065</span>    }</div>
<div class="line"><span class="lineno"> 2066</span> </div>
<div class="line"><span class="lineno"> 2067</span>    <span class="keyword">const</span> dVector3 VcmFix = (SolidMomentum - value)/SolidMass;</div>
<div class="line"><span class="lineno"> 2068</span> </div>
<div class="line"><span class="lineno"> 2069</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> idx = 0; idx &lt; <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties.size(); idx++)</div>
<div class="line"><span class="lineno"> 2070</span>    <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[idx].State == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a545a7e1c8dca42c00f8f139a1913c61cae41480b6bbfbf7407974a88d3d34f4fa">AggregateStates::Solid</a> and</div>
<div class="line"><span class="lineno"> 2071</span>        <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[idx].Mobile)</div>
<div class="line"><span class="lineno"> 2072</span>    {</div>
<div class="line"><span class="lineno"> 2073</span>        <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[idx].Vcm -= VcmFix;</div>
<div class="line"><span class="lineno"> 2074</span>    }</div>
<div class="line"><span class="lineno"> 2075</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5bc0c19bc5b4cc91e7bd1e7dd9b0cf9b" name="a5bc0c19bc5b4cc91e7bd1e7dd9b0cf9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5bc0c19bc5b4cc91e7bd1e7dd9b0cf9b">&#9670;&#160;</a></span>EnforceTotalMassConservation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::EnforceTotalMassConservation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enforces total mass conservation (solid and fluid) </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02018">2018</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2019</span>{</div>
<div class="line"><span class="lineno"> 2020</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a> &gt; 1)</div>
<div class="line"><span class="lineno"> 2021</span>    {</div>
<div class="line"><span class="lineno"> 2022</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a421faa2fe5d86991328b2b06041a326d">ConsoleOutput::WriteExit</a>(<span class="stringliteral">&quot;Not yet implemented for multi fluid&quot;</span>, <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, <span class="stringliteral">&quot;EnforceTotalMassConservation&quot;</span>);</div>
<div class="line"><span class="lineno"> 2023</span>        <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a4d6fed4ab71c6edf2a0bd5dabecc6ec6">OP_Exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 2024</span>    }</div>
<div class="line"><span class="lineno"> 2025</span> </div>
<div class="line"><span class="lineno"> 2026</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#acaf39436ee81673b389cf19247734fca">FluidMass</a> = <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a331be5fb7f4939bbc29d69c8f6937a15">CalculateFluidMass</a>()[0];</div>
<div class="line"><span class="lineno"> 2027</span>    <span class="keywordtype">double</span> SolidMass = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.CalculateSolidMass();</div>
<div class="line"><span class="lineno"> 2028</span>    <span class="keywordtype">double</span> TotalMass = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#acaf39436ee81673b389cf19247734fca">FluidMass</a> + SolidMass;</div>
<div class="line"><span class="lineno"> 2029</span> </div>
<div class="line"><span class="lineno"> 2030</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5e9e538e60ba43e77acb1cc88b20a316">InitialTotalMass</a> == -1.0) <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5e9e538e60ba43e77acb1cc88b20a316">InitialTotalMass</a> = TotalMass;</div>
<div class="line"><span class="lineno"> 2031</span>    <span class="keywordtype">double</span> DeltaMass = TotalMass - <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5e9e538e60ba43e77acb1cc88b20a316">InitialTotalMass</a>;</div>
<div class="line"><span class="lineno"> 2032</span>    <span class="keywordtype">size_t</span> FluidNodes = <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7c5d878b830d47f88531ce6a496ce5f4">CountFluidNodes</a>();</div>
<div class="line"><span class="lineno"> 2033</span>    <span class="keywordtype">double</span> DensityDelta = DeltaMass/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>/FluidNodes/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_function" href="../../dc/d18/classopenphase_1_1GridParameters.html#a9e96c156b3c12ba0bb402d5188dbf1c6">CellVolume</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2034</span> </div>
<div class="line"><span class="lineno"> 2035</span>    <span class="keywordflow">if</span> (DeltaMass &gt; std::numeric_limits&lt;double&gt;::epsilon())</div>
<div class="line"><span class="lineno"> 2036</span>    {</div>
<div class="line"><span class="lineno"> 2037</span>        <span class="keywordflow">if</span> (FluidNodes &gt; 0)</div>
<div class="line"><span class="lineno"> 2038</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>,0,)</div>
<div class="line"><span class="lineno"> 2039</span>        {</div>
<div class="line"><span class="lineno"> 2040</span>            <span class="keywordflow">if</span> (not <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k))</div>
<div class="line"><span class="lineno"> 2041</span>            {</div>
<div class="line"><span class="lineno"> 2042</span>                <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{0})(0,0,0) -= DensityDelta/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>;</div>
<div class="line"><span class="lineno"> 2043</span>            }</div>
<div class="line"><span class="lineno"> 2044</span>        }</div>
<div class="line"><span class="lineno"> 2045</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 2046</span>    }</div>
<div class="line"><span class="lineno"> 2047</span>}</div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a5e9e538e60ba43e77acb1cc88b20a316"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5e9e538e60ba43e77acb1cc88b20a316">openphase::FlowSolverLBM::InitialTotalMass</a></div><div class="ttdeci">double InitialTotalMass</div><div class="ttdoc">Solid mass (used for mass conservation)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00237">FlowSolverLBM.h:237</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_a4d6fed4ab71c6edf2a0bd5dabecc6ec6"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a4d6fed4ab71c6edf2a0bd5dabecc6ec6">openphase::OP_Exit</a></div><div class="ttdeci">void OP_Exit(int exit_code)</div><div class="ttdef"><b>Definition</b> <a href="../../d9/df1/Globals_8h_source.html#l00098">Globals.h:98</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acbf6f50e003944ed8daced249b20ee6e" name="acbf6f50e003944ed8daced249b20ee6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbf6f50e003944ed8daced249b20ee6e">&#9670;&#160;</a></span>EquilibriumDistribution()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/d57/classopenphase_1_1D3Q27.html">D3Q27</a> openphase::FlowSolverLBM::EquilibriumDistribution </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lbDensity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>weights</em>[3][3][3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a>&#160;</td>
          <td class="paramname"><em>lbMomentum</em> = <code>{0.0,0.0,0.0}</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l03077">3077</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3079</span>{</div>
<div class="line"><span class="lineno"> 3080</span>   dVector3 macroVel;</div>
<div class="line"><span class="lineno"> 3081</span>   <span class="keywordflow">if</span>(lbDensity != 0)</div>
<div class="line"><span class="lineno"> 3082</span>   {</div>
<div class="line"><span class="lineno"> 3083</span>       macroVel = lbMomentum/lbDensity;</div>
<div class="line"><span class="lineno"> 3084</span>   }</div>
<div class="line"><span class="lineno"> 3085</span>   <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3086</span>   {</div>
<div class="line"><span class="lineno"> 3087</span>       macroVel.set_to_zero();</div>
<div class="line"><span class="lineno"> 3088</span>   }</div>
<div class="line"><span class="lineno"> 3089</span>   <span class="keywordtype">double</span> u2 = (macroVel*macroVel);</div>
<div class="line"><span class="lineno"> 3090</span>   D3Q27 locPopulations;</div>
<div class="line"><span class="lineno"> 3091</span>   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> x = -1; x &lt;= 1; x++)</div>
<div class="line"><span class="lineno"> 3092</span>   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> y = -1; y &lt;= 1; y++)</div>
<div class="line"><span class="lineno"> 3093</span>   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> z = -1; z &lt;= 1; z++)</div>
<div class="line"><span class="lineno"> 3094</span>   {</div>
<div class="line"><span class="lineno"> 3095</span>       <span class="keywordtype">double</span> cu = x*macroVel[0] + y*macroVel[1] + z*macroVel[2];</div>
<div class="line"><span class="lineno"> 3096</span>       locPopulations(x,y,z) = lbDensity*weights[x+1][y+1][z+1]*(1.0 - 1.5*u2 + cu*(3.0 + 4.5*cu));</div>
<div class="line"><span class="lineno"> 3097</span>   }</div>
<div class="line"><span class="lineno"> 3098</span>   <span class="keywordflow">return</span> locPopulations;</div>
<div class="line"><span class="lineno"> 3099</span>};</div>
</div><!-- fragment -->
</div>
</div>
<a id="acaa0558757ce5f46303dca296d469030" name="acaa0558757ce5f46303dca296d469030"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acaa0558757ce5f46303dca296d469030">&#9670;&#160;</a></span>EquilibriumDistributionTC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/d57/classopenphase_1_1D3Q27.html">D3Q27</a> openphase::FlowSolverLBM::EquilibriumDistributionTC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a>&#160;</td>
          <td class="paramname"><em>lbvel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lbph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lbnut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lbDivVel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a>&#160;</td>
          <td class="paramname"><em>lbFb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>weights</em>[3][3][3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lbrho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a>&#160;</td>
          <td class="paramname"><em>lbGradRho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02487">2487</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2490</span>{</div>
<div class="line"><span class="lineno"> 2491</span>    D3Q27 locPopulations;</div>
<div class="line"><span class="lineno"> 2492</span>    <span class="keywordtype">double</span> lbu2         = lbvel[0]*lbvel[0]+lbvel[1]*lbvel[1]+lbvel[2]*lbvel[2];</div>
<div class="line"><span class="lineno"> 2493</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad8ae2a30dc85638b1a377cc2919200fe">lbtau</a> [n]           = lbnut/<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a> + 0.5; </div>
<div class="line"><span class="lineno"> 2494</span>    <span class="keywordtype">double</span> factor       = (1.0-1.0/(2.0*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad8ae2a30dc85638b1a377cc2919200fe">lbtau</a>[n]));</div>
<div class="line"><span class="lineno"> 2495</span> </div>
<div class="line"><span class="lineno"> 2496</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ii = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii++)</div>
<div class="line"><span class="lineno"> 2497</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj++)</div>
<div class="line"><span class="lineno"> 2498</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk++)</div>
<div class="line"><span class="lineno"> 2499</span>    {</div>
<div class="line"><span class="lineno"> 2500</span>        <span class="keywordtype">double</span> <a class="code hl_variable" href="../../d6/d0a/tinyxml2_8cpp.html#ad3136d2f1f34e592c66e09ba8a852812">CR</a> = (ii-lbvel[0])*lbGradRho[0]+(jj-lbvel[1])*lbGradRho[1]+(kk-lbvel[2])*lbGradRho[2];</div>
<div class="line"><span class="lineno"> 2501</span>        <span class="keywordtype">double</span> CF = (ii-lbvel[0])*lbFb[0]+(jj-lbvel[1])*lbFb[1]+(kk-lbvel[2])*lbFb[2];</div>
<div class="line"><span class="lineno"> 2502</span>        <span class="keywordtype">double</span> lbw  = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92539bf6d5ed043520c0bdbc47c334a9">lbWeights</a>[ii+1][jj+1][kk+1];</div>
<div class="line"><span class="lineno"> 2503</span>        <span class="keywordtype">double</span> lbcu = ii*lbvel[0] + jj*lbvel[1] + kk*lbvel[2];</div>
<div class="line"><span class="lineno"> 2504</span>        <span class="keywordtype">double</span> Feq  = lbrho * lbw *(1.0 + lbcu/<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>- lbu2/(2.0*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>) + lbcu*lbcu/(2.0*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>) );</div>
<div class="line"><span class="lineno"> 2505</span>        <span class="keywordtype">double</span> geq  = Feq*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a> + (lbph - lbrho * <a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a> ) * lbw; </div>
<div class="line"><span class="lineno"> 2506</span> </div>
<div class="line"><span class="lineno"> 2507</span>           locPopulations(ii,jj,kk) = geq - 0.5 * (lbrho * <a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a> * lbw * lbDivVel * factor  + <a class="code hl_variable" href="../../d6/d0a/tinyxml2_8cpp.html#ad3136d2f1f34e592c66e09ba8a852812">CR</a>*(Feq/lbrho-lbw)*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>*factor + CF*Feq/lbrho);</div>
<div class="line"><span class="lineno"> 2508</span>    }</div>
<div class="line"><span class="lineno"> 2509</span>   <span class="keywordflow">return</span> locPopulations;</div>
<div class="line"><span class="lineno"> 2510</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="acfa1ada44d5ad2ecb7b53dc43c26f61b" name="acfa1ada44d5ad2ecb7b53dc43c26f61b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfa1ada44d5ad2ecb7b53dc43c26f61b">&#9670;&#160;</a></span>FinalizeInitialiation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::FinalizeInitialiation </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;&#160;</td>
          <td class="paramname"><em>Vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Needs to be called after the microstructure has been initialized. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l03167">3167</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3169</span>{</div>
<div class="line"><span class="lineno"> 3170</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#af665bb9655e7117ac70af33f7c40ef9f">Bcells</a>(),)</div>
<div class="line"><span class="lineno"> 3171</span>    for (<span class="keywordtype">size_t</span> comp = 0; comp &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++comp)</div>
<div class="line"><span class="lineno"> 3172</span>    {</div>
<div class="line"><span class="lineno"> 3173</span>        <span class="keywordtype">double</span>   lbDensity  = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a> (i,j,k,{comp})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>;</div>
<div class="line"><span class="lineno"> 3174</span>        dVector3 lbMomentum = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a>(i,j,k,{comp})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0e7cad672eea608ab7c5ea5ed6946138">dm</a>;</div>
<div class="line"><span class="lineno"> 3175</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{comp}) = <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#acbf6f50e003944ed8daced249b20ee6e">FlowSolverLBM::EquilibriumDistribution</a>(lbDensity, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92539bf6d5ed043520c0bdbc47c334a9">lbWeights</a>, lbMomentum);</div>
<div class="line"><span class="lineno"> 3176</span>    }</div>
<div class="line"><span class="lineno"> 3177</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 3178</span> </div>
<div class="line"><span class="lineno"> 3179</span>    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac5517e657c322b841aeb9732f8b8e035">DetectObstacles</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>);</div>
<div class="line"><span class="lineno"> 3180</span>    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a78015631ab46781aeba17f0e7af47473">SetObstacleNodes</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>,Vel);</div>
<div class="line"><span class="lineno"> 3181</span>    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aeba3442a2b798b5a17d27ad07e7e23dc">FixPopulations</a>();</div>
<div class="line"><span class="lineno"> 3182</span>    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a85c894c1477deaf9def49df64f42a35e">EnforceMassConservation</a>();</div>
<div class="line"><span class="lineno"> 3183</span>    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aac503798c87d57cd342e2d56063f481b">SetBoundaryConditions</a>(BC);</div>
<div class="line"><span class="lineno"> 3184</span>}</div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a85c894c1477deaf9def49df64f42a35e"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a85c894c1477deaf9def49df64f42a35e">openphase::FlowSolverLBM::EnforceMassConservation</a></div><div class="ttdeci">void EnforceMassConservation(void)</div><div class="ttdoc">Enforces fluid mass conservation for advectional problems.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l01990">FlowSolverLBM.cpp:1990</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_ac5517e657c322b841aeb9732f8b8e035"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac5517e657c322b841aeb9732f8b8e035">openphase::FlowSolverLBM::DetectObstacles</a></div><div class="ttdeci">void DetectObstacles(const PhaseField &amp;Phase)</div><div class="ttdoc">Detects Obstacles.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02106">FlowSolverLBM.cpp:2106</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af6910712da7e1d8d4df869a36cc41fb1" name="af6910712da7e1d8d4df869a36cc41fb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6910712da7e1d8d4df869a36cc41fb1">&#9670;&#160;</a></span>FindObject()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html">OPObject</a> * openphase::OPObject::FindObject </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html">OPObject</a> * &gt;&#160;</td>
          <td class="paramname"><em>ObjectList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>ObjectName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>thisclassname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>thisfunctionname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>necessary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>verbose</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d1c/OPObject_8h_source.html#l00130">130</a> of file <a class="el" href="../../d5/d1c/OPObject_8h_source.html">OPObject.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  138</span>    {</div>
<div class="line"><span class="lineno">  139</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; ObjectList.size(); i++)</div>
<div class="line"><span class="lineno">  140</span>        {</div>
<div class="line"><span class="lineno">  141</span>            <span class="keywordflow">if</span>(ObjectList[i]-&gt;<a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>.size() &gt;= ObjectName.size())</div>
<div class="line"><span class="lineno">  142</span>            {</div>
<div class="line"><span class="lineno">  143</span>                std::string locObjectName = ObjectList[i]-&gt;thisclassname;</div>
<div class="line"><span class="lineno">  144</span>                locObjectName.resize(ObjectName.size());</div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>                <span class="keywordflow">if</span>(locObjectName == ObjectName)</div>
<div class="line"><span class="lineno">  147</span>                {</div>
<div class="line"><span class="lineno">  148</span>                    <span class="keywordflow">return</span> ObjectList[i];</div>
<div class="line"><span class="lineno">  149</span>                }</div>
<div class="line"><span class="lineno">  150</span>            }</div>
<div class="line"><span class="lineno">  151</span>        }</div>
<div class="line"><span class="lineno">  152</span>        <span class="keywordflow">if</span> (verbose)</div>
<div class="line"><span class="lineno">  153</span>        {</div>
<div class="line"><span class="lineno">  154</span>            std::cout &lt;&lt; <span class="stringliteral">&quot;No &quot;</span> &lt;&lt; ObjectName &lt;&lt; <span class="stringliteral">&quot; object found! &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a></div>
<div class="line"><span class="lineno">  155</span>                      &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; thisfunctionname &lt;&lt; <span class="stringliteral">&quot;()&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  156</span>        }</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>        <span class="keywordflow">if</span>(necessary)</div>
<div class="line"><span class="lineno">  159</span>        {</div>
<div class="line"><span class="lineno">  160</span>            <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a4d6fed4ab71c6edf2a0bd5dabecc6ec6">OP_Exit</a>(13);</div>
<div class="line"><span class="lineno">  161</span>        }</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  164</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa710a4052d686aac0b3f38a9a615682e" name="aa710a4052d686aac0b3f38a9a615682e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa710a4052d686aac0b3f38a9a615682e">&#9670;&#160;</a></span>FindObjects()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static std::vector&lt; <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html">OPObject</a> * &gt; openphase::OPObject::FindObjects </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html">OPObject</a> * &gt;&#160;</td>
          <td class="paramname"><em>ObjectList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>ObjectName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>thisclassname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>thisfunctionname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>necessary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>verbose</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d1c/OPObject_8h_source.html#l00166">166</a> of file <a class="el" href="../../d5/d1c/OPObject_8h_source.html">OPObject.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  175</span>    {</div>
<div class="line"><span class="lineno">  176</span>        std::vector&lt;OPObject*&gt; result;</div>
<div class="line"><span class="lineno">  177</span> </div>
<div class="line"><span class="lineno">  178</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; ObjectList.size(); i++)</div>
<div class="line"><span class="lineno">  179</span>        {</div>
<div class="line"><span class="lineno">  180</span>            <span class="keywordflow">if</span>(ObjectList[i]-&gt;<a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>.size() &gt;= ObjectName.size())</div>
<div class="line"><span class="lineno">  181</span>            {</div>
<div class="line"><span class="lineno">  182</span>                std::string locObjectName = ObjectList[i]-&gt;thisclassname;</div>
<div class="line"><span class="lineno">  183</span>                locObjectName.resize(ObjectName.size());</div>
<div class="line"><span class="lineno">  184</span> </div>
<div class="line"><span class="lineno">  185</span>                <span class="keywordflow">if</span>(locObjectName == ObjectName)</div>
<div class="line"><span class="lineno">  186</span>                {</div>
<div class="line"><span class="lineno">  187</span>                    result.push_back(ObjectList[i]);</div>
<div class="line"><span class="lineno">  188</span>                }</div>
<div class="line"><span class="lineno">  189</span>            }</div>
<div class="line"><span class="lineno">  190</span>        }</div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span>        <span class="keywordflow">if</span>(result.size() == 0)</div>
<div class="line"><span class="lineno">  193</span>        {</div>
<div class="line"><span class="lineno">  194</span>            <span class="keywordflow">if</span> (verbose)</div>
<div class="line"><span class="lineno">  195</span>            {</div>
<div class="line"><span class="lineno">  196</span>                std::cout &lt;&lt; <span class="stringliteral">&quot;No &quot;</span> &lt;&lt; ObjectName &lt;&lt; <span class="stringliteral">&quot; objects found! &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a></div>
<div class="line"><span class="lineno">  197</span>                          &lt;&lt; thisfunctionname &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  198</span>            }</div>
<div class="line"><span class="lineno">  199</span>            <span class="keywordflow">if</span>(necessary)</div>
<div class="line"><span class="lineno">  200</span>            {</div>
<div class="line"><span class="lineno">  201</span>                <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a4d6fed4ab71c6edf2a0bd5dabecc6ec6">OP_Exit</a>(13);</div>
<div class="line"><span class="lineno">  202</span>            }</div>
<div class="line"><span class="lineno">  203</span>        }</div>
<div class="line"><span class="lineno">  204</span>        <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  205</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aeba3442a2b798b5a17d27ad07e7e23dc" name="aeba3442a2b798b5a17d27ad07e7e23dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeba3442a2b798b5a17d27ad07e7e23dc">&#9670;&#160;</a></span>FixPopulations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::FixPopulations </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Ensures positive lbPopulations. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02417">2417</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2418</span>{</div>
<div class="line"><span class="lineno"> 2419</span>    <span class="comment">// Add change in fluid nodes</span></div>
<div class="line"><span class="lineno"> 2420</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad85e2131812f1bb919f547226d6a6a3a">Do_FixPopulations</a>)</div>
<div class="line"><span class="lineno"> 2421</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>.Bcells(),)</div>
<div class="line"><span class="lineno"> 2422</span>    {</div>
<div class="line"><span class="lineno"> 2423</span>        <span class="keywordflow">if</span> (not <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k))</div>
<div class="line"><span class="lineno"> 2424</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 2425</span>        {</div>
<div class="line"><span class="lineno"> 2426</span>            <span class="keywordtype">bool</span> FixPopulation = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2427</span>            <span class="comment">// Check for negative populations and fix them</span></div>
<div class="line"><span class="lineno"> 2428</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ++ii)</div>
<div class="line"><span class="lineno"> 2429</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; ++jj)</div>
<div class="line"><span class="lineno"> 2430</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; ++kk)</div>
<div class="line"><span class="lineno"> 2431</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n})(ii,jj,kk) &lt;= 0.0)</div>
<div class="line"><span class="lineno"> 2432</span>            {</div>
<div class="line"><span class="lineno"> 2433</span>                FixPopulation = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2434</span>            }</div>
<div class="line"><span class="lineno"> 2435</span> </div>
<div class="line"><span class="lineno"> 2436</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n}) &lt;= 0.0)</div>
<div class="line"><span class="lineno"> 2437</span>            {</div>
<div class="line"><span class="lineno"> 2438</span>                FixPopulation = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2439</span>                <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a> (i,j,k,{n}) = 0.0;</div>
<div class="line"><span class="lineno"> 2440</span>                <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a>(i,j,k,{n}) = {0,0,0};</div>
<div class="line"><span class="lineno"> 2441</span>            }</div>
<div class="line"><span class="lineno"> 2442</span> </div>
<div class="line"><span class="lineno"> 2443</span>            <span class="keywordflow">if</span> (FixPopulation)</div>
<div class="line"><span class="lineno"> 2444</span>            {</div>
<div class="line"><span class="lineno"> 2445</span>                <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n}) =</div>
<div class="line"><span class="lineno"> 2446</span>                    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#acbf6f50e003944ed8daced249b20ee6e">EquilibriumDistribution</a>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92539bf6d5ed043520c0bdbc47c334a9">lbWeights</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0e7cad672eea608ab7c5ea5ed6946138">dm</a>);</div>
<div class="line"><span class="lineno"> 2447</span>            }</div>
<div class="line"><span class="lineno"> 2448</span>        }</div>
<div class="line"><span class="lineno"> 2449</span>    }</div>
<div class="line"><span class="lineno"> 2450</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 2451</span>}</div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_ad85e2131812f1bb919f547226d6a6a3a"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad85e2131812f1bb919f547226d6a6a3a">openphase::FlowSolverLBM::Do_FixPopulations</a></div><div class="ttdeci">bool Do_FixPopulations</div><div class="ttdoc">Set to &quot;true&quot; if negative Densities and Populations should be fixes.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00187">FlowSolverLBM.h:187</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a276b6c67c853abfc3b0efba1d1b1ace3" name="a276b6c67c853abfc3b0efba1d1b1ace3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a276b6c67c853abfc3b0efba1d1b1ace3">&#9670;&#160;</a></span>FluidDensity() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::FluidDensity </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns local fluid mass density summed over all components. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l03115">3115</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3116</span>{</div>
<div class="line"><span class="lineno"> 3117</span>    <span class="keywordtype">double</span> locFluidDensity = 0.0;</div>
<div class="line"><span class="lineno"> 3118</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> comp = 0; comp &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++comp)</div>
<div class="line"><span class="lineno"> 3119</span>    {</div>
<div class="line"><span class="lineno"> 3120</span>        locFluidDensity += <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5b0e69ba33a9e732b37f59f1f97763d3">FluidDensity</a>(i,j,k,comp);</div>
<div class="line"><span class="lineno"> 3121</span>    }</div>
<div class="line"><span class="lineno"> 3122</span>    <span class="keywordflow">return</span> locFluidDensity;</div>
<div class="line"><span class="lineno"> 3123</span>}</div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a5b0e69ba33a9e732b37f59f1f97763d3"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5b0e69ba33a9e732b37f59f1f97763d3">openphase::FlowSolverLBM::FluidDensity</a></div><div class="ttdeci">double FluidDensity(const int i, const int j, const int k, const size_t comp) const</div><div class="ttdoc">Returns local fluid mass density of component comp.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00261">FlowSolverLBM.h:261</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5b0e69ba33a9e732b37f59f1f97763d3" name="a5b0e69ba33a9e732b37f59f1f97763d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b0e69ba33a9e732b37f59f1f97763d3">&#9670;&#160;</a></span>FluidDensity() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::FluidDensity </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>comp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns local fluid mass density of component comp. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00261">261</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  263</span>{</div>
<div class="line"><span class="lineno">  264</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k)) <span class="keywordflow">return</span> 0.0;</div>
<div class="line"><span class="lineno">  265</span>    <span class="keywordflow">else</span>                 <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{comp});</div>
<div class="line"><span class="lineno">  266</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae8c5e37335dfc6d5022bd769dc4c6e1a" name="ae8c5e37335dfc6d5022bd769dc4c6e1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8c5e37335dfc6d5022bd769dc4c6e1a">&#9670;&#160;</a></span>FluidVelocity() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> openphase::FlowSolverLBM::FluidVelocity </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns local fluid velocity summed over all components. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l03153">3153</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3154</span>{</div>
<div class="line"><span class="lineno"> 3155</span>    <span class="keywordtype">double</span> locFluidDensity = <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5b0e69ba33a9e732b37f59f1f97763d3">FluidDensity</a>(i,j,k);</div>
<div class="line"><span class="lineno"> 3156</span>    <span class="keywordflow">if</span> ((not <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k)) and locFluidDensity &gt; DBL_EPSILON)</div>
<div class="line"><span class="lineno"> 3157</span>    {</div>
<div class="line"><span class="lineno"> 3158</span>        dVector3 locMomentumDensity{0.0,0.0,0.0};</div>
<div class="line"><span class="lineno"> 3159</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> comp = 0; comp &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++comp)</div>
<div class="line"><span class="lineno"> 3160</span>            locMomentumDensity += <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a>(i,j,k,{comp});</div>
<div class="line"><span class="lineno"> 3161</span> </div>
<div class="line"><span class="lineno"> 3162</span>        <span class="keywordflow">return</span> locMomentumDensity/locFluidDensity;</div>
<div class="line"><span class="lineno"> 3163</span>    }</div>
<div class="line"><span class="lineno"> 3164</span>    <span class="keywordflow">else</span> <span class="keywordflow">return</span> dVector3{0.0,0.0,0.0};</div>
<div class="line"><span class="lineno"> 3165</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a972e7a0a07746093679516d1bfd0970e" name="a972e7a0a07746093679516d1bfd0970e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a972e7a0a07746093679516d1bfd0970e">&#9670;&#160;</a></span>FluidVelocity() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> openphase::FlowSolverLBM::FluidVelocity </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>comp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns local fluid velocity of component comp. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l03143">3143</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3145</span>{</div>
<div class="line"><span class="lineno"> 3146</span>    <span class="keywordflow">if</span> ((not <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k)) and (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{comp}) &gt; DBL_EPSILON))</div>
<div class="line"><span class="lineno"> 3147</span>    {</div>
<div class="line"><span class="lineno"> 3148</span>        <span class="keywordflow">return</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a>(i,j,k,{comp}))/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{comp});</div>
<div class="line"><span class="lineno"> 3149</span>    }</div>
<div class="line"><span class="lineno"> 3150</span>    <span class="keywordflow">else</span> <span class="keywordflow">return</span> dVector3{0.0,0.0,0.0};</div>
<div class="line"><span class="lineno"> 3151</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab7b5d4fd526d189f269fade8896a789c" name="ab7b5d4fd526d189f269fade8896a789c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7b5d4fd526d189f269fade8896a789c">&#9670;&#160;</a></span>Initialize() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void openphase::OPObject::Initialize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;&#160;</td>
          <td class="paramname"><em>locSettings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>ObjectNameSuffix</em> = <code>&quot;&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ObjectNameSuffix</td><td>Initializes internal variables and storages </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="../../d8/da6/classopenphase_1_1Composition.html#a49a052989b244d02f4e7a3c5bb67092a">openphase::Composition</a>, <a class="el" href="../../d4/dbd/classopenphase_1_1Crystallography.html#af20107edb2201a79d70680e9d7174596">openphase::Crystallography</a>, <a class="el" href="../../d5/d5b/classopenphase_1_1DoubleObstacle.html#adcd90ecff5b0e5d4febcfa432daa52ea">openphase::DoubleObstacle</a>, <a class="el" href="../../d5/d8a/classopenphase_1_1DrivingForce.html#ad186444347389c20f2a9c82c57d88549">openphase::DrivingForce</a>, <a class="el" href="../../d3/dee/classopenphase_1_1ElasticitySolverSpectral.html#a7b248f75d2cf27f20f9c9d9f7723aa2a">openphase::ElasticitySolverSpectral</a>, <a class="el" href="../../d2/de8/classopenphase_1_1ElasticProperties.html#acb72c6046f8e161f94b73c4ba05f467f">openphase::ElasticProperties</a>, <a class="el" href="../../d5/d73/classopenphase_1_1ElectricalPotential.html#ac0368e52f1e9835ddd5342b07fea228e">openphase::ElectricalPotential</a>, <a class="el" href="../../da/d99/classopenphase_1_1ElectricProperties.html#a5de3d1c2a8847b03163ce5ec290f593c">openphase::ElectricProperties</a>, <a class="el" href="../../d8/d38/classopenphase_1_1ElectricSolverSpectral.html#a4425ccd6f78a8edfa3f8e42571f8ec5b">openphase::ElectricSolverSpectral</a>, <a class="el" href="../../d6/dd7/classopenphase_1_1EquilibriumPartitionDiffusionBinary.html#a9bae35a2a934d2c997b7738ea9925b05">openphase::EquilibriumPartitionDiffusionBinary</a>, <a class="el" href="../../d2/d9e/structopenphase_1_1InteractionSolidFluid.html#a18a309fc3778f9d0114f2d26bd040b43">openphase::InteractionSolidFluid</a>, <a class="el" href="../../d5/d17/classopenphase_1_1InteractionSolidSolid.html#aa6fe570401a6b945f487bdf68b31f045">openphase::InteractionSolidSolid</a>, <a class="el" href="../../d4/d77/classopenphase_1_1FractureField.html#a8fa33a3219e9bf0af58faf4dccd750c6">openphase::FractureField</a>, <a class="el" href="../../d8/dba/classopenphase_1_1GrandPotentialSolver.html#acc03072fe701231002c064b73f9dc050">openphase::GrandPotentialSolver</a>, <a class="el" href="../../d7/d2b/classopenphase_1_1HeatDiffusion.html#abd10629914789085fcabad8e5cd641dd">openphase::HeatDiffusion</a>, <a class="el" href="../../d1/d98/classopenphase_1_1HeatSources.html#a8fca668ab93199ee60061bf3d3ea2dc8">openphase::HeatSources</a>, <a class="el" href="../../d2/d19/classopenphase_1_1InterfaceDiffusion.html#abed8e07372aad102952101ef0030921b">openphase::InterfaceDiffusion</a>, <a class="el" href="../../d9/d6e/classopenphase_1_1InterfaceDiffusionAnisotropic.html#a9edfc3929fd61ed8466b358f90de06ef">openphase::InterfaceDiffusionAnisotropic</a>, <a class="el" href="../../db/d7a/classopenphase_1_1InterfaceProperties.html#a1dca55259333b1d1280691692d14dde4">openphase::InterfaceProperties</a>, <a class="el" href="../../d7/dca/classopenphase_1_1InterfaceRegularization.html#ae8f5ba4990e07d09bf7f220d571a702f">openphase::InterfaceRegularization</a>, <a class="el" href="../../d4/de8/classopenphase_1_1LinearMagneticSolver.html#a11b72b1623d9b9600416b5fa5d8a49bb">openphase::LinearMagneticSolver</a>, <a class="el" href="../../d9/db5/classopenphase_1_1MagneticProperties.html#aaffccd142d12fe802f6ed3eb9a719898">openphase::MagneticProperties</a>, <a class="el" href="../../dd/d85/classopenphase_1_1MassDensity.html#a0aeb220f70fa37233d2b6fe757e80c1b">openphase::MassDensity</a>, <a class="el" href="../../d5/dc6/classopenphase_1_1MechanicalLoads.html#ad8c9b1bbe6a631acd6ae0591e2c32a8c">openphase::MechanicalLoads</a>, <a class="el" href="../../d3/d17/classopenphase_1_1MovingFrame.html#a8a5b5653a8cc6d9b0baafca837509dfc">openphase::MovingFrame</a>, <a class="el" href="../../d5/d4b/classopenphase_1_1Noise.html#a998972377ed4a97de0ce07aa0d9968f4">openphase::Noise</a>, <a class="el" href="../../d3/d76/classopenphase_1_1Nucleation.html#a9940921a3a1f67a671cf3c6e0b91b06a">openphase::Nucleation</a>, <a class="el" href="../../d0/df3/classopenphase_1_1Orientations.html#afd4048102db0bb2327e278413e8d3270">openphase::Orientations</a>, <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a657703c88fcc2adf92532ffc1955661a">openphase::PhaseField</a>, <a class="el" href="../../d1/d12/classopenphase_1_1SymmetryVariants.html#a6e8cf1fbe023a2f79779913a514aa702">openphase::SymmetryVariants</a>, <a class="el" href="../../d4/d35/classopenphase_1_1Temperature.html#a0dbb5ff491305d07ef9516359d0558ef">openphase::Temperature</a>, <a class="el" href="../../d7/d6d/structopenphase_1_1AnalysisSintering.html#a3eaa83e6c8b4937571db8028760dc509">openphase::AnalysisSintering</a>, <a class="el" href="../../d0/db9/classopenphase_1_1UserDrivingForce.html#aea31591d26508762639faf5ceb1635f2">openphase::UserDrivingForce</a>, <a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html#a0c0dc3bfaa326fbef879a39ad0dd77a5">openphase::Velocities</a>, <a class="el" href="../../d6/de5/classopenphase_1_1ElasticitySolverSpectralImpl.html#a00c9b7fc79ab00d34826af308beb9043">openphase::ElasticitySolverSpectralImpl</a>, <a class="el" href="../../dd/d95/classopenphase_1_1AdvectionHR.html#ac09c3411e89753c7e4d1e111e77efd10">openphase::AdvectionHR</a>, and <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html#a2043150542ebbb8ffbe1fcdf12731146">openphase::BoundaryConditions</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d5/d1c/OPObject_8h_source.html#l00064">64</a> of file <a class="el" href="../../d5/d1c/OPObject_8h_source.html">OPObject.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   65</span>    {</div>
<div class="line"><span class="lineno">   66</span>        (void) locSettings; <span class="comment">//unused</span></div>
<div class="line"><span class="lineno">   67</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a383e16d0cc86147dd7fab19dfe18755f" name="a383e16d0cc86147dd7fab19dfe18755f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a383e16d0cc86147dd7fab19dfe18755f">&#9670;&#160;</a></span>Initialize() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::Initialize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;&#160;</td>
          <td class="paramname"><em>locSettings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::stringstream &amp;&#160;</td>
          <td class="paramname"><em>inp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>in_dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates memory and initializes global settings. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00093">93</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   94</span>{</div>
<div class="line"><span class="lineno">   95</span>    <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a> = <span class="stringliteral">&quot;FlowSolverLBM&quot;</span>;</div>
<div class="line"><span class="lineno">   96</span> </div>
<div class="line"><span class="lineno">   97</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a> = locSettings.Grid;</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>      = in_dt;</div>
<div class="line"><span class="lineno">  100</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9c5fb9cd4952a23292b686140a250279">Nphases</a> = locSettings.Nphases;</div>
<div class="line"><span class="lineno">  101</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3682fba50989e5b7ab0df48763a889d3">Ncomp</a>   = (locSettings.Ncomp &gt; 0) ? locSettings.Ncomp - 1 : 0;</div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad56f87a52b427bb6a4646208d54574c1">Pth</a>    = 1.0e05;</div>
<div class="line"><span class="lineno">  104</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a62404913cee1f48eebbf6afbeb13b5d0">PthOld</a> = 1.0e05;</div>
<div class="line"><span class="lineno">  105</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a39e6431910d6e1d9558b91d0a59f6828">Pth0</a>   = 1.0e05;</div>
<div class="line"><span class="lineno">  106</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1b542beebb14e3182c7948b30f3eefd8">Poutlet</a> = 1e-6;</div>
<div class="line"><span class="lineno">  107</span> </div>
<div class="line"><span class="lineno">  108</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5284a4950dae747d84ce23d74fd5963e">cs2</a> = <a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>;</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a6c0dc555248064b06b4d1795657c5026">ObstaclesChanged</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a852ebebddbd520319bcc8b65bffad2a3">Bcells</a> = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#aae205a52da44fe4c880a16b0f5a48cfb">Bcells</a>;</div>
<div class="line"><span class="lineno">  113</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa4faa1708afdfd505f7648f1a063d80b">ElementNames</a> = locSettings.ElementNames;</div>
<div class="line"><span class="lineno">  114</span>    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab7ec322c63819b51ebd5912de9c9d09d">ReadInput</a>(inp); <span class="comment">// NOTE N_Fluid_Comp needs to be read</span></div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#af45dd4140586881f9ed201c3b795faff">Allocate</a>               (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a852ebebddbd520319bcc8b65bffad2a3">Bcells</a>);</div>
<div class="line"><span class="lineno">  117</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a23b20c6aaa054e65abc78e1783f1a595">ObstacleAppeared</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#af45dd4140586881f9ed201c3b795faff">Allocate</a>       (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a852ebebddbd520319bcc8b65bffad2a3">Bcells</a>);</div>
<div class="line"><span class="lineno">  118</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9e20990385a07ac85eb89928bc78158c">ObstacleChangedDensity</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#af45dd4140586881f9ed201c3b795faff">Allocate</a> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a852ebebddbd520319bcc8b65bffad2a3">Bcells</a>);</div>
<div class="line"><span class="lineno">  119</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aee9af090b2f8092c793ae13a596403f7">ObstacleVanished</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#af45dd4140586881f9ed201c3b795faff">Allocate</a>       (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a852ebebddbd520319bcc8b65bffad2a3">Bcells</a>);</div>
<div class="line"><span class="lineno">  120</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#af45dd4140586881f9ed201c3b795faff">Allocate</a>         (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>, {<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>}, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a852ebebddbd520319bcc8b65bffad2a3">Bcells</a>);</div>
<div class="line"><span class="lineno">  121</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>.Allocate           (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>, {<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>}, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a852ebebddbd520319bcc8b65bffad2a3">Bcells</a>);</div>
<div class="line"><span class="lineno">  122</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a>.Allocate        (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>, {<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>}, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a852ebebddbd520319bcc8b65bffad2a3">Bcells</a>);</div>
<div class="line"><span class="lineno">  123</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>.Allocate          (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>, {<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>}, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a852ebebddbd520319bcc8b65bffad2a3">Bcells</a>);</div>
<div class="line"><span class="lineno">  124</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2ab90fa6fd8a7c36d86144281f5b0caa">lbPopulationsTMP</a>.Allocate       (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>, {<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>}, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a852ebebddbd520319bcc8b65bffad2a3">Bcells</a>);</div>
<div class="line"><span class="lineno">  125</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a62faa8027eaa45caa436c65f032bc584">nut</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#af45dd4140586881f9ed201c3b795faff">Allocate</a>                    (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>, {<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>}, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a852ebebddbd520319bcc8b65bffad2a3">Bcells</a>);</div>
<div class="line"><span class="lineno">  126</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afa690789441704b411b9252d930c2363">HydroPressure</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#af45dd4140586881f9ed201c3b795faff">Allocate</a>          (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>, {<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>}, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a852ebebddbd520319bcc8b65bffad2a3">Bcells</a>);</div>
<div class="line"><span class="lineno">  127</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2b6d93798b295d1969521ba48bdc9af1">DivVel</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#af45dd4140586881f9ed201c3b795faff">Allocate</a>                 (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>, {<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>}, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a852ebebddbd520319bcc8b65bffad2a3">Bcells</a>);</div>
<div class="line"><span class="lineno">  128</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2357615d61b1d4d4bb027c1dfa67260c">GradRho</a>.Allocate                (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>, {<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>}, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a852ebebddbd520319bcc8b65bffad2a3">Bcells</a>);</div>
<div class="line"><span class="lineno">  129</span>    </div>
<div class="line"><span class="lineno">  130</span>    <span class="keywordflow">switch</span>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_function" href="../../dc/d18/classopenphase_1_1GridParameters.html#a70ddf5c25482d7cdefe67b0d25dcd258">Active</a>())</div>
<div class="line"><span class="lineno">  131</span>    {</div>
<div class="line"><span class="lineno">  132</span>        <span class="keywordflow">case</span> 1:</div>
<div class="line"><span class="lineno">  133</span>        {</div>
<div class="line"><span class="lineno">  134</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ii = 0; ii &lt; 3; ii++)</div>
<div class="line"><span class="lineno">  135</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> jj = 0; jj &lt; 3; jj++)</div>
<div class="line"><span class="lineno">  136</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> kk = 0; kk &lt; 3; kk++)</div>
<div class="line"><span class="lineno">  137</span>            {</div>
<div class="line"><span class="lineno">  138</span>                <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92539bf6d5ed043520c0bdbc47c334a9">lbWeights</a>[ii][jj][kk] = <a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a4016a8d14e270cb724579dd425f465f0">LBStencil1D</a>[ii][jj][kk];</div>
<div class="line"><span class="lineno">  139</span>            }</div>
<div class="line"><span class="lineno">  140</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  141</span>        }</div>
<div class="line"><span class="lineno">  142</span>        <span class="keywordflow">case</span> 2:</div>
<div class="line"><span class="lineno">  143</span>        {</div>
<div class="line"><span class="lineno">  144</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ii = 0; ii &lt; 3; ii++)</div>
<div class="line"><span class="lineno">  145</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> jj = 0; jj &lt; 3; jj++)</div>
<div class="line"><span class="lineno">  146</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> kk = 0; kk &lt; 3; kk++)</div>
<div class="line"><span class="lineno">  147</span>            {</div>
<div class="line"><span class="lineno">  148</span>                <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92539bf6d5ed043520c0bdbc47c334a9">lbWeights</a>[ii][jj][kk] = <a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#ae003801abf4a476ca70fc7bdf2dfee3d">LBStencil2D</a>[ii][jj][kk];</div>
<div class="line"><span class="lineno">  149</span>            }</div>
<div class="line"><span class="lineno">  150</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  151</span>        }</div>
<div class="line"><span class="lineno">  152</span>        <span class="keywordflow">case</span> 3:</div>
<div class="line"><span class="lineno">  153</span>        {</div>
<div class="line"><span class="lineno">  154</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ii = 0; ii &lt; 3; ii++)</div>
<div class="line"><span class="lineno">  155</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> jj = 0; jj &lt; 3; jj++)</div>
<div class="line"><span class="lineno">  156</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> kk = 0; kk &lt; 3; kk++)</div>
<div class="line"><span class="lineno">  157</span>            {</div>
<div class="line"><span class="lineno">  158</span>                <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92539bf6d5ed043520c0bdbc47c334a9">lbWeights</a>[ii][jj][kk] = <a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#aee944ab5007d26632ce2a86a0df89fd2">LBStencil3D</a>[ii][jj][kk];</div>
<div class="line"><span class="lineno">  159</span>            }</div>
<div class="line"><span class="lineno">  160</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  161</span>        }</div>
<div class="line"><span class="lineno">  162</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  163</span>        {</div>
<div class="line"><span class="lineno">  164</span> </div>
<div class="line"><span class="lineno">  165</span>        }</div>
<div class="line"><span class="lineno">  166</span>    }</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#af665bb9655e7117ac70af33f7c40ef9f">Bcells</a>(),)</div>
<div class="line"><span class="lineno">  169</span>    {</div>
<div class="line"><span class="lineno">  170</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>               (i,j,k) = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  171</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a23b20c6aaa054e65abc78e1783f1a595">ObstacleAppeared</a>       (i,j,k) = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  172</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9e20990385a07ac85eb89928bc78158c">ObstacleChangedDensity</a> (i,j,k) = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  173</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aee9af090b2f8092c793ae13a596403f7">ObstacleVanished</a>       (i,j,k) = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno">  176</span>        {</div>
<div class="line"><span class="lineno">  177</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>   (i,j,k,{n}) = 0.0;</div>
<div class="line"><span class="lineno">  178</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afa690789441704b411b9252d930c2363">HydroPressure</a>    (i,j,k,{n}) = 0.0;</div>
<div class="line"><span class="lineno">  179</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2b6d93798b295d1969521ba48bdc9af1">DivVel</a>           (i,j,k,{n}) = 0.0;</div>
<div class="line"><span class="lineno">  180</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2357615d61b1d4d4bb027c1dfa67260c">GradRho</a>          (i,j,k,{n}).set_to_zero();</div>
<div class="line"><span class="lineno">  181</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>     (i,j,k,{n}).set_to_zero();</div>
<div class="line"><span class="lineno">  182</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a>  (i,j,k,{n}).set_to_zero();</div>
<div class="line"><span class="lineno">  183</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>    (i,j,k,{n}).set_to_zero();</div>
<div class="line"><span class="lineno">  184</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2ab90fa6fd8a7c36d86144281f5b0caa">lbPopulationsTMP</a> (i,j,k,{n}).set_to_zero();</div>
<div class="line"><span class="lineno">  185</span>        }</div>
<div class="line"><span class="lineno">  186</span>    }</div>
<div class="line"><span class="lineno">  187</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  188</span> </div>
<div class="line"><span class="lineno">  189</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5e9e538e60ba43e77acb1cc88b20a316">InitialTotalMass</a> = -1.0;</div>
<div class="line"><span class="lineno">  190</span> </div>
<div class="line"><span class="lineno">  191</span>    locSettings.AddForAdvection(*<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno">  192</span>    locSettings.AddForRemeshing(*<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno">  193</span>    locSettings.AddForReading(*<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno">  194</span> </div>
<div class="line"><span class="lineno">  195</span>    <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#aa112048d179026f359161b1f20e5e98e">initialized</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  196</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a41683f616ffa4631340cb0de41cad70f">ConsoleOutput::Write</a>(<a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, <span class="stringliteral">&quot;Initialized&quot;</span>);</div>
<div class="line"><span class="lineno">  197</span>}</div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a1b542beebb14e3182c7948b30f3eefd8"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1b542beebb14e3182c7948b30f3eefd8">openphase::FlowSolverLBM::Poutlet</a></div><div class="ttdeci">double Poutlet</div><div class="ttdoc">Outlet Hydrodynamic Pressure [Pa].</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00203">FlowSolverLBM.h:203</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a2ab90fa6fd8a7c36d86144281f5b0caa"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2ab90fa6fd8a7c36d86144281f5b0caa">openphase::FlowSolverLBM::lbPopulationsTMP</a></div><div class="ttdeci">Storage3D&lt; D3Q27, 1 &gt; lbPopulationsTMP</div><div class="ttdoc">Temporary array for Populations PDF propagation.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00169">FlowSolverLBM.h:169</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a39e6431910d6e1d9558b91d0a59f6828"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a39e6431910d6e1d9558b91d0a59f6828">openphase::FlowSolverLBM::Pth0</a></div><div class="ttdeci">double Pth0</div><div class="ttdoc">Initial Thermodynamic Pressure [Pa].</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00202">FlowSolverLBM.h:202</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a62404913cee1f48eebbf6afbeb13b5d0"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a62404913cee1f48eebbf6afbeb13b5d0">openphase::FlowSolverLBM::PthOld</a></div><div class="ttdeci">double PthOld</div><div class="ttdoc">Thermodynamic Pressure for previous time step [Pa].</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00201">FlowSolverLBM.h:201</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a852ebebddbd520319bcc8b65bffad2a3"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a852ebebddbd520319bcc8b65bffad2a3">openphase::FlowSolverLBM::Bcells</a></div><div class="ttdeci">int Bcells</div><div class="ttdoc">Number of boundary cells.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00232">FlowSolverLBM.h:232</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a9c5fb9cd4952a23292b686140a250279"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9c5fb9cd4952a23292b686140a250279">openphase::FlowSolverLBM::Nphases</a></div><div class="ttdeci">size_t Nphases</div><div class="ttdoc">Number of thermodynamic phases per grain.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00228">FlowSolverLBM.h:228</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a9e20990385a07ac85eb89928bc78158c"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9e20990385a07ac85eb89928bc78158c">openphase::FlowSolverLBM::ObstacleChangedDensity</a></div><div class="ttdeci">Storage3D&lt; int, 0 &gt; ObstacleChangedDensity</div><div class="ttdoc">True if nearby obstacle changed local density.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00172">FlowSolverLBM.h:172</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_aa4faa1708afdfd505f7648f1a063d80b"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa4faa1708afdfd505f7648f1a063d80b">openphase::FlowSolverLBM::ElementNames</a></div><div class="ttdeci">std::vector&lt; std::string &gt; ElementNames</div><div class="ttdoc">Names of chemical elements.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00252">FlowSolverLBM.h:252</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_ab7ec322c63819b51ebd5912de9c9d09d"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab7ec322c63819b51ebd5912de9c9d09d">openphase::FlowSolverLBM::ReadInput</a></div><div class="ttdeci">void ReadInput(const std::string InputFileName) override</div><div class="ttdoc">Reads input parameters from a file.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00199">FlowSolverLBM.cpp:199</a></div></div>
<div class="ttc" id="aclassopenphase_1_1GridParameters_html_a70ddf5c25482d7cdefe67b0d25dcd258"><div class="ttname"><a href="../../dc/d18/classopenphase_1_1GridParameters.html#a70ddf5c25482d7cdefe67b0d25dcd258">openphase::GridParameters::Active</a></div><div class="ttdeci">int Active(void) const</div><div class="ttdoc">&lt; Indicates dimensionality, e.g. 1D, 2D or 3D</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d68/GridParameters_8h_source.html#l00060">GridParameters.h:60</a></div></div>
<div class="ttc" id="aclassopenphase_1_1GridParameters_html_aae205a52da44fe4c880a16b0f5a48cfb"><div class="ttname"><a href="../../dc/d18/classopenphase_1_1GridParameters.html#aae205a52da44fe4c880a16b0f5a48cfb">openphase::GridParameters::Bcells</a></div><div class="ttdeci">int Bcells</div><div class="ttdoc">Number of boundary cells for setting the boundary conditions.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d68/GridParameters_8h_source.html#l00167">GridParameters.h:167</a></div></div>
<div class="ttc" id="aclassopenphase_1_1OPObject_html_aa112048d179026f359161b1f20e5e98e"><div class="ttname"><a href="../../d6/dcd/classopenphase_1_1OPObject.html#aa112048d179026f359161b1f20e5e98e">openphase::OPObject::initialized</a></div><div class="ttdeci">bool initialized</div><div class="ttdoc">True if obect's Initialize has been executed.</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d1c/OPObject_8h_source.html#l00057">OPObject.h:57</a></div></div>
<div class="ttc" id="aclassopenphase_1_1Storage3D_html_af45dd4140586881f9ed201c3b795faff"><div class="ttname"><a href="../../da/d19/classopenphase_1_1Storage3D.html#af45dd4140586881f9ed201c3b795faff">openphase::Storage3D::Allocate</a></div><div class="ttdeci">void Allocate(const long int nx, const long int ny, const long int nz, const long int dnx, const long int dny, const long int dnz, const std::array&lt; size_t, Rank &gt; nn, const long int bc)</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d8e/Storage3D_8h_source.html#l00535">Storage3D.h:535</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_a4016a8d14e270cb724579dd425f465f0"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a4016a8d14e270cb724579dd425f465f0">openphase::LBStencil1D</a></div><div class="ttdeci">const double LBStencil1D[3][3][3]</div><div class="ttdoc">D1Q3 lattice Boltzmann stencil.</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d0b/D3Q27_8h_source.html#l00041">D3Q27.h:41</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_ae003801abf4a476ca70fc7bdf2dfee3d"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#ae003801abf4a476ca70fc7bdf2dfee3d">openphase::LBStencil2D</a></div><div class="ttdeci">const double LBStencil2D[3][3][3]</div><div class="ttdoc">D2Q9 lattice Boltzmann stencil.</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d0b/D3Q27_8h_source.html#l00053">D3Q27.h:53</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_aee944ab5007d26632ce2a86a0df89fd2"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#aee944ab5007d26632ce2a86a0df89fd2">openphase::LBStencil3D</a></div><div class="ttdeci">const double LBStencil3D[3][3][3]</div><div class="ttdoc">D3Q27 lattice Boltzmann stencil.</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d0b/D3Q27_8h_source.html#l00065">D3Q27.h:65</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac4ec54c388c612d6a3e22d224ec5106e" name="ac4ec54c388c612d6a3e22d224ec5106e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4ec54c388c612d6a3e22d224ec5106e">&#9670;&#160;</a></span>lbWriteVTK()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::lbWriteVTK </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;&#160;</td>
          <td class="paramname"><em>locSettings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>tStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>precision</em> = <code>16</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes physical fields values into file with <a class="el" href="../../d3/d89/structopenphase_1_1VTK.html" title="&lt; static class to write VTK data in xml format">VTK</a> format. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00680">680</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  681</span>{</div>
<div class="line"><span class="lineno">  682</span>    std::vector&lt;VTK::Field_t&gt; ListOfFields;</div>
<div class="line"><span class="lineno">  683</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno">  684</span>    {</div>
<div class="line"><span class="lineno">  685</span>        ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;DensityWetting_&quot;</span> +std::to_string(n), [n, <span class="keyword">this</span>] (<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>;}});</div>
<div class="line"><span class="lineno">  686</span>    }</div>
<div class="line"><span class="lineno">  687</span>    ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;Density&quot;</span>,  [<span class="keyword">this</span>, &amp;<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa47e5e7286c14822bf4c30efecfecf6a">Density</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>,i,j,k)/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>;}});</div>
<div class="line"><span class="lineno">  688</span>    ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;Pressure&quot;</span>, [<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a286f1c691a57f5d5c8b1b217f86cd328">Pressure</a>(i,j,k)/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a83cd87469986a195f9a42c9fbff2f523">dP</a>;}});</div>
<div class="line"><span class="lineno">  689</span>    ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;Obstacle&quot;</span>, [<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> int(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k));}});</div>
<div class="line"><span class="lineno">  690</span>    std::string Filename = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a19ed8803c3eb456f4708ccc6c6edd995">FileInterface::MakeFileName</a>(locSettings.VTKDir, <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>+<span class="stringliteral">&quot;_lattice_units_&quot;</span>, tStep, <span class="stringliteral">&quot;.vts&quot;</span>);</div>
<div class="line"><span class="lineno">  691</span> </div>
<div class="line"><span class="lineno">  692</span>    <a class="code hl_function" href="../../d3/d89/structopenphase_1_1VTK.html#a7617ede48a3aded40ba2eb72d60447f1">VTK::Write</a>(Filename, locSettings, ListOfFields, precision);</div>
<div class="line"><span class="lineno">  693</span>}</div>
<div class="ttc" id="aclassopenphase_1_1FileInterface_html_a19ed8803c3eb456f4708ccc6c6edd995"><div class="ttname"><a href="../../d2/d61/classopenphase_1_1FileInterface.html#a19ed8803c3eb456f4708ccc6c6edd995">openphase::FileInterface::MakeFileName</a></div><div class="ttdeci">static std::string MakeFileName(std::string Directory, std::string NameBase, int Index, std::string FileExtension)</div><div class="ttdoc">Creates full filename string using the location directory, name base, running index and file extensio...</div><div class="ttdef"><b>Definition</b> <a href="../../df/de6/FileInterface_8cpp_source.html#l00108">FileInterface.cpp:108</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a286f1c691a57f5d5c8b1b217f86cd328"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a286f1c691a57f5d5c8b1b217f86cd328">openphase::FlowSolverLBM::Pressure</a></div><div class="ttdeci">double Pressure(const int i, const int j, const int k) const</div><div class="ttdoc">Calculates the pressure at the point (i,j,k)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02894">FlowSolverLBM.cpp:2894</a></div></div>
<div class="ttc" id="astructopenphase_1_1VTK_html_a7617ede48a3aded40ba2eb72d60447f1"><div class="ttname"><a href="../../d3/d89/structopenphase_1_1VTK.html#a7617ede48a3aded40ba2eb72d60447f1">openphase::VTK::Write</a></div><div class="ttdeci">static void Write(const std::string Filename, const Settings &amp;locSettings, std::vector&lt; Field_t &gt; ListOfFields, const int precision=16, const int resolution=1)</div><div class="ttdoc">Writes a list of fields which returns a double into a VTK file.</div><div class="ttdef"><b>Definition</b> <a href="../../d2/de8/VTK_8cpp_source.html#l00075">VTK.cpp:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa33850567674314633589a61d1714cbe" name="aa33850567674314633589a61d1714cbe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa33850567674314633589a61d1714cbe">&#9670;&#160;</a></span>LocalObstacle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::FlowSolverLBM::LocalObstacle </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if obstacle has been detected at (i,j,k) </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02100">2100</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2101</span>{</div>
<div class="line"><span class="lineno"> 2102</span>    <span class="comment">//return SingleSolid(i,j,k,Phase);</span></div>
<div class="line"><span class="lineno"> 2103</span>    <span class="keywordflow">return</span> (<a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a90657b1ab921a0b66ebe8201a939dddf">SolidFraction</a>(i,j,k,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>) &gt;= 0.95);</div>
<div class="line"><span class="lineno"> 2104</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2dbefda68bf2a6123a095d4776f67cab" name="a2dbefda68bf2a6123a095d4776f67cab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2dbefda68bf2a6123a095d4776f67cab">&#9670;&#160;</a></span>MoveFrame()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void openphase::OPObject::MoveFrame </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>dz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">BC</td><td>Shifts the data in 3D storages by dx, dy and dz (they should be 0, -1 or +1) in x, y or z direction, correspondingly. </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="../../dd/d85/classopenphase_1_1MassDensity.html#a6fdd87ac8552c0050bd83b4c6620c180">openphase::MassDensity</a>, <a class="el" href="../../d8/da6/classopenphase_1_1Composition.html#ada44a6da5a526c3eaff543c91b964b1c">openphase::Composition</a>, <a class="el" href="../../d3/d76/classopenphase_1_1Nucleation.html#a66356950cae6def1bda83d894bca859d">openphase::Nucleation</a>, <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#aac075854614724322a8b23dfb874ea2f">openphase::PhaseField</a>, <a class="el" href="../../d4/d35/classopenphase_1_1Temperature.html#a3ca9a283c031d7f260265252bc5db839">openphase::Temperature</a>, and <a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html#ae69458aeb8a6ffe849ee05253a7b77ad">openphase::Velocities</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d5/d1c/OPObject_8h_source.html#l00079">79</a> of file <a class="el" href="../../d5/d1c/OPObject_8h_source.html">OPObject.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   81</span>    {</div>
<div class="line"><span class="lineno">   82</span>            (void) dx; <span class="comment">//unused</span></div>
<div class="line"><span class="lineno">   83</span>            (void) dy; <span class="comment">//unused</span></div>
<div class="line"><span class="lineno">   84</span>            (void) dz; <span class="comment">//unused</span></div>
<div class="line"><span class="lineno">   85</span>            (void) BC; <span class="comment">//unused</span></div>
<div class="line"><span class="lineno">   86</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aba4b86e4e17ee5fd4e9afca6855b1719" name="aba4b86e4e17ee5fd4e9afca6855b1719"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba4b86e4e17ee5fd4e9afca6855b1719">&#9670;&#160;</a></span>OptimalParaKuper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::OptimalParaKuper </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>ReducedTemperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>GasPrameter</em> = <code>0.01</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates the optimal Parameter ParaKuper. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l03033">3033</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3035</span>{</div>
<div class="line"><span class="lineno"> 3036</span>    <span class="keyword">const</span> std::vector&lt;std::vector&lt;double&gt;&gt; OptimalValues =</div>
<div class="line"><span class="lineno"> 3037</span>        {{2.0000000000000018e-01,-1.4092641421153448e-01},</div>
<div class="line"><span class="lineno"> 3038</span>         {3.0000000000000016e-01,-1.4776128416548723e-01},</div>
<div class="line"><span class="lineno"> 3039</span>         {4.0000000000000013e-01,-1.4973625604844859e-01},</div>
<div class="line"><span class="lineno"> 3040</span>         {5.0000000000000011e-01,-1.5026704234216137e-01},</div>
<div class="line"><span class="lineno"> 3041</span>         {6.0000000000000009e-01,-1.5023912552780752e-01},</div>
<div class="line"><span class="lineno"> 3042</span>         {7.0000000000000007e-01,-1.4788430943930206e-01},</div>
<div class="line"><span class="lineno"> 3043</span>         {8.0000000000000004e-01,-1.4180410847718788e-01},</div>
<div class="line"><span class="lineno"> 3044</span>         {9.0000000000000002e-01,-7.8369694891999728e-02}};</div>
<div class="line"><span class="lineno"> 3045</span> </div>
<div class="line"><span class="lineno"> 3046</span>    <span class="comment">// Return smallest temperature if temperature is too small</span></div>
<div class="line"><span class="lineno"> 3047</span>    <span class="keywordflow">if</span> (OptimalValues.front()[0] &gt; ReducedTemperature) <span class="keywordflow">return</span> OptimalValues.front()[1];</div>
<div class="line"><span class="lineno"> 3048</span> </div>
<div class="line"><span class="lineno"> 3049</span>    <span class="comment">// Search for optimal value</span></div>
<div class="line"><span class="lineno"> 3050</span>    std::vector&lt;double&gt; PreviousValue = OptimalValues[0];</div>
<div class="line"><span class="lineno"> 3051</span>    std::vector&lt;double&gt; Interpolated  = {0.0,0.0};</div>
<div class="line"><span class="lineno"> 3052</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a109a9856c6c1a62d6681238bfcab964aa689202409e48743b914713f96d93947c">Value</a>: OptimalValues)</div>
<div class="line"><span class="lineno"> 3053</span>    {</div>
<div class="line"><span class="lineno"> 3054</span>        <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a109a9856c6c1a62d6681238bfcab964aa689202409e48743b914713f96d93947c">Value</a>[0] == ReducedTemperature)</div>
<div class="line"><span class="lineno"> 3055</span>        {</div>
<div class="line"><span class="lineno"> 3056</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a109a9856c6c1a62d6681238bfcab964aa689202409e48743b914713f96d93947c">Value</a>[1];</div>
<div class="line"><span class="lineno"> 3057</span>        }</div>
<div class="line"><span class="lineno"> 3058</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ReducedTemperature &lt; <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a109a9856c6c1a62d6681238bfcab964aa689202409e48743b914713f96d93947c">Value</a>[0] and</div>
<div class="line"><span class="lineno"> 3059</span>                 ReducedTemperature &gt; PreviousValue[0])</div>
<div class="line"><span class="lineno"> 3060</span>        {</div>
<div class="line"><span class="lineno"> 3061</span>            Interpolated = PreviousValue;</div>
<div class="line"><span class="lineno"> 3062</span> </div>
<div class="line"><span class="lineno"> 3063</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> dT = (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a109a9856c6c1a62d6681238bfcab964aa689202409e48743b914713f96d93947c">Value</a>[0]-PreviousValue[0]);</div>
<div class="line"><span class="lineno"> 3064</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> DT = (ReducedTemperature-PreviousValue[0]);</div>
<div class="line"><span class="lineno"> 3065</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> A  = DT/dT;</div>
<div class="line"><span class="lineno"> 3066</span> </div>
<div class="line"><span class="lineno"> 3067</span>            Interpolated[0] = ReducedTemperature;</div>
<div class="line"><span class="lineno"> 3068</span>            Interpolated[1] += (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a109a9856c6c1a62d6681238bfcab964aa689202409e48743b914713f96d93947c">Value</a>[1] - PreviousValue[1])*A;</div>
<div class="line"><span class="lineno"> 3069</span> </div>
<div class="line"><span class="lineno"> 3070</span>            <span class="keywordflow">return</span> Interpolated[1];</div>
<div class="line"><span class="lineno"> 3071</span>        }</div>
<div class="line"><span class="lineno"> 3072</span>        PreviousValue = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a109a9856c6c1a62d6681238bfcab964aa689202409e48743b914713f96d93947c">Value</a>;</div>
<div class="line"><span class="lineno"> 3073</span>    }</div>
<div class="line"><span class="lineno"> 3074</span>    <span class="keywordflow">return</span> PreviousValue[1];</div>
<div class="line"><span class="lineno"> 3075</span>}</div>
<div class="ttc" id="anamespaceopenphase_html_a109a9856c6c1a62d6681238bfcab964aa689202409e48743b914713f96d93947c"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a109a9856c6c1a62d6681238bfcab964aa689202409e48743b914713f96d93947c">openphase::TripleJunctionModels::Value</a></div><div class="ttdeci">@ Value</div><div class="ttdoc">User specified triple junction energy value.</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a286f1c691a57f5d5c8b1b217f86cd328" name="a286f1c691a57f5d5c8b1b217f86cd328"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a286f1c691a57f5d5c8b1b217f86cd328">&#9670;&#160;</a></span>Pressure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::Pressure </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the pressure at the point (i,j,k) </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02894">2894</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2895</span>{</div>
<div class="line"><span class="lineno"> 2896</span>    <span class="keywordtype">double</span> <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a286f1c691a57f5d5c8b1b217f86cd328">Pressure</a> = 0.0;</div>
<div class="line"><span class="lineno"> 2897</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k))</div>
<div class="line"><span class="lineno"> 2898</span>    {</div>
<div class="line"><span class="lineno"> 2899</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae9bc290fd900003e6984f319eb544269">Do_Kupershtokh</a>)</div>
<div class="line"><span class="lineno"> 2900</span>        {</div>
<div class="line"><span class="lineno"> 2901</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 2902</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n}) &gt; DBL_EPSILON)</div>
<div class="line"><span class="lineno"> 2903</span>            {</div>
<div class="line"><span class="lineno"> 2904</span>                <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a286f1c691a57f5d5c8b1b217f86cd328">Pressure</a> += <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab8df6700e0802a129069281b338313d7">lbCriticalPressure</a>[n]*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a83cd87469986a195f9a42c9fbff2f523">dP</a>*<a class="code hl_function" href="../../dc/dbb/structopenphase_1_1VanDerWaalsGas.html#a45f34eb35b2caf8f326acab3453ac5df">VanDerWaalsGas::ReducedPressure</a>(</div>
<div class="line"><span class="lineno"> 2905</span>                        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a135999305b00dce046d03db79817e69e">lbTemperature</a>[n], <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a66544929ec9e15f973b2d349787a5993">CriticalDensity</a>[n]/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a405aa37be090a3d967abab6df1f941ba">lbCriticalTemperature</a>[n]);</div>
<div class="line"><span class="lineno"> 2906</span>            }</div>
<div class="line"><span class="lineno"> 2907</span>        }</div>
<div class="line"><span class="lineno"> 2908</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab45097494cc01fa93c7420778061d7ed">Do_Benzi</a>)</div>
<div class="line"><span class="lineno"> 2909</span>        {</div>
<div class="line"><span class="lineno"> 2910</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 2911</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n}) &gt; DBL_EPSILON)</div>
<div class="line"><span class="lineno"> 2912</span>            {</div>
<div class="line"><span class="lineno"> 2913</span>                <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; rho   = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n});</div>
<div class="line"><span class="lineno"> 2914</span>                <span class="keyword">const</span> <span class="keywordtype">double</span> locPsi = <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>(rho,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7cd6cc5ca27add2432f5809f9d45ca03">rho_0</a>[n]);</div>
<div class="line"><span class="lineno"> 2915</span> </div>
<div class="line"><span class="lineno"> 2916</span>                <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a286f1c691a57f5d5c8b1b217f86cd328">Pressure</a> += <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5284a4950dae747d84ce23d74fd5963e">cs2</a>*rho + 0.5*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5284a4950dae747d84ce23d74fd5963e">cs2</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a587965ea13dcb7fddac42b87da1df7cf">Gb</a>[n][n]*locPsi*locPsi;</div>
<div class="line"><span class="lineno"> 2917</span>            }</div>
<div class="line"><span class="lineno"> 2918</span>        }</div>
<div class="line"><span class="lineno"> 2919</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7c63a86b32c4126fb329829acf6af13c">Do_ThermalComp</a>)</div>
<div class="line"><span class="lineno"> 2920</span>        {</div>
<div class="line"><span class="lineno"> 2921</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 2922</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n}) &gt; DBL_EPSILON)</div>
<div class="line"><span class="lineno"> 2923</span>            {</div>
<div class="line"><span class="lineno"> 2924</span>                <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a286f1c691a57f5d5c8b1b217f86cd328">Pressure</a> += <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afa690789441704b411b9252d930c2363">HydroPressure</a>(i,j,k,{n});</div>
<div class="line"><span class="lineno"> 2925</span>            }</div>
<div class="line"><span class="lineno"> 2926</span>        }</div>
<div class="line"><span class="lineno"> 2927</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2928</span>        {</div>
<div class="line"><span class="lineno"> 2929</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 2930</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n}) &gt; DBL_EPSILON)</div>
<div class="line"><span class="lineno"> 2931</span>            {</div>
<div class="line"><span class="lineno"> 2932</span>                <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; rho = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n});</div>
<div class="line"><span class="lineno"> 2933</span> </div>
<div class="line"><span class="lineno"> 2934</span>                <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a286f1c691a57f5d5c8b1b217f86cd328">Pressure</a> += <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5284a4950dae747d84ce23d74fd5963e">cs2</a>*rho;</div>
<div class="line"><span class="lineno"> 2935</span>            }</div>
<div class="line"><span class="lineno"> 2936</span>        }</div>
<div class="line"><span class="lineno"> 2937</span>    }</div>
<div class="line"><span class="lineno"> 2938</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a286f1c691a57f5d5c8b1b217f86cd328">Pressure</a>;</div>
<div class="line"><span class="lineno"> 2939</span>}</div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_ab8df6700e0802a129069281b338313d7"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab8df6700e0802a129069281b338313d7">openphase::FlowSolverLBM::lbCriticalPressure</a></div><div class="ttdeci">std::vector&lt; double &gt; lbCriticalPressure</div><div class="ttdoc">Critical Pressure for Kupersthok (Van der Waal)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00243">FlowSolverLBM.h:243</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a59bb2f04263441de9c1e65b8555e53f1" name="a59bb2f04263441de9c1e65b8555e53f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59bb2f04263441de9c1e65b8555e53f1">&#9670;&#160;</a></span>PressureTensor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a> openphase::FlowSolverLBM::PressureTensor </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the pressure tensor at the point (i,j,k) </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02941">2941</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2942</span>{</div>
<div class="line"><span class="lineno"> 2943</span>    dMatrix3x3 <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a286f1c691a57f5d5c8b1b217f86cd328">Pressure</a>({0,0,0,0,0,0,0,0,0});</div>
<div class="line"><span class="lineno"> 2944</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae9bc290fd900003e6984f319eb544269">Do_Kupershtokh</a>)</div>
<div class="line"><span class="lineno"> 2945</span>    {</div>
<div class="line"><span class="lineno"> 2946</span>        dMatrix3x3 lbPressure({0,0,0,0,0,0,0,0,0});</div>
<div class="line"><span class="lineno"> 2947</span>        <span class="comment">//Info::WriteWarning(&quot;Pressure tensor calculation is inaccurate&quot;, thisclassname, &quot;PressureTensor&quot;);</span></div>
<div class="line"><span class="lineno"> 2948</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 2949</span>        {</div>
<div class="line"><span class="lineno"> 2950</span>            <span class="keywordtype">double</span> LaplacianPhi    = 0.0;</div>
<div class="line"><span class="lineno"> 2951</span>            <span class="keywordtype">double</span> GradPhi[3]      = {0,0,0};</div>
<div class="line"><span class="lineno"> 2952</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> weight[3] = {-0.5,0.0,0.5};</div>
<div class="line"><span class="lineno"> 2953</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = -1; ii &lt;= 1; ii++)</div>
<div class="line"><span class="lineno"> 2954</span>            {</div>
<div class="line"><span class="lineno"> 2955</span>                <span class="keyword">const</span> <span class="keywordtype">double</span> pi = <a class="code hl_function" href="../../dc/dbb/structopenphase_1_1VanDerWaalsGas.html#a45f34eb35b2caf8f326acab3453ac5df">VanDerWaalsGas::ReducedPressure</a>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i+ii,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a135999305b00dce046d03db79817e69e">lbTemperature</a>[n], <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a66544929ec9e15f973b2d349787a5993">CriticalDensity</a>[n]/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a405aa37be090a3d967abab6df1f941ba">lbCriticalTemperature</a>[n]);</div>
<div class="line"><span class="lineno"> 2956</span>                <span class="keyword">const</span> <span class="keywordtype">double</span> pj = <a class="code hl_function" href="../../dc/dbb/structopenphase_1_1VanDerWaalsGas.html#a45f34eb35b2caf8f326acab3453ac5df">VanDerWaalsGas::ReducedPressure</a>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j+ii,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a135999305b00dce046d03db79817e69e">lbTemperature</a>[n], <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a66544929ec9e15f973b2d349787a5993">CriticalDensity</a>[n]/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a405aa37be090a3d967abab6df1f941ba">lbCriticalTemperature</a>[n]);</div>
<div class="line"><span class="lineno"> 2957</span>                <span class="keyword">const</span> <span class="keywordtype">double</span> pk = <a class="code hl_function" href="../../dc/dbb/structopenphase_1_1VanDerWaalsGas.html#a45f34eb35b2caf8f326acab3453ac5df">VanDerWaalsGas::ReducedPressure</a>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k+ii,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a135999305b00dce046d03db79817e69e">lbTemperature</a>[n], <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a66544929ec9e15f973b2d349787a5993">CriticalDensity</a>[n]/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a405aa37be090a3d967abab6df1f941ba">lbCriticalTemperature</a>[n]);</div>
<div class="line"><span class="lineno"> 2958</span> </div>
<div class="line"><span class="lineno"> 2959</span>                GradPhi[0] += weight[ii+1]*<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a44913b19d54d780a4b9e00fcab11cbb6">Phi</a>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i+ii,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>, pi, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a11c6271193ddf1f694f1bfc4227bf617">GasParameter</a>[n]);</div>
<div class="line"><span class="lineno"> 2960</span>                GradPhi[1] += weight[ii+1]*<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a44913b19d54d780a4b9e00fcab11cbb6">Phi</a>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j+ii,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>, pj, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a11c6271193ddf1f694f1bfc4227bf617">GasParameter</a>[n]);</div>
<div class="line"><span class="lineno"> 2961</span>                GradPhi[2] += weight[ii+1]*<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a44913b19d54d780a4b9e00fcab11cbb6">Phi</a>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k+ii,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>, pk, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a11c6271193ddf1f694f1bfc4227bf617">GasParameter</a>[n]);</div>
<div class="line"><span class="lineno"> 2962</span>            }</div>
<div class="line"><span class="lineno"> 2963</span> </div>
<div class="line"><span class="lineno"> 2964</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii++)</div>
<div class="line"><span class="lineno"> 2965</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj++)</div>
<div class="line"><span class="lineno"> 2966</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk++)</div>
<div class="line"><span class="lineno"> 2967</span>            {</div>
<div class="line"><span class="lineno"> 2968</span>                <span class="keyword">const</span> <span class="keywordtype">double</span> pijk = <a class="code hl_function" href="../../dc/dbb/structopenphase_1_1VanDerWaalsGas.html#a45f34eb35b2caf8f326acab3453ac5df">VanDerWaalsGas::ReducedPressure</a>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i+ii,j+jj,k+kk,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a135999305b00dce046d03db79817e69e">lbTemperature</a>[n], <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a66544929ec9e15f973b2d349787a5993">CriticalDensity</a>[n]/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a405aa37be090a3d967abab6df1f941ba">lbCriticalTemperature</a>[n]);</div>
<div class="line"><span class="lineno"> 2969</span>                LaplacianPhi += <a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a308506fb01f248e342986c5b57ad1f88">LaplacianStencil3D_27a</a>[ii+1][jj+1][kk+1]*</div>
<div class="line"><span class="lineno"> 2970</span>                    <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a44913b19d54d780a4b9e00fcab11cbb6">Phi</a>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i+ii,j+jj,k+kk,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>, pijk , <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a11c6271193ddf1f694f1bfc4227bf617">GasParameter</a>[n]);</div>
<div class="line"><span class="lineno"> 2971</span>            }</div>
<div class="line"><span class="lineno"> 2972</span> </div>
<div class="line"><span class="lineno"> 2973</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> locPhi  = <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a44913b19d54d780a4b9e00fcab11cbb6">Phi</a>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>, <a class="code hl_function" href="../../dc/dbb/structopenphase_1_1VanDerWaalsGas.html#a45f34eb35b2caf8f326acab3453ac5df">VanDerWaalsGas::ReducedPressure</a>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a135999305b00dce046d03db79817e69e">lbTemperature</a>[n], <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a66544929ec9e15f973b2d349787a5993">CriticalDensity</a>[n]/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a405aa37be090a3d967abab6df1f941ba">lbCriticalTemperature</a>[n]), <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a11c6271193ddf1f694f1bfc4227bf617">GasParameter</a>[n]);</div>
<div class="line"><span class="lineno"> 2974</span> </div>
<div class="line"><span class="lineno"> 2975</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> GradPhi2 =</div>
<div class="line"><span class="lineno"> 2976</span>                GradPhi[0]*GradPhi[0] +</div>
<div class="line"><span class="lineno"> 2977</span>                GradPhi[1]*GradPhi[1] +</div>
<div class="line"><span class="lineno"> 2978</span>                GradPhi[2]*GradPhi[2];</div>
<div class="line"><span class="lineno"> 2979</span> </div>
<div class="line"><span class="lineno"> 2980</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> lbp0 = <a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a></div>
<div class="line"><span class="lineno"> 2981</span>                - 6.0*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a587965ea13dcb7fddac42b87da1df7cf">Gb</a>[n][n]/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>*0.50*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>*locPhi*locPhi</div>
<div class="line"><span class="lineno"> 2982</span>                - 6.0*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a587965ea13dcb7fddac42b87da1df7cf">Gb</a>[n][n]/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>*0.50*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>*locPhi*LaplacianPhi</div>
<div class="line"><span class="lineno"> 2983</span>                - 6.0*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a587965ea13dcb7fddac42b87da1df7cf">Gb</a>[n][n]/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>*0.25*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>*GradPhi2;</div>
<div class="line"><span class="lineno"> 2984</span> </div>
<div class="line"><span class="lineno"> 2985</span>            lbPressure(0,0) += lbp0;</div>
<div class="line"><span class="lineno"> 2986</span>            lbPressure(1,1) += lbp0;</div>
<div class="line"><span class="lineno"> 2987</span>            lbPressure(2,2) += lbp0;</div>
<div class="line"><span class="lineno"> 2988</span> </div>
<div class="line"><span class="lineno"> 2989</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii &lt; 3; ii++)</div>
<div class="line"><span class="lineno"> 2990</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = 0; jj &lt; 3; jj++)</div>
<div class="line"><span class="lineno"> 2991</span>            {</div>
<div class="line"><span class="lineno"> 2992</span>                lbPressure(ii,jj) += 6.0*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a587965ea13dcb7fddac42b87da1df7cf">Gb</a>[n][n]/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>*0.5*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>*GradPhi[ii]*GradPhi[jj];</div>
<div class="line"><span class="lineno"> 2993</span>            }</div>
<div class="line"><span class="lineno"> 2994</span>        }</div>
<div class="line"><span class="lineno"> 2995</span>        <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a286f1c691a57f5d5c8b1b217f86cd328">Pressure</a> = lbPressure*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a83cd87469986a195f9a42c9fbff2f523">dP</a>;</div>
<div class="line"><span class="lineno"> 2996</span>    }</div>
<div class="line"><span class="lineno"> 2997</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab45097494cc01fa93c7420778061d7ed">Do_Benzi</a>)</div>
<div class="line"><span class="lineno"> 2998</span>    {</div>
<div class="line"><span class="lineno"> 2999</span>        <span class="comment">//READ: Shan - 2008 - Pressure tensor calculation in a class of nonideal...</span></div>
<div class="line"><span class="lineno"> 3000</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 3001</span>        {</div>
<div class="line"><span class="lineno"> 3002</span>            <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; rho = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n});</div>
<div class="line"><span class="lineno"> 3003</span>            <span class="keyword">const</span> <span class="keywordtype">double</span>  p0  = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5284a4950dae747d84ce23d74fd5963e">cs2</a>*rho;</div>
<div class="line"><span class="lineno"> 3004</span>            <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a286f1c691a57f5d5c8b1b217f86cd328">Pressure</a>(0,0) += p0;</div>
<div class="line"><span class="lineno"> 3005</span>            <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a286f1c691a57f5d5c8b1b217f86cd328">Pressure</a>(1,1) += p0;</div>
<div class="line"><span class="lineno"> 3006</span>            <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a286f1c691a57f5d5c8b1b217f86cd328">Pressure</a>(2,2) += p0;</div>
<div class="line"><span class="lineno"> 3007</span> </div>
<div class="line"><span class="lineno"> 3008</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> m = 0; m &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++m)</div>
<div class="line"><span class="lineno"> 3009</span>            <span class="keywordflow">if</span> (std::abs(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a587965ea13dcb7fddac42b87da1df7cf">Gb</a>[n][m]) &gt; DBL_EPSILON)</div>
<div class="line"><span class="lineno"> 3010</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii++)</div>
<div class="line"><span class="lineno"> 3011</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj++)</div>
<div class="line"><span class="lineno"> 3012</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk++)</div>
<div class="line"><span class="lineno"> 3013</span>            {</div>
<div class="line"><span class="lineno"> 3014</span>                <span class="keyword">const</span> dVector3 vel {ii*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>,jj*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>,kk*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>};</div>
<div class="line"><span class="lineno"> 3015</span> </div>
<div class="line"><span class="lineno"> 3016</span>                <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a286f1c691a57f5d5c8b1b217f86cd328">Pressure</a> += vel.dyadic(vel) * 0.5 * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a587965ea13dcb7fddac42b87da1df7cf">Gb</a>[n][m] * <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>(rho, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7cd6cc5ca27add2432f5809f9d45ca03">rho_0</a>[n]) * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92539bf6d5ed043520c0bdbc47c334a9">lbWeights</a>[ii+1][jj+1][kk+1] * <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i+ii,j+jj,k,{m}), <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7cd6cc5ca27add2432f5809f9d45ca03">rho_0</a>[m]);</div>
<div class="line"><span class="lineno"> 3017</span>            }</div>
<div class="line"><span class="lineno"> 3018</span>        }</div>
<div class="line"><span class="lineno"> 3019</span>    }</div>
<div class="line"><span class="lineno"> 3020</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3021</span>    {</div>
<div class="line"><span class="lineno"> 3022</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 3023</span>        {</div>
<div class="line"><span class="lineno"> 3024</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> p0 = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5284a4950dae747d84ce23d74fd5963e">cs2</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n});</div>
<div class="line"><span class="lineno"> 3025</span>            <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a286f1c691a57f5d5c8b1b217f86cd328">Pressure</a>(0,0) += p0;</div>
<div class="line"><span class="lineno"> 3026</span>            <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a286f1c691a57f5d5c8b1b217f86cd328">Pressure</a>(1,1) += p0;</div>
<div class="line"><span class="lineno"> 3027</span>            <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a286f1c691a57f5d5c8b1b217f86cd328">Pressure</a>(2,2) += p0;</div>
<div class="line"><span class="lineno"> 3028</span>        }</div>
<div class="line"><span class="lineno"> 3029</span>    }</div>
<div class="line"><span class="lineno"> 3030</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a286f1c691a57f5d5c8b1b217f86cd328">Pressure</a>;</div>
<div class="line"><span class="lineno"> 3031</span>}</div>
<div class="ttc" id="anamespaceopenphase_html_a308506fb01f248e342986c5b57ad1f88"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a308506fb01f248e342986c5b57ad1f88">openphase::LaplacianStencil3D_27a</a></div><div class="ttdeci">const double LaplacianStencil3D_27a[3][3][3]</div><div class="ttdoc">27 point 3D Laplacian stencil by Spotz and Carey (1995)</div><div class="ttdef"><b>Definition</b> <a href="../../df/da2/LaplacianStencil_8h_source.html#l00109">LaplacianStencil.h:109</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a733647bb9863ddba4791eab6854cb519" name="a733647bb9863ddba4791eab6854cb519"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a733647bb9863ddba4791eab6854cb519">&#9670;&#160;</a></span>Propagation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::Propagation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Propagates Populations. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l01667">1667</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1668</span>{</div>
<div class="line"><span class="lineno"> 1669</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2ab90fa6fd8a7c36d86144281f5b0caa">lbPopulationsTMP</a>,0,)</div>
<div class="line"><span class="lineno"> 1670</span>    for (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 1671</span>    {</div>
<div class="line"><span class="lineno"> 1672</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2ab90fa6fd8a7c36d86144281f5b0caa">lbPopulationsTMP</a>(i,j,k,{n}).set_to_zero();</div>
<div class="line"><span class="lineno"> 1673</span>    }</div>
<div class="line"><span class="lineno"> 1674</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1675</span> </div>
<div class="line"><span class="lineno"> 1676</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>,0,)</div>
<div class="line"><span class="lineno"> 1677</span>    for (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 1678</span>    {</div>
<div class="line"><span class="lineno"> 1679</span>        <span class="keywordtype">double</span> lbDensityChange = 0.0;</div>
<div class="line"><span class="lineno"> 1680</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ii = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ++ii)</div>
<div class="line"><span class="lineno"> 1681</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; ++jj)</div>
<div class="line"><span class="lineno"> 1682</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; ++kk)</div>
<div class="line"><span class="lineno"> 1683</span>        {</div>
<div class="line"><span class="lineno"> 1684</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i, j, k))</div>
<div class="line"><span class="lineno"> 1685</span>            {</div>
<div class="line"><span class="lineno"> 1686</span>                <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2ab90fa6fd8a7c36d86144281f5b0caa">lbPopulationsTMP</a>(i,j,k,{n})(ii,jj,kk) =</div>
<div class="line"><span class="lineno"> 1687</span>                    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n})(ii,jj,kk);</div>
<div class="line"><span class="lineno"> 1688</span>            }</div>
<div class="line"><span class="lineno"> 1689</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i-ii, j-jj, k-kk))</div>
<div class="line"><span class="lineno"> 1690</span>            {</div>
<div class="line"><span class="lineno"> 1691</span>                <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2ab90fa6fd8a7c36d86144281f5b0caa">lbPopulationsTMP</a>(i,j,k,{n})(ii,jj,kk) =</div>
<div class="line"><span class="lineno"> 1692</span>                    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aaaecdbf57d1375053d64613f53c5e7f7">BounceBack</a>(i, j, k, ii, jj, kk, n, <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, BC, lbDensityChange);</div>
<div class="line"><span class="lineno"> 1693</span>            }</div>
<div class="line"><span class="lineno"> 1694</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1695</span>            {</div>
<div class="line"><span class="lineno"> 1696</span>                <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2ab90fa6fd8a7c36d86144281f5b0caa">lbPopulationsTMP</a>(i,j,k,{n})(ii,jj,kk) =</div>
<div class="line"><span class="lineno"> 1697</span>                    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i-ii, j-jj, k-kk,{n})(ii,jj,kk);</div>
<div class="line"><span class="lineno"> 1698</span>            }</div>
<div class="line"><span class="lineno"> 1699</span>        }</div>
<div class="line"><span class="lineno"> 1700</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2ab90fa6fd8a7c36d86144281f5b0caa">lbPopulationsTMP</a>(i,j,k,{n})(0,0,0) -= lbDensityChange; <span class="comment">//NoSlip</span></div>
<div class="line"><span class="lineno"> 1701</span>    }</div>
<div class="line"><span class="lineno"> 1702</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1703</span> </div>
<div class="line"><span class="lineno"> 1704</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>,0,)</div>
<div class="line"><span class="lineno"> 1705</span>    for (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 1706</span>    {</div>
<div class="line"><span class="lineno"> 1707</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n}) = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2ab90fa6fd8a7c36d86144281f5b0caa">lbPopulationsTMP</a>(i,j,k,{n});</div>
<div class="line"><span class="lineno"> 1708</span>    }</div>
<div class="line"><span class="lineno"> 1709</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1710</span> </div>
<div class="line"><span class="lineno"> 1711</span>   <span class="comment">// if(dNx) BC.SetXVector(lbPopulations);</span></div>
<div class="line"><span class="lineno"> 1712</span>   <span class="comment">// if(dNy) BC.SetYVector(lbPopulations);</span></div>
<div class="line"><span class="lineno"> 1713</span>   <span class="comment">// if(dNz) BC.SetZVector(lbPopulations);</span></div>
<div class="line"><span class="lineno"> 1714</span>}</div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_aaaecdbf57d1375053d64613f53c5e7f7"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aaaecdbf57d1375053d64613f53c5e7f7">openphase::FlowSolverLBM::BounceBack</a></div><div class="ttdeci">double BounceBack(const int i, const int j, const int k, const int ii, const int jj, const int kk, const size_t n, PhaseField &amp;Phase, const BoundaryConditions &amp;BC, double &amp;lbDensityChange)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l01543">FlowSolverLBM.cpp:1543</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1608caa47f9df10552e4a3d4b2bd4f34" name="a1608caa47f9df10552e4a3d4b2bd4f34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1608caa47f9df10552e4a3d4b2bd4f34">&#9670;&#160;</a></span>PropagationSecondOrderBB()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::PropagationSecondOrderBB </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Propagates Populations. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l01787">1787</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1788</span>{</div>
<div class="line"><span class="lineno"> 1789</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2ab90fa6fd8a7c36d86144281f5b0caa">lbPopulationsTMP</a>,0,)</div>
<div class="line"><span class="lineno"> 1790</span>    for (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 1791</span>    {</div>
<div class="line"><span class="lineno"> 1792</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2ab90fa6fd8a7c36d86144281f5b0caa">lbPopulationsTMP</a>(i,j,k,{n}).set_to_zero();</div>
<div class="line"><span class="lineno"> 1793</span>    }</div>
<div class="line"><span class="lineno"> 1794</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1795</span> </div>
<div class="line"><span class="lineno"> 1796</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>,0,)</div>
<div class="line"><span class="lineno"> 1797</span>    for (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 1798</span>    {</div>
<div class="line"><span class="lineno"> 1799</span>        <span class="keywordtype">double</span> lbDensityChange = 0.0;</div>
<div class="line"><span class="lineno"> 1800</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ii = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ++ii)</div>
<div class="line"><span class="lineno"> 1801</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; ++jj)</div>
<div class="line"><span class="lineno"> 1802</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; ++kk)</div>
<div class="line"><span class="lineno"> 1803</span>        {</div>
<div class="line"><span class="lineno"> 1804</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i, j, k))</div>
<div class="line"><span class="lineno"> 1805</span>            {</div>
<div class="line"><span class="lineno"> 1806</span>                <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2ab90fa6fd8a7c36d86144281f5b0caa">lbPopulationsTMP</a>(i,j,k,{n})(ii,jj,kk) =</div>
<div class="line"><span class="lineno"> 1807</span>                    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n})(ii,jj,kk);</div>
<div class="line"><span class="lineno"> 1808</span>            }</div>
<div class="line"><span class="lineno"> 1809</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i-ii, j-jj, k-kk))</div>
<div class="line"><span class="lineno"> 1810</span>            {</div>
<div class="line"><span class="lineno"> 1811</span>                <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2ab90fa6fd8a7c36d86144281f5b0caa">lbPopulationsTMP</a>(i,j,k,{n})(ii,jj,kk) =</div>
<div class="line"><span class="lineno"> 1812</span>                    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae707969f20e943c0db6228ad2e1af981">SecondOrderBounceBack</a>(i, j, k, ii, jj, kk, n, <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, BC, lbDensityChange);</div>
<div class="line"><span class="lineno"> 1813</span>            }</div>
<div class="line"><span class="lineno"> 1814</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1815</span>            {</div>
<div class="line"><span class="lineno"> 1816</span>                <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2ab90fa6fd8a7c36d86144281f5b0caa">lbPopulationsTMP</a>(i,j,k,{n})(ii,jj,kk) =</div>
<div class="line"><span class="lineno"> 1817</span>                    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i-ii, j-jj, k-kk,{n})(ii,jj,kk);</div>
<div class="line"><span class="lineno"> 1818</span>            }</div>
<div class="line"><span class="lineno"> 1819</span>        }</div>
<div class="line"><span class="lineno"> 1820</span>    }</div>
<div class="line"><span class="lineno"> 1821</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1822</span> </div>
<div class="line"><span class="lineno"> 1823</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>,0,)</div>
<div class="line"><span class="lineno"> 1824</span>    for (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 1825</span>    {</div>
<div class="line"><span class="lineno"> 1826</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n}) = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2ab90fa6fd8a7c36d86144281f5b0caa">lbPopulationsTMP</a>(i,j,k,{n});</div>
<div class="line"><span class="lineno"> 1827</span>    }</div>
<div class="line"><span class="lineno"> 1828</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1829</span> </div>
<div class="line"><span class="lineno"> 1830</span>   <span class="comment">// if(dNx) BC.SetXVector(lbPopulations);</span></div>
<div class="line"><span class="lineno"> 1831</span>   <span class="comment">// if(dNy) BC.SetYVector(lbPopulations);</span></div>
<div class="line"><span class="lineno"> 1832</span>   <span class="comment">// if(dNz) BC.SetZVector(lbPopulations);</span></div>
<div class="line"><span class="lineno"> 1833</span>}</div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_ae707969f20e943c0db6228ad2e1af981"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae707969f20e943c0db6228ad2e1af981">openphase::FlowSolverLBM::SecondOrderBounceBack</a></div><div class="ttdeci">double SecondOrderBounceBack(const int i, const int j, const int k, const int ii, const int jj, const int kk, const size_t n, PhaseField &amp;Phase, const BoundaryConditions &amp;BC, double &amp;lbDensityChange)</div><div class="ttdoc">BounceBack at Solid Interfaces.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l01716">FlowSolverLBM.cpp:1716</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a297a77842a22e3f115c9b9a43979ff05" name="a297a77842a22e3f115c9b9a43979ff05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a297a77842a22e3f115c9b9a43979ff05">&#9670;&#160;</a></span>Read()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::FlowSolverLBM::Read </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;&#160;</td>
          <td class="paramname"><em>locSettings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>tStep</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read raw (binary) fields from file. </p>

<p>Reimplemented from <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#adbd36cc2fee5c391f60f52ecd6114d2c">openphase::OPObject</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00494">494</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  495</span>{</div>
<div class="line"><span class="lineno">  496</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno">  497</span>    std::string FileName = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a19ed8803c3eb456f4708ccc6c6edd995">FileInterface::MakeFileName</a>(locSettings.InputRawDataDir, <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>+<span class="charliteral">&#39;_&#39;</span>+std::to_string(MPI_RANK)+<span class="stringliteral">&quot;_&quot;</span>, tStep, <span class="stringliteral">&quot;.dat&quot;</span>);</div>
<div class="line"><span class="lineno">  498</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  499</span>    std::string FileName = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a19ed8803c3eb456f4708ccc6c6edd995">FileInterface::MakeFileName</a>(locSettings.InputRawDataDir, <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>+<span class="charliteral">&#39;_&#39;</span>, tStep, <span class="stringliteral">&quot;.dat&quot;</span>);</div>
<div class="line"><span class="lineno">  500</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  501</span> </div>
<div class="line"><span class="lineno">  502</span>    std::ifstream inp(FileName.c_str(), std::ios::in | std::ios::binary);</div>
<div class="line"><span class="lineno">  503</span> </div>
<div class="line"><span class="lineno">  504</span>    <span class="keywordflow">if</span> (!inp)</div>
<div class="line"><span class="lineno">  505</span>    {</div>
<div class="line"><span class="lineno">  506</span>        std::stringstream message;</div>
<div class="line"><span class="lineno">  507</span>        message &lt;&lt; <span class="stringliteral">&quot;File \&quot;&quot;</span> &lt;&lt; FileName &lt;&lt; <span class="stringliteral">&quot;\&quot; could not be opened&quot;</span>;</div>
<div class="line"><span class="lineno">  508</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">ConsoleOutput::WriteWarning</a>(message.str(), <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, <span class="stringliteral">&quot;Read()&quot;</span>);</div>
<div class="line"><span class="lineno">  509</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  510</span>    };</div>
<div class="line"><span class="lineno">  511</span> </div>
<div class="line"><span class="lineno">  512</span>    <span class="keywordtype">int</span> locNx = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>;</div>
<div class="line"><span class="lineno">  513</span>    <span class="keywordtype">int</span> locNy = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>;</div>
<div class="line"><span class="lineno">  514</span>    <span class="keywordtype">int</span> locNz = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>;</div>
<div class="line"><span class="lineno">  515</span>    inp.read(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;locNx), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><span class="lineno">  516</span>    inp.read(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;locNy), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><span class="lineno">  517</span>    inp.read(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;locNz), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><span class="lineno">  518</span> </div>
<div class="line"><span class="lineno">  519</span>    <span class="keywordflow">if</span>(locNx != <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a> or locNy != <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a> or locNz != <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>)</div>
<div class="line"><span class="lineno">  520</span>    {</div>
<div class="line"><span class="lineno">  521</span>        std::stringstream message;</div>
<div class="line"><span class="lineno">  522</span>        message &lt;&lt; <span class="stringliteral">&quot;Inconsistent system dimensions!\n&quot;</span></div>
<div class="line"><span class="lineno">  523</span>                &lt;&lt; <span class="stringliteral">&quot;Input data dimensions: (&quot;</span></div>
<div class="line"><span class="lineno">  524</span>                &lt;&lt; locNx &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><span class="lineno">  525</span>                &lt;&lt; locNy &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><span class="lineno">  526</span>                &lt;&lt; locNz &lt;&lt; <span class="stringliteral">&quot;) grid points.\n&quot;</span></div>
<div class="line"><span class="lineno">  527</span>                &lt;&lt; <span class="stringliteral">&quot;Required data dimensions: (&quot;</span></div>
<div class="line"><span class="lineno">  528</span>                &lt;&lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a> &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><span class="lineno">  529</span>                &lt;&lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a> &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><span class="lineno">  530</span>                &lt;&lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a> &lt;&lt; <span class="stringliteral">&quot;) grid points.\n&quot;</span>;</div>
<div class="line"><span class="lineno">  531</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  532</span>        <span class="keywordflow">throw</span> std::runtime_error(message.str());</div>
<div class="line"><span class="lineno">  533</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  534</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  535</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  536</span>    }</div>
<div class="line"><span class="lineno">  537</span> </div>
<div class="line"><span class="lineno">  538</span>    <span class="keywordtype">size_t</span> locN_Fluid_Comp = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>;</div>
<div class="line"><span class="lineno">  539</span>    inp.read(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>), <span class="keyword">sizeof</span>(<span class="keywordtype">size_t</span>));</div>
<div class="line"><span class="lineno">  540</span> </div>
<div class="line"><span class="lineno">  541</span>    <span class="keywordflow">if</span>(locN_Fluid_Comp != <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>)</div>
<div class="line"><span class="lineno">  542</span>    {</div>
<div class="line"><span class="lineno">  543</span>        std::stringstream message;</div>
<div class="line"><span class="lineno">  544</span>        message &lt;&lt; <span class="stringliteral">&quot;Inconsistent number of fluid components\n&quot;</span></div>
<div class="line"><span class="lineno">  545</span>                &lt;&lt; <span class="stringliteral">&quot;Input number of fluid components: &quot;</span></div>
<div class="line"><span class="lineno">  546</span>                &lt;&lt; locN_Fluid_Comp &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><span class="lineno">  547</span>                &lt;&lt; <span class="stringliteral">&quot;Required number of fluid components: &quot;</span></div>
<div class="line"><span class="lineno">  548</span>                &lt;&lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  549</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  550</span>        <span class="keywordflow">throw</span> std::runtime_error(message.str());</div>
<div class="line"><span class="lineno">  551</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  552</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  553</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  554</span>    }</div>
<div class="line"><span class="lineno">  555</span> </div>
<div class="line"><span class="lineno">  556</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a71aed4b94e116454c7b11985a91e49ec">STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>,0)</div>
<div class="line"><span class="lineno">  557</span>    {</div>
<div class="line"><span class="lineno">  558</span>        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno">  559</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ii = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ++ii)</div>
<div class="line"><span class="lineno">  560</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; ++jj)</div>
<div class="line"><span class="lineno">  561</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; ++kk)</div>
<div class="line"><span class="lineno">  562</span>        {</div>
<div class="line"><span class="lineno">  563</span>            inp.read(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n})(ii,jj,kk)), <span class="keyword">sizeof</span>(double));</div>
<div class="line"><span class="lineno">  564</span>        }</div>
<div class="line"><span class="lineno">  565</span>    }</div>
<div class="line"><span class="lineno">  566</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a6ad2c83345f230517a1770304d7b39ad">STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  567</span> </div>
<div class="line"><span class="lineno">  568</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a71aed4b94e116454c7b11985a91e49ec">STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>,0)</div>
<div class="line"><span class="lineno">  569</span>    {</div>
<div class="line"><span class="lineno">  570</span>        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno">  571</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> m = 0; m &lt; 3; ++m)</div>
<div class="line"><span class="lineno">  572</span>        {</div>
<div class="line"><span class="lineno">  573</span>            inp.read(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>(i,j,k,{n})[m]), <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><span class="lineno">  574</span>        }</div>
<div class="line"><span class="lineno">  575</span>    }</div>
<div class="line"><span class="lineno">  576</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a6ad2c83345f230517a1770304d7b39ad">STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  577</span> </div>
<div class="line"><span class="lineno">  578</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a71aed4b94e116454c7b11985a91e49ec">STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>,0)</div>
<div class="line"><span class="lineno">  579</span>    {</div>
<div class="line"><span class="lineno">  580</span>        inp.read(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k)), <span class="keyword">sizeof</span>(<span class="keywordtype">bool</span>));</div>
<div class="line"><span class="lineno">  581</span>    }</div>
<div class="line"><span class="lineno">  582</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a6ad2c83345f230517a1770304d7b39ad">STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  583</span> </div>
<div class="line"><span class="lineno">  584</span>    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#af6e8285978dabe6066bd291c5674ffdb">CalculateDensityAndMomentum</a>();</div>
<div class="line"><span class="lineno">  585</span>    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aac503798c87d57cd342e2d56063f481b">SetBoundaryConditions</a>(BC);</div>
<div class="line"><span class="lineno">  586</span> </div>
<div class="line"><span class="lineno">  587</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, <span class="stringliteral">&quot;Binary input loaded&quot;</span>);</div>
<div class="line"><span class="lineno">  588</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  589</span>}</div>
<div class="ttc" id="aMacros_8h_html_a6ad2c83345f230517a1770304d7b39ad"><div class="ttname"><a href="../../df/d0a/Macros_8h.html#a6ad2c83345f230517a1770304d7b39ad">STORAGE_LOOP_END</a></div><div class="ttdeci">#define STORAGE_LOOP_END</div><div class="ttdef"><b>Definition</b> <a href="../../df/d0a/Macros_8h_source.html#l00074">Macros.h:74</a></div></div>
<div class="ttc" id="aMacros_8h_html_a71aed4b94e116454c7b11985a91e49ec"><div class="ttname"><a href="../../df/d0a/Macros_8h.html#a71aed4b94e116454c7b11985a91e49ec">STORAGE_LOOP_BEGIN</a></div><div class="ttdeci">#define STORAGE_LOOP_BEGIN(i, j, k, T__, op_loop_bcells__)</div><div class="ttdef"><b>Definition</b> <a href="../../df/d0a/Macros_8h_source.html#l00053">Macros.h:53</a></div></div>
<div class="ttc" id="aclassopenphase_1_1ConsoleOutput_html_ae2753bb70e817b1bdd5ae2b99adf6e0f"><div class="ttname"><a href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">openphase::ConsoleOutput::WriteStandard</a></div><div class="ttdeci">static void WriteStandard(const std::string &amp;Left, const T Right, const int precision=StandardPrecision, floatfield notation=StandardNotation, const size_t ColumnWidth=StandardColumnWidth)</div><div class="ttdoc">Writes GetStandard result to std::cout if MPI-Rank 0.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/dfe/ConsoleOutput_8h_source.html#l00291">ConsoleOutput.h:291</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab7ec322c63819b51ebd5912de9c9d09d" name="ab7ec322c63819b51ebd5912de9c9d09d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7ec322c63819b51ebd5912de9c9d09d">&#9670;&#160;</a></span>ReadInput() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::ReadInput </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>InputFileName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reads input parameters from a file. </p>

<p>Reimplemented from <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9c766ff0ddd3866b7c2f2f83ebebcf31">openphase::OPObject</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00199">199</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  200</span>{</div>
<div class="line"><span class="lineno">  201</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3adb3c1b74bf9ac814922b7a8283707e">ConsoleOutput::WriteLineInsert</a>(<span class="stringliteral">&quot;FlowSolverLBM input&quot;</span>);</div>
<div class="line"><span class="lineno">  202</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Source&quot;</span>, InputFileName);</div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>    fstream inpF(InputFileName.c_str(), ios::in | ios_base::binary);</div>
<div class="line"><span class="lineno">  205</span> </div>
<div class="line"><span class="lineno">  206</span>    <span class="keywordflow">if</span> (!inpF)</div>
<div class="line"><span class="lineno">  207</span>    {</div>
<div class="line"><span class="lineno">  208</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a421faa2fe5d86991328b2b06041a326d">ConsoleOutput::WriteExit</a>(<span class="stringliteral">&quot;File \&quot;&quot;</span> + InputFileName + <span class="stringliteral">&quot;\&quot; could not be opened&quot;</span>, <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>,<span class="stringliteral">&quot;ReadInput()&quot;</span>);</div>
<div class="line"><span class="lineno">  209</span>        std::exit(EXIT_FAILURE);</div>
<div class="line"><span class="lineno">  210</span>    };</div>
<div class="line"><span class="lineno">  211</span>    stringstream inp;</div>
<div class="line"><span class="lineno">  212</span>    inp &lt;&lt; inpF.rdbuf();</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab7ec322c63819b51ebd5912de9c9d09d">ReadInput</a>(inp);</div>
<div class="line"><span class="lineno">  215</span> </div>
<div class="line"><span class="lineno">  216</span>    inpF.close();</div>
<div class="line"><span class="lineno">  217</span>}</div>
<div class="ttc" id="aclassopenphase_1_1ConsoleOutput_html_a3adb3c1b74bf9ac814922b7a8283707e"><div class="ttname"><a href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3adb3c1b74bf9ac814922b7a8283707e">openphase::ConsoleOutput::WriteLineInsert</a></div><div class="ttdeci">static void WriteLineInsert(const std::string Insert, const std::string LineType=&quot;-&quot;)</div><div class="ttdef"><b>Definition</b> <a href="../../da/da0/ConsoleOutput_8cpp_source.html#l00117">ConsoleOutput.cpp:117</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a415f95242a02f3ea284dccf408614be2" name="a415f95242a02f3ea284dccf408614be2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a415f95242a02f3ea284dccf408614be2">&#9670;&#160;</a></span>ReadInput() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::ReadInput </td>
          <td>(</td>
          <td class="paramtype">std::stringstream &amp;&#160;</td>
          <td class="paramname"><em>inp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reads input parameters from a stringstream. </p>

<p>Reimplemented from <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9a7696bf13bb3e6b88a6965937aafdbb">openphase::OPObject</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00219">219</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  220</span>{</div>
<div class="line"><span class="lineno">  221</span>    <span class="keywordtype">int</span> moduleLocation = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#afbaeccd98923fc3babc30e1e7b3eed62">FileInterface::FindModuleLocation</a>(inp, <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>);</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a> = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a8077611f56a17832ac4d22d604df6dcd">FileInterface::ReadParameterD</a>(inp, moduleLocation, std::string(<span class="stringliteral">&quot;N_FLUID_COMP&quot;</span>), <span class="keyword">false</span>, 1);</div>
<div class="line"><span class="lineno">  224</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a79b3ebcd11696e18f2db1079356829e3">nu</a>.resize(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>);</div>
<div class="line"><span class="lineno">  225</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno">  226</span>    {</div>
<div class="line"><span class="lineno">  227</span>        std::stringstream NUstr;</div>
<div class="line"><span class="lineno">  228</span>        NUstr &lt;&lt; <span class="stringliteral">&quot;NU[&quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line"><span class="lineno">  229</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a79b3ebcd11696e18f2db1079356829e3">nu</a>[n] = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a8077611f56a17832ac4d22d604df6dcd">FileInterface::ReadParameterD</a>(inp, moduleLocation, NUstr.str());</div>
<div class="line"><span class="lineno">  230</span>    }</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2dc5ba2dfe7ff199c4e6b625c57b4001">Do_BounceBack</a>            = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a1b38acae500f606496f04a55e714731c">FileInterface::ReadParameterB</a>(inp, moduleLocation, std::string(<span class="stringliteral">&quot;BOUNCEBACK&quot;</span>));</div>
<div class="line"><span class="lineno">  233</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab45097494cc01fa93c7420778061d7ed">Do_Benzi</a>                 = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a1b38acae500f606496f04a55e714731c">FileInterface::ReadParameterB</a>(inp, moduleLocation, std::string(<span class="stringliteral">&quot;BENZI&quot;</span>), <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  234</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a359a5b0d89af4a527bb3d9cfdba32f85">Do_BounceBackElastic</a>     = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a1b38acae500f606496f04a55e714731c">FileInterface::ReadParameterB</a>(inp, moduleLocation, std::string(<span class="stringliteral">&quot;BBELASTIC&quot;</span>), <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  235</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a570918ac5d77ab38b6f92f9a31e401e0">Do_Drag</a>                  = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a1b38acae500f606496f04a55e714731c">FileInterface::ReadParameterB</a>(inp, moduleLocation, std::string(<span class="stringliteral">&quot;DRAG&quot;</span>));</div>
<div class="line"><span class="lineno">  236</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad85e2131812f1bb919f547226d6a6a3a">Do_FixPopulations</a>        = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a1b38acae500f606496f04a55e714731c">FileInterface::ReadParameterB</a>(inp, moduleLocation, std::string(<span class="stringliteral">&quot;bFixPop&quot;</span>),  <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  237</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2254d3b9f9dab0e6a6917590f020879d">Do_Gravity</a>               = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a1b38acae500f606496f04a55e714731c">FileInterface::ReadParameterB</a>(inp, moduleLocation, std::string(<span class="stringliteral">&quot;GRAVITY&quot;</span>), <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  238</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae9bc290fd900003e6984f319eb544269">Do_Kupershtokh</a>           = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a1b38acae500f606496f04a55e714731c">FileInterface::ReadParameterB</a>(inp, moduleLocation, std::string(<span class="stringliteral">&quot;KUPERSHTOKH&quot;</span>), <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  239</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7c63a86b32c4126fb329829acf6af13c">Do_ThermalComp</a>           = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a1b38acae500f606496f04a55e714731c">FileInterface::ReadParameterB</a>(inp, moduleLocation, std::string(<span class="stringliteral">&quot;THERMALCOMP&quot;</span>), <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  240</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92c22f0dfe11f8b261391b7e73fdc2f4">Do_DI</a>                           = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a1b38acae500f606496f04a55e714731c">FileInterface::ReadParameterB</a>(inp, moduleLocation, std::string(<span class="stringliteral">&quot;Diffuse_Interface&quot;</span>), <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  241</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a> = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a05c3fb3e8b5d3a1d805b450014155f3d">FileInterface::ReadParameterI</a>(inp, moduleLocation, std::string(<span class="stringliteral">&quot;FluidRedistributionRange&quot;</span>), <span class="keyword">false</span>, 1);</div>
<div class="line"><span class="lineno">  242</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aaa6a4778188230a23cbbf10d21a33219">ParaKuper</a>                = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a8077611f56a17832ac4d22d604df6dcd">FileInterface::ReadParameterD</a>(inp, moduleLocation, std::string(<span class="stringliteral">&quot;ParaKuper&quot;</span>), <span class="keyword">false</span>, -0.0152);</div>
<div class="line"><span class="lineno">  243</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad61619206ef9c5955004f3ff0186687a">h_star</a>                   = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a8077611f56a17832ac4d22d604df6dcd">FileInterface::ReadParameterD</a>(inp, moduleLocation, std::string(<span class="stringliteral">&quot;H_STAR&quot;</span>), <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a570918ac5d77ab38b6f92f9a31e401e0">Do_Drag</a>, 0.0);</div>
<div class="line"><span class="lineno">  244</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a147890b1c75d4b407881212ea40ecf05">Do_TwoPhase</a> = (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab45097494cc01fa93c7420778061d7ed">Do_Benzi</a> or <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae9bc290fd900003e6984f319eb544269">Do_Kupershtokh</a>) ? <span class="keyword">true</span> : false;</div>
<div class="line"><span class="lineno">  245</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab5ba4a4e507c7d80c6268bb41e4f3c2a">Do_GuoForcing</a>            = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a1b38acae500f606496f04a55e714731c">FileInterface::ReadParameterB</a>(inp, moduleLocation, std::string(<span class="stringliteral">&quot;GUO_FORCING&quot;</span>), <span class="keyword">false</span>,  <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a147890b1c75d4b407881212ea40ecf05">Do_TwoPhase</a>);</div>
<div class="line"><span class="lineno">  246</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a06f6913d390fd7e3e2174b6a82506b4b">Do_EDForcing</a>             = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a1b38acae500f606496f04a55e714731c">FileInterface::ReadParameterB</a>(inp, moduleLocation, std::string(<span class="stringliteral">&quot;ED_FORCING&quot;</span>),  <span class="keyword">false</span>, !<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a147890b1c75d4b407881212ea40ecf05">Do_TwoPhase</a>);</div>
<div class="line"><span class="lineno">  247</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afd420cebecad62af1b472379f9b05663">GradRho_Upwind</a>               = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a1b38acae500f606496f04a55e714731c">FileInterface::ReadParameterB</a>(inp, moduleLocation, std::string(<span class="stringliteral">&quot;GradRho_Upwind&quot;</span>), <span class="keyword">false</span>, <span class="keyword">false</span>); </div>
<div class="line"><span class="lineno">  248</span>       <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac26558dc3c1f0f921a771ceedbc474e2">GradRho_Central</a>          = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a1b38acae500f606496f04a55e714731c">FileInterface::ReadParameterB</a>(inp, moduleLocation, std::string(<span class="stringliteral">&quot;GradRho_Central&quot;</span>), <span class="keyword">false</span>, <span class="keyword">false</span>); </div>
<div class="line"><span class="lineno">  249</span>       <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a911943c5a05841969b913c12c1d4921c">GradRho_VanLeer</a>          = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a1b38acae500f606496f04a55e714731c">FileInterface::ReadParameterB</a>(inp, moduleLocation, std::string(<span class="stringliteral">&quot;GradRho_VanLeer&quot;</span>), <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  250</span> </div>
<div class="line"><span class="lineno">  251</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a852ebebddbd520319bcc8b65bffad2a3">Bcells</a> &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a>)</div>
<div class="line"><span class="lineno">  252</span>    {</div>
<div class="line"><span class="lineno">  253</span>        std::stringstream message;</div>
<div class="line"><span class="lineno">  254</span>            message &lt;&lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a852ebebddbd520319bcc8b65bffad2a3">Bcells</a> &lt;&lt; <span class="stringliteral">&quot; boundary cells are too few, at least &quot;</span></div>
<div class="line"><span class="lineno">  255</span>                    &lt;&lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a> &lt;&lt; <span class="stringliteral">&quot; boundary cells are needed!&quot;</span>;</div>
<div class="line"><span class="lineno">  256</span> </div>
<div class="line"><span class="lineno">  257</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a421faa2fe5d86991328b2b06041a326d">ConsoleOutput::WriteExit</a>(message.str(), <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, <span class="stringliteral">&quot;ReadInput&quot;</span>);</div>
<div class="line"><span class="lineno">  258</span>        std::exit(EXIT_FAILURE);</div>
<div class="line"><span class="lineno">  259</span>    }</div>
<div class="line"><span class="lineno">  260</span> </div>
<div class="line"><span class="lineno">  261</span>    <span class="comment">// Determine density discretization</span></div>
<div class="line"><span class="lineno">  262</span>    <span class="comment">// NOTE that dRho is the equilibrium fluid density [Kg/m^2] if no liquid-vapor phase separation is considered!</span></div>
<div class="line"><span class="lineno">  263</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a> = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a8077611f56a17832ac4d22d604df6dcd">FileInterface::ReadParameterD</a>(inp, moduleLocation, std::string(<span class="stringliteral">&quot;dRho&quot;</span>));</div>
<div class="line"><span class="lineno">  264</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5421bde5029b801f847f4ec190b3a5dc">dM</a>   = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_function" href="../../dc/d18/classopenphase_1_1GridParameters.html#a9e96c156b3c12ba0bb402d5188dbf1c6">CellVolume</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  265</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a83cd87469986a195f9a42c9fbff2f523">dP</a>   = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5421bde5029b801f847f4ec190b3a5dc">dM</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>;</div>
<div class="line"><span class="lineno">  266</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0e7cad672eea608ab7c5ea5ed6946138">dm</a>   = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5421bde5029b801f847f4ec190b3a5dc">dM</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>;</div>
<div class="line"><span class="lineno">  267</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3b6d8de9f278b56d9346a2adb823a4e2">df</a>   = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5421bde5029b801f847f4ec190b3a5dc">dM</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>;</div>
<div class="line"><span class="lineno">  268</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a74ae26b9feb1666e9c177e5e88558d8a">dnu</a>  = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>;</div>
<div class="line"><span class="lineno">  269</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9c24d4bdb6833cf83827eb7ae9629f47">dv</a>   = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>;</div>
<div class="line"><span class="lineno">  270</span> </div>
<div class="line"><span class="lineno">  271</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3682fba50989e5b7ab0df48763a889d3">Ncomp</a> &gt; 0)</div>
<div class="line"><span class="lineno">  272</span>    {</div>
<div class="line"><span class="lineno">  273</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#addfc8e9e14301fe577dac27985c8e294">dDensity_dc</a>.resize(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3682fba50989e5b7ab0df48763a889d3">Ncomp</a>);</div>
<div class="line"><span class="lineno">  274</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3682fba50989e5b7ab0df48763a889d3">Ncomp</a>; ++n)</div>
<div class="line"><span class="lineno">  275</span>        {</div>
<div class="line"><span class="lineno">  276</span>            std::stringstream dDensity_dc_str;</div>
<div class="line"><span class="lineno">  277</span>            dDensity_dc_str &lt;&lt; <span class="stringliteral">&quot;DDENSITY_DC_&quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa4faa1708afdfd505f7648f1a063d80b">ElementNames</a>[n];</div>
<div class="line"><span class="lineno">  278</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#addfc8e9e14301fe577dac27985c8e294">dDensity_dc</a>[n] = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a8077611f56a17832ac4d22d604df6dcd">FileInterface::ReadParameterD</a>(inp, moduleLocation, dDensity_dc_str.str(), <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2254d3b9f9dab0e6a6917590f020879d">Do_Gravity</a>,0.0);</div>
<div class="line"><span class="lineno">  279</span>        }</div>
<div class="line"><span class="lineno">  280</span>    }</div>
<div class="line"><span class="lineno">  281</span> </div>
<div class="line"><span class="lineno">  282</span>    <span class="comment">// GA Gravitational acceleration</span></div>
<div class="line"><span class="lineno">  283</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; 3; i++)</div>
<div class="line"><span class="lineno">  284</span>    {</div>
<div class="line"><span class="lineno">  285</span>        std::stringstream GAstr;</div>
<div class="line"><span class="lineno">  286</span>        GAstr &lt;&lt; <span class="stringliteral">&quot;G0_&quot;</span> &lt;&lt; i;</div>
<div class="line"><span class="lineno">  287</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0041741e7a61b58755ac052871ccc47a">GA</a>[i] = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a8077611f56a17832ac4d22d604df6dcd">FileInterface::ReadParameterD</a>(inp, moduleLocation, GAstr.str(), <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2254d3b9f9dab0e6a6917590f020879d">Do_Gravity</a>, 0.0);</div>
<div class="line"><span class="lineno">  288</span>    }</div>
<div class="line"><span class="lineno">  289</span> </div>
<div class="line"><span class="lineno">  290</span>    <span class="comment">// Read Benzi interaction parameter</span></div>
<div class="line"><span class="lineno">  291</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a587965ea13dcb7fddac42b87da1df7cf">Gb</a>.resize(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>);</div>
<div class="line"><span class="lineno">  292</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno">  293</span>    {</div>
<div class="line"><span class="lineno">  294</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a587965ea13dcb7fddac42b87da1df7cf">Gb</a>[n].resize(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>);</div>
<div class="line"><span class="lineno">  295</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> m = 0; m &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++m)</div>
<div class="line"><span class="lineno">  296</span>        {</div>
<div class="line"><span class="lineno">  297</span>            std::stringstream Gbstr;</div>
<div class="line"><span class="lineno">  298</span>            Gbstr &lt;&lt; <span class="stringliteral">&quot;GB_&quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; m;</div>
<div class="line"><span class="lineno">  299</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a587965ea13dcb7fddac42b87da1df7cf">Gb</a>[n][m] = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a8077611f56a17832ac4d22d604df6dcd">FileInterface::ReadParameterD</a>(inp, moduleLocation, Gbstr.str(), <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab45097494cc01fa93c7420778061d7ed">Do_Benzi</a>, (n==m) ? 1 : 0);</div>
<div class="line"><span class="lineno">  300</span> </div>
<div class="line"><span class="lineno">  301</span>        }</div>
<div class="line"><span class="lineno">  302</span>    }</div>
<div class="line"><span class="lineno">  303</span> </div>
<div class="line"><span class="lineno">  304</span>    <span class="comment">// Read Kupershtokh interaction parameter</span></div>
<div class="line"><span class="lineno">  305</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0d614141e8c6298e8b39f8b7d67fe8da">lbGK</a>.resize(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>);</div>
<div class="line"><span class="lineno">  306</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno">  307</span>    {</div>
<div class="line"><span class="lineno">  308</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0d614141e8c6298e8b39f8b7d67fe8da">lbGK</a>[n].resize(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>);</div>
<div class="line"><span class="lineno">  309</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> m = 0; m &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++m)</div>
<div class="line"><span class="lineno">  310</span>        {</div>
<div class="line"><span class="lineno">  311</span>            std::stringstream GKstr;</div>
<div class="line"><span class="lineno">  312</span>            GKstr &lt;&lt; <span class="stringliteral">&quot;lbGK_&quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; m;</div>
<div class="line"><span class="lineno">  313</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0d614141e8c6298e8b39f8b7d67fe8da">lbGK</a>[n][m] = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a8077611f56a17832ac4d22d604df6dcd">FileInterface::ReadParameterD</a>(inp, moduleLocation, GKstr.str(), <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae9bc290fd900003e6984f319eb544269">Do_Kupershtokh</a>, (n==m) ? 1 : 0);</div>
<div class="line"><span class="lineno">  314</span>        }</div>
<div class="line"><span class="lineno">  315</span>    }</div>
<div class="line"><span class="lineno">  316</span> </div>
<div class="line"><span class="lineno">  317</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7cd6cc5ca27add2432f5809f9d45ca03">rho_0</a>.resize(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>);</div>
<div class="line"><span class="lineno">  318</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno">  319</span>    {</div>
<div class="line"><span class="lineno">  320</span>        std::stringstream RHO0str;</div>
<div class="line"><span class="lineno">  321</span>        RHO0str &lt;&lt; <span class="stringliteral">&quot;RHO0_&quot;</span> &lt;&lt; n;</div>
<div class="line"><span class="lineno">  322</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7cd6cc5ca27add2432f5809f9d45ca03">rho_0</a>[n] = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a8077611f56a17832ac4d22d604df6dcd">FileInterface::ReadParameterD</a>(inp, moduleLocation, RHO0str.str(), <span class="keyword">false</span>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>);</div>
<div class="line"><span class="lineno">  323</span>    }</div>
<div class="line"><span class="lineno">  324</span> </div>
<div class="line"><span class="lineno">  325</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a66544929ec9e15f973b2d349787a5993">CriticalDensity</a>.resize(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>);</div>
<div class="line"><span class="lineno">  326</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno">  327</span>    {</div>
<div class="line"><span class="lineno">  328</span>        std::stringstream RHOCstr;</div>
<div class="line"><span class="lineno">  329</span>        RHOCstr &lt;&lt; <span class="stringliteral">&quot;RHOC_&quot;</span> &lt;&lt; n;</div>
<div class="line"><span class="lineno">  330</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a66544929ec9e15f973b2d349787a5993">CriticalDensity</a>[n] = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a8077611f56a17832ac4d22d604df6dcd">FileInterface::ReadParameterD</a>(inp, moduleLocation, RHOCstr.str(), <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae9bc290fd900003e6984f319eb544269">Do_Kupershtokh</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>);</div>
<div class="line"><span class="lineno">  331</span>    }</div>
<div class="line"><span class="lineno">  332</span> </div>
<div class="line"><span class="lineno">  333</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a135999305b00dce046d03db79817e69e">lbTemperature</a>.resize(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>);</div>
<div class="line"><span class="lineno">  334</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno">  335</span>    {</div>
<div class="line"><span class="lineno">  336</span>        std::stringstream TEMPstr;</div>
<div class="line"><span class="lineno">  337</span>        TEMPstr &lt;&lt; <span class="stringliteral">&quot;TEMP_&quot;</span> &lt;&lt; n;</div>
<div class="line"><span class="lineno">  338</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a135999305b00dce046d03db79817e69e">lbTemperature</a>[n] = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a8077611f56a17832ac4d22d604df6dcd">FileInterface::ReadParameterD</a>(inp, moduleLocation, TEMPstr.str(), <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae9bc290fd900003e6984f319eb544269">Do_Kupershtokh</a>, 0.0);</div>
<div class="line"><span class="lineno">  339</span>    }</div>
<div class="line"><span class="lineno">  340</span> </div>
<div class="line"><span class="lineno">  341</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a405aa37be090a3d967abab6df1f941ba">lbCriticalTemperature</a>.resize(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>);</div>
<div class="line"><span class="lineno">  342</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno">  343</span>    {</div>
<div class="line"><span class="lineno">  344</span>       std::stringstream TEMPCstr;</div>
<div class="line"><span class="lineno">  345</span>       TEMPCstr &lt;&lt; <span class="stringliteral">&quot;TEMPC_&quot;</span> &lt;&lt; n;</div>
<div class="line"><span class="lineno">  346</span>       <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a405aa37be090a3d967abab6df1f941ba">lbCriticalTemperature</a>[n] = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a8077611f56a17832ac4d22d604df6dcd">FileInterface::ReadParameterD</a>(inp, moduleLocation, TEMPCstr.str(), <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae9bc290fd900003e6984f319eb544269">Do_Kupershtokh</a>, 0.0);</div>
<div class="line"><span class="lineno">  347</span>    }</div>
<div class="line"><span class="lineno">  348</span> </div>
<div class="line"><span class="lineno">  349</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a11c6271193ddf1f694f1bfc4227bf617">GasParameter</a>.resize(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>);</div>
<div class="line"><span class="lineno">  350</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab8df6700e0802a129069281b338313d7">lbCriticalPressure</a>.resize(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>);</div>
<div class="line"><span class="lineno">  351</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno">  352</span>    {</div>
<div class="line"><span class="lineno">  353</span>        std::stringstream TEMPCstr;</div>
<div class="line"><span class="lineno">  354</span>        TEMPCstr &lt;&lt; <span class="stringliteral">&quot;CRITP_&quot;</span> &lt;&lt; n;</div>
<div class="line"><span class="lineno">  355</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab8df6700e0802a129069281b338313d7">lbCriticalPressure</a>[n] = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a8077611f56a17832ac4d22d604df6dcd">FileInterface::ReadParameterD</a>(inp, moduleLocation, TEMPCstr.str(), <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae9bc290fd900003e6984f319eb544269">Do_Kupershtokh</a>, 0.0);</div>
<div class="line"><span class="lineno">  356</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a11c6271193ddf1f694f1bfc4227bf617">GasParameter</a>[n]       = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab8df6700e0802a129069281b338313d7">lbCriticalPressure</a>[n]/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a66544929ec9e15f973b2d349787a5993">CriticalDensity</a>[n]*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>*(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>)/(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>);</div>
<div class="line"><span class="lineno">  357</span>    }</div>
<div class="line"><span class="lineno">  358</span> </div>
<div class="line"><span class="lineno">  359</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa6aa8fda060bc8571b4b0a95464abd04">LiquidDensity</a> .resize(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>);</div>
<div class="line"><span class="lineno">  360</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a6720e11af1b05213fbba7af7e7047848">VaporDensity</a>  .resize(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>);</div>
<div class="line"><span class="lineno">  361</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa03483eba53de530daf4d2dbd62a8985">SurfaceTension</a>.resize(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>);</div>
<div class="line"><span class="lineno">  362</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7d68fa3e9c3b4dc37721947295a7507f">InterfaceWidth</a>.resize(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>);</div>
<div class="line"><span class="lineno">  363</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab45097494cc01fa93c7420778061d7ed">Do_Benzi</a>)</div>
<div class="line"><span class="lineno">  364</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno">  365</span>    {</div>
<div class="line"><span class="lineno">  366</span> </div>
<div class="line"><span class="lineno">  367</span>        <span class="keyword">const</span> BenziGas::EquilibriumValues_t Equilibrium =</div>
<div class="line"><span class="lineno">  368</span>            <a class="code hl_function" href="../../d1/d01/structopenphase_1_1BenziGas.html#abb19a21f219dccd485ad14c0b3247a12">BenziGas::EquilibriumValues</a>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a587965ea13dcb7fddac42b87da1df7cf">Gb</a>[n][n]/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>);</div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa6aa8fda060bc8571b4b0a95464abd04">LiquidDensity</a>  [n] = Equilibrium.lbLiquidDensity*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>;</div>
<div class="line"><span class="lineno">  371</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a6720e11af1b05213fbba7af7e7047848">VaporDensity</a>   [n] = Equilibrium.lbVaporDensity*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>;</div>
<div class="line"><span class="lineno">  372</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa03483eba53de530daf4d2dbd62a8985">SurfaceTension</a> [n] = Equilibrium.lbSurfaceTension*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5421bde5029b801f847f4ec190b3a5dc">dM</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>;</div>
<div class="line"><span class="lineno">  373</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7d68fa3e9c3b4dc37721947295a7507f">InterfaceWidth</a> [n] = 2.0; <span class="comment">//TODO calculate</span></div>
<div class="line"><span class="lineno">  374</span> </div>
<div class="line"><span class="lineno">  375</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a41683f616ffa4631340cb0de41cad70f">ConsoleOutput::Write</a>(<span class="stringliteral">&quot;Vapor density   [&quot;</span>+std::to_string(n)+<span class="stringliteral">&quot;]&quot;</span>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a6720e11af1b05213fbba7af7e7047848">VaporDensity</a>   [n]);</div>
<div class="line"><span class="lineno">  376</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a41683f616ffa4631340cb0de41cad70f">ConsoleOutput::Write</a>(<span class="stringliteral">&quot;Liquid density  [&quot;</span>+std::to_string(n)+<span class="stringliteral">&quot;]&quot;</span>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa6aa8fda060bc8571b4b0a95464abd04">LiquidDensity</a>  [n]);</div>
<div class="line"><span class="lineno">  377</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a41683f616ffa4631340cb0de41cad70f">ConsoleOutput::Write</a>(<span class="stringliteral">&quot;Surface tension [&quot;</span>+std::to_string(n)+<span class="stringliteral">&quot;]&quot;</span>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa03483eba53de530daf4d2dbd62a8985">SurfaceTension</a> [n]);</div>
<div class="line"><span class="lineno">  378</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a41683f616ffa4631340cb0de41cad70f">ConsoleOutput::Write</a>(<span class="stringliteral">&quot;Interface width [&quot;</span>+std::to_string(n)+<span class="stringliteral">&quot;]&quot;</span>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7d68fa3e9c3b4dc37721947295a7507f">InterfaceWidth</a> [n]);</div>
<div class="line"><span class="lineno">  379</span>    }</div>
<div class="line"><span class="lineno">  380</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae9bc290fd900003e6984f319eb544269">Do_Kupershtokh</a>)</div>
<div class="line"><span class="lineno">  381</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno">  382</span>    {</div>
<div class="line"><span class="lineno">  383</span>        <span class="keyword">const</span> VanDerWaalsGas::EquilibriumValues_t Equilibrium =</div>
<div class="line"><span class="lineno">  384</span>            <a class="code hl_function" href="../../dc/dbb/structopenphase_1_1VanDerWaalsGas.html#a950642927785bbfb8e25d5afa58ee758">VanDerWaalsGas::EquilibriumValues</a>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a135999305b00dce046d03db79817e69e">lbTemperature</a>[n], <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a405aa37be090a3d967abab6df1f941ba">lbCriticalTemperature</a>[n]);</div>
<div class="line"><span class="lineno">  385</span> </div>
<div class="line"><span class="lineno">  386</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa6aa8fda060bc8571b4b0a95464abd04">LiquidDensity</a>  [n] = Equilibrium.LiquidDensity*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>;</div>
<div class="line"><span class="lineno">  387</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a6720e11af1b05213fbba7af7e7047848">VaporDensity</a>   [n] = Equilibrium.VaporDensity*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>;</div>
<div class="line"><span class="lineno">  388</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa03483eba53de530daf4d2dbd62a8985">SurfaceTension</a> [n] = 0.0*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5421bde5029b801f847f4ec190b3a5dc">dM</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>; <span class="comment">//TODO</span></div>
<div class="line"><span class="lineno">  389</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7d68fa3e9c3b4dc37721947295a7507f">InterfaceWidth</a> [n] = 0.402819*std::pow(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a11c6271193ddf1f694f1bfc4227bf617">GasParameter</a>[n],-0.470509);</div>
<div class="line"><span class="lineno">  390</span> </div>
<div class="line"><span class="lineno">  391</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a41683f616ffa4631340cb0de41cad70f">ConsoleOutput::Write</a>(<span class="stringliteral">&quot;Vapor density   [&quot;</span>+std::to_string(n)+<span class="stringliteral">&quot;]&quot;</span>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a6720e11af1b05213fbba7af7e7047848">VaporDensity</a>   [n]);</div>
<div class="line"><span class="lineno">  392</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a41683f616ffa4631340cb0de41cad70f">ConsoleOutput::Write</a>(<span class="stringliteral">&quot;Liquid density  [&quot;</span>+std::to_string(n)+<span class="stringliteral">&quot;]&quot;</span>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa6aa8fda060bc8571b4b0a95464abd04">LiquidDensity</a>  [n]);</div>
<div class="line"><span class="lineno">  393</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a41683f616ffa4631340cb0de41cad70f">ConsoleOutput::Write</a>(<span class="stringliteral">&quot;Surface tension [&quot;</span>+std::to_string(n)+<span class="stringliteral">&quot;]&quot;</span>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa03483eba53de530daf4d2dbd62a8985">SurfaceTension</a> [n]);</div>
<div class="line"><span class="lineno">  394</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a41683f616ffa4631340cb0de41cad70f">ConsoleOutput::Write</a>(<span class="stringliteral">&quot;Interface width [&quot;</span>+std::to_string(n)+<span class="stringliteral">&quot;]&quot;</span>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7d68fa3e9c3b4dc37721947295a7507f">InterfaceWidth</a> [n]);</div>
<div class="line"><span class="lineno">  395</span>    }</div>
<div class="line"><span class="lineno">  396</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  397</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno">  398</span>    {</div>
<div class="line"><span class="lineno">  399</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa6aa8fda060bc8571b4b0a95464abd04">LiquidDensity</a>  [n] = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>;</div>
<div class="line"><span class="lineno">  400</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a6720e11af1b05213fbba7af7e7047848">VaporDensity</a>   [n] = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>;</div>
<div class="line"><span class="lineno">  401</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7d68fa3e9c3b4dc37721947295a7507f">InterfaceWidth</a> [n] = 1.0;</div>
<div class="line"><span class="lineno">  402</span>    }</div>
<div class="line"><span class="lineno">  403</span> </div>
<div class="line"><span class="lineno">  404</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aad6241df3842eb309a60fd8d55888559">U0X</a>  = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a8077611f56a17832ac4d22d604df6dcd">FileInterface::ReadParameterD</a>(inp, moduleLocation, std::string(<span class="stringliteral">&quot;U0X&quot;</span>), <span class="keyword">false</span>, 0.0);</div>
<div class="line"><span class="lineno">  405</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3d8f89a8680b20a5f22438db5dacbfc8">U0Y</a>  = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a8077611f56a17832ac4d22d604df6dcd">FileInterface::ReadParameterD</a>(inp, moduleLocation, std::string(<span class="stringliteral">&quot;U0Y&quot;</span>), <span class="keyword">false</span>, 0.0);</div>
<div class="line"><span class="lineno">  406</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a85853583f9b71927e8de8fb66cb4fb09">U0Z</a>  = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a8077611f56a17832ac4d22d604df6dcd">FileInterface::ReadParameterD</a>(inp, moduleLocation, std::string(<span class="stringliteral">&quot;U0Z&quot;</span>), <span class="keyword">false</span>, 0.0);</div>
<div class="line"><span class="lineno">  407</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a39e6431910d6e1d9558b91d0a59f6828">Pth0</a> = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a8077611f56a17832ac4d22d604df6dcd">FileInterface::ReadParameterD</a>(inp, moduleLocation, std::string(<span class="stringliteral">&quot;Pth0&quot;</span>), <span class="keyword">false</span>, 1.0e5);</div>
<div class="line"><span class="lineno">  408</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1b542beebb14e3182c7948b30f3eefd8">Poutlet</a> = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a8077611f56a17832ac4d22d604df6dcd">FileInterface::ReadParameterD</a>(inp, moduleLocation, std::string(<span class="stringliteral">&quot;Poutlet&quot;</span>), <span class="keyword">false</span>, 1.0e5);</div>
<div class="line"><span class="lineno">  409</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad56f87a52b427bb6a4646208d54574c1">Pth</a>    = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a39e6431910d6e1d9558b91d0a59f6828">Pth0</a>;</div>
<div class="line"><span class="lineno">  410</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a62404913cee1f48eebbf6afbeb13b5d0">PthOld</a> = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a39e6431910d6e1d9558b91d0a59f6828">Pth0</a>;</div>
<div class="line"><span class="lineno">  411</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1b542beebb14e3182c7948b30f3eefd8">Poutlet</a> = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1b542beebb14e3182c7948b30f3eefd8">Poutlet</a> - 1.0e5 + 1.0e-4;</div>
<div class="line"><span class="lineno">  412</span> </div>
<div class="line"><span class="lineno">  413</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a733d0ed28089ce96e664da9b2508c692">Wetting</a>.resize(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>);</div>
<div class="line"><span class="lineno">  414</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a147890b1c75d4b407881212ea40ecf05">Do_TwoPhase</a>)</div>
<div class="line"><span class="lineno">  415</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno">  416</span>    {</div>
<div class="line"><span class="lineno">  417</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a733d0ed28089ce96e664da9b2508c692">Wetting</a>[n].resize(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9c5fb9cd4952a23292b686140a250279">Nphases</a>);</div>
<div class="line"><span class="lineno">  418</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> m = 0; m &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9c5fb9cd4952a23292b686140a250279">Nphases</a>; ++m)</div>
<div class="line"><span class="lineno">  419</span>        {</div>
<div class="line"><span class="lineno">  420</span>            std::stringstream TEMPCstr;</div>
<div class="line"><span class="lineno">  421</span>            TEMPCstr &lt;&lt; <span class="stringliteral">&quot;Wetting_&quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; m;</div>
<div class="line"><span class="lineno">  422</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a733d0ed28089ce96e664da9b2508c692">Wetting</a>[n][m] = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a8077611f56a17832ac4d22d604df6dcd">FileInterface::ReadParameterD</a>(inp, moduleLocation, TEMPCstr.str());</div>
<div class="line"><span class="lineno">  423</span>        }</div>
<div class="line"><span class="lineno">  424</span>    }</div>
<div class="line"><span class="lineno">  425</span> </div>
<div class="line"><span class="lineno">  426</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#acaf39436ee81673b389cf19247734fca">FluidMass</a>.resize(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>, 0.0);</div>
<div class="line"><span class="lineno">  427</span> </div>
<div class="line"><span class="lineno">  428</span>    <span class="comment">// NOTE: the minimum and maximum kinematic viscosity values are based</span></div>
<div class="line"><span class="lineno">  429</span>    <span class="comment">// on experience and may be adjusted.</span></div>
<div class="line"><span class="lineno">  430</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> nu_min = 0.05*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>;</div>
<div class="line"><span class="lineno">  431</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> nu_max = 1.00*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>;</div>
<div class="line"><span class="lineno">  432</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> nu_opt = 0.5/3.0*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>; <span class="comment">// optimal value !</span></div>
<div class="line"><span class="lineno">  433</span> </div>
<div class="line"><span class="lineno">  434</span>    <span class="comment">// Set relaxation parameter tau</span></div>
<div class="line"><span class="lineno">  435</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad8ae2a30dc85638b1a377cc2919200fe">lbtau</a>.resize(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>);</div>
<div class="line"><span class="lineno">  436</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno">  437</span>    {</div>
<div class="line"><span class="lineno">  438</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a79b3ebcd11696e18f2db1079356829e3">nu</a>[n] &lt; nu_min) or (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a79b3ebcd11696e18f2db1079356829e3">nu</a>[n] &gt; nu_max))</div>
<div class="line"><span class="lineno">  439</span>        {</div>
<div class="line"><span class="lineno">  440</span>            std::stringstream message;</div>
<div class="line"><span class="lineno">  441</span>            message &lt;&lt; <span class="stringliteral">&quot;Bad kinematic viscosity&quot;</span></div>
<div class="line"><span class="lineno">  442</span>                    &lt;&lt;            <span class="stringliteral">&quot;nu_lb = &quot;</span>&lt;&lt; std::scientific &lt;&lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a79b3ebcd11696e18f2db1079356829e3">nu</a>[n]</div>
<div class="line"><span class="lineno">  443</span>                    &lt;&lt; <span class="stringliteral">&quot;\n\t  (Min nu_lb = &quot;</span>&lt;&lt; std::scientific &lt;&lt; nu_min</div>
<div class="line"><span class="lineno">  444</span>                    &lt;&lt;      <span class="stringliteral">&quot;; Opt nu_lb = &quot;</span>&lt;&lt; std::scientific &lt;&lt; nu_opt</div>
<div class="line"><span class="lineno">  445</span>                    &lt;&lt;      <span class="stringliteral">&quot;; Max nu_lb = &quot;</span>&lt;&lt; std::scientific &lt;&lt; nu_max</div>
<div class="line"><span class="lineno">  446</span>                    &lt;&lt;<span class="stringliteral">&quot;)!\n\t  Simulation may be unstable! Adjust dx or dt.&quot;</span>;</div>
<div class="line"><span class="lineno">  447</span>            <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">ConsoleOutput::WriteWarning</a>(message.str(), <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, <span class="stringliteral">&quot;Initialize&quot;</span>);</div>
<div class="line"><span class="lineno">  448</span>        }</div>
<div class="line"><span class="lineno">  449</span> </div>
<div class="line"><span class="lineno">  450</span>        <span class="comment">// Set relaxation parameter tau</span></div>
<div class="line"><span class="lineno">  451</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad8ae2a30dc85638b1a377cc2919200fe">lbtau</a> [n] = 3*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a79b3ebcd11696e18f2db1079356829e3">nu</a>[n]/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a> + 0.5;</div>
<div class="line"><span class="lineno">  452</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;lbtau[&quot;</span>+std::to_string(n)+<span class="stringliteral">&quot;]&quot;</span>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad8ae2a30dc85638b1a377cc2919200fe">lbtau</a>[n]);</div>
<div class="line"><span class="lineno">  453</span>    }</div>
<div class="line"><span class="lineno">  454</span> </div>
<div class="line"><span class="lineno">  455</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ad86f674a75177eed4dd6cd8c06fcba47">ConsoleOutput::WriteLine</a>();</div>
<div class="line"><span class="lineno">  456</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#acf973fcf791b7ed17177550d8a7175e9">ConsoleOutput::WriteBlankLine</a>();</div>
<div class="line"><span class="lineno">  457</span>}</div>
<div class="ttc" id="aclassopenphase_1_1ConsoleOutput_html_acf973fcf791b7ed17177550d8a7175e9"><div class="ttname"><a href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#acf973fcf791b7ed17177550d8a7175e9">openphase::ConsoleOutput::WriteBlankLine</a></div><div class="ttdeci">static void WriteBlankLine(void)</div><div class="ttdef"><b>Definition</b> <a href="../../da/da0/ConsoleOutput_8cpp_source.html#l00129">ConsoleOutput.cpp:129</a></div></div>
<div class="ttc" id="aclassopenphase_1_1ConsoleOutput_html_ad86f674a75177eed4dd6cd8c06fcba47"><div class="ttname"><a href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ad86f674a75177eed4dd6cd8c06fcba47">openphase::ConsoleOutput::WriteLine</a></div><div class="ttdeci">static void WriteLine(const std::string LineType=&quot;-&quot;)</div><div class="ttdef"><b>Definition</b> <a href="../../da/da0/ConsoleOutput_8cpp_source.html#l00106">ConsoleOutput.cpp:106</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FileInterface_html_a05c3fb3e8b5d3a1d805b450014155f3d"><div class="ttname"><a href="../../d2/d61/classopenphase_1_1FileInterface.html#a05c3fb3e8b5d3a1d805b450014155f3d">openphase::FileInterface::ReadParameterI</a></div><div class="ttdeci">static int ReadParameterI(const std::stringstream &amp;Inp, int currentLocation, std::string Key, const bool mandatory=true, int const defaultval=0)</div><div class="ttdef"><b>Definition</b> <a href="../../df/de6/FileInterface_8cpp_source.html#l01902">FileInterface.cpp:1902</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FileInterface_html_a1b38acae500f606496f04a55e714731c"><div class="ttname"><a href="../../d2/d61/classopenphase_1_1FileInterface.html#a1b38acae500f606496f04a55e714731c">openphase::FileInterface::ReadParameterB</a></div><div class="ttdeci">static bool ReadParameterB(const std::stringstream &amp;Inp, int currentLocation, std::string Key, const bool mandatory=true, const bool defaultval=false)</div><div class="ttdef"><b>Definition</b> <a href="../../df/de6/FileInterface_8cpp_source.html#l01316">FileInterface.cpp:1316</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FileInterface_html_a8077611f56a17832ac4d22d604df6dcd"><div class="ttname"><a href="../../d2/d61/classopenphase_1_1FileInterface.html#a8077611f56a17832ac4d22d604df6dcd">openphase::FileInterface::ReadParameterD</a></div><div class="ttdeci">static double ReadParameterD(const std::stringstream &amp;Inp, int currentLocation, const std::string Key, const bool mandatory=true, const double defaultval=0.0)</div><div class="ttdef"><b>Definition</b> <a href="../../df/de6/FileInterface_8cpp_source.html#l00257">FileInterface.cpp:257</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FileInterface_html_afbaeccd98923fc3babc30e1e7b3eed62"><div class="ttname"><a href="../../d2/d61/classopenphase_1_1FileInterface.html#afbaeccd98923fc3babc30e1e7b3eed62">openphase::FileInterface::FindModuleLocation</a></div><div class="ttdeci">static int FindModuleLocation(const std::stringstream &amp;Inp, const std::string module)</div><div class="ttdef"><b>Definition</b> <a href="../../df/de6/FileInterface_8cpp_source.html#l00129">FileInterface.cpp:129</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a3d8f89a8680b20a5f22438db5dacbfc8"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3d8f89a8680b20a5f22438db5dacbfc8">openphase::FlowSolverLBM::U0Y</a></div><div class="ttdeci">double U0Y</div><div class="ttdoc">Inlet Velocity in y direction [m/s].</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00206">FlowSolverLBM.h:206</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a5421bde5029b801f847f4ec190b3a5dc"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5421bde5029b801f847f4ec190b3a5dc">openphase::FlowSolverLBM::dM</a></div><div class="ttdeci">double dM</div><div class="ttdoc">Coefficient to calculate physical mass from lattice mass [Kg].</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00222">FlowSolverLBM.h:222</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a733d0ed28089ce96e664da9b2508c692"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a733d0ed28089ce96e664da9b2508c692">openphase::FlowSolverLBM::Wetting</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; Wetting</div><div class="ttdoc">Wetting Parameter [Kg/m^3].</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00255">FlowSolverLBM.h:255</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a85853583f9b71927e8de8fb66cb4fb09"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a85853583f9b71927e8de8fb66cb4fb09">openphase::FlowSolverLBM::U0Z</a></div><div class="ttdeci">double U0Z</div><div class="ttdoc">Inlet Velocity in z direction [m/s].</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00207">FlowSolverLBM.h:207</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a92c22f0dfe11f8b261391b7e73fdc2f4"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92c22f0dfe11f8b261391b7e73fdc2f4">openphase::FlowSolverLBM::Do_DI</a></div><div class="ttdeci">bool Do_DI</div><div class="ttdoc">Set to &quot;true&quot; if the interface considered diffuse.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00193">FlowSolverLBM.h:193</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_aa03483eba53de530daf4d2dbd62a8985"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa03483eba53de530daf4d2dbd62a8985">openphase::FlowSolverLBM::SurfaceTension</a></div><div class="ttdeci">std::vector&lt; double &gt; SurfaceTension</div><div class="ttdoc">Surface tension (physical units) [kg/s^2].</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00240">FlowSolverLBM.h:240</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_aad6241df3842eb309a60fd8d55888559"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aad6241df3842eb309a60fd8d55888559">openphase::FlowSolverLBM::U0X</a></div><div class="ttdeci">double U0X</div><div class="ttdoc">Inlet Velocity in x direction [m/s].</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00205">FlowSolverLBM.h:205</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_ad91501a0b7baf58043f1c744d858816d"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">openphase::FlowSolverLBM::FluidRedistributionRange</a></div><div class="ttdeci">int FluidRedistributionRange</div><div class="ttdoc">Fluid distribution range in case of 2 phase flow.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/FlowSolverLBM_8h_source.html#l00233">FlowSolverLBM.h:233</a></div></div>
<div class="ttc" id="astructopenphase_1_1BenziGas_html_abb19a21f219dccd485ad14c0b3247a12"><div class="ttname"><a href="../../d1/d01/structopenphase_1_1BenziGas.html#abb19a21f219dccd485ad14c0b3247a12">openphase::BenziGas::EquilibriumValues</a></div><div class="ttdeci">static EquilibriumValues_t EquilibriumValues(const double BennziParameter)</div><div class="ttdoc">Calculates the equilibrium densities.</div><div class="ttdef"><b>Definition</b> <a href="../../dc/df1/BenziGas_8cpp_source.html#l00034">BenziGas.cpp:34</a></div></div>
<div class="ttc" id="astructopenphase_1_1VanDerWaalsGas_html_a950642927785bbfb8e25d5afa58ee758"><div class="ttname"><a href="../../dc/dbb/structopenphase_1_1VanDerWaalsGas.html#a950642927785bbfb8e25d5afa58ee758">openphase::VanDerWaalsGas::EquilibriumValues</a></div><div class="ttdeci">static EquilibriumValues_t EquilibriumValues(const double Temperature, const double CriticalTemperature=1.0, const double LaplacePressure=0.0)</div><div class="ttdoc">Calculates the equilibrium densities.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d47/VanDerWaalsGas_8cpp_source.html#l00032">VanDerWaalsGas.cpp:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4e6f273f5ed0752225c0060c9e044a18" name="a4e6f273f5ed0752225c0060c9e044a18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e6f273f5ed0752225c0060c9e044a18">&#9670;&#160;</a></span>Remesh()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::Remesh </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>newNx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>newNy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>newNz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#af421c7d819be4718f586fb3f97c34583">openphase::OPObject</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00481">481</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  483</span>{</div>
<div class="line"><span class="lineno">  484</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_function" href="../../dc/d18/classopenphase_1_1GridParameters.html#a9b5bec6fce00e1d8169690ad16c7563d">SetDimensions</a>(newNx, newNy, newNz);</div>
<div class="line"><span class="lineno">  485</span> </div>
<div class="line"><span class="lineno">  486</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>  .<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#a0d8d0ac8475f544e2e72929d4b9bae12">Reallocate</a>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>);</div>
<div class="line"><span class="lineno">  487</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>        .<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#a0d8d0ac8475f544e2e72929d4b9bae12">Reallocate</a>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>);</div>
<div class="line"><span class="lineno">  488</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a> .Reallocate(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>);</div>
<div class="line"><span class="lineno">  489</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>    .Reallocate(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>);</div>
<div class="line"><span class="lineno">  490</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>   .Reallocate(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>);</div>
<div class="line"><span class="lineno">  491</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2ab90fa6fd8a7c36d86144281f5b0caa">lbPopulationsTMP</a>.Reallocate(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>);</div>
<div class="line"><span class="lineno">  492</span>}</div>
<div class="ttc" id="aclassopenphase_1_1GridParameters_html_a9b5bec6fce00e1d8169690ad16c7563d"><div class="ttname"><a href="../../dc/d18/classopenphase_1_1GridParameters.html#a9b5bec6fce00e1d8169690ad16c7563d">openphase::GridParameters::SetDimensions</a></div><div class="ttdeci">void SetDimensions(int total_nx, int total_ny, int total_nz)</div><div class="ttdoc">Sets grid parameters.</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d43/GridParameters_8cpp_source.html#l00645">GridParameters.cpp:645</a></div></div>
<div class="ttc" id="aclassopenphase_1_1Storage3D_html_a0d8d0ac8475f544e2e72929d4b9bae12"><div class="ttname"><a href="../../da/d19/classopenphase_1_1Storage3D.html#a0d8d0ac8475f544e2e72929d4b9bae12">openphase::Storage3D::Reallocate</a></div><div class="ttdeci">void Reallocate(const long int nx, const long int ny, const long int nz)</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d8e/Storage3D_8h_source.html#l00814">Storage3D.h:814</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae707969f20e943c0db6228ad2e1af981" name="ae707969f20e943c0db6228ad2e1af981"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae707969f20e943c0db6228ad2e1af981">&#9670;&#160;</a></span>SecondOrderBounceBack()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::SecondOrderBounceBack </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ii</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>jj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>kk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>lbDensityChange</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>BounceBack at Solid Interfaces. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l01716">1716</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1719</span>{</div>
<div class="line"><span class="lineno"> 1720</span>    <span class="keywordtype">double</span> NewPopulation = 0.0;</div>
<div class="line"><span class="lineno"> 1721</span>    <span class="keywordtype">size_t</span> Gasidx = 0;</div>
<div class="line"><span class="lineno"> 1722</span>    <span class="comment">//size_t Solididx = 0;</span></div>
<div class="line"><span class="lineno"> 1723</span>    <span class="comment">//double ep=1e-9;</span></div>
<div class="line"><span class="lineno"> 1724</span>    <span class="keywordflow">for</span>(<span class="keyword">auto</span> it = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).cbegin(); it != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).cend(); ++it)</div>
<div class="line"><span class="lineno"> 1725</span>    <span class="keywordflow">if</span>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[it-&gt;index].State == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a545a7e1c8dca42c00f8f139a1913c61ca635459702f9817de29e608fa3395637c">AggregateStates::Gas</a>)</div>
<div class="line"><span class="lineno"> 1726</span>    {</div>
<div class="line"><span class="lineno"> 1727</span>        Gasidx = it-&gt;index;</div>
<div class="line"><span class="lineno"> 1728</span>    }</div>
<div class="line"><span class="lineno"> 1729</span>    dVector3 Norm{0.0,0.0,0.0};</div>
<div class="line"><span class="lineno"> 1730</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i-ii,j-jj,k-kk).cbegin(); it != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i-ii,j-jj,k-kk).cend(); ++it)</div>
<div class="line"><span class="lineno"> 1731</span>    {</div>
<div class="line"><span class="lineno"> 1732</span>       <span class="keywordflow">if</span>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[it-&gt;index].State == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a545a7e1c8dca42c00f8f139a1913c61cae41480b6bbfbf7407974a88d3d34f4fa">AggregateStates::Solid</a>)</div>
<div class="line"><span class="lineno"> 1733</span>       {</div>
<div class="line"><span class="lineno"> 1734</span>            <span class="comment">//Solididx=it-&gt;index;</span></div>
<div class="line"><span class="lineno"> 1735</span>            NodeAB&lt;dVector3,dVector3&gt; Normals = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Normals(i, j, k);</div>
<div class="line"><span class="lineno"> 1736</span>              <span class="comment">//dVector3 Norm = Normals.get_asym1(Solididx, Gasidx);</span></div>
<div class="line"><span class="lineno"> 1737</span>       }</div>
<div class="line"><span class="lineno"> 1738</span>    }</div>
<div class="line"><span class="lineno"> 1739</span> </div>
<div class="line"><span class="lineno"> 1740</span>    <span class="keywordtype">double</span> Phif   = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fractions(i,j,k,{Gasidx});</div>
<div class="line"><span class="lineno"> 1741</span>    <span class="keywordtype">double</span> DX     = fabs(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth/<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a> * asin(1.0-2.0*Phif));</div>
<div class="line"><span class="lineno"> 1742</span>    <span class="comment">//double DX   = fabs(Phase.iWidth/Pi * acos(2.0*Phif-1));</span></div>
<div class="line"><span class="lineno"> 1743</span>    dVector3 X    = Norm*DX;</div>
<div class="line"><span class="lineno"> 1744</span>    dVector3 Xf   = {double(i), double(j), double(k)};</div>
<div class="line"><span class="lineno"> 1745</span>    dVector3 Xs   = {double(i-ii), double(j-jj), double(k-kk)};</div>
<div class="line"><span class="lineno"> 1746</span>    dVector3 Xsf;</div>
<div class="line"><span class="lineno"> 1747</span>    <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a8c0f8b77e0d42687ea8c78fb3f9b6d88">CalculateDistancePeriodic</a>(Xf, Xs, Xsf, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>);</div>
<div class="line"><span class="lineno"> 1748</span>    <span class="keywordtype">double</span> l      = Xsf.length();</div>
<div class="line"><span class="lineno"> 1749</span>    dVector3 esf  = Xsf.normalize();</div>
<div class="line"><span class="lineno"> 1750</span>    <span class="keywordtype">double</span> q      = X.abs() / (Norm * esf);</div>
<div class="line"><span class="lineno"> 1751</span>    q=q/l;</div>
<div class="line"><span class="lineno"> 1752</span> </div>
<div class="line"><span class="lineno"> 1753</span>    <span class="keywordflow">if</span>(q&gt;1.0)</div>
<div class="line"><span class="lineno"> 1754</span>    {</div>
<div class="line"><span class="lineno"> 1755</span>        q=1.0;</div>
<div class="line"><span class="lineno"> 1756</span>    }</div>
<div class="line"><span class="lineno"> 1757</span> </div>
<div class="line"><span class="lineno"> 1758</span>    <span class="keywordflow">if</span>(q&lt;0.5)</div>
<div class="line"><span class="lineno"> 1759</span>    {</div>
<div class="line"><span class="lineno"> 1760</span>        NewPopulation = 2.0*q*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n})(-ii,-jj,-kk)</div>
<div class="line"><span class="lineno"> 1761</span>                    +(1.0-2.0*q)*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i+ii,j+jj,k+kk,{n})(-ii,-jj,-kk);</div>
<div class="line"><span class="lineno"> 1762</span>    }</div>
<div class="line"><span class="lineno"> 1763</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(q&gt;=0.5)</div>
<div class="line"><span class="lineno"> 1764</span>    {</div>
<div class="line"><span class="lineno"> 1765</span>        NewPopulation = 1.0/2.0/q*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n})(-ii,-jj,-kk)</div>
<div class="line"><span class="lineno"> 1766</span>                       +(2.0*q-1.0)/2.0/q*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n})(ii,jj,kk);</div>
<div class="line"><span class="lineno"> 1767</span>    }</div>
<div class="line"><span class="lineno"> 1768</span>    </div>
<div class="line"><span class="lineno"> 1769</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1770</span><span class="comment">    if(q&lt;0.5)</span></div>
<div class="line"><span class="lineno"> 1771</span><span class="comment">    {</span></div>
<div class="line"><span class="lineno"> 1772</span><span class="comment">        NewPopulation = q*(2.0*q+1.0)*lbPopulations(i,j,k,{n})(-ii,-jj,-kk)</span></div>
<div class="line"><span class="lineno"> 1773</span><span class="comment">                        +(1.0-4.0*q*q)*lbPopulations(i+ii,j+jj,k+kk,{n})(-ii,-jj,-kk)</span></div>
<div class="line"><span class="lineno"> 1774</span><span class="comment">                        -q*(1.0-2.0*q)*lbPopulations(i+2.0*ii,j+2.0*jj,k+2.0*kk,{n})(-ii,-jj,-kk);</span></div>
<div class="line"><span class="lineno"> 1775</span><span class="comment">    }</span></div>
<div class="line"><span class="lineno"> 1776</span><span class="comment">    else if(q&gt;=0.5)</span></div>
<div class="line"><span class="lineno"> 1777</span><span class="comment">    {</span></div>
<div class="line"><span class="lineno"> 1778</span><span class="comment">        NewPopulation = 1.0/(q*(2.0*q+1))*lbPopulations(i,j,k,{n})(-ii,-jj,-kk)</span></div>
<div class="line"><span class="lineno"> 1779</span><span class="comment">                        + (2.0*q-1.0)/q*lbPopulations(i,j,k,{n})(ii,jj,kk)</span></div>
<div class="line"><span class="lineno"> 1780</span><span class="comment">                        + (1.0-2.0*q)/(1.0+2.0*q)*lbPopulations(i+ii,j+jj,k+kk,{n})(ii,jj,kk);</span></div>
<div class="line"><span class="lineno"> 1781</span><span class="comment">    }</span></div>
<div class="line"><span class="lineno"> 1782</span><span class="comment">    */</span></div>
<div class="line"><span class="lineno"> 1783</span> </div>
<div class="line"><span class="lineno"> 1784</span>    <span class="keywordflow">return</span> NewPopulation;</div>
<div class="line"><span class="lineno"> 1785</span>}</div>
<div class="ttc" id="anamespaceopenphase_html_a2c26ef9422df111d9487d3d34cf3d613"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">openphase::Pi</a></div><div class="ttdeci">static constexpr double Pi</div><div class="ttdoc">Pi constant value.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/df1/Globals_8h_source.html#l00124">Globals.h:124</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_a545a7e1c8dca42c00f8f139a1913c61ca635459702f9817de29e608fa3395637c"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a545a7e1c8dca42c00f8f139a1913c61ca635459702f9817de29e608fa3395637c">openphase::AggregateStates::Gas</a></div><div class="ttdeci">@ Gas</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9bfe793fe9c76800a12f0a4249657268" name="a9bfe793fe9c76800a12f0a4249657268"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bfe793fe9c76800a12f0a4249657268">&#9670;&#160;</a></span>Set1DNonReflectingPressureOutletatBCXN()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::Set1DNonReflectingPressureOutletatBCXN </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;&#160;</td>
          <td class="paramname"><em>Vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l01338">1338</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1339</span>{</div>
<div class="line"><span class="lineno"> 1340</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 1341</span>    <span class="keywordflow">if</span>(MPI_CART_RANK[0] == MPI_CART_SIZE[0]-1)</div>
<div class="line"><span class="lineno"> 1342</span>    {</div>
<div class="line"><span class="lineno"> 1343</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>,0,)</div>
<div class="line"><span class="lineno"> 1344</span>        {</div>
<div class="line"><span class="lineno"> 1345</span>            <span class="keywordflow">if</span>(i==<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>-1)</div>
<div class="line"><span class="lineno"> 1346</span>            {</div>
<div class="line"><span class="lineno"> 1347</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 1348</span>                {</div>
<div class="line"><span class="lineno"> 1349</span>                    <span class="comment">//===========================</span></div>
<div class="line"><span class="lineno"> 1350</span>                    <span class="keywordtype">double</span> Pbold   = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afa690789441704b411b9252d930c2363">HydroPressure</a>(i,j,k,{n});</div>
<div class="line"><span class="lineno"> 1351</span>                    <span class="keywordtype">double</span> Pbmold  = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afa690789441704b411b9252d930c2363">HydroPressure</a>(i-1,j,k,{n});</div>
<div class="line"><span class="lineno"> 1352</span>                    <span class="keywordtype">double</span> Pbmmold = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afa690789441704b411b9252d930c2363">HydroPressure</a>(i-2,j,k,{n});</div>
<div class="line"><span class="lineno"> 1353</span> </div>
<div class="line"><span class="lineno"> 1354</span>                    <span class="keywordtype">double</span> uxbold  = Vel.Phase(i,j,k,{n})[0];</div>
<div class="line"><span class="lineno"> 1355</span>                    <span class="keywordtype">double</span> uxbmold = Vel.Phase(i-1,j,k,{n})[0];</div>
<div class="line"><span class="lineno"> 1356</span>                    <span class="keywordtype">double</span> uxbmmold= Vel.Phase(i-2,j,k,{n})[0];</div>
<div class="line"><span class="lineno"> 1357</span> </div>
<div class="line"><span class="lineno"> 1358</span>                    <span class="keywordtype">double</span> uzbold  = Vel.Phase(i,j,k,{n})[2];</div>
<div class="line"><span class="lineno"> 1359</span>                    <span class="keywordtype">double</span> uzbmold = Vel.Phase(i-1,j,k,{n})[2];</div>
<div class="line"><span class="lineno"> 1360</span>                    <span class="keywordtype">double</span> uzbmmold= Vel.Phase(i-2,j,k,{n})[2];</div>
<div class="line"><span class="lineno"> 1361</span> </div>
<div class="line"><span class="lineno"> 1362</span>                    <span class="keywordtype">double</span> rhob = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n});</div>
<div class="line"><span class="lineno"> 1363</span>                    <span class="keywordtype">double</span> rhobm= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i-1,j,k,{n});</div>
<div class="line"><span class="lineno"> 1364</span> </div>
<div class="line"><span class="lineno"> 1365</span>                    <span class="keywordtype">double</span> L1, L3, L5; <span class="comment">//charachteristics value</span></div>
<div class="line"><span class="lineno"> 1366</span>                    <span class="keywordtype">double</span> KMaxv = 0.2;</div>
<div class="line"><span class="lineno"> 1367</span>                    L1=KMaxv * (Pbold - <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1b542beebb14e3182c7948b30f3eefd8">Poutlet</a>);</div>
<div class="line"><span class="lineno"> 1368</span>                    L3= uxbold * (uzbold-uzbmold)/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>;</div>
<div class="line"><span class="lineno"> 1369</span>                    L5=(uxbold+sqrt(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5284a4950dae747d84ce23d74fd5963e">cs2</a>)) * ((Pbold-Pbmold)/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a> + rhob * sqrt(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5284a4950dae747d84ce23d74fd5963e">cs2</a>) * (uxbold-uxbmold)/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>);</div>
<div class="line"><span class="lineno"> 1370</span> </div>
<div class="line"><span class="lineno"> 1371</span>                    <span class="keywordtype">double</span> uxbn = uxbold - (L5-L1)*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/(2.0* sqrt(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5284a4950dae747d84ce23d74fd5963e">cs2</a>) * rhob );</div>
<div class="line"><span class="lineno"> 1372</span>                    <span class="keywordtype">double</span> uzbn = uzbold - L3 * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>;</div>
<div class="line"><span class="lineno"> 1373</span>                    <span class="keywordtype">double</span> pb   = Pbold - (L5+L1)*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/2.0;</div>
<div class="line"><span class="lineno"> 1374</span> </div>
<div class="line"><span class="lineno"> 1375</span>                    <span class="keywordflow">if</span>(uxbmold&lt;0)</div>
<div class="line"><span class="lineno"> 1376</span>                    {</div>
<div class="line"><span class="lineno"> 1377</span>                        L3= uxbmold * (uzbmold-uzbmmold)/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a> ;</div>
<div class="line"><span class="lineno"> 1378</span>                        L5=(uxbmold+sqrt(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5284a4950dae747d84ce23d74fd5963e">cs2</a>)) * ((Pbmold-Pbmmold)/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a> + rhobm * sqrt(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5284a4950dae747d84ce23d74fd5963e">cs2</a>) * (uxbmold-uxbmmold)/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>);</div>
<div class="line"><span class="lineno"> 1379</span>                        pb = Pbmold - (L5+L1)*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/2.0;</div>
<div class="line"><span class="lineno"> 1380</span>                        uxbn = uxbmold - (L5-L1)*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/(2.0* sqrt(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5284a4950dae747d84ce23d74fd5963e">cs2</a>) * rhobm );</div>
<div class="line"><span class="lineno"> 1381</span>                        uzbn = uzbmold - L3 * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>;</div>
<div class="line"><span class="lineno"> 1382</span>                    }</div>
<div class="line"><span class="lineno"> 1383</span>                    dVector3 lbub  = {uxbn*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>, 0.0, uzbn*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>};</div>
<div class="line"><span class="lineno"> 1384</span> </div>
<div class="line"><span class="lineno"> 1385</span>                    <span class="keywordtype">int</span> im = i-1;</div>
<div class="line"><span class="lineno"> 1386</span>                    <span class="keywordtype">double</span> pm = 0.0;</div>
<div class="line"><span class="lineno"> 1387</span>                    dVector3 Mvm = {0.0, 0.0, 0.0};</div>
<div class="line"><span class="lineno"> 1388</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ++ii)</div>
<div class="line"><span class="lineno"> 1389</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; ++jj)</div>
<div class="line"><span class="lineno"> 1390</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; ++kk)</div>
<div class="line"><span class="lineno"> 1391</span>                    {</div>
<div class="line"><span class="lineno"> 1392</span>                        <span class="keywordtype">double</span> rrm = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(im,j,k,{n})(ii,jj,kk);</div>
<div class="line"><span class="lineno"> 1393</span>                        pm  += rrm*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a83cd87469986a195f9a42c9fbff2f523">dP</a>;</div>
<div class="line"><span class="lineno"> 1394</span>                        Mvm[0] += rrm*ii*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0e7cad672eea608ab7c5ea5ed6946138">dm</a>;</div>
<div class="line"><span class="lineno"> 1395</span>                        Mvm[1] += rrm*jj*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0e7cad672eea608ab7c5ea5ed6946138">dm</a>;</div>
<div class="line"><span class="lineno"> 1396</span>                        Mvm[2] += rrm*kk*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0e7cad672eea608ab7c5ea5ed6946138">dm</a>;</div>
<div class="line"><span class="lineno"> 1397</span>                    }</div>
<div class="line"><span class="lineno"> 1398</span>                    dVector3 um = (Mvm * 3.0 + <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>(im,j,k,{n})*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/2.0)/rhobm;</div>
<div class="line"><span class="lineno"> 1399</span>                    pm =  <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5284a4950dae747d84ce23d74fd5963e">cs2</a>/2.0 *<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>* (  (um[0]*  <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2357615d61b1d4d4bb027c1dfa67260c">GradRho</a>(im,j,k,{n})[0] )</div>
<div class="line"><span class="lineno"> 1400</span>                                         +(um[1]*  <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2357615d61b1d4d4bb027c1dfa67260c">GradRho</a>(im,j,k,{n})[1] )</div>
<div class="line"><span class="lineno"> 1401</span>                                         +(um[2]*  <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2357615d61b1d4d4bb027c1dfa67260c">GradRho</a>(im,j,k,{n})[2] ) + rhobm * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2b6d93798b295d1969521ba48bdc9af1">DivVel</a>(i-1,j,k,{n}) ) + pm;</div>
<div class="line"><span class="lineno"> 1402</span> </div>
<div class="line"><span class="lineno"> 1403</span>                    dVector3 lbum = um *<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>;</div>
<div class="line"><span class="lineno"> 1404</span> </div>
<div class="line"><span class="lineno"> 1405</span>                    <span class="keywordtype">double</span> lbu2b  = lbub[0]*lbub[0]+lbub[1]*lbub[1]+lbub[2]*lbub[2];</div>
<div class="line"><span class="lineno"> 1406</span>                    <span class="keywordtype">double</span> lbu2m  = lbum[0]*lbum[0]+lbum[1]*lbum[1]+lbum[2]*lbum[2];</div>
<div class="line"><span class="lineno"> 1407</span> </div>
<div class="line"><span class="lineno"> 1408</span>                    <span class="keywordtype">double</span> lbtaub  = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a62faa8027eaa45caa436c65f032bc584">nut</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a74ae26b9feb1666e9c177e5e88558d8a">dnu</a>/<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a> + 0.5;</div>
<div class="line"><span class="lineno"> 1409</span>                    <span class="keywordtype">double</span> lbtaum  = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a62faa8027eaa45caa436c65f032bc584">nut</a>(im,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a74ae26b9feb1666e9c177e5e88558d8a">dnu</a>/<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a> + 0.5;</div>
<div class="line"><span class="lineno"> 1410</span>                    <span class="keywordtype">int</span> ii=-1;</div>
<div class="line"><span class="lineno"> 1411</span>                    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; ++jj)</div>
<div class="line"><span class="lineno"> 1412</span>                    {</div>
<div class="line"><span class="lineno"> 1413</span>                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; ++kk)</div>
<div class="line"><span class="lineno"> 1414</span>                        {</div>
<div class="line"><span class="lineno"> 1415</span>                            <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k-1) and kk==1)</div>
<div class="line"><span class="lineno"> 1416</span>                            {</div>
<div class="line"><span class="lineno"> 1417</span>                            }</div>
<div class="line"><span class="lineno"> 1418</span>                            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k+1) and kk==-1)</div>
<div class="line"><span class="lineno"> 1419</span>                            {</div>
<div class="line"><span class="lineno"> 1420</span> </div>
<div class="line"><span class="lineno"> 1421</span>                            }</div>
<div class="line"><span class="lineno"> 1422</span>                            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1423</span>                            {</div>
<div class="line"><span class="lineno"> 1424</span>                                dVector3 lbFbb       = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3b6d8de9f278b56d9346a2adb823a4e2">df</a>;</div>
<div class="line"><span class="lineno"> 1425</span>                                dVector3 lbFbm       = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>(im,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3b6d8de9f278b56d9346a2adb823a4e2">df</a>;</div>
<div class="line"><span class="lineno"> 1426</span>                                dVector3 lbGradRhob  = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2357615d61b1d4d4bb027c1dfa67260c">GradRho</a>(i,j,k,{n})*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>;</div>
<div class="line"><span class="lineno"> 1427</span>                                dVector3 lbGradRhom  = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2357615d61b1d4d4bb027c1dfa67260c">GradRho</a>(im,j,k,{n})*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>;</div>
<div class="line"><span class="lineno"> 1428</span>                                <span class="keywordtype">double</span> lbrhob        = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>;</div>
<div class="line"><span class="lineno"> 1429</span>                                <span class="keywordtype">double</span> lbrhom        = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(im,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>;</div>
<div class="line"><span class="lineno"> 1430</span>                                <span class="keywordtype">double</span> lbphb         = pb/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a83cd87469986a195f9a42c9fbff2f523">dP</a>;</div>
<div class="line"><span class="lineno"> 1431</span>                                <span class="keywordtype">double</span> lbphm         = pm/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a83cd87469986a195f9a42c9fbff2f523">dP</a>;</div>
<div class="line"><span class="lineno"> 1432</span>                                <span class="keywordtype">double</span> lbDivVelb     = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2b6d93798b295d1969521ba48bdc9af1">DivVel</a>(i,j,k,{n})*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>;</div>
<div class="line"><span class="lineno"> 1433</span>                                <span class="keywordtype">double</span> lbDivVelm     = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2b6d93798b295d1969521ba48bdc9af1">DivVel</a>(im,j,k,{n})*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>;</div>
<div class="line"><span class="lineno"> 1434</span>                                <span class="comment">//double factorb       = (1.0+1.0/(2.0*lbtaub));</span></div>
<div class="line"><span class="lineno"> 1435</span>                                <span class="keywordtype">double</span> factorm       = (1.0+1.0/(2.0*lbtaum));</div>
<div class="line"><span class="lineno"> 1436</span>                                <span class="keywordtype">double</span> CRb           = (ii-lbub[0])*lbGradRhob[0]+(jj-lbub[1])*lbGradRhob[1]+(kk-lbub[2])*lbGradRhob[2];</div>
<div class="line"><span class="lineno"> 1437</span>                                <span class="keywordtype">double</span> CRm           = (ii-lbum[0])*lbGradRhom[0]+(jj-lbum[1])*lbGradRhom[1]+(kk-lbum[2])*lbGradRhom[2];</div>
<div class="line"><span class="lineno"> 1438</span>                                <span class="keywordtype">double</span> CFb           = (ii-lbub[0])*lbFbb[0]+(jj-lbub[1])*lbFbb[1]+(kk-lbub[2])*lbFbb[2];</div>
<div class="line"><span class="lineno"> 1439</span>                                <span class="keywordtype">double</span> CFm           = (ii-lbum[0])*lbFbm[0]+(jj-lbum[1])*lbFbm[1]+(kk-lbum[2])*lbFbm[2];</div>
<div class="line"><span class="lineno"> 1440</span>                                <span class="keywordtype">double</span> lbw           = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92539bf6d5ed043520c0bdbc47c334a9">lbWeights</a>[ii+1][jj+1][kk+1];</div>
<div class="line"><span class="lineno"> 1441</span>                                <span class="keywordtype">double</span> lbcub         = ii*lbub[0] + jj*lbub[1] + kk*lbub[2];</div>
<div class="line"><span class="lineno"> 1442</span>                                <span class="keywordtype">double</span> lbcum         = ii*lbum[0] + jj*lbum[1] + kk*lbum[2];</div>
<div class="line"><span class="lineno"> 1443</span>                                <span class="keywordtype">double</span> Feqb          = lbrhob * lbw *(1.0 + lbcub/<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>- lbu2b/(2.0*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>) + lbcub*lbcub/(2.0*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>) );</div>
<div class="line"><span class="lineno"> 1444</span>                                <span class="keywordtype">double</span> Feqm          = lbrhom * lbw *(1.0 + lbcum/<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>- lbu2m/(2.0*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>) + lbcum*lbcum/(2.0*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>) );</div>
<div class="line"><span class="lineno"> 1445</span>                                <span class="keywordtype">double</span> geqb          = Feqb*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a> + (lbphb - lbrhob * <a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a> ) * lbw; </div>
<div class="line"><span class="lineno"> 1446</span>                                <span class="keywordtype">double</span> geqm          = Feqm*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a> + (lbphm - lbrhom * <a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a> ) * lbw; </div>
<div class="line"><span class="lineno"> 1447</span>                                <span class="keywordtype">double</span> Ab            = 0.5 * (lbw*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>*lbrhob*lbDivVelb+CRb*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>*(Feqb/lbrhob-lbw)+ CFb*Feqb/lbrhob);</div>
<div class="line"><span class="lineno"> 1448</span>                                <span class="keywordtype">double</span> Am            = 0.5 * (lbw*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>*lbrhom*lbDivVelm+CRm*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>*(Feqm/lbrhom-lbw)+ CFm*Feqm/lbrhom);</div>
<div class="line"><span class="lineno"> 1449</span>                                <span class="keywordtype">double</span> gbm           = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(im,j,k,{n})(ii,jj,kk);</div>
<div class="line"><span class="lineno"> 1450</span>                                <span class="keywordtype">double</span> gm            = (gbm+1/lbtaum/2.0*geqm+Am)/factorm;</div>
<div class="line"><span class="lineno"> 1451</span>                                <span class="keywordtype">double</span> gb            = geqb + gm - geqm;</div>
<div class="line"><span class="lineno"> 1452</span>                                <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n})(ii,jj,kk) = gb - 1/2.0/lbtaub * (geqb-gm) - Ab;</div>
<div class="line"><span class="lineno"> 1453</span>                            }</div>
<div class="line"><span class="lineno"> 1454</span>                        }</div>
<div class="line"><span class="lineno"> 1455</span>                    }</div>
<div class="line"><span class="lineno"> 1456</span>                }</div>
<div class="line"><span class="lineno"> 1457</span>            }</div>
<div class="line"><span class="lineno"> 1458</span>        }</div>
<div class="line"><span class="lineno"> 1459</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1460</span>    }</div>
<div class="line"><span class="lineno"> 1461</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1462</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aac503798c87d57cd342e2d56063f481b" name="aac503798c87d57cd342e2d56063f481b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac503798c87d57cd342e2d56063f481b">&#9670;&#160;</a></span>SetBoundaryConditions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::SetBoundaryConditions </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets boundary conditions for the particle distribution functions and flow velocities. </p>

<p>Reimplemented from <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#a098bf706cf87cf06361ec9bca1c7d32c">openphase::OPObject</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00695">695</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  696</span>{</div>
<div class="line"><span class="lineno">  697</span>    BC.SetXVector(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>);</div>
<div class="line"><span class="lineno">  698</span>    BC.SetYVector(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>);</div>
<div class="line"><span class="lineno">  699</span>    BC.SetZVector(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>);</div>
<div class="line"><span class="lineno">  700</span> </div>
<div class="line"><span class="lineno">  701</span>    BC.SetX(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>);</div>
<div class="line"><span class="lineno">  702</span>    BC.SetY(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>);</div>
<div class="line"><span class="lineno">  703</span>    BC.SetZ(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>);</div>
<div class="line"><span class="lineno">  704</span> </div>
<div class="line"><span class="lineno">  705</span>    BC.SetXVector(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a>);</div>
<div class="line"><span class="lineno">  706</span>    BC.SetYVector(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a>);</div>
<div class="line"><span class="lineno">  707</span>    BC.SetZVector(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a>);</div>
<div class="line"><span class="lineno">  708</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a06a19a74bb3b814f2cebd8b8eacbdec8" name="a06a19a74bb3b814f2cebd8b8eacbdec8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06a19a74bb3b814f2cebd8b8eacbdec8">&#9670;&#160;</a></span>SetCornerCorrection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::SetCornerCorrection </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l01140">1140</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1141</span>{</div>
<div class="line"><span class="lineno"> 1142</span> </div>
<div class="line"><span class="lineno"> 1143</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 1144</span>    <span class="keywordflow">if</span>(MPI_CART_RANK[0]==0)</div>
<div class="line"><span class="lineno"> 1145</span>    {</div>
<div class="line"><span class="lineno"> 1146</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#af665bb9655e7117ac70af33f7c40ef9f">Bcells</a>(),)</div>
<div class="line"><span class="lineno"> 1147</span>        {</div>
<div class="line"><span class="lineno"> 1148</span>            <span class="keywordflow">if</span>(i==0)</div>
<div class="line"><span class="lineno"> 1149</span>            {</div>
<div class="line"><span class="lineno"> 1150</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k) and <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k-1))   <span class="comment">//left corners</span></div>
<div class="line"><span class="lineno"> 1151</span>                {</div>
<div class="line"><span class="lineno"> 1152</span>                    <span class="keywordtype">double</span> lbUx=<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aad6241df3842eb309a60fd8d55888559">U0X</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>;</div>
<div class="line"><span class="lineno"> 1153</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 1154</span>                    {</div>
<div class="line"><span class="lineno"> 1155</span>                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ii = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ++ii)</div>
<div class="line"><span class="lineno"> 1156</span>                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; ++jj)</div>
<div class="line"><span class="lineno"> 1157</span>                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; ++kk)</div>
<div class="line"><span class="lineno"> 1158</span>                        {</div>
<div class="line"><span class="lineno"> 1159</span> </div>
<div class="line"><span class="lineno"> 1160</span>                            <span class="keywordflow">if</span>(ii==1 and kk==0)</div>
<div class="line"><span class="lineno"> 1161</span>                            {</div>
<div class="line"><span class="lineno"> 1162</span>                                <span class="keywordtype">double</span> cu = ii*lbUx;</div>
<div class="line"><span class="lineno"> 1163</span>                                <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i-ii,j-jj,k-kk,{n})(ii,jj,kk)=<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i+ii,j+jj,k+kk,{n})(-ii,-jj,-kk)</div>
<div class="line"><span class="lineno"> 1164</span>                                                                    +2.0*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92539bf6d5ed043520c0bdbc47c334a9">lbWeights</a>[ii+1][jj+1][kk+1] * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i-ii,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a> * cu;</div>
<div class="line"><span class="lineno"> 1165</span>                            }</div>
<div class="line"><span class="lineno"> 1166</span>                            <span class="keywordflow">if</span>(ii==1 and kk==-1)</div>
<div class="line"><span class="lineno"> 1167</span>                            {</div>
<div class="line"><span class="lineno"> 1168</span>                                <span class="keywordtype">double</span> cu = ii*lbUx;</div>
<div class="line"><span class="lineno"> 1169</span>                                <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i-ii,j-jj,k-kk,{n})(ii,jj,kk)=<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n})(-ii,-jj,-kk)</div>
<div class="line"><span class="lineno"> 1170</span>                                        +2.0*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92539bf6d5ed043520c0bdbc47c334a9">lbWeights</a>[ii+1][jj+1][kk+1] * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i-ii,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a> * cu;</div>
<div class="line"><span class="lineno"> 1171</span>                            }</div>
<div class="line"><span class="lineno"> 1172</span>                        }</div>
<div class="line"><span class="lineno"> 1173</span>                    }</div>
<div class="line"><span class="lineno"> 1174</span>                }</div>
<div class="line"><span class="lineno"> 1175</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k) and <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k+1))   <span class="comment">//right corners</span></div>
<div class="line"><span class="lineno"> 1176</span>                {</div>
<div class="line"><span class="lineno"> 1177</span>                    <span class="keywordtype">double</span> lbUx=<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aad6241df3842eb309a60fd8d55888559">U0X</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>;</div>
<div class="line"><span class="lineno"> 1178</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 1179</span>                    {</div>
<div class="line"><span class="lineno"> 1180</span>                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ii = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ++ii)</div>
<div class="line"><span class="lineno"> 1181</span>                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; ++jj)</div>
<div class="line"><span class="lineno"> 1182</span>                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; ++kk)</div>
<div class="line"><span class="lineno"> 1183</span>                        {</div>
<div class="line"><span class="lineno"> 1184</span>                            <span class="keywordflow">if</span>(ii==1 and kk==0)</div>
<div class="line"><span class="lineno"> 1185</span>                            {</div>
<div class="line"><span class="lineno"> 1186</span>                                <span class="keywordtype">double</span> cu = ii*lbUx;</div>
<div class="line"><span class="lineno"> 1187</span>                                <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i-ii,j-jj,k-kk,{n})(ii,jj,kk)=<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i+ii,j+jj,k+kk,{n})(-ii,-jj,-kk)</div>
<div class="line"><span class="lineno"> 1188</span>                                                                    +2.0*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92539bf6d5ed043520c0bdbc47c334a9">lbWeights</a>[ii+1][jj+1][kk+1] * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i-ii,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a> * cu;</div>
<div class="line"><span class="lineno"> 1189</span>                            }</div>
<div class="line"><span class="lineno"> 1190</span>                            <span class="keywordflow">if</span>(ii==1 and kk==1)</div>
<div class="line"><span class="lineno"> 1191</span>                            {</div>
<div class="line"><span class="lineno"> 1192</span>                                <span class="keywordtype">double</span> cu = ii*lbUx;</div>
<div class="line"><span class="lineno"> 1193</span>                                <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i-ii,j-jj,k-kk,{n})(ii,jj,kk)=<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n})(-ii,-jj,-kk)</div>
<div class="line"><span class="lineno"> 1194</span>                                        +2.0*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92539bf6d5ed043520c0bdbc47c334a9">lbWeights</a>[ii+1][jj+1][kk+1] * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i-ii,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a> * cu;</div>
<div class="line"><span class="lineno"> 1195</span>                            }</div>
<div class="line"><span class="lineno"> 1196</span>                        }</div>
<div class="line"><span class="lineno"> 1197</span>                    }</div>
<div class="line"><span class="lineno"> 1198</span>                }</div>
<div class="line"><span class="lineno"> 1199</span>            }</div>
<div class="line"><span class="lineno"> 1200</span>        }</div>
<div class="line"><span class="lineno"> 1201</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1202</span>    }</div>
<div class="line"><span class="lineno"> 1203</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1204</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8634cfcc3c329c853ca93f586922d121" name="a8634cfcc3c329c853ca93f586922d121"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8634cfcc3c329c853ca93f586922d121">&#9670;&#160;</a></span>SetDivUnearBCsZeroXZPlane()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::SetDivUnearBCsZeroXZPlane </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02547">2547</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2548</span>{</div>
<div class="line"><span class="lineno"> 2549</span> </div>
<div class="line"><span class="lineno"> 2550</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 2551</span>{</div>
<div class="line"><span class="lineno"> 2552</span>    <span class="keywordflow">if</span>(MPI_CART_RANK[0]==0)</div>
<div class="line"><span class="lineno"> 2553</span>    {</div>
<div class="line"><span class="lineno"> 2554</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=-<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#a120fc8665123a3d1e254d6bec5703568">BcellsY</a>(); j&lt;<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>+<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#a120fc8665123a3d1e254d6bec5703568">BcellsY</a>(); j++)</div>
<div class="line"><span class="lineno"> 2555</span>        {</div>
<div class="line"><span class="lineno"> 2556</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=-<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#ae5b7f46778808a4c932c08f0a1d83a6c">BcellsZ</a>(); k&lt;<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>+<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#ae5b7f46778808a4c932c08f0a1d83a6c">BcellsZ</a>(); k++)</div>
<div class="line"><span class="lineno"> 2557</span>            {</div>
<div class="line"><span class="lineno"> 2558</span>                <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2b6d93798b295d1969521ba48bdc9af1">DivVel</a>(0,j,k,{0})=0.0;</div>
<div class="line"><span class="lineno"> 2559</span>            }</div>
<div class="line"><span class="lineno"> 2560</span>        }</div>
<div class="line"><span class="lineno"> 2561</span>    }</div>
<div class="line"><span class="lineno"> 2562</span> </div>
<div class="line"><span class="lineno"> 2563</span>    <span class="keywordflow">if</span>(MPI_CART_RANK[0]==MPI_CART_SIZE[0]-1)</div>
<div class="line"><span class="lineno"> 2564</span>    {</div>
<div class="line"><span class="lineno"> 2565</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=-<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#a120fc8665123a3d1e254d6bec5703568">BcellsY</a>(); j&lt;<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>+<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#a120fc8665123a3d1e254d6bec5703568">BcellsY</a>(); j++)</div>
<div class="line"><span class="lineno"> 2566</span>        {</div>
<div class="line"><span class="lineno"> 2567</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=-<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#ae5b7f46778808a4c932c08f0a1d83a6c">BcellsZ</a>(); k&lt;<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>+<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#ae5b7f46778808a4c932c08f0a1d83a6c">BcellsZ</a>(); k++)</div>
<div class="line"><span class="lineno"> 2568</span>            {</div>
<div class="line"><span class="lineno"> 2569</span>                <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2b6d93798b295d1969521ba48bdc9af1">DivVel</a>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>-1,j,k,{0})=0.0;</div>
<div class="line"><span class="lineno"> 2570</span>            }</div>
<div class="line"><span class="lineno"> 2571</span>        }</div>
<div class="line"><span class="lineno"> 2572</span>    }</div>
<div class="line"><span class="lineno"> 2573</span> </div>
<div class="line"><span class="lineno"> 2574</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>!=0)</div>
<div class="line"><span class="lineno"> 2575</span>    {</div>
<div class="line"><span class="lineno"> 2576</span>        <span class="keywordflow">if</span>(MPI_CART_RANK[1]==0)</div>
<div class="line"><span class="lineno"> 2577</span>        {</div>
<div class="line"><span class="lineno"> 2578</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=-<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#ae5b7f46778808a4c932c08f0a1d83a6c">BcellsZ</a>(); k&lt;<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>+<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#ae5b7f46778808a4c932c08f0a1d83a6c">BcellsZ</a>(); k++)</div>
<div class="line"><span class="lineno"> 2579</span>            {</div>
<div class="line"><span class="lineno"> 2580</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=-<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#a8867105dcde5bb2b44f8613d98bf4d86">BcellsX</a>(); i&lt;<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>+<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#a8867105dcde5bb2b44f8613d98bf4d86">BcellsX</a>(); i++)</div>
<div class="line"><span class="lineno"> 2581</span>                {</div>
<div class="line"><span class="lineno"> 2582</span>                    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2b6d93798b295d1969521ba48bdc9af1">DivVel</a>(i,0,k,{0})=0.0;</div>
<div class="line"><span class="lineno"> 2583</span>                }</div>
<div class="line"><span class="lineno"> 2584</span>            }</div>
<div class="line"><span class="lineno"> 2585</span>        }</div>
<div class="line"><span class="lineno"> 2586</span>        <span class="keywordflow">if</span>(MPI_CART_RANK[1]==MPI_CART_SIZE[1]-1)</div>
<div class="line"><span class="lineno"> 2587</span>        {</div>
<div class="line"><span class="lineno"> 2588</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=-<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#ae5b7f46778808a4c932c08f0a1d83a6c">BcellsZ</a>(); k&lt;<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>+<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#ae5b7f46778808a4c932c08f0a1d83a6c">BcellsZ</a>(); k++)</div>
<div class="line"><span class="lineno"> 2589</span>            {</div>
<div class="line"><span class="lineno"> 2590</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=-<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#a8867105dcde5bb2b44f8613d98bf4d86">BcellsX</a>(); i&lt;<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>+<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#a8867105dcde5bb2b44f8613d98bf4d86">BcellsX</a>(); i++)</div>
<div class="line"><span class="lineno"> 2591</span>                {</div>
<div class="line"><span class="lineno"> 2592</span>                    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2b6d93798b295d1969521ba48bdc9af1">DivVel</a>(i,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>-1,k,{0})=0.0;</div>
<div class="line"><span class="lineno"> 2593</span>                }</div>
<div class="line"><span class="lineno"> 2594</span>            }</div>
<div class="line"><span class="lineno"> 2595</span>        }</div>
<div class="line"><span class="lineno"> 2596</span>    }</div>
<div class="line"><span class="lineno"> 2597</span> </div>
<div class="line"><span class="lineno"> 2598</span>    <span class="keywordflow">if</span>(MPI_CART_RANK[2]==0)</div>
<div class="line"><span class="lineno"> 2599</span>    {</div>
<div class="line"><span class="lineno"> 2600</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=-<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#a120fc8665123a3d1e254d6bec5703568">BcellsY</a>(); j&lt;<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>+<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#a120fc8665123a3d1e254d6bec5703568">BcellsY</a>(); j++)</div>
<div class="line"><span class="lineno"> 2601</span>        {</div>
<div class="line"><span class="lineno"> 2602</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=-<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#a8867105dcde5bb2b44f8613d98bf4d86">BcellsX</a>(); i&lt;<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>+<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#a8867105dcde5bb2b44f8613d98bf4d86">BcellsX</a>(); i++)</div>
<div class="line"><span class="lineno"> 2603</span>            {</div>
<div class="line"><span class="lineno"> 2604</span>                <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2b6d93798b295d1969521ba48bdc9af1">DivVel</a>(i,j,0,{0})=0.0;</div>
<div class="line"><span class="lineno"> 2605</span>            }</div>
<div class="line"><span class="lineno"> 2606</span>        }</div>
<div class="line"><span class="lineno"> 2607</span>    }</div>
<div class="line"><span class="lineno"> 2608</span> </div>
<div class="line"><span class="lineno"> 2609</span>    <span class="keywordflow">if</span>(MPI_CART_RANK[2]==MPI_CART_SIZE[2]-1)</div>
<div class="line"><span class="lineno"> 2610</span>    {</div>
<div class="line"><span class="lineno"> 2611</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=-<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#a120fc8665123a3d1e254d6bec5703568">BcellsY</a>(); j&lt;<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>+<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#a120fc8665123a3d1e254d6bec5703568">BcellsY</a>(); j++)</div>
<div class="line"><span class="lineno"> 2612</span>        {</div>
<div class="line"><span class="lineno"> 2613</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=-<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#a8867105dcde5bb2b44f8613d98bf4d86">BcellsX</a>(); i&lt;<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>+<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#a8867105dcde5bb2b44f8613d98bf4d86">BcellsX</a>(); i++)</div>
<div class="line"><span class="lineno"> 2614</span>            {</div>
<div class="line"><span class="lineno"> 2615</span>                <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2b6d93798b295d1969521ba48bdc9af1">DivVel</a>(i,j,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>-1,{0})=0.0;</div>
<div class="line"><span class="lineno"> 2616</span>            }</div>
<div class="line"><span class="lineno"> 2617</span>        }</div>
<div class="line"><span class="lineno"> 2618</span>    }</div>
<div class="line"><span class="lineno"> 2619</span>}</div>
<div class="line"><span class="lineno"> 2620</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2621</span> </div>
<div class="line"><span class="lineno"> 2622</span>}</div>
<div class="ttc" id="aclassopenphase_1_1Storage3D_html_a120fc8665123a3d1e254d6bec5703568"><div class="ttname"><a href="../../da/d19/classopenphase_1_1Storage3D.html#a120fc8665123a3d1e254d6bec5703568">openphase::Storage3D::BcellsY</a></div><div class="ttdeci">long int BcellsY() const</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d8e/Storage3D_8h_source.html#l01068">Storage3D.h:1068</a></div></div>
<div class="ttc" id="aclassopenphase_1_1Storage3D_html_a8867105dcde5bb2b44f8613d98bf4d86"><div class="ttname"><a href="../../da/d19/classopenphase_1_1Storage3D.html#a8867105dcde5bb2b44f8613d98bf4d86">openphase::Storage3D::BcellsX</a></div><div class="ttdeci">long int BcellsX() const</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d8e/Storage3D_8h_source.html#l01063">Storage3D.h:1063</a></div></div>
<div class="ttc" id="aclassopenphase_1_1Storage3D_html_ae5b7f46778808a4c932c08f0a1d83a6c"><div class="ttname"><a href="../../da/d19/classopenphase_1_1Storage3D.html#ae5b7f46778808a4c932c08f0a1d83a6c">openphase::Storage3D::BcellsZ</a></div><div class="ttdeci">long int BcellsZ() const</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d8e/Storage3D_8h_source.html#l01073">Storage3D.h:1073</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="addcb972c15f9da5af57db5294d24f582" name="addcb972c15f9da5af57db5294d24f582"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addcb972c15f9da5af57db5294d24f582">&#9670;&#160;</a></span>SetDivUnearObstZero()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::SetDivUnearObstZero </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02512">2512</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2513</span>{</div>
<div class="line"><span class="lineno"> 2514</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>,0,)</div>
<div class="line"><span class="lineno"> 2515</span>    if (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k))</div>
<div class="line"><span class="lineno"> 2516</span>    {</div>
<div class="line"><span class="lineno"> 2517</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii++)</div>
<div class="line"><span class="lineno"> 2518</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj++)</div>
<div class="line"><span class="lineno"> 2519</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk++)</div>
<div class="line"><span class="lineno"> 2520</span>        {</div>
<div class="line"><span class="lineno"> 2521</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2b6d93798b295d1969521ba48bdc9af1">DivVel</a>(i+ii,j+jj,k+kk,{0}) = 0.0;</div>
<div class="line"><span class="lineno"> 2522</span>        }</div>
<div class="line"><span class="lineno"> 2523</span>    }</div>
<div class="line"><span class="lineno"> 2524</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 2525</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a819951dc89737ee6638dd87373e81ac0" name="a819951dc89737ee6638dd87373e81ac0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a819951dc89737ee6638dd87373e81ac0">&#9670;&#160;</a></span>SetDivVelBCNXZero()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::SetDivVelBCNXZero </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02527">2527</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2528</span>{</div>
<div class="line"><span class="lineno"> 2529</span> </div>
<div class="line"><span class="lineno"> 2530</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 2531</span>{</div>
<div class="line"><span class="lineno"> 2532</span>    <span class="keywordflow">if</span>(MPI_CART_RANK[0]==MPI_CART_SIZE[0]-1)</div>
<div class="line"><span class="lineno"> 2533</span>    {</div>
<div class="line"><span class="lineno"> 2534</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=-<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#a120fc8665123a3d1e254d6bec5703568">BcellsY</a>(); j&lt;<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>+<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#a120fc8665123a3d1e254d6bec5703568">BcellsY</a>(); j++)</div>
<div class="line"><span class="lineno"> 2535</span>        {</div>
<div class="line"><span class="lineno"> 2536</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=-<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#ae5b7f46778808a4c932c08f0a1d83a6c">BcellsZ</a>(); k&lt;<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>+<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#ae5b7f46778808a4c932c08f0a1d83a6c">BcellsZ</a>(); k++)</div>
<div class="line"><span class="lineno"> 2537</span>            {</div>
<div class="line"><span class="lineno"> 2538</span>                <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2b6d93798b295d1969521ba48bdc9af1">DivVel</a>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>-1,j,k,{0})=0.0;</div>
<div class="line"><span class="lineno"> 2539</span>            }</div>
<div class="line"><span class="lineno"> 2540</span>        }</div>
<div class="line"><span class="lineno"> 2541</span>    }</div>
<div class="line"><span class="lineno"> 2542</span>}</div>
<div class="line"><span class="lineno"> 2543</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2544</span> </div>
<div class="line"><span class="lineno"> 2545</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4aa7134220bdc3b0d46435789e484955" name="a4aa7134220bdc3b0d46435789e484955"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4aa7134220bdc3b0d46435789e484955">&#9670;&#160;</a></span>SetFluidNodesNearObstacle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::SetFluidNodesNearObstacle </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets lbPoblulations of vanishing Obstacles and of appearing Obstacles. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02283">2283</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2284</span>{</div>
<div class="line"><span class="lineno"> 2285</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> rrrr = std::max(3,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a>);</div>
<div class="line"><span class="lineno"> 2286</span>    <span class="keyword">auto</span> InsideRedistributionRange = [rrrr](<span class="keywordtype">int</span> ii, <span class="keywordtype">int</span> jj, <span class="keywordtype">int</span> kk) {<span class="keywordflow">return</span> ii*ii + jj*jj + kk*kk &lt;= rrrr;};</div>
<div class="line"><span class="lineno"> 2287</span>    <span class="keyword">auto</span> redistributable = [<span class="keyword">this</span>, InsideRedistributionRange](<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> ii, <span class="keywordtype">int</span> jj, <span class="keywordtype">int</span> kk)</div>
<div class="line"><span class="lineno"> 2288</span>    {</div>
<div class="line"><span class="lineno"> 2289</span>        <span class="keywordflow">if</span> (not <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i+ii,j+jj,k+kk))</div>
<div class="line"><span class="lineno"> 2290</span>        <span class="keywordflow">if</span> (not <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aee9af090b2f8092c793ae13a596403f7">ObstacleVanished</a>(i+ii,j+jj,k+kk))</div>
<div class="line"><span class="lineno"> 2291</span>        <span class="keywordflow">if</span> (InsideRedistributionRange(ii,jj,kk))</div>
<div class="line"><span class="lineno"> 2292</span>        <span class="keywordflow">if</span> (ii + jj + kk != 0)</div>
<div class="line"><span class="lineno"> 2293</span>        {</div>
<div class="line"><span class="lineno"> 2294</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2295</span>        }</div>
<div class="line"><span class="lineno"> 2296</span> </div>
<div class="line"><span class="lineno"> 2297</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2298</span>    };</div>
<div class="line"><span class="lineno"> 2299</span> </div>
<div class="line"><span class="lineno"> 2300</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>.Bcells()-<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a>,)</div>
<div class="line"><span class="lineno"> 2301</span>    {</div>
<div class="line"><span class="lineno"> 2302</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9e20990385a07ac85eb89928bc78158c">ObstacleChangedDensity</a>(i,j,k) = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2303</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 2304</span>        {</div>
<div class="line"><span class="lineno"> 2305</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2ab90fa6fd8a7c36d86144281f5b0caa">lbPopulationsTMP</a>(i,j,k,{n}).set_to_zero();</div>
<div class="line"><span class="lineno"> 2306</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aee9af090b2f8092c793ae13a596403f7">ObstacleVanished</a>(i,j,k)) <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n}).set_to_zero();</div>
<div class="line"><span class="lineno"> 2307</span>        }</div>
<div class="line"><span class="lineno"> 2308</span>    }</div>
<div class="line"><span class="lineno"> 2309</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 2310</span> </div>
<div class="line"><span class="lineno"> 2311</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>.Bcells()-<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a>,)</div>
<div class="line"><span class="lineno"> 2312</span>    if (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aee9af090b2f8092c793ae13a596403f7">ObstacleVanished</a>(i,j,k))</div>
<div class="line"><span class="lineno"> 2313</span>    for (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 2314</span>    {</div>
<div class="line"><span class="lineno"> 2315</span>        <span class="comment">// If an obstacle vanishes the present cell has to be filled with the</span></div>
<div class="line"><span class="lineno"> 2316</span>        <span class="comment">// surrounding fluid from the neighbour cells</span></div>
<div class="line"><span class="lineno"> 2317</span> </div>
<div class="line"><span class="lineno"> 2318</span>        <span class="comment">// Calculate local average population</span></div>
<div class="line"><span class="lineno"> 2319</span>        <span class="keywordtype">double</span>   SumWeights = 0;</div>
<div class="line"><span class="lineno"> 2320</span>        <span class="keywordtype">double</span>   avDensity  = 0;</div>
<div class="line"><span class="lineno"> 2321</span>        dVector3 avMomentum = {0.0,0.0,0.0};</div>
<div class="line"><span class="lineno"> 2322</span>        <span class="keywordtype">int</span> FluidNeighbours = 0;</div>
<div class="line"><span class="lineno"> 2323</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ++ii)</div>
<div class="line"><span class="lineno"> 2324</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; ++jj)</div>
<div class="line"><span class="lineno"> 2325</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; ++kk)</div>
<div class="line"><span class="lineno"> 2326</span>        <span class="keywordflow">if</span> (redistributable(i,j,k,ii,jj,kk))</div>
<div class="line"><span class="lineno"> 2327</span>        {</div>
<div class="line"><span class="lineno"> 2328</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> weight = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i+ii,j+jj,k+kk,{n});</div>
<div class="line"><span class="lineno"> 2329</span>            SumWeights += weight;</div>
<div class="line"><span class="lineno"> 2330</span>            avDensity  += <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a> (i+ii,j+jj,k+kk,{n})*weight;</div>
<div class="line"><span class="lineno"> 2331</span>            avMomentum += <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a>(i+ii,j+jj,k+kk,{n})*weight;</div>
<div class="line"><span class="lineno"> 2332</span>            FluidNeighbours++;</div>
<div class="line"><span class="lineno"> 2333</span>        }</div>
<div class="line"><span class="lineno"> 2334</span> </div>
<div class="line"><span class="lineno"> 2335</span>        <span class="keywordflow">if</span> (FluidNeighbours)</div>
<div class="line"><span class="lineno"> 2336</span>        {</div>
<div class="line"><span class="lineno"> 2337</span>            avDensity  /= SumWeights;</div>
<div class="line"><span class="lineno"> 2338</span>            avMomentum /= SumWeights;</div>
<div class="line"><span class="lineno"> 2339</span> </div>
<div class="line"><span class="lineno"> 2340</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>  (i,j,k,{n}) = avDensity;</div>
<div class="line"><span class="lineno"> 2341</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a> (i,j,k,{n}) = avMomentum;</div>
<div class="line"><span class="lineno"> 2342</span>            <span class="keyword">const</span> D3Q27 DeltaPop = <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#acbf6f50e003944ed8daced249b20ee6e">EquilibriumDistribution</a>(avDensity/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92539bf6d5ed043520c0bdbc47c334a9">lbWeights</a>, avMomentum/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0e7cad672eea608ab7c5ea5ed6946138">dm</a>);</div>
<div class="line"><span class="lineno"> 2343</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2ab90fa6fd8a7c36d86144281f5b0caa">lbPopulationsTMP</a>(i,j,k,{n}) += DeltaPop;</div>
<div class="line"><span class="lineno"> 2344</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9e20990385a07ac85eb89928bc78158c">ObstacleChangedDensity</a>(i,j,k) = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2345</span> </div>
<div class="line"><span class="lineno"> 2346</span>            <span class="comment">// Subtract added fluid from neighbouring cells</span></div>
<div class="line"><span class="lineno"> 2347</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ++ii)</div>
<div class="line"><span class="lineno"> 2348</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; ++jj)</div>
<div class="line"><span class="lineno"> 2349</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; ++kk)</div>
<div class="line"><span class="lineno"> 2350</span>            <span class="keywordflow">if</span> (redistributable(i,j,k,ii,jj,kk))</div>
<div class="line"><span class="lineno"> 2351</span>            {</div>
<div class="line"><span class="lineno"> 2352</span><span class="preprocessor">                #pragma omp critical</span></div>
<div class="line"><span class="lineno"> 2353</span>                {</div>
<div class="line"><span class="lineno"> 2354</span>                    <span class="keyword">const</span> <span class="keywordtype">double</span> weight = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i+ii,j+jj,k+kk,{n});</div>
<div class="line"><span class="lineno"> 2355</span>                    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2ab90fa6fd8a7c36d86144281f5b0caa">lbPopulationsTMP</a>(i+ii,j+jj,k+kk,{n}) -= DeltaPop*weight/SumWeights;</div>
<div class="line"><span class="lineno"> 2356</span>                    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9e20990385a07ac85eb89928bc78158c">ObstacleChangedDensity</a>(i+ii,j+jj,k+kk) = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2357</span>                }</div>
<div class="line"><span class="lineno"> 2358</span>            }</div>
<div class="line"><span class="lineno"> 2359</span>        }</div>
<div class="line"><span class="lineno"> 2360</span>        <span class="keywordflow">else</span> std::cerr &lt;&lt; <span class="stringliteral">&quot;Warning no fluid Neighbours\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 2361</span>    }</div>
<div class="line"><span class="lineno"> 2362</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 2363</span> </div>
<div class="line"><span class="lineno"> 2364</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>.Bcells()-<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a>,)</div>
<div class="line"><span class="lineno"> 2365</span>    if (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a23b20c6aaa054e65abc78e1783f1a595">ObstacleAppeared</a>(i,j,k))</div>
<div class="line"><span class="lineno"> 2366</span>    for (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 2367</span>    {</div>
<div class="line"><span class="lineno"> 2368</span>        <span class="comment">// If an obstacle appears the present fluid has to be moved to the</span></div>
<div class="line"><span class="lineno"> 2369</span>        <span class="comment">// neighbouring cell</span></div>
<div class="line"><span class="lineno"> 2370</span> </div>
<div class="line"><span class="lineno"> 2371</span>        <span class="comment">// Count number of fluid neighbours</span></div>
<div class="line"><span class="lineno"> 2372</span>        <span class="keywordtype">double</span>   SumWeights = 0;</div>
<div class="line"><span class="lineno"> 2373</span>        <span class="keywordtype">int</span> FluidNeighbours = 0;</div>
<div class="line"><span class="lineno"> 2374</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ++ii)</div>
<div class="line"><span class="lineno"> 2375</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; ++jj)</div>
<div class="line"><span class="lineno"> 2376</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; ++kk)</div>
<div class="line"><span class="lineno"> 2377</span>        <span class="keywordflow">if</span> (redistributable(i,j,k,ii,jj,kk))</div>
<div class="line"><span class="lineno"> 2378</span>        {</div>
<div class="line"><span class="lineno"> 2379</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> weight = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i+ii,j+jj,k+kk,{n});</div>
<div class="line"><span class="lineno"> 2380</span>            SumWeights += weight;</div>
<div class="line"><span class="lineno"> 2381</span>            FluidNeighbours++;</div>
<div class="line"><span class="lineno"> 2382</span>        }</div>
<div class="line"><span class="lineno"> 2383</span> </div>
<div class="line"><span class="lineno"> 2384</span>        <span class="keywordflow">if</span> (FluidNeighbours)</div>
<div class="line"><span class="lineno"> 2385</span>        {</div>
<div class="line"><span class="lineno"> 2386</span>            <span class="comment">// Add fluid from this cell to the neighbouring cells</span></div>
<div class="line"><span class="lineno"> 2387</span>            <span class="keyword">const</span> D3Q27 DeltaPop = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n});</div>
<div class="line"><span class="lineno"> 2388</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ++ii)</div>
<div class="line"><span class="lineno"> 2389</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; ++jj)</div>
<div class="line"><span class="lineno"> 2390</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad91501a0b7baf58043f1c744d858816d">FluidRedistributionRange</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; ++kk)</div>
<div class="line"><span class="lineno"> 2391</span>            <span class="keywordflow">if</span> (redistributable(i,j,k,ii,jj,kk))</div>
<div class="line"><span class="lineno"> 2392</span>            {</div>
<div class="line"><span class="lineno"> 2393</span><span class="preprocessor">                #pragma omp critical</span></div>
<div class="line"><span class="lineno"> 2394</span>                {</div>
<div class="line"><span class="lineno"> 2395</span>                    <span class="keyword">const</span> <span class="keywordtype">double</span> weight = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i+ii,j+jj,k+kk,{n});</div>
<div class="line"><span class="lineno"> 2396</span>                    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2ab90fa6fd8a7c36d86144281f5b0caa">lbPopulationsTMP</a>(i+ii,j+jj,k+kk,{n}) += DeltaPop*weight/SumWeights;</div>
<div class="line"><span class="lineno"> 2397</span>                    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9e20990385a07ac85eb89928bc78158c">ObstacleChangedDensity</a>(i+ii,j+jj,k+kk) = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2398</span>                }</div>
<div class="line"><span class="lineno"> 2399</span>            }</div>
<div class="line"><span class="lineno"> 2400</span>       }</div>
<div class="line"><span class="lineno"> 2401</span>       <span class="keywordflow">else</span> std::cerr &lt;&lt; <span class="stringliteral">&quot;Warning no fluid Neighbours\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 2402</span>    }</div>
<div class="line"><span class="lineno"> 2403</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 2404</span> </div>
<div class="line"><span class="lineno"> 2405</span>    <span class="comment">// Add change in fluid nodes</span></div>
<div class="line"><span class="lineno"> 2406</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>,0,)</div>
<div class="line"><span class="lineno"> 2407</span>    {</div>
<div class="line"><span class="lineno"> 2408</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9e20990385a07ac85eb89928bc78158c">ObstacleChangedDensity</a>(i,j,k))</div>
<div class="line"><span class="lineno"> 2409</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 2410</span>        {</div>
<div class="line"><span class="lineno"> 2411</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n}) += <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2ab90fa6fd8a7c36d86144281f5b0caa">lbPopulationsTMP</a>(i,j,k,{n});</div>
<div class="line"><span class="lineno"> 2412</span>        }</div>
<div class="line"><span class="lineno"> 2413</span>    }</div>
<div class="line"><span class="lineno"> 2414</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 2415</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7d6be591a43c1cc03fd88b92ab3242eb" name="a7d6be591a43c1cc03fd88b92ab3242eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d6be591a43c1cc03fd88b92ab3242eb">&#9670;&#160;</a></span>SetInitialPopulationsTC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::SetInitialPopulationsTC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;&#160;</td>
          <td class="paramname"><em>Vel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializing the populations when thermal compressibility considered. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00922">922</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  923</span>{</div>
<div class="line"><span class="lineno">  924</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afa690789441704b411b9252d930c2363">HydroPressure</a>,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afa690789441704b411b9252d930c2363">HydroPressure</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#af665bb9655e7117ac70af33f7c40ef9f">Bcells</a>(),)</div>
<div class="line"><span class="lineno">  925</span>    for (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno">  926</span>    {</div>
<div class="line"><span class="lineno">  927</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afa690789441704b411b9252d930c2363">HydroPressure</a> (i,j,k,{n}) = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1b542beebb14e3182c7948b30f3eefd8">Poutlet</a>;</div>
<div class="line"><span class="lineno">  928</span>    }</div>
<div class="line"><span class="lineno">  929</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  930</span> </div>
<div class="line"><span class="lineno">  931</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#af665bb9655e7117ac70af33f7c40ef9f">Bcells</a>(),)</div>
<div class="line"><span class="lineno">  932</span>    for (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno">  933</span>    {</div>
<div class="line"><span class="lineno">  934</span>        dVector3 lbvel      = Vel.Phase(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9c24d4bdb6833cf83827eb7ae9629f47">dv</a>;</div>
<div class="line"><span class="lineno">  935</span>       dVector3 lbFb       = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3b6d8de9f278b56d9346a2adb823a4e2">df</a>;</div>
<div class="line"><span class="lineno">  936</span>       dVector3 lbGradRho  = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2357615d61b1d4d4bb027c1dfa67260c">GradRho</a>(i,j,k,{n})*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>;</div>
<div class="line"><span class="lineno">  937</span>        <span class="keywordtype">double</span> lbnu         = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a62faa8027eaa45caa436c65f032bc584">nut</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a74ae26b9feb1666e9c177e5e88558d8a">dnu</a>;</div>
<div class="line"><span class="lineno">  938</span>        <span class="keywordtype">double</span> lbrho        = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>;</div>
<div class="line"><span class="lineno">  939</span>        <span class="keywordtype">double</span> lbph         = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afa690789441704b411b9252d930c2363">HydroPressure</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a83cd87469986a195f9a42c9fbff2f523">dP</a>;</div>
<div class="line"><span class="lineno">  940</span>        <span class="keywordtype">double</span> lbDivVel     = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2b6d93798b295d1969521ba48bdc9af1">DivVel</a>(i,j,k,{n})*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>;</div>
<div class="line"><span class="lineno">  941</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n}) = <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#acaa0558757ce5f46303dca296d469030">EquilibriumDistributionTC</a>( lbvel, lbph, lbnu,  lbDivVel,  lbFb, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92539bf6d5ed043520c0bdbc47c334a9">lbWeights</a>, lbrho, lbGradRho, n);</div>
<div class="line"><span class="lineno">  942</span>    }</div>
<div class="line"><span class="lineno">  943</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  944</span> </div>
<div class="line"><span class="lineno">  945</span>    BC.SetXVector(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>);</div>
<div class="line"><span class="lineno">  946</span>    BC.SetYVector(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>);</div>
<div class="line"><span class="lineno">  947</span>    BC.SetZVector(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>);</div>
<div class="line"><span class="lineno">  948</span>}</div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_acaa0558757ce5f46303dca296d469030"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#acaa0558757ce5f46303dca296d469030">openphase::FlowSolverLBM::EquilibriumDistributionTC</a></div><div class="ttdeci">D3Q27 EquilibriumDistributionTC(dVector3 lbvel, double lbph, double lbnut, double lbDivVel, dVector3 lbFb, const double weights[3][3][3], double lbrho, dVector3 lbGradRho, size_t n)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02487">FlowSolverLBM.cpp:2487</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a78015631ab46781aeba17f0e7af47473" name="a78015631ab46781aeba17f0e7af47473"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78015631ab46781aeba17f0e7af47473">&#9670;&#160;</a></span>SetObstacleNodes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::SetObstacleNodes </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;&#160;</td>
          <td class="paramname"><em>Vel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets density and momentum in obstacles to be used when solid moves. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02453">2453</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2454</span>{</div>
<div class="line"><span class="lineno"> 2455</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#af665bb9655e7117ac70af33f7c40ef9f">Bcells</a>(),)</div>
<div class="line"><span class="lineno"> 2456</span>    if (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k))</div>
<div class="line"><span class="lineno"> 2457</span>    for (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 2458</span>    {</div>
<div class="line"><span class="lineno"> 2459</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a>(i,j,k,{n}).set_to_zero();</div>
<div class="line"><span class="lineno"> 2460</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a147890b1c75d4b407881212ea40ecf05">Do_TwoPhase</a>)</div>
<div class="line"><span class="lineno"> 2461</span>        {</div>
<div class="line"><span class="lineno"> 2462</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a> (i,j,k,{n}) = 0.0;</div>
<div class="line"><span class="lineno"> 2463</span>            <span class="keywordflow">for</span>(<span class="keyword">auto</span> it = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 2464</span>                    it != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).cend(); it++)</div>
<div class="line"><span class="lineno"> 2465</span>            <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[it-&gt;index].State == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a545a7e1c8dca42c00f8f139a1913c61cae41480b6bbfbf7407974a88d3d34f4fa">AggregateStates::Solid</a>)</div>
<div class="line"><span class="lineno"> 2466</span>            {</div>
<div class="line"><span class="lineno"> 2467</span>                <span class="keywordtype">size_t</span> pIndex = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[it-&gt;index].Phase;</div>
<div class="line"><span class="lineno"> 2468</span> </div>
<div class="line"><span class="lineno"> 2469</span>                <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a> (i,j,k,{n}) += it-&gt;value * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a733d0ed28089ce96e664da9b2508c692">Wetting</a>[n][pIndex];</div>
<div class="line"><span class="lineno"> 2470</span> </div>
<div class="line"><span class="lineno"> 2471</span>                <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[it-&gt;index].Mobile)</div>
<div class="line"><span class="lineno"> 2472</span>                {</div>
<div class="line"><span class="lineno"> 2473</span>                    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a>(i,j,k,{n}) += Vel.Phase(i,j,k,{pIndex}) *</div>
<div class="line"><span class="lineno"> 2474</span>                        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n}) * it-&gt;value;</div>
<div class="line"><span class="lineno"> 2475</span>                }</div>
<div class="line"><span class="lineno"> 2476</span>            }</div>
<div class="line"><span class="lineno"> 2477</span>        }</div>
<div class="line"><span class="lineno"> 2478</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2479</span>        {</div>
<div class="line"><span class="lineno"> 2480</span>            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a> (i,j,k,{n}) = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>;</div>
<div class="line"><span class="lineno"> 2481</span>        }</div>
<div class="line"><span class="lineno"> 2482</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n}) =</div>
<div class="line"><span class="lineno"> 2483</span>            <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#acbf6f50e003944ed8daced249b20ee6e">EquilibriumDistribution</a>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92539bf6d5ed043520c0bdbc47c334a9">lbWeights</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0e7cad672eea608ab7c5ea5ed6946138">dm</a>);</div>
<div class="line"><span class="lineno"> 2484</span>    }</div>
<div class="line"><span class="lineno"> 2485</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 2486</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a627879285e493481ee046182cd93bc30" name="a627879285e493481ee046182cd93bc30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a627879285e493481ee046182cd93bc30">&#9670;&#160;</a></span>SetOutFlow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::SetOutFlow </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l01464">1464</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1465</span>{</div>
<div class="line"><span class="lineno"> 1466</span>    <span class="keywordtype">int</span> i1 = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>-1;</div>
<div class="line"><span class="lineno"> 1467</span>    <span class="keywordtype">int</span> i2 = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a> + <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#aae205a52da44fe4c880a16b0f5a48cfb">Bcells</a>; </div>
<div class="line"><span class="lineno"> 1468</span>    <span class="keywordtype">int</span> j1 = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#aae205a52da44fe4c880a16b0f5a48cfb">Bcells</a> * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>;</div>
<div class="line"><span class="lineno"> 1469</span>    <span class="keywordtype">int</span> j2 = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a> + <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#aae205a52da44fe4c880a16b0f5a48cfb">Bcells</a> * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; </div>
<div class="line"><span class="lineno"> 1470</span>    <span class="keywordtype">int</span> k1 = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#aae205a52da44fe4c880a16b0f5a48cfb">Bcells</a> * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>;</div>
<div class="line"><span class="lineno"> 1471</span>    <span class="keywordtype">int</span> k2 = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a> + <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#aae205a52da44fe4c880a16b0f5a48cfb">Bcells</a> * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; </div>
<div class="line"><span class="lineno"> 1472</span> </div>
<div class="line"><span class="lineno"> 1473</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a77c3cc57b7a3f3bf027c4009086c41c5">OffsetX</a>+<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>==<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a696f288eba9b872bde8e18aedd6da440">TotalNx</a>)</div>
<div class="line"><span class="lineno"> 1474</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = i1; i &lt; i2; ++i)</div>
<div class="line"><span class="lineno"> 1475</span>    {</div>
<div class="line"><span class="lineno"> 1476</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = j1; j&lt; j2 ; ++j)</div>
<div class="line"><span class="lineno"> 1477</span>        {</div>
<div class="line"><span class="lineno"> 1478</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = k1; k&lt; k2 ; ++k)</div>
<div class="line"><span class="lineno"> 1479</span>            {</div>
<div class="line"><span class="lineno"> 1480</span>                <span class="keywordtype">int</span> ii=-1;</div>
<div class="line"><span class="lineno"> 1481</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 1482</span>                {</div>
<div class="line"><span class="lineno"> 1483</span>                    <span class="comment">//for(int ii = -Grid.dNx; ii &lt;= Grid.dNx; ++ii)</span></div>
<div class="line"><span class="lineno"> 1484</span>                    {</div>
<div class="line"><span class="lineno"> 1485</span>                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; ++jj)</div>
<div class="line"><span class="lineno"> 1486</span>                        {</div>
<div class="line"><span class="lineno"> 1487</span>                            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; ++kk)</div>
<div class="line"><span class="lineno"> 1488</span>                            {</div>
<div class="line"><span class="lineno"> 1489</span>                                <span class="keywordflow">if</span>(order == 0)</div>
<div class="line"><span class="lineno"> 1490</span>                                {</div>
<div class="line"><span class="lineno"> 1491</span>                                    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n})(ii,jj,kk) = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i-1,j,k,{n})(ii,jj,kk);</div>
<div class="line"><span class="lineno"> 1492</span>                                }</div>
<div class="line"><span class="lineno"> 1493</span>                                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (order == 1)</div>
<div class="line"><span class="lineno"> 1494</span>                                {</div>
<div class="line"><span class="lineno"> 1495</span>                                    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n})(ii,jj,kk) = 2.0*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i-1,j,k,{n})(ii,jj,kk) </div>
<div class="line"><span class="lineno"> 1496</span>                                                            - <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i-2,j,k,{n})(ii,jj,kk) ;</div>
<div class="line"><span class="lineno"> 1497</span>                                }</div>
<div class="line"><span class="lineno"> 1498</span>                            } </div>
<div class="line"><span class="lineno"> 1499</span>                        }</div>
<div class="line"><span class="lineno"> 1500</span>                    }</div>
<div class="line"><span class="lineno"> 1501</span>                }</div>
<div class="line"><span class="lineno"> 1502</span>            }</div>
<div class="line"><span class="lineno"> 1503</span>        }</div>
<div class="line"><span class="lineno"> 1504</span>    }</div>
<div class="line"><span class="lineno"> 1505</span>}</div>
<div class="ttc" id="aclassopenphase_1_1GridParameters_html_a696f288eba9b872bde8e18aedd6da440"><div class="ttname"><a href="../../dc/d18/classopenphase_1_1GridParameters.html#a696f288eba9b872bde8e18aedd6da440">openphase::GridParameters::TotalNx</a></div><div class="ttdeci">int TotalNx</div><div class="ttdoc">Total number of grid cells in X direction (in case of MPI parallelism)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d68/GridParameters_8h_source.html#l00148">GridParameters.h:148</a></div></div>
<div class="ttc" id="aclassopenphase_1_1GridParameters_html_a77c3cc57b7a3f3bf027c4009086c41c5"><div class="ttname"><a href="../../dc/d18/classopenphase_1_1GridParameters.html#a77c3cc57b7a3f3bf027c4009086c41c5">openphase::GridParameters::OffsetX</a></div><div class="ttdeci">int OffsetX</div><div class="ttdoc">X coordinate of the local domain coordinate system origin (in case of MPI parallelism)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d68/GridParameters_8h_source.html#l00149">GridParameters.h:149</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af531a270a7f9829fa0eb8b68eeef3ba2" name="af531a270a7f9829fa0eb8b68eeef3ba2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af531a270a7f9829fa0eb8b68eeef3ba2">&#9670;&#160;</a></span>SetPressureOutlet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::SetPressureOutlet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;&#160;</td>
          <td class="paramname"><em>Vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>KMaxv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l01206">1206</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1207</span>{</div>
<div class="line"><span class="lineno"> 1208</span>    <span class="keywordflow">if</span>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.OffsetX+<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>==<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a696f288eba9b872bde8e18aedd6da440">TotalNx</a>)</div>
<div class="line"><span class="lineno"> 1209</span>    {</div>
<div class="line"><span class="lineno"> 1210</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>,0,)</div>
<div class="line"><span class="lineno"> 1211</span>        {</div>
<div class="line"><span class="lineno"> 1212</span>            <span class="keywordflow">if</span>(i==<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>-1)</div>
<div class="line"><span class="lineno"> 1213</span>            {</div>
<div class="line"><span class="lineno"> 1214</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k))</div>
<div class="line"><span class="lineno"> 1215</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 1216</span>                {</div>
<div class="line"><span class="lineno"> 1217</span>                    <span class="comment">//===========================</span></div>
<div class="line"><span class="lineno"> 1218</span>                    <span class="keywordtype">double</span> Pbold   = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afa690789441704b411b9252d930c2363">HydroPressure</a>(i,j,k,{n});</div>
<div class="line"><span class="lineno"> 1219</span>                    <span class="keywordtype">double</span> Pbmold  = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afa690789441704b411b9252d930c2363">HydroPressure</a>(i-1,j,k,{n});</div>
<div class="line"><span class="lineno"> 1220</span>                    <span class="keywordtype">double</span> Pbmmold = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afa690789441704b411b9252d930c2363">HydroPressure</a>(i-2,j,k,{n});</div>
<div class="line"><span class="lineno"> 1221</span> </div>
<div class="line"><span class="lineno"> 1222</span>                    <span class="keywordtype">double</span> uxbold  = Vel.Phase(i,j,k,{n})[0];</div>
<div class="line"><span class="lineno"> 1223</span>                    <span class="keywordtype">double</span> uxbmold = Vel.Phase(i-1,j,k,{n})[0];</div>
<div class="line"><span class="lineno"> 1224</span>                    <span class="keywordtype">double</span> uxbmmold= Vel.Phase(i-2,j,k,{n})[0];</div>
<div class="line"><span class="lineno"> 1225</span> </div>
<div class="line"><span class="lineno"> 1226</span>                    <span class="keywordtype">double</span> uybold  = Vel.Phase(i,j,k,{n})[1];</div>
<div class="line"><span class="lineno"> 1227</span>                    <span class="keywordtype">double</span> uybmold = Vel.Phase(i-1,j,k,{n})[1];</div>
<div class="line"><span class="lineno"> 1228</span>                    <span class="keywordtype">double</span> uybmmold= Vel.Phase(i-2,j,k,{n})[1];</div>
<div class="line"><span class="lineno"> 1229</span> </div>
<div class="line"><span class="lineno"> 1230</span>                    <span class="keywordtype">double</span> uzbold  = Vel.Phase(i,j,k,{n})[2];</div>
<div class="line"><span class="lineno"> 1231</span>                    <span class="keywordtype">double</span> uzbmold = Vel.Phase(i-1,j,k,{n})[2];</div>
<div class="line"><span class="lineno"> 1232</span>                    <span class="keywordtype">double</span> uzbmmold= Vel.Phase(i-2,j,k,{n})[2];</div>
<div class="line"><span class="lineno"> 1233</span> </div>
<div class="line"><span class="lineno"> 1234</span>                    <span class="keywordtype">double</span> rhob = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n});</div>
<div class="line"><span class="lineno"> 1235</span>                    <span class="keywordtype">double</span> rhobm= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i-1,j,k,{n});</div>
<div class="line"><span class="lineno"> 1236</span> </div>
<div class="line"><span class="lineno"> 1237</span>                    <span class="keywordtype">double</span> L1,L3,L4, L5; <span class="comment">//charachteristics value</span></div>
<div class="line"><span class="lineno"> 1238</span>                    <span class="keywordtype">double</span> dx=<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>;</div>
<div class="line"><span class="lineno"> 1239</span>                    L1= KMaxv  * (Pbold - <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1b542beebb14e3182c7948b30f3eefd8">Poutlet</a>);</div>
<div class="line"><span class="lineno"> 1240</span>                    L3= uxbold * (uzbold-uzbmold)/dx;</div>
<div class="line"><span class="lineno"> 1241</span>                    L4= uxbold * (uybold-uybmold)/dx;</div>
<div class="line"><span class="lineno"> 1242</span>                    L5=(uxbold+sqrt(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5284a4950dae747d84ce23d74fd5963e">cs2</a>)) * ((Pbold-Pbmold)/dx + rhob * sqrt(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5284a4950dae747d84ce23d74fd5963e">cs2</a>) * (uxbold-uxbmold)/dx);</div>
<div class="line"><span class="lineno"> 1243</span> </div>
<div class="line"><span class="lineno"> 1244</span>                    <span class="keywordtype">double</span> uxbn = uxbold - (L5-L1)*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/(2.0* sqrt(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5284a4950dae747d84ce23d74fd5963e">cs2</a>) * rhob );</div>
<div class="line"><span class="lineno"> 1245</span>                    <span class="keywordtype">double</span> uybn = uybold - L4 * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>;</div>
<div class="line"><span class="lineno"> 1246</span>                    <span class="keywordtype">double</span> uzbn = uzbold - L3 * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>;</div>
<div class="line"><span class="lineno"> 1247</span>                    <span class="keywordtype">double</span> pbn  = Pbold - (L5+L1)*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/2.0;</div>
<div class="line"><span class="lineno"> 1248</span> </div>
<div class="line"><span class="lineno"> 1249</span>                    <span class="keywordflow">if</span>(uxbmold&lt;0)</div>
<div class="line"><span class="lineno"> 1250</span>                    {</div>
<div class="line"><span class="lineno"> 1251</span>                        L3   = uxbmold * (uzbmold-uzbmmold)/dx;</div>
<div class="line"><span class="lineno"> 1252</span>                        L4   = uxbmold * (uybmold-uybmmold)/dx;</div>
<div class="line"><span class="lineno"> 1253</span>                        L5   =(uxbmold+sqrt(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5284a4950dae747d84ce23d74fd5963e">cs2</a>)) * ((Pbmold-Pbmmold)/dx + rhobm * sqrt(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5284a4950dae747d84ce23d74fd5963e">cs2</a>) * (uxbmold-uxbmmold)/dx);</div>
<div class="line"><span class="lineno"> 1254</span>                        pbn  = Pbmold -  (L5+L1)*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/2.0;</div>
<div class="line"><span class="lineno"> 1255</span>                        uxbn = uxbmold - (L5-L1)*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/(2.0* sqrt(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5284a4950dae747d84ce23d74fd5963e">cs2</a>) * rhobm );</div>
<div class="line"><span class="lineno"> 1256</span>                        uzbn = uzbmold - L3 * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>;</div>
<div class="line"><span class="lineno"> 1257</span>                        uybn = uybmold - L4 * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>;</div>
<div class="line"><span class="lineno"> 1258</span>                    }</div>
<div class="line"><span class="lineno"> 1259</span>                    dVector3 lbub  = {uxbn*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/dx, uybn*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/dx, uzbn*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/dx};</div>
<div class="line"><span class="lineno"> 1260</span> </div>
<div class="line"><span class="lineno"> 1261</span>                    <span class="keywordtype">int</span> im = i-1;</div>
<div class="line"><span class="lineno"> 1262</span>                    <span class="keywordtype">double</span> pm = 0.0;</div>
<div class="line"><span class="lineno"> 1263</span>                    dVector3 Mvm = {0.0, 0.0, 0.0};</div>
<div class="line"><span class="lineno"> 1264</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ++ii)</div>
<div class="line"><span class="lineno"> 1265</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; ++jj)</div>
<div class="line"><span class="lineno"> 1266</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; ++kk)</div>
<div class="line"><span class="lineno"> 1267</span>                    {</div>
<div class="line"><span class="lineno"> 1268</span>                        <span class="keywordtype">double</span> rrm = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(im,j,k,{n})(ii,jj,kk);</div>
<div class="line"><span class="lineno"> 1269</span>                        pm  += rrm*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a83cd87469986a195f9a42c9fbff2f523">dP</a>;</div>
<div class="line"><span class="lineno"> 1270</span>                        Mvm[0] += rrm*ii*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0e7cad672eea608ab7c5ea5ed6946138">dm</a>;</div>
<div class="line"><span class="lineno"> 1271</span>                        Mvm[1] += rrm*jj*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0e7cad672eea608ab7c5ea5ed6946138">dm</a>;</div>
<div class="line"><span class="lineno"> 1272</span>                        Mvm[2] += rrm*kk*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0e7cad672eea608ab7c5ea5ed6946138">dm</a>;</div>
<div class="line"><span class="lineno"> 1273</span>                    }</div>
<div class="line"><span class="lineno"> 1274</span>                    dVector3 um = (Mvm * 3.0 + <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>(im,j,k,{n})*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/2.0)/rhobm;</div>
<div class="line"><span class="lineno"> 1275</span>                    pm +=  <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5284a4950dae747d84ce23d74fd5963e">cs2</a>/2.0 *<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>* (  (um[0]*  <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2357615d61b1d4d4bb027c1dfa67260c">GradRho</a>(im,j,k,{n})[0] )</div>
<div class="line"><span class="lineno"> 1276</span>                                         +(um[1]*  <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2357615d61b1d4d4bb027c1dfa67260c">GradRho</a>(im,j,k,{n})[1] )</div>
<div class="line"><span class="lineno"> 1277</span>                                         +(um[2]*  <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2357615d61b1d4d4bb027c1dfa67260c">GradRho</a>(im,j,k,{n})[2] ) + rhobm * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a2b6d93798b295d1969521ba48bdc9af1">DivVel</a>(i-1,j,k,{n}) );</div>
<div class="line"><span class="lineno"> 1278</span> </div>
<div class="line"><span class="lineno"> 1279</span>                    dVector3 lbum = um *<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>;</div>
<div class="line"><span class="lineno"> 1280</span> </div>
<div class="line"><span class="lineno"> 1281</span>                    <span class="keywordtype">double</span> lbu2b  = lbub[0]*lbub[0]+lbub[1]*lbub[1]+lbub[2]*lbub[2];</div>
<div class="line"><span class="lineno"> 1282</span>                    <span class="keywordtype">double</span> lbu2m  = lbum[0]*lbum[0]+lbum[1]*lbum[1]+lbum[2]*lbum[2];</div>
<div class="line"><span class="lineno"> 1283</span> </div>
<div class="line"><span class="lineno"> 1284</span>                    <span class="comment">//double lbtaub  = nut(i ,j,k,{n})/dnu/lbcs2 + 0.5;</span></div>
<div class="line"><span class="lineno"> 1285</span>                    <span class="comment">//double lbtaum  = nut(im,j,k,{n})/dnu/lbcs2 + 0.5;</span></div>
<div class="line"><span class="lineno"> 1286</span>                    <span class="keywordtype">int</span> ii=-1;</div>
<div class="line"><span class="lineno"> 1287</span>                    <span class="comment">//for(int ii = -Grid.dNx; ii &lt;= Grid.dNx; ++ii)</span></div>
<div class="line"><span class="lineno"> 1288</span>                    {</div>
<div class="line"><span class="lineno"> 1289</span>                    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; ++jj)</div>
<div class="line"><span class="lineno"> 1290</span>                    {</div>
<div class="line"><span class="lineno"> 1291</span>                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; ++kk)</div>
<div class="line"><span class="lineno"> 1292</span>                        {</div>
<div class="line"><span class="lineno"> 1293</span>                            <span class="comment">//if(!Obstacle(i-ii,j-jj,k-kk))</span></div>
<div class="line"><span class="lineno"> 1294</span>                            {</div>
<div class="line"><span class="lineno"> 1295</span>                            <span class="comment">//dVector3 lbFbb       = ForceDensity(i,j,k,{n})/df;</span></div>
<div class="line"><span class="lineno"> 1296</span>                            <span class="comment">//dVector3 lbFbm       = ForceDensity(im,j,k,{n})/df;</span></div>
<div class="line"><span class="lineno"> 1297</span>                            <span class="comment">//dVector3 lbGradRhob  = GradRho(i,j,k,{n})*Grid.dx;</span></div>
<div class="line"><span class="lineno"> 1298</span>                            <span class="comment">//dVector3 lbGradRhom  = GradRho(im,j,k,{n})*Grid.dx;</span></div>
<div class="line"><span class="lineno"> 1299</span>                            <span class="keywordtype">double</span> lbrhob        = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>;</div>
<div class="line"><span class="lineno"> 1300</span>                            <span class="keywordtype">double</span> lbrhom        = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(im,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>;</div>
<div class="line"><span class="lineno"> 1301</span>                            <span class="keywordtype">double</span> lbphb         = pbn/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a83cd87469986a195f9a42c9fbff2f523">dP</a>;</div>
<div class="line"><span class="lineno"> 1302</span>                            <span class="keywordtype">double</span> lbphm         = pm /<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a83cd87469986a195f9a42c9fbff2f523">dP</a>;</div>
<div class="line"><span class="lineno"> 1303</span>                            <span class="comment">//double lbDivVelb     = DivVel(i,j,k,{n})*dt;</span></div>
<div class="line"><span class="lineno"> 1304</span>                            <span class="comment">//double lbDivVelm     = DivVel(im,j,k,{n})*dt;</span></div>
<div class="line"><span class="lineno"> 1305</span>                            <span class="comment">//double factorb       = (1.0+1.0/(2.0*lbtaub));</span></div>
<div class="line"><span class="lineno"> 1306</span>                            <span class="comment">//double factorm       = (1.0+1.0/(2.0*lbtaum));</span></div>
<div class="line"><span class="lineno"> 1307</span>                            <span class="comment">//double CRb           = (ii-lbub[0])*lbGradRhob[0]+(jj-lbub[1])*lbGradRhob[1]+(kk-lbub[2])*lbGradRhob[2];</span></div>
<div class="line"><span class="lineno"> 1308</span>                            <span class="comment">//double CRm           = (ii-lbum[0])*lbGradRhom[0]+(jj-lbum[1])*lbGradRhom[1]+(kk-lbum[2])*lbGradRhom[2];</span></div>
<div class="line"><span class="lineno"> 1309</span>                            <span class="comment">//double CFb           = (ii-lbub[0])*lbFbb[0]+(jj-lbub[1])*lbFbb[1]+(kk-lbub[2])*lbFbb[2];</span></div>
<div class="line"><span class="lineno"> 1310</span>                            <span class="comment">//double CFm           = (ii-lbum[0])*lbFbm[0]+(jj-lbum[1])*lbFbm[1]+(kk-lbum[2])*lbFbm[2];</span></div>
<div class="line"><span class="lineno"> 1311</span>                            <span class="keywordtype">double</span> lbw           = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92539bf6d5ed043520c0bdbc47c334a9">lbWeights</a>[ii+1][jj+1][kk+1];</div>
<div class="line"><span class="lineno"> 1312</span>                            <span class="keywordtype">double</span> lbcub         = ii*lbub[0] + jj*lbub[1] + kk*lbub[2];</div>
<div class="line"><span class="lineno"> 1313</span>                            <span class="keywordtype">double</span> lbcum         = ii*lbum[0] + jj*lbum[1] + kk*lbum[2];</div>
<div class="line"><span class="lineno"> 1314</span>                            <span class="keywordtype">double</span> Feqb          = lbrhob * lbw *(1.0 + lbcub/<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>- lbu2b/(2.0*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>) + lbcub*lbcub/(2.0*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>) );</div>
<div class="line"><span class="lineno"> 1315</span>                            <span class="keywordtype">double</span> Feqm          = lbrhom * lbw *(1.0 + lbcum/<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>- lbu2m/(2.0*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>) + lbcum*lbcum/(2.0*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a>) );</div>
<div class="line"><span class="lineno"> 1316</span>                            <span class="keywordtype">double</span> geqb          = Feqb*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a> + (lbphb - lbrhob * <a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a> ) * lbw; </div>
<div class="line"><span class="lineno"> 1317</span>                            <span class="keywordtype">double</span> geqm          = Feqm*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a> + (lbphm - lbrhom * <a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a9cd858076e6d2d99fbae21404b46703e">lbcs2</a> ) * lbw; </div>
<div class="line"><span class="lineno"> 1318</span> </div>
<div class="line"><span class="lineno"> 1319</span>                            <span class="comment">//double Ab            = 0.5 * (lbw*lbcs2*lbrhob*lbDivVelb+CRb*lbcs2*(Feqb/lbrhob-lbw)+ CFb*Feqb/lbrhob);</span></div>
<div class="line"><span class="lineno"> 1320</span>                            <span class="comment">//double Am            = 0.5 * (lbw*lbcs2*lbrhom*lbDivVelm+CRm*lbcs2*(Feqm/lbrhom-lbw)+ CFm*Feqm/lbrhom);</span></div>
<div class="line"><span class="lineno"> 1321</span> </div>
<div class="line"><span class="lineno"> 1322</span>                            <span class="keywordtype">double</span> gbarm         = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(im,j,k,{n})(ii,jj,kk);</div>
<div class="line"><span class="lineno"> 1323</span>                            <span class="comment">//double gm            = (gbarm+1/lbtaum/2.0*geqm+Am)/factorm;</span></div>
<div class="line"><span class="lineno"> 1324</span>                            <span class="comment">//double gb            = geqb + gm - geqm;</span></div>
<div class="line"><span class="lineno"> 1325</span>                            <span class="comment">//lbPopulations(i,j,k,{n})(ii,jj,kk) = gb - 1/2.0/lbtaub * (geqb-gb) - Ab;</span></div>
<div class="line"><span class="lineno"> 1326</span>                            <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n})(ii,jj,kk) = geqb + gbarm - geqm;</div>
<div class="line"><span class="lineno"> 1327</span>                            }</div>
<div class="line"><span class="lineno"> 1328</span>                        }</div>
<div class="line"><span class="lineno"> 1329</span>                    }</div>
<div class="line"><span class="lineno"> 1330</span>                    }</div>
<div class="line"><span class="lineno"> 1331</span>                }</div>
<div class="line"><span class="lineno"> 1332</span>            }</div>
<div class="line"><span class="lineno"> 1333</span>        }</div>
<div class="line"><span class="lineno"> 1334</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1335</span>    }</div>
<div class="line"><span class="lineno"> 1336</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2859ca456f78f88aff04b8b320b06a27" name="a2859ca456f78f88aff04b8b320b06a27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2859ca456f78f88aff04b8b320b06a27">&#9670;&#160;</a></span>SetUniformVelocity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::SetUniformVelocity </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a>&#160;</td>
          <td class="paramname"><em>U0</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the initial values of particle distribution functions. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00591">591</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  593</span>{</div>
<div class="line"><span class="lineno">  594</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#af665bb9655e7117ac70af33f7c40ef9f">Bcells</a>(),)</div>
<div class="line"><span class="lineno">  595</span>    for (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno">  596</span>    {</div>
<div class="line"><span class="lineno">  597</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>  (i,j,k,{n}) = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>;</div>
<div class="line"><span class="lineno">  598</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a> (i,j,k,{n}) = U0*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n});</div>
<div class="line"><span class="lineno">  599</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>   (i,j,k,{n}) = <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#acbf6f50e003944ed8daced249b20ee6e">EquilibriumDistribution</a>(1.0, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92539bf6d5ed043520c0bdbc47c334a9">lbWeights</a>, <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ae0a0f10cae3f3b764b4fa994a842f3a5">MomentumDensity</a>(i,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0e7cad672eea608ab7c5ea5ed6946138">dm</a>);</div>
<div class="line"><span class="lineno">  600</span>    }</div>
<div class="line"><span class="lineno">  601</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  602</span> </div>
<div class="line"><span class="lineno">  603</span>    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aac503798c87d57cd342e2d56063f481b">SetBoundaryConditions</a>(BC);</div>
<div class="line"><span class="lineno">  604</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="abbda519d20462824db04d7ba55f1b880" name="abbda519d20462824db04d7ba55f1b880"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbda519d20462824db04d7ba55f1b880">&#9670;&#160;</a></span>SetVelocityInletUniform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::SetVelocityInletUniform </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l01101">1101</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1102</span>{</div>
<div class="line"><span class="lineno"> 1103</span> </div>
<div class="line"><span class="lineno"> 1104</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 1105</span> </div>
<div class="line"><span class="lineno"> 1106</span>    <span class="keywordflow">if</span>(MPI_CART_RANK[0]==0)</div>
<div class="line"><span class="lineno"> 1107</span>    {</div>
<div class="line"><span class="lineno"> 1108</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#af665bb9655e7117ac70af33f7c40ef9f">Bcells</a>(),)</div>
<div class="line"><span class="lineno"> 1109</span>        {</div>
<div class="line"><span class="lineno"> 1110</span>            <span class="keywordflow">if</span>(i==0)</div>
<div class="line"><span class="lineno"> 1111</span>            {</div>
<div class="line"><span class="lineno"> 1112</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k-1) and !<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k+1))</div>
<div class="line"><span class="lineno"> 1113</span>                {</div>
<div class="line"><span class="lineno"> 1114</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno"> 1115</span>                    {</div>
<div class="line"><span class="lineno"> 1116</span>                        <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7c63a86b32c4126fb329829acf6af13c">Do_ThermalComp</a>)</div>
<div class="line"><span class="lineno"> 1117</span>                        {</div>
<div class="line"><span class="lineno"> 1118</span>                            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ii = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ++ii)</div>
<div class="line"><span class="lineno"> 1119</span>                            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; ++jj)</div>
<div class="line"><span class="lineno"> 1120</span>                            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; ++kk)</div>
<div class="line"><span class="lineno"> 1121</span>                            {</div>
<div class="line"><span class="lineno"> 1122</span>                                <span class="keywordtype">double</span> lbUx=<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aad6241df3842eb309a60fd8d55888559">U0X</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>;</div>
<div class="line"><span class="lineno"> 1123</span>                                <span class="keywordflow">if</span>(ii==1)</div>
<div class="line"><span class="lineno"> 1124</span>                                {</div>
<div class="line"><span class="lineno"> 1125</span>                                    <span class="keywordtype">double</span> cu = ii*lbUx;</div>
<div class="line"><span class="lineno"> 1126</span>                                    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i-ii,j-jj,k-kk,{n})(ii,jj,kk)=<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i+ii,j+jj,k+kk,{n})(-ii,-jj,-kk)</div>
<div class="line"><span class="lineno"> 1127</span>                                                                +2.0*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a92539bf6d5ed043520c0bdbc47c334a9">lbWeights</a>[ii+1][jj+1][kk+1] * <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i-ii,j,k,{n})/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a> * cu;</div>
<div class="line"><span class="lineno"> 1128</span>                                }</div>
<div class="line"><span class="lineno"> 1129</span>                            }</div>
<div class="line"><span class="lineno"> 1130</span>                        }</div>
<div class="line"><span class="lineno"> 1131</span>                    }</div>
<div class="line"><span class="lineno"> 1132</span>                }</div>
<div class="line"><span class="lineno"> 1133</span>            }</div>
<div class="line"><span class="lineno"> 1134</span>        }</div>
<div class="line"><span class="lineno"> 1135</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1136</span>    }</div>
<div class="line"><span class="lineno"> 1137</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1138</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af3e5d4e6932a05fb66627854b90cfcd6" name="af3e5d4e6932a05fb66627854b90cfcd6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3e5d4e6932a05fb66627854b90cfcd6">&#9670;&#160;</a></span>SingleSolid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::FlowSolverLBM::SingleSolid </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if single solid is present at (i,j,k) </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02077">2077</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2078</span>{</div>
<div class="line"><span class="lineno"> 2079</span>    <span class="keywordflow">for</span>(<span class="keyword">auto</span> it = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 2080</span>            it != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).cend(); ++it)</div>
<div class="line"><span class="lineno"> 2081</span>    <span class="keywordflow">if</span>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[it-&gt;index].State == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a545a7e1c8dca42c00f8f139a1913c61cae41480b6bbfbf7407974a88d3d34f4fa">AggregateStates::Solid</a>)</div>
<div class="line"><span class="lineno"> 2082</span>    {</div>
<div class="line"><span class="lineno"> 2083</span>        <span class="keywordflow">if</span>(it-&gt;value &gt;= 0.95) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2084</span>    }</div>
<div class="line"><span class="lineno"> 2085</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2086</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a90657b1ab921a0b66ebe8201a939dddf" name="a90657b1ab921a0b66ebe8201a939dddf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90657b1ab921a0b66ebe8201a939dddf">&#9670;&#160;</a></span>SolidFraction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::SolidFraction </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns if solid fraction at (i,j,k) </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02088">2088</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2089</span>{</div>
<div class="line"><span class="lineno"> 2090</span>    <span class="keywordtype">double</span> <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a90657b1ab921a0b66ebe8201a939dddf">SolidFraction</a> = 0.0;</div>
<div class="line"><span class="lineno"> 2091</span>    <span class="keywordflow">for</span>(<span class="keyword">auto</span> it = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 2092</span>            it != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).cend(); ++it)</div>
<div class="line"><span class="lineno"> 2093</span>    <span class="keywordflow">if</span>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[it-&gt;index].State == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a545a7e1c8dca42c00f8f139a1913c61cae41480b6bbfbf7407974a88d3d34f4fa">AggregateStates::Solid</a>)</div>
<div class="line"><span class="lineno"> 2094</span>    {</div>
<div class="line"><span class="lineno"> 2095</span>        <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a90657b1ab921a0b66ebe8201a939dddf">SolidFraction</a> += it-&gt;value;</div>
<div class="line"><span class="lineno"> 2096</span>    }</div>
<div class="line"><span class="lineno"> 2097</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a90657b1ab921a0b66ebe8201a939dddf">SolidFraction</a>;</div>
<div class="line"><span class="lineno"> 2098</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6ce2bd921984e5a35136ee434328d1b4" name="a6ce2bd921984e5a35136ee434328d1b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ce2bd921984e5a35136ee434328d1b4">&#9670;&#160;</a></span>Solve() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::Solve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d8/da6/classopenphase_1_1Composition.html">Composition</a> &amp;&#160;</td>
          <td class="paramname"><em>Cx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;&#160;</td>
          <td class="paramname"><em>Vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates one time step of the Navier-Stokes solver. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02662">2662</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2664</span>{</div>
<div class="line"><span class="lineno"> 2665</span>    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac5517e657c322b841aeb9732f8b8e035">DetectObstacles</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>);</div>
<div class="line"><span class="lineno"> 2666</span>    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a78015631ab46781aeba17f0e7af47473">SetObstacleNodes</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, Vel);</div>
<div class="line"><span class="lineno"> 2667</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a6c0dc555248064b06b4d1795657c5026">ObstaclesChanged</a>) <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#af6e8285978dabe6066bd291c5674ffdb">CalculateDensityAndMomentum</a>();</div>
<div class="line"><span class="lineno"> 2668</span> </div>
<div class="line"><span class="lineno"> 2669</span>    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a733647bb9863ddba4791eab6854cb519">Propagation</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, BC);</div>
<div class="line"><span class="lineno"> 2670</span>    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#af6e8285978dabe6066bd291c5674ffdb">CalculateDensityAndMomentum</a>();</div>
<div class="line"><span class="lineno"> 2671</span> </div>
<div class="line"><span class="lineno"> 2672</span>    BC.SetX(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>);</div>
<div class="line"><span class="lineno"> 2673</span>    BC.SetY(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>);</div>
<div class="line"><span class="lineno"> 2674</span>    BC.SetZ(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>);</div>
<div class="line"><span class="lineno"> 2675</span> </div>
<div class="line"><span class="lineno"> 2676</span>    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afe6c94036f18a00f2ebd751c3014d5b6">ApplyForces</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, Vel, Cx);</div>
<div class="line"><span class="lineno"> 2677</span>    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#af3c9d0663c6ceed9329730b5e7035430">Collision</a>();</div>
<div class="line"><span class="lineno"> 2678</span>    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#af6e8285978dabe6066bd291c5674ffdb">CalculateDensityAndMomentum</a>(); <span class="comment">//Commented by Dmitry // Uncommented by Raphael</span></div>
<div class="line"><span class="lineno"> 2679</span>    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aac503798c87d57cd342e2d56063f481b">SetBoundaryConditions</a>(BC);</div>
<div class="line"><span class="lineno"> 2680</span> </div>
<div class="line"><span class="lineno"> 2681</span>    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a863645b683596db07ac439b417656210">CalculateFluidVelocities</a>(Vel, <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, BC);</div>
<div class="line"><span class="lineno"> 2682</span> </div>
<div class="line"><span class="lineno"> 2683</span><span class="preprocessor">    #ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 2684</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> idx = 0; idx &lt; <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties.size(); idx++)</div>
<div class="line"><span class="lineno"> 2685</span>    <span class="keywordflow">if</span>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[idx].Exist and <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[idx].State == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a545a7e1c8dca42c00f8f139a1913c61cae41480b6bbfbf7407974a88d3d34f4fa">AggregateStates::Solid</a>)</div>
<div class="line"><span class="lineno"> 2686</span>    {</div>
<div class="line"><span class="lineno"> 2687</span>        <span class="keyword">auto</span> locForce = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[idx].Force;</div>
<div class="line"><span class="lineno"> 2688</span>        OP_MPI_Allreduce(&amp;locForce[0], &amp;(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[idx].Force[0]), 1, OP_MPI_DOUBLE, OP_MPI_SUM, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 2689</span>        OP_MPI_Allreduce(&amp;locForce[1], &amp;(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[idx].Force[1]), 1, OP_MPI_DOUBLE, OP_MPI_SUM, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 2690</span>        OP_MPI_Allreduce(&amp;locForce[2], &amp;(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[idx].Force[2]), 1, OP_MPI_DOUBLE, OP_MPI_SUM, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 2691</span> </div>
<div class="line"><span class="lineno"> 2692</span>        <span class="keyword">auto</span> locTorque = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[idx].Torque;</div>
<div class="line"><span class="lineno"> 2693</span>        OP_MPI_Allreduce(&amp;locTorque[0], &amp;(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[idx].Torque[0]), 1, OP_MPI_DOUBLE, OP_MPI_SUM, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 2694</span>        OP_MPI_Allreduce(&amp;locTorque[1], &amp;(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[idx].Torque[1]), 1, OP_MPI_DOUBLE, OP_MPI_SUM, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 2695</span>        OP_MPI_Allreduce(&amp;locTorque[2], &amp;(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[idx].Torque[2]), 1, OP_MPI_DOUBLE, OP_MPI_SUM, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 2696</span>    }</div>
<div class="line"><span class="lineno"> 2697</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno"> 2698</span>}</div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a733647bb9863ddba4791eab6854cb519"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a733647bb9863ddba4791eab6854cb519">openphase::FlowSolverLBM::Propagation</a></div><div class="ttdeci">void Propagation(PhaseField &amp;Phase, const BoundaryConditions &amp;BC)</div><div class="ttdoc">Propagates Populations.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l01667">FlowSolverLBM.cpp:1667</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_a863645b683596db07ac439b417656210"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a863645b683596db07ac439b417656210">openphase::FlowSolverLBM::CalculateFluidVelocities</a></div><div class="ttdeci">void CalculateFluidVelocities(Velocities &amp;Vel, const PhaseField &amp;Phase, const BoundaryConditions &amp;BC) const</div><div class="ttdoc">Calculates Fluid velocities.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02879">FlowSolverLBM.cpp:2879</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_af3c9d0663c6ceed9329730b5e7035430"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#af3c9d0663c6ceed9329730b5e7035430">openphase::FlowSolverLBM::Collision</a></div><div class="ttdeci">void Collision()</div><div class="ttdoc">Processes the collisions. Adjusts center of mass properties of colliding particles.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l01886">FlowSolverLBM.cpp:1886</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FlowSolverLBM_html_afe6c94036f18a00f2ebd751c3014d5b6"><div class="ttname"><a href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afe6c94036f18a00f2ebd751c3014d5b6">openphase::FlowSolverLBM::ApplyForces</a></div><div class="ttdeci">void ApplyForces(PhaseField &amp;Phase, const Velocities &amp;Vel, const Composition &amp;Cx)</div><div class="ttdoc">Applies forces.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l01858">FlowSolverLBM.cpp:1858</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a696288540747efec80dc3f4866b33e88" name="a696288540747efec80dc3f4866b33e88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a696288540747efec80dc3f4866b33e88">&#9670;&#160;</a></span>Solve() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::Solve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;&#160;</td>
          <td class="paramname"><em>Vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates one time step of the Navier-Stokes solver. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l02624">2624</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2626</span>{</div>
<div class="line"><span class="lineno"> 2627</span>    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac5517e657c322b841aeb9732f8b8e035">DetectObstacles</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>);</div>
<div class="line"><span class="lineno"> 2628</span>    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a78015631ab46781aeba17f0e7af47473">SetObstacleNodes</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, Vel);</div>
<div class="line"><span class="lineno"> 2629</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a6c0dc555248064b06b4d1795657c5026">ObstaclesChanged</a>) <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#af6e8285978dabe6066bd291c5674ffdb">CalculateDensityAndMomentum</a>();</div>
<div class="line"><span class="lineno"> 2630</span> </div>
<div class="line"><span class="lineno"> 2631</span>    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a733647bb9863ddba4791eab6854cb519">Propagation</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>,BC);</div>
<div class="line"><span class="lineno"> 2632</span>    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#af6e8285978dabe6066bd291c5674ffdb">CalculateDensityAndMomentum</a>();</div>
<div class="line"><span class="lineno"> 2633</span> </div>
<div class="line"><span class="lineno"> 2634</span>    BC.SetX(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>);</div>
<div class="line"><span class="lineno"> 2635</span>    BC.SetY(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>);</div>
<div class="line"><span class="lineno"> 2636</span>    BC.SetZ(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>);</div>
<div class="line"><span class="lineno"> 2637</span> </div>
<div class="line"><span class="lineno"> 2638</span>    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#afe6c94036f18a00f2ebd751c3014d5b6">ApplyForces</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, Vel);</div>
<div class="line"><span class="lineno"> 2639</span>    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#af3c9d0663c6ceed9329730b5e7035430">Collision</a>();</div>
<div class="line"><span class="lineno"> 2640</span>    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#af6e8285978dabe6066bd291c5674ffdb">CalculateDensityAndMomentum</a>(); <span class="comment">//Commented by Dmitry // Uncommented by Raphael</span></div>
<div class="line"><span class="lineno"> 2641</span>    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aac503798c87d57cd342e2d56063f481b">SetBoundaryConditions</a>(BC);</div>
<div class="line"><span class="lineno"> 2642</span> </div>
<div class="line"><span class="lineno"> 2643</span>    <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a863645b683596db07ac439b417656210">CalculateFluidVelocities</a>(Vel, <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, BC);</div>
<div class="line"><span class="lineno"> 2644</span> </div>
<div class="line"><span class="lineno"> 2645</span><span class="preprocessor">    #ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 2646</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> idx = 0; idx &lt; <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties.size(); idx++)</div>
<div class="line"><span class="lineno"> 2647</span>    <span class="keywordflow">if</span>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[idx].Exist and <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[idx].State == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a545a7e1c8dca42c00f8f139a1913c61cae41480b6bbfbf7407974a88d3d34f4fa">AggregateStates::Solid</a>)</div>
<div class="line"><span class="lineno"> 2648</span>    {</div>
<div class="line"><span class="lineno"> 2649</span>        <span class="keyword">auto</span> locForce = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[idx].Force;</div>
<div class="line"><span class="lineno"> 2650</span>        OP_MPI_Allreduce(&amp;locForce[0], &amp;(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[idx].Force[0]), 1, OP_MPI_DOUBLE, OP_MPI_SUM, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 2651</span>        OP_MPI_Allreduce(&amp;locForce[1], &amp;(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[idx].Force[1]), 1, OP_MPI_DOUBLE, OP_MPI_SUM, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 2652</span>        OP_MPI_Allreduce(&amp;locForce[2], &amp;(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[idx].Force[2]), 1, OP_MPI_DOUBLE, OP_MPI_SUM, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 2653</span> </div>
<div class="line"><span class="lineno"> 2654</span>        <span class="keyword">auto</span> locTorque = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[idx].Torque;</div>
<div class="line"><span class="lineno"> 2655</span>        OP_MPI_Allreduce(&amp;locTorque[0], &amp;(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[idx].Torque[0]), 1, OP_MPI_DOUBLE, OP_MPI_SUM, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 2656</span>        OP_MPI_Allreduce(&amp;locTorque[1], &amp;(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[idx].Torque[1]), 1, OP_MPI_DOUBLE, OP_MPI_SUM, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 2657</span>        OP_MPI_Allreduce(&amp;locTorque[2], &amp;(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[idx].Torque[2]), 1, OP_MPI_DOUBLE, OP_MPI_SUM, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 2658</span>    }</div>
<div class="line"><span class="lineno"> 2659</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno"> 2660</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1ab7011ac0eafbbd995e46445026ef4f" name="a1ab7011ac0eafbbd995e46445026ef4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ab7011ac0eafbbd995e46445026ef4f">&#9670;&#160;</a></span>SolveTC3D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::SolveTC3D </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;&#160;</td>
          <td class="paramname"><em>Vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/da6/classopenphase_1_1Composition.html">Composition</a> &amp;&#160;</td>
          <td class="paramname"><em>Cx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/d35/classopenphase_1_1Temperature.html">Temperature</a> &amp;&#160;</td>
          <td class="paramname"><em>Tx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a39b0afff7e320e23788a0e7db47a4b19" name="a39b0afff7e320e23788a0e7db47a4b19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39b0afff7e320e23788a0e7db47a4b19">&#9670;&#160;</a></span>Update_dt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::Update_dt </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>_dt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates one time step of the Navier-Stokes solver. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00459">459</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  460</span>{</div>
<div class="line"><span class="lineno">  461</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>  = _dt;</div>
<div class="line"><span class="lineno">  462</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5421bde5029b801f847f4ec190b3a5dc">dM</a>  = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3f3275be19efcce0234470fdc88d77fd">dRho</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_function" href="../../dc/d18/classopenphase_1_1GridParameters.html#a9e96c156b3c12ba0bb402d5188dbf1c6">CellVolume</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  463</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a83cd87469986a195f9a42c9fbff2f523">dP</a>  = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5421bde5029b801f847f4ec190b3a5dc">dM</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>;</div>
<div class="line"><span class="lineno">  464</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a0e7cad672eea608ab7c5ea5ed6946138">dm</a>  = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5421bde5029b801f847f4ec190b3a5dc">dM</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>;</div>
<div class="line"><span class="lineno">  465</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a3b6d8de9f278b56d9346a2adb823a4e2">df</a>  = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a5421bde5029b801f847f4ec190b3a5dc">dM</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>;</div>
<div class="line"><span class="lineno">  466</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a74ae26b9feb1666e9c177e5e88558d8a">dnu</a> = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a>;</div>
<div class="line"><span class="lineno">  467</span>    <span class="comment">// NOTE: the minimum and maximum kinematic viscosity values are based</span></div>
<div class="line"><span class="lineno">  468</span>    <span class="comment">// on experience and may be adjusted.</span></div>
<div class="line"><span class="lineno">  469</span>    <span class="comment">//const double nu_min = 0.05*dx*dx/dt;</span></div>
<div class="line"><span class="lineno">  470</span>    <span class="comment">//const double nu_max = 1.00*dx*dx/dt;</span></div>
<div class="line"><span class="lineno">  471</span>    <span class="comment">//const double nu_opt = 0.5/3.0*dx*dx/dt; // optimal value !</span></div>
<div class="line"><span class="lineno">  472</span> </div>
<div class="line"><span class="lineno">  473</span>    <span class="comment">// Set relaxation parameter tau</span></div>
<div class="line"><span class="lineno">  474</span>    <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad8ae2a30dc85638b1a377cc2919200fe">lbtau</a>.resize(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>);</div>
<div class="line"><span class="lineno">  475</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno">  476</span>    {</div>
<div class="line"><span class="lineno">  477</span>        <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad8ae2a30dc85638b1a377cc2919200fe">lbtau</a>[n] = 3*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a79b3ebcd11696e18f2db1079356829e3">nu</a>[n]/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>/<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>*<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab04d9d80bea5a4114c3c31eed361db5c">dt</a> + 0.5;</div>
<div class="line"><span class="lineno">  478</span>    }</div>
<div class="line"><span class="lineno">  479</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7cdecb6b85ec910f609c81c816482972" name="a7cdecb6b85ec910f609c81c816482972"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cdecb6b85ec910f609c81c816482972">&#9670;&#160;</a></span>Write()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::FlowSolverLBM::Write </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;&#160;</td>
          <td class="paramname"><em>locSettings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>tStep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Writes raw (binary) fields to file. </p>

<p>Reimplemented from <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#a2b2d60f99c90b6fc30f52b516ee0df2b">openphase::OPObject</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00606">606</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  607</span>{</div>
<div class="line"><span class="lineno">  608</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno">  609</span>    std::string FileName = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a19ed8803c3eb456f4708ccc6c6edd995">FileInterface::MakeFileName</a>(locSettings.RawDataDir, <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>+<span class="charliteral">&#39;_&#39;</span>+std::to_string(MPI_RANK)+<span class="stringliteral">&quot;_&quot;</span>, tStep, <span class="stringliteral">&quot;.dat&quot;</span>);</div>
<div class="line"><span class="lineno">  610</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  611</span>    std::string FileName = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a19ed8803c3eb456f4708ccc6c6edd995">FileInterface::MakeFileName</a>(locSettings.RawDataDir, <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>+<span class="charliteral">&#39;_&#39;</span>, tStep, <span class="stringliteral">&quot;.dat&quot;</span>);</div>
<div class="line"><span class="lineno">  612</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  613</span> </div>
<div class="line"><span class="lineno">  614</span>    std::ofstream out(FileName.c_str(), std::ios::out | std::ios::binary);</div>
<div class="line"><span class="lineno">  615</span> </div>
<div class="line"><span class="lineno">  616</span>    <span class="keywordflow">if</span> (!out)</div>
<div class="line"><span class="lineno">  617</span>    {</div>
<div class="line"><span class="lineno">  618</span>        std::stringstream message;</div>
<div class="line"><span class="lineno">  619</span>        message &lt;&lt; <span class="stringliteral">&quot;File \&quot;&quot;</span> &lt;&lt; FileName</div>
<div class="line"><span class="lineno">  620</span>            &lt;&lt; <span class="stringliteral">&quot;\&quot; could not be created! Terminating!!!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  621</span>        <span class="keywordflow">throw</span> std::runtime_error(message.str());</div>
<div class="line"><span class="lineno">  622</span>    };</div>
<div class="line"><span class="lineno">  623</span> </div>
<div class="line"><span class="lineno">  624</span>    out.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>),           <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><span class="lineno">  625</span>    out.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>),           <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><span class="lineno">  626</span>    out.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>),           <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><span class="lineno">  627</span>    out.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>), <span class="keyword">sizeof</span>(<span class="keywordtype">size_t</span>));</div>
<div class="line"><span class="lineno">  628</span> </div>
<div class="line"><span class="lineno">  629</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a71aed4b94e116454c7b11985a91e49ec">STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>,0)</div>
<div class="line"><span class="lineno">  630</span>    {</div>
<div class="line"><span class="lineno">  631</span>        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno">  632</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ii = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ++ii)</div>
<div class="line"><span class="lineno">  633</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; ++jj)</div>
<div class="line"><span class="lineno">  634</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a9adff9295d5ffac6ed4be9bb59ab8070">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; ++kk)</div>
<div class="line"><span class="lineno">  635</span>        {</div>
<div class="line"><span class="lineno">  636</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> value = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a7ae0f2b577b9a7525d84e110ed21e047">lbPopulations</a>(i,j,k,{n})(ii,jj,kk);</div>
<div class="line"><span class="lineno">  637</span>            out.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;value), <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><span class="lineno">  638</span>        }</div>
<div class="line"><span class="lineno">  639</span>    }</div>
<div class="line"><span class="lineno">  640</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a6ad2c83345f230517a1770304d7b39ad">STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  641</span> </div>
<div class="line"><span class="lineno">  642</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a71aed4b94e116454c7b11985a91e49ec">STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>,0)</div>
<div class="line"><span class="lineno">  643</span>    {</div>
<div class="line"><span class="lineno">  644</span>        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno">  645</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> m = 0; m &lt; 3; ++m)</div>
<div class="line"><span class="lineno">  646</span>        {</div>
<div class="line"><span class="lineno">  647</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> value = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a1c3ab22cfd49f007f6c0289f093dcd8b">ForceDensity</a>(i,j,k,{n})[m];</div>
<div class="line"><span class="lineno">  648</span>            out.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;value), <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><span class="lineno">  649</span>        }</div>
<div class="line"><span class="lineno">  650</span>    }</div>
<div class="line"><span class="lineno">  651</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a6ad2c83345f230517a1770304d7b39ad">STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  652</span> </div>
<div class="line"><span class="lineno">  653</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a71aed4b94e116454c7b11985a91e49ec">STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>,0)</div>
<div class="line"><span class="lineno">  654</span>    {</div>
<div class="line"><span class="lineno">  655</span>        <span class="keyword">const</span> <span class="keywordtype">bool</span> value = <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k);</div>
<div class="line"><span class="lineno">  656</span>        out.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;value), <span class="keyword">sizeof</span>(<span class="keywordtype">bool</span>));</div>
<div class="line"><span class="lineno">  657</span>    }</div>
<div class="line"><span class="lineno">  658</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a6ad2c83345f230517a1770304d7b39ad">STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  659</span> </div>
<div class="line"><span class="lineno">  660</span>    out.close();</div>
<div class="line"><span class="lineno">  661</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  662</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3563ba006c5c86f62ca1cc920835c183" name="a3563ba006c5c86f62ca1cc920835c183"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3563ba006c5c86f62ca1cc920835c183">&#9670;&#160;</a></span>WriteVTK()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::FlowSolverLBM::WriteVTK </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;&#160;</td>
          <td class="paramname"><em>locSettings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>tStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>precision</em> = <code>16</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes physical fields values into file with <a class="el" href="../../d3/d89/structopenphase_1_1VTK.html" title="&lt; static class to write VTK data in xml format">VTK</a> format. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00664">664</a> of file <a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  665</span>{</div>
<div class="line"><span class="lineno">  666</span>    std::vector&lt;VTK::Field_t&gt; ListOfFields;</div>
<div class="line"><span class="lineno">  667</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ac0c2cd11db03f22d554529d296ba08f6">N_Fluid_Comp</a>; ++n)</div>
<div class="line"><span class="lineno">  668</span>    {</div>
<div class="line"><span class="lineno">  669</span>        ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;DensityWetting_&quot;</span> +std::to_string(n), [n, <span class="keyword">this</span>] (<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ad5001f5c5e9e2aa3f12640ce3f31614a">DensityWetting</a>(i,j,k,{n});}});</div>
<div class="line"><span class="lineno">  670</span>    }</div>
<div class="line"><span class="lineno">  671</span>    ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;Density&quot;</span>,  [<span class="keyword">this</span>, &amp;<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aa47e5e7286c14822bf4c30efecfecf6a">Density</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>,i,j,k);}});</div>
<div class="line"><span class="lineno">  672</span>    ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;Pressure&quot;</span>, [<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_function" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a286f1c691a57f5d5c8b1b217f86cd328">Pressure</a>(i,j,k);}});</div>
<div class="line"><span class="lineno">  673</span>    ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;Obstacle&quot;</span>, [<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> int(<a class="code hl_variable" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#add3ce72d4d4ffd34781bac8b0f7a6673">Obstacle</a>(i,j,k));}});</div>
<div class="line"><span class="lineno">  674</span> </div>
<div class="line"><span class="lineno">  675</span>    std::string Filename = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a19ed8803c3eb456f4708ccc6c6edd995">FileInterface::MakeFileName</a>(locSettings.VTKDir, <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>+<span class="charliteral">&#39;_&#39;</span>, tStep, <span class="stringliteral">&quot;.vts&quot;</span>);</div>
<div class="line"><span class="lineno">  676</span> </div>
<div class="line"><span class="lineno">  677</span>    <a class="code hl_function" href="../../d3/d89/structopenphase_1_1VTK.html#a7617ede48a3aded40ba2eb72d60447f1">VTK::Write</a>(Filename, locSettings, ListOfFields, precision);</div>
<div class="line"><span class="lineno">  678</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a7f54d22dc59afcace6359f599fabcaac" name="a7f54d22dc59afcace6359f599fabcaac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f54d22dc59afcace6359f599fabcaac">&#9670;&#160;</a></span>advectable</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::OPObject::advectable = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>True if the object has non-empty <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#afd82ead485f6d9695aa733729100614c">Advect()</a> method. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d1c/OPObject_8h_source.html#l00060">60</a> of file <a class="el" href="../../d5/d1c/OPObject_8h_source.html">OPObject.h</a>.</p>

</div>
</div>
<a id="a852ebebddbd520319bcc8b65bffad2a3" name="a852ebebddbd520319bcc8b65bffad2a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a852ebebddbd520319bcc8b65bffad2a3">&#9670;&#160;</a></span>Bcells</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int openphase::FlowSolverLBM::Bcells</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of boundary cells. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00232">232</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a49a9d1e352e5dafc93f493012d527ee1" name="a49a9d1e352e5dafc93f493012d527ee1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49a9d1e352e5dafc93f493012d527ee1">&#9670;&#160;</a></span>boundary_conditions</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::OPObject::boundary_conditions = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>True if the object has non-empty <a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#aac503798c87d57cd342e2d56063f481b" title="Sets boundary conditions for the particle distribution functions and flow velocities.">SetBoundaryConditions()</a> </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d1c/OPObject_8h_source.html#l00062">62</a> of file <a class="el" href="../../d5/d1c/OPObject_8h_source.html">OPObject.h</a>.</p>

</div>
</div>
<a id="a66544929ec9e15f973b2d349787a5993" name="a66544929ec9e15f973b2d349787a5993"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66544929ec9e15f973b2d349787a5993">&#9670;&#160;</a></span>CriticalDensity</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; openphase::FlowSolverLBM::CriticalDensity</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Critical density of phase separation (Two phase flow) </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00242">242</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a5284a4950dae747d84ce23d74fd5963e" name="a5284a4950dae747d84ce23d74fd5963e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5284a4950dae747d84ce23d74fd5963e">&#9670;&#160;</a></span>cs2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::cs2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Speed of sound squared [m/s]. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00235">235</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="addfc8e9e14301fe577dac27985c8e294" name="addfc8e9e14301fe577dac27985c8e294"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addfc8e9e14301fe577dac27985c8e294">&#9670;&#160;</a></span>dDensity_dc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; openphase::FlowSolverLBM::dDensity_dc</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Density change according to the change of concentration [Kg/(mol/mol)]. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00241">241</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="ad5001f5c5e9e2aa3f12640ce3f31614a" name="ad5001f5c5e9e2aa3f12640ce3f31614a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5001f5c5e9e2aa3f12640ce3f31614a">&#9670;&#160;</a></span>DensityWetting</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; double, 1 &gt; openphase::FlowSolverLBM::DensityWetting</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fluid density / Solid wetting parameter. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00176">176</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a3b6d8de9f278b56d9346a2adb823a4e2" name="a3b6d8de9f278b56d9346a2adb823a4e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b6d8de9f278b56d9346a2adb823a4e2">&#9670;&#160;</a></span>df</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::df</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Coefficient to calculate physical force density from lattice force density [Kg/(m^2 s^2)]. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00217">217</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a2b6d93798b295d1969521ba48bdc9af1" name="a2b6d93798b295d1969521ba48bdc9af1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b6d93798b295d1969521ba48bdc9af1">&#9670;&#160;</a></span>DivVel</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; double, 1 &gt; openphase::FlowSolverLBM::DivVel</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Divergence of velocity when thermal compressibility considered. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00179">179</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a0e7cad672eea608ab7c5ea5ed6946138" name="a0e7cad672eea608ab7c5ea5ed6946138"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e7cad672eea608ab7c5ea5ed6946138">&#9670;&#160;</a></span>dm</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::dm</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Coefficient to calculate physical momentum density from lattice momentum density [Kg/(m^2 s)]. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00216">216</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a5421bde5029b801f847f4ec190b3a5dc" name="a5421bde5029b801f847f4ec190b3a5dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5421bde5029b801f847f4ec190b3a5dc">&#9670;&#160;</a></span>dM</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::dM</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Coefficient to calculate physical mass from lattice mass [Kg]. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00222">222</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a74ae26b9feb1666e9c177e5e88558d8a" name="a74ae26b9feb1666e9c177e5e88558d8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74ae26b9feb1666e9c177e5e88558d8a">&#9670;&#160;</a></span>dnu</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::dnu</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Coefficient to calculate physical kinematic viscosity from lattice kinematic viscosity [m^2/s]. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00218">218</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="ab45097494cc01fa93c7420778061d7ed" name="ab45097494cc01fa93c7420778061d7ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab45097494cc01fa93c7420778061d7ed">&#9670;&#160;</a></span>Do_Benzi</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::FlowSolverLBM::Do_Benzi</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set to "true" if Benzi force should be calculated. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00182">182</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a2dc5ba2dfe7ff199c4e6b625c57b4001" name="a2dc5ba2dfe7ff199c4e6b625c57b4001"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2dc5ba2dfe7ff199c4e6b625c57b4001">&#9670;&#160;</a></span>Do_BounceBack</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::FlowSolverLBM::Do_BounceBack</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set to "true" for the fluid bounce back at the interface (not energy conserving with mobile solids) </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00183">183</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a359a5b0d89af4a527bb3d9cfdba32f85" name="a359a5b0d89af4a527bb3d9cfdba32f85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a359a5b0d89af4a527bb3d9cfdba32f85">&#9670;&#160;</a></span>Do_BounceBackElastic</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::FlowSolverLBM::Do_BounceBackElastic</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set to "true" for the elastic fluid bounce back (energy conserving with mobile solids) </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00184">184</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a92c22f0dfe11f8b261391b7e73fdc2f4" name="a92c22f0dfe11f8b261391b7e73fdc2f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92c22f0dfe11f8b261391b7e73fdc2f4">&#9670;&#160;</a></span>Do_DI</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::FlowSolverLBM::Do_DI</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set to "true" if the interface considered diffuse. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00193">193</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a570918ac5d77ab38b6f92f9a31e401e0" name="a570918ac5d77ab38b6f92f9a31e401e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a570918ac5d77ab38b6f92f9a31e401e0">&#9670;&#160;</a></span>Do_Drag</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::FlowSolverLBM::Do_Drag</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set to "true" if drag force at the interfaces should be calculated. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00185">185</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a06f6913d390fd7e3e2174b6a82506b4b" name="a06f6913d390fd7e3e2174b6a82506b4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06f6913d390fd7e3e2174b6a82506b4b">&#9670;&#160;</a></span>Do_EDForcing</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::FlowSolverLBM::Do_EDForcing</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set to "true" if exact difference method should be used to apply the calculated force. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00186">186</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="ad85e2131812f1bb919f547226d6a6a3a" name="ad85e2131812f1bb919f547226d6a6a3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad85e2131812f1bb919f547226d6a6a3a">&#9670;&#160;</a></span>Do_FixPopulations</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::FlowSolverLBM::Do_FixPopulations</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set to "true" if negative Densities and Populations should be fixes. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00187">187</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a2254d3b9f9dab0e6a6917590f020879d" name="a2254d3b9f9dab0e6a6917590f020879d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2254d3b9f9dab0e6a6917590f020879d">&#9670;&#160;</a></span>Do_Gravity</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::FlowSolverLBM::Do_Gravity</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set to "true" if gravitational force should be calculated. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00188">188</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="ab5ba4a4e507c7d80c6268bb41e4f3c2a" name="ab5ba4a4e507c7d80c6268bb41e4f3c2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5ba4a4e507c7d80c6268bb41e4f3c2a">&#9670;&#160;</a></span>Do_GuoForcing</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::FlowSolverLBM::Do_GuoForcing</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00189">189</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="ae9bc290fd900003e6984f319eb544269" name="ae9bc290fd900003e6984f319eb544269"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9bc290fd900003e6984f319eb544269">&#9670;&#160;</a></span>Do_Kupershtokh</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::FlowSolverLBM::Do_Kupershtokh</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set to "true" if Kupershtokh's method for two phase fluid flow should be used. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00190">190</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a7c63a86b32c4126fb329829acf6af13c" name="a7c63a86b32c4126fb329829acf6af13c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c63a86b32c4126fb329829acf6af13c">&#9670;&#160;</a></span>Do_ThermalComp</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::FlowSolverLBM::Do_ThermalComp</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set to "true" if thermal compressibility considered. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00192">192</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a147890b1c75d4b407881212ea40ecf05" name="a147890b1c75d4b407881212ea40ecf05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a147890b1c75d4b407881212ea40ecf05">&#9670;&#160;</a></span>Do_TwoPhase</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::FlowSolverLBM::Do_TwoPhase</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set to "true" if two phase flow should be calculated. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00191">191</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a83cd87469986a195f9a42c9fbff2f523" name="a83cd87469986a195f9a42c9fbff2f523"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83cd87469986a195f9a42c9fbff2f523">&#9670;&#160;</a></span>dP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::dP</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Coefficient to calculate physical pressure from lattice pressure [Pa]. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00215">215</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a3f3275be19efcce0234470fdc88d77fd" name="a3f3275be19efcce0234470fdc88d77fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f3275be19efcce0234470fdc88d77fd">&#9670;&#160;</a></span>dRho</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::dRho</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Coefficient to calculate physical density from lattice density [Kg/m^3]. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00214">214</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="ab04d9d80bea5a4114c3c31eed361db5c" name="ab04d9d80bea5a4114c3c31eed361db5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab04d9d80bea5a4114c3c31eed361db5c">&#9670;&#160;</a></span>dt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::dt</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Coefficient to calculate physical time from lattice time [s]. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00221">221</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a9c24d4bdb6833cf83827eb7ae9629f47" name="a9c24d4bdb6833cf83827eb7ae9629f47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c24d4bdb6833cf83827eb7ae9629f47">&#9670;&#160;</a></span>dv</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::dv</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00219">219</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="aa4faa1708afdfd505f7648f1a063d80b" name="aa4faa1708afdfd505f7648f1a063d80b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4faa1708afdfd505f7648f1a063d80b">&#9670;&#160;</a></span>ElementNames</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; openphase::FlowSolverLBM::ElementNames</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Names of chemical elements. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00252">252</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="acaf39436ee81673b389cf19247734fca" name="acaf39436ee81673b389cf19247734fca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acaf39436ee81673b389cf19247734fca">&#9670;&#160;</a></span>FluidMass</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; openphase::FlowSolverLBM::FluidMass</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fluid mass (used for mass conservation) </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00245">245</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="ad91501a0b7baf58043f1c744d858816d" name="ad91501a0b7baf58043f1c744d858816d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad91501a0b7baf58043f1c744d858816d">&#9670;&#160;</a></span>FluidRedistributionRange</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int openphase::FlowSolverLBM::FluidRedistributionRange</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fluid distribution range in case of 2 phase flow. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00233">233</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a1c3ab22cfd49f007f6c0289f093dcd8b" name="a1c3ab22cfd49f007f6c0289f093dcd8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c3ab22cfd49f007f6c0289f093dcd8b">&#9670;&#160;</a></span>ForceDensity</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a>, 1 &gt; openphase::FlowSolverLBM::ForceDensity</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Force density. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00174">174</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a0041741e7a61b58755ac052871ccc47a" name="a0041741e7a61b58755ac052871ccc47a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0041741e7a61b58755ac052871ccc47a">&#9670;&#160;</a></span>GA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> openphase::FlowSolverLBM::GA</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gravity acceleration in true units [m/s^2]. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00209">209</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a11c6271193ddf1f694f1bfc4227bf617" name="a11c6271193ddf1f694f1bfc4227bf617"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11c6271193ddf1f694f1bfc4227bf617">&#9670;&#160;</a></span>GasParameter</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; openphase::FlowSolverLBM::GasParameter</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gas parameter for Kupersthok (interface width) </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00238">238</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a587965ea13dcb7fddac42b87da1df7cf" name="a587965ea13dcb7fddac42b87da1df7cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a587965ea13dcb7fddac42b87da1df7cf">&#9670;&#160;</a></span>Gb</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;double&gt; &gt; openphase::FlowSolverLBM::Gb</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parameter for Benzi-force [Kg/(m^3)]. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00254">254</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a2357615d61b1d4d4bb027c1dfa67260c" name="a2357615d61b1d4d4bb027c1dfa67260c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2357615d61b1d4d4bb027c1dfa67260c">&#9670;&#160;</a></span>GradRho</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a>, 1 &gt; openphase::FlowSolverLBM::GradRho</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gradient of density when thermal compressibility considered. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00180">180</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="ac26558dc3c1f0f921a771ceedbc474e2" name="ac26558dc3c1f0f921a771ceedbc474e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac26558dc3c1f0f921a771ceedbc474e2">&#9670;&#160;</a></span>GradRho_Central</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::FlowSolverLBM::GradRho_Central</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00197">197</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="afd420cebecad62af1b472379f9b05663" name="afd420cebecad62af1b472379f9b05663"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd420cebecad62af1b472379f9b05663">&#9670;&#160;</a></span>GradRho_Upwind</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::FlowSolverLBM::GradRho_Upwind</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00196">196</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a911943c5a05841969b913c12c1d4921c" name="a911943c5a05841969b913c12c1d4921c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a911943c5a05841969b913c12c1d4921c">&#9670;&#160;</a></span>GradRho_VanLeer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::FlowSolverLBM::GradRho_VanLeer</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00198">198</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a9adff9295d5ffac6ed4be9bb59ab8070" name="a9adff9295d5ffac6ed4be9bb59ab8070"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9adff9295d5ffac6ed4be9bb59ab8070">&#9670;&#160;</a></span>Grid</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d18/classopenphase_1_1GridParameters.html">GridParameters</a> openphase::FlowSolverLBM::Grid</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simulation grid parameters. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00230">230</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="ad61619206ef9c5955004f3ff0186687a" name="ad61619206ef9c5955004f3ff0186687a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad61619206ef9c5955004f3ff0186687a">&#9670;&#160;</a></span>h_star</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::h_star</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>dimensionless drag force parameter </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00212">212</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="afa690789441704b411b9252d930c2363" name="afa690789441704b411b9252d930c2363"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa690789441704b411b9252d930c2363">&#9670;&#160;</a></span>HydroPressure</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; double, 1 &gt; openphase::FlowSolverLBM::HydroPressure</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Hydrolic Pressure for each lattice when thermal compressibility considered. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00178">178</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="aa112048d179026f359161b1f20e5e98e" name="aa112048d179026f359161b1f20e5e98e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa112048d179026f359161b1f20e5e98e">&#9670;&#160;</a></span>initialized</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::OPObject::initialized = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>True if obect's Initialize has been executed. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d1c/OPObject_8h_source.html#l00057">57</a> of file <a class="el" href="../../d5/d1c/OPObject_8h_source.html">OPObject.h</a>.</p>

</div>
</div>
<a id="a5e9e538e60ba43e77acb1cc88b20a316" name="a5e9e538e60ba43e77acb1cc88b20a316"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e9e538e60ba43e77acb1cc88b20a316">&#9670;&#160;</a></span>InitialTotalMass</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::InitialTotalMass</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solid mass (used for mass conservation) </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00237">237</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a65ef7d7ae73be8f9a7fa626762c4937d" name="a65ef7d7ae73be8f9a7fa626762c4937d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65ef7d7ae73be8f9a7fa626762c4937d">&#9670;&#160;</a></span>input_read</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::OPObject::input_read = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>True if obect's <a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#ab7ec322c63819b51ebd5912de9c9d09d" title="Reads input parameters from a file.">ReadInput()</a> has been executed. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d1c/OPObject_8h_source.html#l00058">58</a> of file <a class="el" href="../../d5/d1c/OPObject_8h_source.html">OPObject.h</a>.</p>

</div>
</div>
<a id="a7d68fa3e9c3b4dc37721947295a7507f" name="a7d68fa3e9c3b4dc37721947295a7507f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d68fa3e9c3b4dc37721947295a7507f">&#9670;&#160;</a></span>InterfaceWidth</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; openphase::FlowSolverLBM::InterfaceWidth</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Equilibrium interface width [TODO]. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00239">239</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="ab8df6700e0802a129069281b338313d7" name="ab8df6700e0802a129069281b338313d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8df6700e0802a129069281b338313d7">&#9670;&#160;</a></span>lbCriticalPressure</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; openphase::FlowSolverLBM::lbCriticalPressure</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Critical Pressure for Kupersthok (Van der Waal) </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00243">243</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a405aa37be090a3d967abab6df1f941ba" name="a405aa37be090a3d967abab6df1f941ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a405aa37be090a3d967abab6df1f941ba">&#9670;&#160;</a></span>lbCriticalTemperature</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; openphase::FlowSolverLBM::lbCriticalTemperature</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Critical temperature of phase separation (Two phase flow) </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00244">244</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a0d614141e8c6298e8b39f8b7d67fe8da" name="a0d614141e8c6298e8b39f8b7d67fe8da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d614141e8c6298e8b39f8b7d67fe8da">&#9670;&#160;</a></span>lbGK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;double&gt; &gt; openphase::FlowSolverLBM::lbGK</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parameter for Kupershtohk. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00256">256</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a7ae0f2b577b9a7525d84e110ed21e047" name="a7ae0f2b577b9a7525d84e110ed21e047"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ae0f2b577b9a7525d84e110ed21e047">&#9670;&#160;</a></span>lbPopulations</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; <a class="el" href="../../d5/d57/classopenphase_1_1D3Q27.html">D3Q27</a>, 1 &gt; openphase::FlowSolverLBM::lbPopulations</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Populations (discretized particle distribution functions) PDF) </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00168">168</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a2ab90fa6fd8a7c36d86144281f5b0caa" name="a2ab90fa6fd8a7c36d86144281f5b0caa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ab90fa6fd8a7c36d86144281f5b0caa">&#9670;&#160;</a></span>lbPopulationsTMP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; <a class="el" href="../../d5/d57/classopenphase_1_1D3Q27.html">D3Q27</a>, 1 &gt; openphase::FlowSolverLBM::lbPopulationsTMP</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Temporary array for Populations PDF propagation. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00169">169</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="ad8ae2a30dc85638b1a377cc2919200fe" name="ad8ae2a30dc85638b1a377cc2919200fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8ae2a30dc85638b1a377cc2919200fe">&#9670;&#160;</a></span>lbtau</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; openphase::FlowSolverLBM::lbtau</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Relaxation time for BGK collision operator. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00251">251</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a135999305b00dce046d03db79817e69e" name="a135999305b00dce046d03db79817e69e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a135999305b00dce046d03db79817e69e">&#9670;&#160;</a></span>lbTemperature</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; openphase::FlowSolverLBM::lbTemperature</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="../../d4/d35/classopenphase_1_1Temperature.html" title="&lt; Storage for the temperature">Temperature</a> (Two phase flow) </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00247">247</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a92539bf6d5ed043520c0bdbc47c334a9" name="a92539bf6d5ed043520c0bdbc47c334a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92539bf6d5ed043520c0bdbc47c334a9">&#9670;&#160;</a></span>lbWeights</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::lbWeights[3][3][3]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Lattice Boltzmann stencil weights. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00224">224</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="aa6aa8fda060bc8571b4b0a95464abd04" name="aa6aa8fda060bc8571b4b0a95464abd04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6aa8fda060bc8571b4b0a95464abd04">&#9670;&#160;</a></span>LiquidDensity</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; openphase::FlowSolverLBM::LiquidDensity</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Equilibrium density of the liquid phase. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00246">246</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="ae0a0f10cae3f3b764b4fa994a842f3a5" name="ae0a0f10cae3f3b764b4fa994a842f3a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0a0f10cae3f3b764b4fa994a842f3a5">&#9670;&#160;</a></span>MomentumDensity</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a>, 1 &gt; openphase::FlowSolverLBM::MomentumDensity</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Momentum density. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00175">175</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="ac0c2cd11db03f22d554529d296ba08f6" name="ac0c2cd11db03f22d554529d296ba08f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0c2cd11db03f22d554529d296ba08f6">&#9670;&#160;</a></span>N_Fluid_Comp</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t openphase::FlowSolverLBM::N_Fluid_Comp</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of fluid components. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00227">227</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a3682fba50989e5b7ab0df48763a889d3" name="a3682fba50989e5b7ab0df48763a889d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3682fba50989e5b7ab0df48763a889d3">&#9670;&#160;</a></span>Ncomp</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t openphase::FlowSolverLBM::Ncomp</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of chemical components. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00226">226</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a9c5fb9cd4952a23292b686140a250279" name="a9c5fb9cd4952a23292b686140a250279"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c5fb9cd4952a23292b686140a250279">&#9670;&#160;</a></span>Nphases</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t openphase::FlowSolverLBM::Nphases</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of thermodynamic phases per grain. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00228">228</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a79b3ebcd11696e18f2db1079356829e3" name="a79b3ebcd11696e18f2db1079356829e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79b3ebcd11696e18f2db1079356829e3">&#9670;&#160;</a></span>nu</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; openphase::FlowSolverLBM::nu</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Kinematic viscosity [m^2/s]. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00249">249</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a62faa8027eaa45caa436c65f032bc584" name="a62faa8027eaa45caa436c65f032bc584"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62faa8027eaa45caa436c65f032bc584">&#9670;&#160;</a></span>nut</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; double, 1 &gt; openphase::FlowSolverLBM::nut</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>kinematic viscosity in lattice units when thermal compressibility considered </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00177">177</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="add3ce72d4d4ffd34781bac8b0f7a6673" name="add3ce72d4d4ffd34781bac8b0f7a6673"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add3ce72d4d4ffd34781bac8b0f7a6673">&#9670;&#160;</a></span>Obstacle</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; int, 0 &gt; openphase::FlowSolverLBM::Obstacle</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>1 if Node is solid </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00170">170</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a23b20c6aaa054e65abc78e1783f1a595" name="a23b20c6aaa054e65abc78e1783f1a595"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23b20c6aaa054e65abc78e1783f1a595">&#9670;&#160;</a></span>ObstacleAppeared</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; int, 0 &gt; openphase::FlowSolverLBM::ObstacleAppeared</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>True if obstacle node appeared. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00171">171</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a9e20990385a07ac85eb89928bc78158c" name="a9e20990385a07ac85eb89928bc78158c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e20990385a07ac85eb89928bc78158c">&#9670;&#160;</a></span>ObstacleChangedDensity</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; int, 0 &gt; openphase::FlowSolverLBM::ObstacleChangedDensity</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>True if nearby obstacle changed local density. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00172">172</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a6c0dc555248064b06b4d1795657c5026" name="a6c0dc555248064b06b4d1795657c5026"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c0dc555248064b06b4d1795657c5026">&#9670;&#160;</a></span>ObstaclesChanged</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::FlowSolverLBM::ObstaclesChanged</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>True if an obstacle changed. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00194">194</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="aee9af090b2f8092c793ae13a596403f7" name="aee9af090b2f8092c793ae13a596403f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee9af090b2f8092c793ae13a596403f7">&#9670;&#160;</a></span>ObstacleVanished</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; int, 0 &gt; openphase::FlowSolverLBM::ObstacleVanished</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>True if obstacle node vanished. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00173">173</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="aaa6a4778188230a23cbbf10d21a33219" name="aaa6a4778188230a23cbbf10d21a33219"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa6a4778188230a23cbbf10d21a33219">&#9670;&#160;</a></span>ParaKuper</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::ParaKuper</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Kupershtokh parameter (to tune numerical accuracy!) </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00211">211</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a1b542beebb14e3182c7948b30f3eefd8" name="a1b542beebb14e3182c7948b30f3eefd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b542beebb14e3182c7948b30f3eefd8">&#9670;&#160;</a></span>Poutlet</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::Poutlet</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Outlet Hydrodynamic Pressure [Pa]. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00203">203</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="ad56f87a52b427bb6a4646208d54574c1" name="ad56f87a52b427bb6a4646208d54574c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad56f87a52b427bb6a4646208d54574c1">&#9670;&#160;</a></span>Pth</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::Pth</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Thermodynamic Pressure [Pa]. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00200">200</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a39e6431910d6e1d9558b91d0a59f6828" name="a39e6431910d6e1d9558b91d0a59f6828"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39e6431910d6e1d9558b91d0a59f6828">&#9670;&#160;</a></span>Pth0</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::Pth0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initial Thermodynamic Pressure [Pa]. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00202">202</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a62404913cee1f48eebbf6afbeb13b5d0" name="a62404913cee1f48eebbf6afbeb13b5d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62404913cee1f48eebbf6afbeb13b5d0">&#9670;&#160;</a></span>PthOld</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::PthOld</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Thermodynamic Pressure for previous time step [Pa]. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00201">201</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="aa5b7ff7b56e2d266c2fd59b620a1603b" name="aa5b7ff7b56e2d266c2fd59b620a1603b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5b7ff7b56e2d266c2fd59b620a1603b">&#9670;&#160;</a></span>readable</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::OPObject::readable = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>True if the object has non-empty <a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a297a77842a22e3f115c9b9a43979ff05" title="Read raw (binary) fields from file.">Read()</a> method. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d1c/OPObject_8h_source.html#l00061">61</a> of file <a class="el" href="../../d5/d1c/OPObject_8h_source.html">OPObject.h</a>.</p>

</div>
</div>
<a id="a44d40bc5a3ef87d7c461b457e01091dd" name="a44d40bc5a3ef87d7c461b457e01091dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44d40bc5a3ef87d7c461b457e01091dd">&#9670;&#160;</a></span>remeshable</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::OPObject::remeshable = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>True if the object has non-empty <a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html#a4e6f273f5ed0752225c0060c9e044a18">Remesh()</a> method. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d1c/OPObject_8h_source.html#l00059">59</a> of file <a class="el" href="../../d5/d1c/OPObject_8h_source.html">OPObject.h</a>.</p>

</div>
</div>
<a id="a7cd6cc5ca27add2432f5809f9d45ca03" name="a7cd6cc5ca27add2432f5809f9d45ca03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cd6cc5ca27add2432f5809f9d45ca03">&#9670;&#160;</a></span>rho_0</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; openphase::FlowSolverLBM::rho_0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reference density (Parameter for Benzi) [Kg/m^3]. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00250">250</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="aa03483eba53de530daf4d2dbd62a8985" name="aa03483eba53de530daf4d2dbd62a8985"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa03483eba53de530daf4d2dbd62a8985">&#9670;&#160;</a></span>SurfaceTension</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; openphase::FlowSolverLBM::SurfaceTension</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Surface tension (physical units) [kg/s^2]. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00240">240</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a9006e8f49762d851b52708b363ba14f2" name="a9006e8f49762d851b52708b363ba14f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9006e8f49762d851b52708b363ba14f2">&#9670;&#160;</a></span>thisclassname</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string openphase::OPObject::thisclassname</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Object's implementation class name. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d1c/OPObject_8h_source.html#l00054">54</a> of file <a class="el" href="../../d5/d1c/OPObject_8h_source.html">OPObject.h</a>.</p>

</div>
</div>
<a id="ac8c040bdc306f76b58d5a79201e5df66" name="ac8c040bdc306f76b58d5a79201e5df66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8c040bdc306f76b58d5a79201e5df66">&#9670;&#160;</a></span>thisobjectname</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string openphase::OPObject::thisobjectname</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Object's name. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d1c/OPObject_8h_source.html#l00055">55</a> of file <a class="el" href="../../d5/d1c/OPObject_8h_source.html">OPObject.h</a>.</p>

</div>
</div>
<a id="aad6241df3842eb309a60fd8d55888559" name="aad6241df3842eb309a60fd8d55888559"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad6241df3842eb309a60fd8d55888559">&#9670;&#160;</a></span>U0X</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::U0X</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inlet Velocity in x direction [m/s]. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00205">205</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a3d8f89a8680b20a5f22438db5dacbfc8" name="a3d8f89a8680b20a5f22438db5dacbfc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d8f89a8680b20a5f22438db5dacbfc8">&#9670;&#160;</a></span>U0Y</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::U0Y</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inlet Velocity in y direction [m/s]. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00206">206</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a85853583f9b71927e8de8fb66cb4fb09" name="a85853583f9b71927e8de8fb66cb4fb09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85853583f9b71927e8de8fb66cb4fb09">&#9670;&#160;</a></span>U0Z</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::FlowSolverLBM::U0Z</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inlet Velocity in z direction [m/s]. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00207">207</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a6720e11af1b05213fbba7af7e7047848" name="a6720e11af1b05213fbba7af7e7047848"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6720e11af1b05213fbba7af7e7047848">&#9670;&#160;</a></span>VaporDensity</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; openphase::FlowSolverLBM::VaporDensity</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Equilibrium density of the solid phase. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00248">248</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<a id="a733d0ed28089ce96e664da9b2508c692" name="a733d0ed28089ce96e664da9b2508c692"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a733d0ed28089ce96e664da9b2508c692">&#9670;&#160;</a></span>Wetting</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;double&gt; &gt; openphase::FlowSolverLBM::Wetting</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wetting Parameter [Kg/m^3]. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html#l00255">255</a> of file <a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../da/d41/FlowSolverLBM_8h_source.html">FlowSolverLBM.h</a></li>
<li><a class="el" href="../../d7/d72/FlowSolverLBM_8cpp_source.html">FlowSolverLBM.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Dec 17 2025 09:11:00 for OpenPhase by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
