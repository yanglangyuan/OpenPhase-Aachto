<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenPhase: openphase::PhaseField Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">OpenPhase
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d0/d6c/namespaceopenphase.html">openphase</a></li><li class="navelem"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../dd/d0b/classopenphase_1_1PhaseField-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">openphase::PhaseField Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>&lt; Phase field class. It stores the phase fields, performs basic operations on them.  
 <a href="../../d5/d16/classopenphase_1_1PhaseField.html#details">More...</a></p>

<p><code>#include &quot;<a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a>&quot;</code></p>
<div class="dynheader">
Inheritance diagram for openphase::PhaseField:</div>
<div class="dyncontent">
 <div class="center">
  <img src="../../d5/d16/classopenphase_1_1PhaseField.png" usemap="#openphase::PhaseField_map" alt=""/>
  <map id="openphase::PhaseField_map" name="openphase::PhaseField_map">
<area href="../../d6/dcd/classopenphase_1_1OPObject.html" alt="openphase::OPObject" shape="rect" coords="0,0,143,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a88f3cc02af2a27c2f56247ada4a419d1" id="r_a88f3cc02af2a27c2f56247ada4a419d1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a88f3cc02af2a27c2f56247ada4a419d1">PhaseField</a> ()</td></tr>
<tr class="separator:a88f3cc02af2a27c2f56247ada4a419d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aded29116e630debd960b4bd0a0d33f3d" id="r_aded29116e630debd960b4bd0a0d33f3d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#aded29116e630debd960b4bd0a0d33f3d">PhaseField</a> (<a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;locSettings, std::string InputFileName=<a class="el" href="../../d0/d6c/namespaceopenphase.html#a9e087efe4525895243a5c0d3a7fb07c6">DefaultInputFileName</a>)</td></tr>
<tr class="separator:aded29116e630debd960b4bd0a0d33f3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a657703c88fcc2adf92532ffc1955661a" id="r_a657703c88fcc2adf92532ffc1955661a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a657703c88fcc2adf92532ffc1955661a">Initialize</a> (<a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;locSettings, std::string ObjectNameSuffix=&quot;&quot;) override</td></tr>
<tr class="memdesc:a657703c88fcc2adf92532ffc1955661a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the storage and initial variables of the driving force class.  <br /></td></tr>
<tr class="separator:a657703c88fcc2adf92532ffc1955661a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a6511943316b1eebb1e5e345fc81588" id="r_a1a6511943316b1eebb1e5e345fc81588"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a1a6511943316b1eebb1e5e345fc81588">ReadInput</a> (const std::string InputFileName) override</td></tr>
<tr class="memdesc:a1a6511943316b1eebb1e5e345fc81588"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads input from the file.  <br /></td></tr>
<tr class="separator:a1a6511943316b1eebb1e5e345fc81588"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af41d0a9687ce39388b1551b66a2ffe84" id="r_af41d0a9687ce39388b1551b66a2ffe84"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#af41d0a9687ce39388b1551b66a2ffe84">ReadInput</a> (std::stringstream &amp;inp) override</td></tr>
<tr class="memdesc:af41d0a9687ce39388b1551b66a2ffe84"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads input from the stringstream.  <br /></td></tr>
<tr class="separator:af41d0a9687ce39388b1551b66a2ffe84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91e492bc34c35a88697432b6bda3bc95" id="r_a91e492bc34c35a88697432b6bda3bc95"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a91e492bc34c35a88697432b6bda3bc95">ReadJSON</a> (const std::string InputFileName)</td></tr>
<tr class="separator:a91e492bc34c35a88697432b6bda3bc95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa160891e608d26b6333bea5b1087b0bf" id="r_aa160891e608d26b6333bea5b1087b0bf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa160891e608d26b6333bea5b1087b0bf">AllocateStorages</a> (<a class="el" href="../../dc/d18/classopenphase_1_1GridParameters.html">GridParameters</a> &amp;<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>)</td></tr>
<tr class="memdesc:aa160891e608d26b6333bea5b1087b0bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates internal storages.  <br /></td></tr>
<tr class="separator:aa160891e608d26b6333bea5b1087b0bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f305e969f2b5970684ccf9f8752a669" id="r_a0f305e969f2b5970684ccf9f8752a669"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a0f305e969f2b5970684ccf9f8752a669">Remesh</a> (int newNx, int newNy, int newNz, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC) override</td></tr>
<tr class="memdesc:a0f305e969f2b5970684ccf9f8752a669"><td class="mdescLeft">&#160;</td><td class="mdescRight">Changes the mesh size while keeping the data.  <br /></td></tr>
<tr class="separator:a0f305e969f2b5970684ccf9f8752a669"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2503f8f70079ecf3f7899a1458acb6fc" id="r_a2503f8f70079ecf3f7899a1458acb6fc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a2503f8f70079ecf3f7899a1458acb6fc">Clear</a> (void)</td></tr>
<tr class="memdesc:a2503f8f70079ecf3f7899a1458acb6fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clears the phase field storage.  <br /></td></tr>
<tr class="separator:a2503f8f70079ecf3f7899a1458acb6fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a631209c7492c13b5575850ae2a809d5c" id="r_a631209c7492c13b5575850ae2a809d5c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a631209c7492c13b5575850ae2a809d5c">Refine</a> (void)</td></tr>
<tr class="memdesc:a631209c7492c13b5575850ae2a809d5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates double resolution phase-fields from the single resolution ones.  <br /></td></tr>
<tr class="separator:a631209c7492c13b5575850ae2a809d5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a500b45060139b7e51d305fb90c46e4" id="r_a3a500b45060139b7e51d305fb90c46e4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3a500b45060139b7e51d305fb90c46e4">CalculateReferenceVolume</a> (double radius)</td></tr>
<tr class="memdesc:a3a500b45060139b7e51d305fb90c46e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates reference volume (RefVolume) for nucleation.  <br /></td></tr>
<tr class="separator:a3a500b45060139b7e51d305fb90c46e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc7cec18fec3213263fc9703303d7842" id="r_acc7cec18fec3213263fc9703303d7842"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#acc7cec18fec3213263fc9703303d7842">AddGrainInfo</a> (size_t PhaseIndex)</td></tr>
<tr class="memdesc:acc7cec18fec3213263fc9703303d7842"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds new grain information for a phase "PhaseIndex", returns resulting phase field index.  <br /></td></tr>
<tr class="separator:acc7cec18fec3213263fc9703303d7842"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39bca279acb9052993508886a5fe3ca1" id="r_a39bca279acb9052993508886a5fe3ca1"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a39bca279acb9052993508886a5fe3ca1">PlantGrainNucleus</a> (size_t PhaseIndex, int x, int y, int z)</td></tr>
<tr class="memdesc:a39bca279acb9052993508886a5fe3ca1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Plants grain nucleus at position (x,y,z) of a phase "PhaseIndex", returns resulting phase field index.  <br /></td></tr>
<tr class="separator:a39bca279acb9052993508886a5fe3ca1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8490e436f96b55e460658686ef4c203" id="r_ab8490e436f96b55e460658686ef4c203"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#ab8490e436f96b55e460658686ef4c203">Normal</a> (<a class="el" href="../../da/ddf/classopenphase_1_1NodePF.html#ab9d86bf0658a44de5aff74d71bd46363">NodePF::citerator</a> alpha, <a class="el" href="../../da/ddf/classopenphase_1_1NodePF.html#ab9d86bf0658a44de5aff74d71bd46363">NodePF::citerator</a> beta) const</td></tr>
<tr class="memdesc:ab8490e436f96b55e460658686ef4c203"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns interface normal for a given pair of phase fields at a given position in double resolution.  <br /></td></tr>
<tr class="separator:ab8490e436f96b55e460658686ef4c203"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94f58f14335a53fbe1d61f4486004534" id="r_a94f58f14335a53fbe1d61f4486004534"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d3/dc0/classopenphase_1_1NodeAB.html">NodeAB</a>&lt; <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a>, <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a94f58f14335a53fbe1d61f4486004534">Normals</a> (const int i, const int j, const int k) const</td></tr>
<tr class="memdesc:a94f58f14335a53fbe1d61f4486004534"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns interface normals for all pairs of phase fields at a given position.  <br /></td></tr>
<tr class="separator:a94f58f14335a53fbe1d61f4486004534"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c9dc9f31745cc5aa910e0a4e4a76326" id="r_a7c9dc9f31745cc5aa910e0a4e4a76326"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d3/dc0/classopenphase_1_1NodeAB.html">NodeAB</a>&lt; <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a>, <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7c9dc9f31745cc5aa910e0a4e4a76326">NormalsDR</a> (const int i, const int j, const int k) const</td></tr>
<tr class="memdesc:a7c9dc9f31745cc5aa910e0a4e4a76326"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns interface normals for all pairs of phase fields at a given position in double resolution.  <br /></td></tr>
<tr class="separator:a7c9dc9f31745cc5aa910e0a4e4a76326"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d160e3ff1782e6f87f67a64193d7a30" id="r_a3d160e3ff1782e6f87f67a64193d7a30"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d8/d8b/classopenphase_1_1NodeA.html">NodeA</a>&lt; <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3d160e3ff1782e6f87f67a64193d7a30">NormalsPhase</a> (const int i, const int j, const int k) const</td></tr>
<tr class="memdesc:a3d160e3ff1782e6f87f67a64193d7a30"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns interface normals for all pairs of phase fields at a given position.  <br /></td></tr>
<tr class="separator:a3d160e3ff1782e6f87f67a64193d7a30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdd6a035437a9feef3b603ef694c3a55" id="r_acdd6a035437a9feef3b603ef694c3a55"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d8/d8b/classopenphase_1_1NodeA.html">NodeA</a>&lt; <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#acdd6a035437a9feef3b603ef694c3a55">NormalsPhaseDR</a> (const int i, const int j, const int k) const</td></tr>
<tr class="memdesc:acdd6a035437a9feef3b603ef694c3a55"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns interface normals for all pairs of phase fields at a given position.  <br /></td></tr>
<tr class="separator:acdd6a035437a9feef3b603ef694c3a55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb6a39a1c39844061f3858d21170f3c0" id="r_adb6a39a1c39844061f3858d21170f3c0"><td class="memTemplParams" colspan="2">template&lt;class T &gt; </td></tr>
<tr class="memitem:adb6a39a1c39844061f3858d21170f3c0"><td class="memTemplItemLeft" align="right" valign="top">double&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#adb6a39a1c39844061f3858d21170f3c0">LocalN</a> (const T &amp;locPF) const</td></tr>
<tr class="separator:adb6a39a1c39844061f3858d21170f3c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83a0ea555927327924b0b5eda16537f4" id="r_a83a0ea555927327924b0b5eda16537f4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a83a0ea555927327924b0b5eda16537f4">ClearGrainsForcesAndAccelerations</a> ()</td></tr>
<tr class="separator:a83a0ea555927327924b0b5eda16537f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a113417761f840a9748831c84aff8e692" id="r_a113417761f840a9748831c84aff8e692"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a113417761f840a9748831c84aff8e692">PhaseFieldPresent</a> (const int i, const int j, const int k, const size_t Index) const</td></tr>
<tr class="memdesc:a113417761f840a9748831c84aff8e692"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if phase field is present in a grid cell with coordinates (i,j,k)  <br /></td></tr>
<tr class="separator:a113417761f840a9748831c84aff8e692"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbd72fa57b91e462b8f4c84cbb84a860" id="r_abbd72fa57b91e462b8f4c84cbb84a860"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#abbd72fa57b91e462b8f4c84cbb84a860">ThermodynamicPhasePresent</a> (size_t alpha)</td></tr>
<tr class="separator:abbd72fa57b91e462b8f4c84cbb84a860"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6aade89dfd19d9728488fbac901e12f" id="r_ab6aade89dfd19d9728488fbac901e12f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#ab6aade89dfd19d9728488fbac901e12f">ThermodynamicPhasePairPresent</a> (size_t alpha, size_t beta)</td></tr>
<tr class="separator:ab6aade89dfd19d9728488fbac901e12f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accb74fb9f428cc7eeffc38a4aae626da" id="r_accb74fb9f428cc7eeffc38a4aae626da"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#accb74fb9f428cc7eeffc38a4aae626da">GetPresentPhaseFields</a> () const</td></tr>
<tr class="memdesc:accb74fb9f428cc7eeffc38a4aae626da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns an ordered list with indices of present phase fields.  <br /></td></tr>
<tr class="separator:accb74fb9f428cc7eeffc38a4aae626da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a639df9f867a4d9dcfe67cb2d64818412" id="r_a639df9f867a4d9dcfe67cb2d64818412"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a639df9f867a4d9dcfe67cb2d64818412">VicinityPhaseFields</a> (const int i, const int j, const int k) const</td></tr>
<tr class="memdesc:a639df9f867a4d9dcfe67cb2d64818412"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns list of phase fields at point (i,j,k) and neighboring nodes.  <br /></td></tr>
<tr class="separator:a639df9f867a4d9dcfe67cb2d64818412"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14459aef7e8f81944069f7aa68793864" id="r_a14459aef7e8f81944069f7aa68793864"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a14459aef7e8f81944069f7aa68793864">Advect</a> (<a class="el" href="../../dd/d95/classopenphase_1_1AdvectionHR.html">AdvectionHR</a> &amp;Adv, const <a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;Vel, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, const double dt, const double tStep, const bool finalize=true)</td></tr>
<tr class="memdesc:a14459aef7e8f81944069f7aa68793864"><td class="mdescLeft">&#160;</td><td class="mdescRight">Advects phase-field when no LB solver is used.  <br /></td></tr>
<tr class="separator:a14459aef7e8f81944069f7aa68793864"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c0a168e690f7cb617ef0fc21bacd4a8" id="r_a8c0a168e690f7cb617ef0fc21bacd4a8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a8c0a168e690f7cb617ef0fc21bacd4a8">AdvectALE</a> (<a class="el" href="../../dd/d95/classopenphase_1_1AdvectionHR.html">AdvectionHR</a> &amp;Adv, const <a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;Vel, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, const double dt, const double tStep, const bool finalize=true)</td></tr>
<tr class="memdesc:a8c0a168e690f7cb617ef0fc21bacd4a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Advects phase-field in the ALE scheme.  <br /></td></tr>
<tr class="separator:a8c0a168e690f7cb617ef0fc21bacd4a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c7aaf38cb25aec9c50089124d101961" id="r_a2c7aaf38cb25aec9c50089124d101961"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a2c7aaf38cb25aec9c50089124d101961">Advect</a> (<a class="el" href="../../dd/d95/classopenphase_1_1AdvectionHR.html">AdvectionHR</a> &amp;Adv, const <a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;Vel, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, <a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html">FlowSolverLBM</a> &amp;LBM, const double dt, const double tStep, const bool finalize=true)</td></tr>
<tr class="memdesc:a2c7aaf38cb25aec9c50089124d101961"><td class="mdescLeft">&#160;</td><td class="mdescRight">Advects phase-field when a LB solver is used.  <br /></td></tr>
<tr class="separator:a2c7aaf38cb25aec9c50089124d101961"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c5e8c77192dca99d865d6f01c7b72d8" id="r_a8c5e8c77192dca99d865d6f01c7b72d8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a8c5e8c77192dca99d865d6f01c7b72d8">EffectiveOrientation</a> (const int i, const int j, const int k) const</td></tr>
<tr class="memdesc:a8c5e8c77192dca99d865d6f01c7b72d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns averaged grain rotations, averaging is done via quaternions.  <br /></td></tr>
<tr class="separator:a8c5e8c77192dca99d865d6f01c7b72d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a825ae7162676d2a690c3e072d0a49581" id="r_a825ae7162676d2a690c3e072d0a49581"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a825ae7162676d2a690c3e072d0a49581">SetBoundaryConditions</a> (const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC) override</td></tr>
<tr class="memdesc:a825ae7162676d2a690c3e072d0a49581"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set boundary conditions.  <br /></td></tr>
<tr class="separator:a825ae7162676d2a690c3e072d0a49581"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8c994d103fffdf2f55db24ab6553cf1" id="r_af8c994d103fffdf2f55db24ab6553cf1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#af8c994d103fffdf2f55db24ab6553cf1">Finalize</a> (const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, const bool finalize=true)</td></tr>
<tr class="memdesc:af8c994d103fffdf2f55db24ab6553cf1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finalizing the phase fields calculations.  <br /></td></tr>
<tr class="separator:af8c994d103fffdf2f55db24ab6553cf1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1b22713f51e2761503ac0e16af0cb8b" id="r_ac1b22713f51e2761503ac0e16af0cb8b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#ac1b22713f51e2761503ac0e16af0cb8b">FinalizeInitialization</a> (const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="memdesc:ac1b22713f51e2761503ac0e16af0cb8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finalizing the phase fields after initialization.  <br /></td></tr>
<tr class="separator:ac1b22713f51e2761503ac0e16af0cb8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33dcb60f605e77f9e5b1489c903dff44" id="r_a33dcb60f605e77f9e5b1489c903dff44"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a33dcb60f605e77f9e5b1489c903dff44">FixSpreading</a> (const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, double cutoff)</td></tr>
<tr class="memdesc:a33dcb60f605e77f9e5b1489c903dff44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes phase-fields with values below the cutoff (used for reducing parasitic diffusion in advection)  <br /></td></tr>
<tr class="separator:a33dcb60f605e77f9e5b1489c903dff44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae696c115461770a961448e429988a1dc" id="r_ae696c115461770a961448e429988a1dc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#ae696c115461770a961448e429988a1dc">KeepPhaseFieldsVolume</a> (void)</td></tr>
<tr class="memdesc:ae696c115461770a961448e429988a1dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Keeps phase fields volume constant by allowing only grain shape change. Should be called before <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a8634488569676742857d5127adc23e20" title="Normalizes the interface fields such that resulting phase fields after merge do not escape interval [...">NormalizeIncrements()</a>  <br /></td></tr>
<tr class="separator:ae696c115461770a961448e429988a1dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8634488569676742857d5127adc23e20" id="r_a8634488569676742857d5127adc23e20"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a8634488569676742857d5127adc23e20">NormalizeIncrements</a> (const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, const double dt)</td></tr>
<tr class="memdesc:a8634488569676742857d5127adc23e20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Normalizes the interface fields such that resulting phase fields after merge do not escape interval [0,1] and sum up to 1.  <br /></td></tr>
<tr class="separator:a8634488569676742857d5127adc23e20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc8bd5f899b5a035ec29b8ac061a1a90" id="r_afc8bd5f899b5a035ec29b8ac061a1a90"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#afc8bd5f899b5a035ec29b8ac061a1a90">MergeIncrements</a> (const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, const double dt, const bool finalize=true, const bool clear=true)</td></tr>
<tr class="memdesc:afc8bd5f899b5a035ec29b8ac061a1a90"><td class="mdescLeft">&#160;</td><td class="mdescRight">Merges the increments into the phase fields.  <br /></td></tr>
<tr class="separator:afc8bd5f899b5a035ec29b8ac061a1a90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac075854614724322a8b23dfb874ea2f" id="r_aac075854614724322a8b23dfb874ea2f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#aac075854614724322a8b23dfb874ea2f">MoveFrame</a> (const int dx, const int dy, const int dz, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC) override</td></tr>
<tr class="memdesc:aac075854614724322a8b23dfb874ea2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shifts the data in the storage by dx, dy and dz (they should be 0, -1 or +1) in x, y and or z directions correspondingly.  <br /></td></tr>
<tr class="separator:aac075854614724322a8b23dfb874ea2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f61075c4b485f20b5e6887150c310c6" id="r_a1f61075c4b485f20b5e6887150c310c6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a1f61075c4b485f20b5e6887150c310c6">ConsumePlane</a> (const int dx, const int dy, const int dz, const int x, const int y, const int z, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="memdesc:a1f61075c4b485f20b5e6887150c310c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shifts the data in the storage by dx, dy and dz (they should be 0, -1 or +1) in the direction to/from (x, y, z) point.  <br /></td></tr>
<tr class="separator:a1f61075c4b485f20b5e6887150c310c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6484859b48f04ff0ec8d8bc8c53943d3" id="r_a6484859b48f04ff0ec8d8bc8c53943d3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d8/d8b/classopenphase_1_1NodeA.html">NodeA</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a6484859b48f04ff0ec8d8bc8c53943d3">Dot</a> (const int i, const int j, const int k, const double dt) const</td></tr>
<tr class="memdesc:a6484859b48f04ff0ec8d8bc8c53943d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the upcoming derivatives of Fields with respect to time including finalization! (NOTE: Dot = Dot1 + Dot2)  <br /></td></tr>
<tr class="separator:a6484859b48f04ff0ec8d8bc8c53943d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af77624912d453d5dcbc7466ec6250baf" id="r_af77624912d453d5dcbc7466ec6250baf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d8/d8b/classopenphase_1_1NodeA.html">NodeA</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#af77624912d453d5dcbc7466ec6250baf">Dot1</a> (const int i, const int j, const int k, const double dt) const</td></tr>
<tr class="memdesc:af77624912d453d5dcbc7466ec6250baf"><td class="mdescLeft">&#160;</td><td class="mdescRight">(used for semi-implicit solver Grand Potential solver!)  <br /></td></tr>
<tr class="separator:af77624912d453d5dcbc7466ec6250baf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75b9fbb10df069d24ad28d5c27db4eaa" id="r_a75b9fbb10df069d24ad28d5c27db4eaa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d8/d8b/classopenphase_1_1NodeA.html">NodeA</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a75b9fbb10df069d24ad28d5c27db4eaa">Dot2</a> (const int i, const int j, const int k, const double dt) const</td></tr>
<tr class="memdesc:a75b9fbb10df069d24ad28d5c27db4eaa"><td class="mdescLeft">&#160;</td><td class="mdescRight">(used for semi-implicit solver Grand Potential solver!)  <br /></td></tr>
<tr class="separator:a75b9fbb10df069d24ad28d5c27db4eaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75bb00cffe9873812da4a2554e80ec20" id="r_a75bb00cffe9873812da4a2554e80ec20"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; double, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a75bb00cffe9873812da4a2554e80ec20">NewFractions</a> (double dt)</td></tr>
<tr class="memdesc:a75bb00cffe9873812da4a2554e80ec20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Phase fractions at next time step.  <br /></td></tr>
<tr class="separator:a75bb00cffe9873812da4a2554e80ec20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af493fd0af6996f16f26a78732d3c3f04" id="r_af493fd0af6996f16f26a78732d3c3f04"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d2/d51/classopenphase_1_1Tensor.html">Tensor</a>&lt; double, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#af493fd0af6996f16f26a78732d3c3f04">CalculateNewFractions</a> (<a class="el" href="../../d2/d51/classopenphase_1_1Tensor.html">Tensor</a>&lt; double, 1 &gt; oldFractions, <a class="el" href="../../d3/dc0/classopenphase_1_1NodeAB.html">NodeAB</a>&lt; double, double &gt; &amp;<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>, double locdt)</td></tr>
<tr class="memdesc:af493fd0af6996f16f26a78732d3c3f04"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates new thermodynamic phase fractions as if Phi.MergeIncrements would have been applied.  <br /></td></tr>
<tr class="separator:af493fd0af6996f16f26a78732d3c3f04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e5b8a08920660a502ce1ce80bf8372c" id="r_a9e5b8a08920660a502ce1ce80bf8372c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d2/d51/classopenphase_1_1Tensor.html">Tensor</a>&lt; double, 2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a9e5b8a08920660a502ce1ce80bf8372c">CalculatePsi</a> (<a class="el" href="../../d3/dc0/classopenphase_1_1NodeAB.html">NodeAB</a>&lt; double, double &gt; &amp;<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>, double locdt)</td></tr>
<tr class="memdesc:a9e5b8a08920660a502ce1ce80bf8372c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates Phi.FieldsDot for thermodynamic phases.  <br /></td></tr>
<tr class="separator:a9e5b8a08920660a502ce1ce80bf8372c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aded773d18aecc0080ceee7e3daddbef5" id="r_aded773d18aecc0080ceee7e3daddbef5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d2/d51/classopenphase_1_1Tensor.html">Tensor</a>&lt; double, 2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#aded773d18aecc0080ceee7e3daddbef5">FractionsPsi</a> (const int x, const int y, const int z, double locdt) const</td></tr>
<tr class="memdesc:aded773d18aecc0080ceee7e3daddbef5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates Phi.FieldsDot for thermodynamic phases.  <br /></td></tr>
<tr class="separator:aded773d18aecc0080ceee7e3daddbef5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83abda8ee8c2ac7c1252db160ea767da" id="r_a83abda8ee8c2ac7c1252db160ea767da"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d2/d51/classopenphase_1_1Tensor.html">Tensor</a>&lt; double, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a83abda8ee8c2ac7c1252db160ea767da">NewFractions</a> (const int x, const int y, const int z, double locdt) const</td></tr>
<tr class="memdesc:a83abda8ee8c2ac7c1252db160ea767da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates new thermodynamic phase fractions as if Phi.MergeIncrements would have been applied.  <br /></td></tr>
<tr class="separator:a83abda8ee8c2ac7c1252db160ea767da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a318deca1c64d3fd7dc3106f71c734ef7" id="r_a318deca1c64d3fd7dc3106f71c734ef7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a318deca1c64d3fd7dc3106f71c734ef7">SolidPhaseFraction</a> (const int i, const int j, const int k) const</td></tr>
<tr class="memdesc:a318deca1c64d3fd7dc3106f71c734ef7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns local solid phase fraction.  <br /></td></tr>
<tr class="separator:a318deca1c64d3fd7dc3106f71c734ef7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a007421c86ce87f496fa4658e62d1f777" id="r_a007421c86ce87f496fa4658e62d1f777"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a007421c86ce87f496fa4658e62d1f777">SolidMassDensity</a> (const int i, const int j, const int k) const</td></tr>
<tr class="memdesc:a007421c86ce87f496fa4658e62d1f777"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns local solid mass density.  <br /></td></tr>
<tr class="separator:a007421c86ce87f496fa4658e62d1f777"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a815c29d3999f1fe26ed62b27bff4c019" id="r_a815c29d3999f1fe26ed62b27bff4c019"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a815c29d3999f1fe26ed62b27bff4c019">CalculateSolidMass</a> (void) const</td></tr>
<tr class="memdesc:a815c29d3999f1fe26ed62b27bff4c019"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates and returns SolidMass.  <br /></td></tr>
<tr class="separator:a815c29d3999f1fe26ed62b27bff4c019"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace9fa222a53d1b1328d682e947267d4e" id="r_ace9fa222a53d1b1328d682e947267d4e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#ace9fa222a53d1b1328d682e947267d4e">SelectiveCombinePhaseFields</a> (const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, const size_t TargetPFIndex, const size_t SourcePFIndex)</td></tr>
<tr class="separator:ace9fa222a53d1b1328d682e947267d4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d70acca43b1fd05174f9c24893f2172" id="r_a1d70acca43b1fd05174f9c24893f2172"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a1d70acca43b1fd05174f9c24893f2172">GetMaxPhaseFieldOverlap</a> (const size_t thPhase1, const size_t thPhase2)</td></tr>
<tr class="separator:a1d70acca43b1fd05174f9c24893f2172"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c4019fa7a39d6ad521011483e222e9b" id="r_a2c4019fa7a39d6ad521011483e222e9b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d1/d51/classopenphase_1_1Matrix.html">Matrix</a>&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a2c4019fa7a39d6ad521011483e222e9b">GetPhaseFieldOverlap</a> (const size_t thPhase1, const size_t thPhase2)</td></tr>
<tr class="separator:a2c4019fa7a39d6ad521011483e222e9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6359a182e5f0bd698966129a427320ce" id="r_a6359a182e5f0bd698966129a427320ce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a6359a182e5f0bd698966129a427320ce">PrintPFVolumes</a> () const</td></tr>
<tr class="memdesc:a6359a182e5f0bd698966129a427320ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints volume of all phase fields.  <br /></td></tr>
<tr class="separator:a6359a182e5f0bd698966129a427320ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae711f820ad536a4f25a9c100dbab990f" id="r_ae711f820ad536a4f25a9c100dbab990f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#ae711f820ad536a4f25a9c100dbab990f">PrintPointStatistics</a> (const int x, const int y, const int z) const</td></tr>
<tr class="memdesc:ae711f820ad536a4f25a9c100dbab990f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints the locally present phase fields and their values to the screen.  <br /></td></tr>
<tr class="separator:ae711f820ad536a4f25a9c100dbab990f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a371e195bf6d984bc64f6492956de914b" id="r_a371e195bf6d984bc64f6492956de914b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a371e195bf6d984bc64f6492956de914b">PrintVolumeFractions</a> (void)</td></tr>
<tr class="memdesc:a371e195bf6d984bc64f6492956de914b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints volume fraction of all thermodynamic phases.  <br /></td></tr>
<tr class="separator:a371e195bf6d984bc64f6492956de914b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad31260709ab209458255a5f4d8541c3d" id="r_ad31260709ab209458255a5f4d8541c3d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#ad31260709ab209458255a5f4d8541c3d">WriteVolumePercentages</a> (const std::string &amp;filename, double time, char separator=',') const</td></tr>
<tr class="memdesc:ad31260709ab209458255a5f4d8541c3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes volume fraction of all thermodynamic phases to the file FileName.  <br /></td></tr>
<tr class="separator:ad31260709ab209458255a5f4d8541c3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add08e9ecc28c84cbaa472a8945674881" id="r_add08e9ecc28c84cbaa472a8945674881"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#add08e9ecc28c84cbaa472a8945674881">WriteGrainsVolume</a> (int time_step, double time, std::string filename)</td></tr>
<tr class="memdesc:add08e9ecc28c84cbaa472a8945674881"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes grains' volume in grid cells over time into a file.  <br /></td></tr>
<tr class="separator:add08e9ecc28c84cbaa472a8945674881"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e62b1271b2e4238f55d5aaaae201fcf" id="r_a9e62b1271b2e4238f55d5aaaae201fcf"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a9e62b1271b2e4238f55d5aaaae201fcf">Read</a> (std::string FileName)</td></tr>
<tr class="memdesc:a9e62b1271b2e4238f55d5aaaae201fcf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read raw (binary) phase fields from the file named FileName.  <br /></td></tr>
<tr class="separator:a9e62b1271b2e4238f55d5aaaae201fcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2130b8b55885da8bfe082c1ec1021b0" id="r_aa2130b8b55885da8bfe082c1ec1021b0"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2130b8b55885da8bfe082c1ec1021b0">Read</a> (const <a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;locSettings, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, const int tStep) override</td></tr>
<tr class="memdesc:aa2130b8b55885da8bfe082c1ec1021b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read raw (binary) phase fields from the file of specific time step.  <br /></td></tr>
<tr class="separator:aa2130b8b55885da8bfe082c1ec1021b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac883490c74b78489443cc705013c5214" id="r_ac883490c74b78489443cc705013c5214"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#ac883490c74b78489443cc705013c5214">ReadH5</a> (const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, <a class="el" href="../../dc/d89/classopenphase_1_1H5Interface.html">H5Interface</a> &amp;H5, const int tStep)</td></tr>
<tr class="memdesc:ac883490c74b78489443cc705013c5214"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read raw data from HDF5 file.  <br /></td></tr>
<tr class="separator:ac883490c74b78489443cc705013c5214"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd0125f9c7d2afc5e47b2769ae5edab6" id="r_afd0125f9c7d2afc5e47b2769ae5edab6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#afd0125f9c7d2afc5e47b2769ae5edab6">WriteMPI</a> (const std::string &amp;Path)</td></tr>
<tr class="separator:afd0125f9c7d2afc5e47b2769ae5edab6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a801c176e912c98819700f99ab35de04f" id="r_a801c176e912c98819700f99ab35de04f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a801c176e912c98819700f99ab35de04f">Write</a> (const std::string &amp;FileName) const</td></tr>
<tr class="memdesc:a801c176e912c98819700f99ab35de04f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write raw (binary) phase fields to the file FileName.  <br /></td></tr>
<tr class="separator:a801c176e912c98819700f99ab35de04f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a939d4b51c2e44fc256f73da1f592d60d" id="r_a939d4b51c2e44fc256f73da1f592d60d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a939d4b51c2e44fc256f73da1f592d60d">Write</a> (const <a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;locSettings, const int tStep) const override</td></tr>
<tr class="memdesc:a939d4b51c2e44fc256f73da1f592d60d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write raw (binary) phase fields to the file PhaseField_tStep.dat.  <br /></td></tr>
<tr class="separator:a939d4b51c2e44fc256f73da1f592d60d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05832d56292f980e7a9c7e60205d49e9" id="r_a05832d56292f980e7a9c7e60205d49e9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a05832d56292f980e7a9c7e60205d49e9">WriteH5</a> (<a class="el" href="../../dc/d89/classopenphase_1_1H5Interface.html">H5Interface</a> &amp;H5, const int tStep)</td></tr>
<tr class="memdesc:a05832d56292f980e7a9c7e60205d49e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes output in HDF5 format.  <br /></td></tr>
<tr class="separator:a05832d56292f980e7a9c7e60205d49e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e850926eb486edcdd55f67a93a418c7" id="r_a0e850926eb486edcdd55f67a93a418c7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a0e850926eb486edcdd55f67a93a418c7">WriteAverageVolume</a> (const int tStep, const size_t PhaseIndex) const</td></tr>
<tr class="memdesc:a0e850926eb486edcdd55f67a93a418c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes to the file the average volume of a given phase.  <br /></td></tr>
<tr class="separator:a0e850926eb486edcdd55f67a93a418c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1eea42255f8d7efcafe303a0198ab09" id="r_ad1eea42255f8d7efcafe303a0198ab09"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#ad1eea42255f8d7efcafe303a0198ab09">WriteVTK</a> (<a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;locSettings, const int tStep, const bool CurvatureOutput=false, const int precision=16) const</td></tr>
<tr class="memdesc:ad1eea42255f8d7efcafe303a0198ab09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes phase fields to the file in <a class="el" href="../../d3/d89/structopenphase_1_1VTK.html" title="&lt; static class to write VTK data in xml format">VTK</a> format.  <br /></td></tr>
<tr class="separator:ad1eea42255f8d7efcafe303a0198ab09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a398163fb479fea1925abdcc543f2edaa" id="r_a398163fb479fea1925abdcc543f2edaa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a398163fb479fea1925abdcc543f2edaa">WriteDistortedVTK</a> (<a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;locSettings, const <a class="el" href="../../d2/de8/classopenphase_1_1ElasticProperties.html">ElasticProperties</a> &amp;EP, const int tStep, const bool CurvatureOutput=false, const int precision=16) const</td></tr>
<tr class="memdesc:a398163fb479fea1925abdcc543f2edaa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes phase fields on distorted grid to the file in <a class="el" href="../../d3/d89/structopenphase_1_1VTK.html" title="&lt; static class to write VTK data in xml format">VTK</a> format in MPI environment.  <br /></td></tr>
<tr class="separator:a398163fb479fea1925abdcc543f2edaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c0985f8597ce55d39eb1565a6f5ee21" id="r_a7c0985f8597ce55d39eb1565a6f5ee21"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7c0985f8597ce55d39eb1565a6f5ee21">WriteIndividualPhaseFieldValuesVTK</a> (<a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;locSettings, const int tStep, const std::initializer_list&lt; size_t &gt; FieldIndices, const int precision=16) const</td></tr>
<tr class="memdesc:a7c0985f8597ce55d39eb1565a6f5ee21"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes values of individual phase fields to file in <a class="el" href="../../d3/d89/structopenphase_1_1VTK.html" title="&lt; static class to write VTK data in xml format">VTK</a> format.  <br /></td></tr>
<tr class="separator:a7c0985f8597ce55d39eb1565a6f5ee21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9685e85c1d1e6c1e54fde08a4b53a865" id="r_a9685e85c1d1e6c1e54fde08a4b53a865"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a9685e85c1d1e6c1e54fde08a4b53a865">WriteLaplacianVTK</a> (<a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;locSettings, const int tStep, size_t PhiIndex, const int precision=16)</td></tr>
<tr class="memdesc:a9685e85c1d1e6c1e54fde08a4b53a865"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes Laplacian of a given phase field to the file in <a class="el" href="../../d3/d89/structopenphase_1_1VTK.html" title="&lt; static class to write VTK data in xml format">VTK</a> format.  <br /></td></tr>
<tr class="separator:a9685e85c1d1e6c1e54fde08a4b53a865"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44d63a0e1824696eeffb1ef348d24b81" id="r_a44d63a0e1824696eeffb1ef348d24b81"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a44d63a0e1824696eeffb1ef348d24b81">operator=</a> (const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;rhs)</td></tr>
<tr class="memdesc:a44d63a0e1824696eeffb1ef348d24b81"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy operator for <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html" title="&lt; Phase field class. It stores the phase fields, performs basic operations on them.">PhaseField</a> class.  <br /></td></tr>
<tr class="separator:a44d63a0e1824696eeffb1ef348d24b81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7aaf1025baa44ad0a3308376d719da9" id="r_ac7aaf1025baa44ad0a3308376d719da9"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#ac7aaf1025baa44ad0a3308376d719da9">CurvaturePhase</a> (const int i, const int j, const int k, const size_t Index) const</td></tr>
<tr class="memdesc:ac7aaf1025baa44ad0a3308376d719da9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Curvature for each thermodynamic phase <a class="el" href="../../d3/d89/structopenphase_1_1VTK.html" title="&lt; static class to write VTK data in xml format">VTK</a> output.  <br /></td></tr>
<tr class="separator:ac7aaf1025baa44ad0a3308376d719da9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe08f3c4509a459e08932ed2c17cf21c" id="r_afe08f3c4509a459e08932ed2c17cf21c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#afe08f3c4509a459e08932ed2c17cf21c">CurvaturePhaseDR</a> (const int i, const int j, const int k, const size_t Index) const</td></tr>
<tr class="memdesc:afe08f3c4509a459e08932ed2c17cf21c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Curvature for each thermodynamic phase <a class="el" href="../../d3/d89/structopenphase_1_1VTK.html" title="&lt; static class to write VTK data in xml format">VTK</a> output.  <br /></td></tr>
<tr class="separator:afe08f3c4509a459e08932ed2c17cf21c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af250fd36715996014455d03cf2054239" id="r_af250fd36715996014455d03cf2054239"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#af250fd36715996014455d03cf2054239">Interfaces</a> (const int i, const int j, const int k) const</td></tr>
<tr class="memdesc:af250fd36715996014455d03cf2054239"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicates interfaces for <a class="el" href="../../d3/d89/structopenphase_1_1VTK.html" title="&lt; static class to write VTK data in xml format">VTK</a> output.  <br /></td></tr>
<tr class="separator:af250fd36715996014455d03cf2054239"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a486fdf527759c74e5a2cad6d183f3dff" id="r_a486fdf527759c74e5a2cad6d183f3dff"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a486fdf527759c74e5a2cad6d183f3dff">InterfacesDR</a> (const int i, const int j, const int k) const</td></tr>
<tr class="memdesc:a486fdf527759c74e5a2cad6d183f3dff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicates interfaces for <a class="el" href="../../d3/d89/structopenphase_1_1VTK.html" title="&lt; static class to write VTK data in xml format">VTK</a> output in double resolution.  <br /></td></tr>
<tr class="separator:a486fdf527759c74e5a2cad6d183f3dff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab1a7fa2e3620073ed7d35d341e53090" id="r_aab1a7fa2e3620073ed7d35d341e53090"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#aab1a7fa2e3620073ed7d35d341e53090">Variants</a> (const int i, const int j, const int k) const</td></tr>
<tr class="memdesc:aab1a7fa2e3620073ed7d35d341e53090"><td class="mdescLeft">&#160;</td><td class="mdescRight">Variants for <a class="el" href="../../d3/d89/structopenphase_1_1VTK.html" title="&lt; static class to write VTK data in xml format">VTK</a> output.  <br /></td></tr>
<tr class="separator:aab1a7fa2e3620073ed7d35d341e53090"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55d4d59b9f62750671aa6ba743e0afde" id="r_a55d4d59b9f62750671aa6ba743e0afde"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a55d4d59b9f62750671aa6ba743e0afde">VariantsDR</a> (const int i, const int j, const int k) const</td></tr>
<tr class="memdesc:a55d4d59b9f62750671aa6ba743e0afde"><td class="mdescLeft">&#160;</td><td class="mdescRight">Variants for <a class="el" href="../../d3/d89/structopenphase_1_1VTK.html" title="&lt; static class to write VTK data in xml format">VTK</a> output in double resolution.  <br /></td></tr>
<tr class="separator:a55d4d59b9f62750671aa6ba743e0afde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef4cc644c0c70be7ff72707535cd0d52" id="r_aef4cc644c0c70be7ff72707535cd0d52"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#aef4cc644c0c70be7ff72707535cd0d52">ParentGrain</a> (const int i, const int j, const int k) const</td></tr>
<tr class="memdesc:aef4cc644c0c70be7ff72707535cd0d52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parent grain index for <a class="el" href="../../d3/d89/structopenphase_1_1VTK.html" title="&lt; static class to write VTK data in xml format">VTK</a> output.  <br /></td></tr>
<tr class="separator:aef4cc644c0c70be7ff72707535cd0d52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d16abfb203f146a81ff92a2d3a68cfb" id="r_a0d16abfb203f146a81ff92a2d3a68cfb"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a0d16abfb203f146a81ff92a2d3a68cfb">ParentGrainDR</a> (const int i, const int j, const int k) const</td></tr>
<tr class="memdesc:a0d16abfb203f146a81ff92a2d3a68cfb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parent grain index for <a class="el" href="../../d3/d89/structopenphase_1_1VTK.html" title="&lt; static class to write VTK data in xml format">VTK</a> output in double resolution.  <br /></td></tr>
<tr class="separator:a0d16abfb203f146a81ff92a2d3a68cfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41426a7a8ececf8e6ecb7724e13bd793" id="r_a41426a7a8ececf8e6ecb7724e13bd793"><td class="memItemLeft" align="right" valign="top">std::array&lt; double, 2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a41426a7a8ececf8e6ecb7724e13bd793">PrincipalCurvatures</a> (const int i, const int j, const int k, const size_t phase) const</td></tr>
<tr class="memdesc:a41426a7a8ececf8e6ecb7724e13bd793"><td class="mdescLeft">&#160;</td><td class="mdescRight">Principle Curvatures for plotting <a class="el" href="../../d3/d89/structopenphase_1_1VTK.html" title="&lt; static class to write VTK data in xml format">VTK</a>.  <br /></td></tr>
<tr class="separator:a41426a7a8ececf8e6ecb7724e13bd793"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1eb4ab9b20c8618ab7db82fee65d03a" id="r_ad1eb4ab9b20c8618ab7db82fee65d03a"><td class="memItemLeft" align="right" valign="top">std::pair&lt; <a class="el" href="../../d8/d8b/classopenphase_1_1NodeA.html">NodeA</a>&lt; double &gt;, <a class="el" href="../../d8/d8b/classopenphase_1_1NodeA.html">NodeA</a>&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#ad1eb4ab9b20c8618ab7db82fee65d03a">PrincipalCurvatures</a> (const int i, const int j, const int k) const</td></tr>
<tr class="memdesc:ad1eb4ab9b20c8618ab7db82fee65d03a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns principal curvatures of all phase fields at a given position.  <br /></td></tr>
<tr class="separator:ad1eb4ab9b20c8618ab7db82fee65d03a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:af6910712da7e1d8d4df869a36cc41fb1" id="r_af6910712da7e1d8d4df869a36cc41fb1"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html">OPObject</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#af6910712da7e1d8d4df869a36cc41fb1">FindObject</a> (std::vector&lt; <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html">OPObject</a> * &gt; ObjectList, std::string ObjectName, std::string <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, std::string thisfunctionname, bool necessary, bool verbose=true)</td></tr>
<tr class="separator:af6910712da7e1d8d4df869a36cc41fb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa710a4052d686aac0b3f38a9a615682e" id="r_aa710a4052d686aac0b3f38a9a615682e"><td class="memItemLeft" align="right" valign="top">static std::vector&lt; <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html">OPObject</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#aa710a4052d686aac0b3f38a9a615682e">FindObjects</a> (std::vector&lt; <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html">OPObject</a> * &gt; ObjectList, std::string ObjectName, std::string <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, std::string thisfunctionname, bool necessary, bool verbose=true)</td></tr>
<tr class="separator:aa710a4052d686aac0b3f38a9a615682e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a7514a5f0d25deb090526b0a71ca95132" id="r_a7514a5f0d25deb090526b0a71ca95132"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d18/classopenphase_1_1GridParameters.html">GridParameters</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a></td></tr>
<tr class="memdesc:a7514a5f0d25deb090526b0a71ca95132"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simulation grid parameters.  <br /></td></tr>
<tr class="separator:a7514a5f0d25deb090526b0a71ca95132"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaeea2220078792baa302dc4300807029" id="r_aaeea2220078792baa302dc4300807029"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a></td></tr>
<tr class="memdesc:aaeea2220078792baa302dc4300807029"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of thermodynamic phases.  <br /></td></tr>
<tr class="separator:aaeea2220078792baa302dc4300807029"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f76b712f5418522f474928d17f453ef" id="r_a2f76b712f5418522f474928d17f453ef"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a2f76b712f5418522f474928d17f453ef">NucleusVolumeFactor</a></td></tr>
<tr class="memdesc:a2f76b712f5418522f474928d17f453ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Scales the critical nucleus volume.  <br /></td></tr>
<tr class="separator:a2f76b712f5418522f474928d17f453ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acff69bbd27278034e9ecce362211ff29" id="r_acff69bbd27278034e9ecce362211ff29"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d6c/namespaceopenphase.html#a5148c5d7019baf33d0a115bcb065772c">InterfaceNormalModels</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#acff69bbd27278034e9ecce362211ff29">InterfaceNormalModel</a></td></tr>
<tr class="memdesc:acff69bbd27278034e9ecce362211ff29"><td class="mdescLeft">&#160;</td><td class="mdescRight">Model selector for the interface normal calculation.  <br /></td></tr>
<tr class="separator:acff69bbd27278034e9ecce362211ff29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65cf354fce580b8677302a60babdc3b2" id="r_a65cf354fce580b8677302a60babdc3b2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d6c/namespaceopenphase.html#aa3d45caada142bcd6850f4ba4aebc678">LaplacianStencils</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a65cf354fce580b8677302a60babdc3b2">PhaseFieldLaplacianStencil</a></td></tr>
<tr class="memdesc:a65cf354fce580b8677302a60babdc3b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Phase-field Laplacian stencil selector.  <br /></td></tr>
<tr class="separator:a65cf354fce580b8677302a60babdc3b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d205eece17c945a4b51869b49184e1a" id="r_a6d205eece17c945a4b51869b49184e1a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d6c/namespaceopenphase.html#a210cb929dad1ae2aed26a10365a10b3d">GradientStencils</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a6d205eece17c945a4b51869b49184e1a">PhaseFieldGradientStencil</a></td></tr>
<tr class="memdesc:a6d205eece17c945a4b51869b49184e1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Phase-field gradient stencil selector.  <br /></td></tr>
<tr class="separator:a6d205eece17c945a4b51869b49184e1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3390ad72b1d99545de2cb145cdc35118" id="r_a3390ad72b1d99545de2cb145cdc35118"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d3/dc0/classopenphase_1_1NodeAB.html">NodeAB</a>&lt; double, double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3390ad72b1d99545de2cb145cdc35118">PairwiseGrowthFactors</a></td></tr>
<tr class="memdesc:a3390ad72b1d99545de2cb145cdc35118"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pairwise growth reduction factors to deal with stoichiometric and other constraints.  <br /></td></tr>
<tr class="separator:a3390ad72b1d99545de2cb145cdc35118"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00842a7df5798d0d7e5c677949ec5600" id="r_a00842a7df5798d0d7e5c677949ec5600"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a00842a7df5798d0d7e5c677949ec5600">PhaseNames</a></td></tr>
<tr class="memdesc:a00842a7df5798d0d7e5c677949ec5600"><td class="mdescLeft">&#160;</td><td class="mdescRight">Names of phases for subset selection.  <br /></td></tr>
<tr class="separator:a00842a7df5798d0d7e5c677949ec5600"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18545778a21115cf2146d08dc86e2de4" id="r_a18545778a21115cf2146d08dc86e2de4"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="../../d0/d6c/namespaceopenphase.html#a545a7e1c8dca42c00f8f139a1913c61c">AggregateStates</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a18545778a21115cf2146d08dc86e2de4">PhaseAggregateStates</a></td></tr>
<tr class="memdesc:a18545778a21115cf2146d08dc86e2de4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Aggregate states of all phases.  <br /></td></tr>
<tr class="separator:a18545778a21115cf2146d08dc86e2de4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c76a1996bda299c8471a126fb4f1f38" id="r_a0c76a1996bda299c8471a126fb4f1f38"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a0c76a1996bda299c8471a126fb4f1f38">PhaseEquilibriumDensities</a></td></tr>
<tr class="memdesc:a0c76a1996bda299c8471a126fb4f1f38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Equilibrium densities for all phases.  <br /></td></tr>
<tr class="separator:a0c76a1996bda299c8471a126fb4f1f38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f11e6f1f190ef9bb7e6c6013ec03101" id="r_a7f11e6f1f190ef9bb7e6c6013ec03101"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7f11e6f1f190ef9bb7e6c6013ec03101">FractionsTotal</a></td></tr>
<tr class="memdesc:a7f11e6f1f190ef9bb7e6c6013ec03101"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total phase fractions in the entire simulation domain.  <br /></td></tr>
<tr class="separator:a7f11e6f1f190ef9bb7e6c6013ec03101"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80736ea4892c99f7a189d1138252be4b" id="r_a80736ea4892c99f7a189d1138252be4b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a80736ea4892c99f7a189d1138252be4b">NucleationPresent</a></td></tr>
<tr class="memdesc:a80736ea4892c99f7a189d1138252be4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if there are nuclei of any phase, false otherwise.  <br /></td></tr>
<tr class="separator:a80736ea4892c99f7a189d1138252be4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae9497091c72d48f9c660f24a4b4749b" id="r_aae9497091c72d48f9c660f24a4b4749b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#aae9497091c72d48f9c660f24a4b4749b">ConsiderNucleusVolume</a></td></tr>
<tr class="separator:aae9497091c72d48f9c660f24a4b4749b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4099b0db42d5fcbf908eafe2a338032e" id="r_a4099b0db42d5fcbf908eafe2a338032e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d8/d86/classopenphase_1_1LaplacianStencil.html">LaplacianStencil</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a4099b0db42d5fcbf908eafe2a338032e">LStencil</a></td></tr>
<tr class="memdesc:a4099b0db42d5fcbf908eafe2a338032e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Laplacian stencil. Uses user specified stencil as the basis.  <br /></td></tr>
<tr class="separator:a4099b0db42d5fcbf908eafe2a338032e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f560b94dd8685e5f84363d403c5d495" id="r_a1f560b94dd8685e5f84363d403c5d495"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/da4/classopenphase_1_1GradientStencil.html">GradientStencil</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a1f560b94dd8685e5f84363d403c5d495">GStencil</a></td></tr>
<tr class="memdesc:a1f560b94dd8685e5f84363d403c5d495"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gradient stencil. Uses user specified stencil as the basis.  <br /></td></tr>
<tr class="separator:a1f560b94dd8685e5f84363d403c5d495"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2c57b6e85a5364094952fd5257be9c5" id="r_aa2c57b6e85a5364094952fd5257be9c5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/d90/classopenphase_1_1GrainsProperties.html">GrainsProperties</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a></td></tr>
<tr class="memdesc:aa2c57b6e85a5364094952fd5257be9c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Phase fields properties. Contains information about location, velocity, orientation, volume, aggregate state etc. of each phase field.  <br /></td></tr>
<tr class="separator:aa2c57b6e85a5364094952fd5257be9c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a784a4bea9a5379192bdf4f12ab12cf10" id="r_a784a4bea9a5379192bdf4f12ab12cf10"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; double, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a784a4bea9a5379192bdf4f12ab12cf10">Fractions</a></td></tr>
<tr class="memdesc:a784a4bea9a5379192bdf4f12ab12cf10"><td class="mdescLeft">&#160;</td><td class="mdescRight">Phase fractions storage.  <br /></td></tr>
<tr class="separator:a784a4bea9a5379192bdf4f12ab12cf10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebd94a373c8ff15a6ca2296c8db48e18" id="r_aebd94a373c8ff15a6ca2296c8db48e18"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; <a class="el" href="../../da/ddf/classopenphase_1_1NodePF.html">NodePF</a>, 0 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a></td></tr>
<tr class="memdesc:aebd94a373c8ff15a6ca2296c8db48e18"><td class="mdescLeft">&#160;</td><td class="mdescRight">Phase-field storage.  <br /></td></tr>
<tr class="separator:aebd94a373c8ff15a6ca2296c8db48e18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3562565ae829ac5ed575324eb92ce1e8" id="r_a3562565ae829ac5ed575324eb92ce1e8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; <a class="el" href="../../d3/dc0/classopenphase_1_1NodeAB.html">NodeAB</a>&lt; double, double &gt;, 0 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a></td></tr>
<tr class="memdesc:a3562565ae829ac5ed575324eb92ce1e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Phase-field increments storage.  <br /></td></tr>
<tr class="separator:a3562565ae829ac5ed575324eb92ce1e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd10af2caa601ce82e2150bdc4d395b9" id="r_abd10af2caa601ce82e2150bdc4d395b9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; <a class="el" href="../../d8/d8b/classopenphase_1_1NodeA.html">NodeA</a>&lt; double &gt;, 0 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#abd10af2caa601ce82e2150bdc4d395b9">FieldsAdvectionDot</a></td></tr>
<tr class="memdesc:abd10af2caa601ce82e2150bdc4d395b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Phase-field storage for advection increments.  <br /></td></tr>
<tr class="separator:abd10af2caa601ce82e2150bdc4d395b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae462950f95d4fc9a10834b300a721627" id="r_ae462950f95d4fc9a10834b300a721627"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; <a class="el" href="../../da/ddf/classopenphase_1_1NodePF.html">NodePF</a>, 0 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#ae462950f95d4fc9a10834b300a721627">FieldsAdvectionBackup</a></td></tr>
<tr class="memdesc:ae462950f95d4fc9a10834b300a721627"><td class="mdescLeft">&#160;</td><td class="mdescRight">Phase-field backup storage for advection.  <br /></td></tr>
<tr class="separator:ae462950f95d4fc9a10834b300a721627"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81113f3bf9c388a9ac8e31861902c40b" id="r_a81113f3bf9c388a9ac8e31861902c40b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; <a class="el" href="../../da/ddf/classopenphase_1_1NodePF.html">NodePF</a>, 0 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a></td></tr>
<tr class="memdesc:a81113f3bf9c388a9ac8e31861902c40b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Phase-field storage for double resolution mode.  <br /></td></tr>
<tr class="separator:a81113f3bf9c388a9ac8e31861902c40b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a751e2803a23026fbb7e4b0b2c7673391" id="r_a751e2803a23026fbb7e4b0b2c7673391"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; <a class="el" href="../../d3/dc0/classopenphase_1_1NodeAB.html">NodeAB</a>&lt; double, double &gt;, 0 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a></td></tr>
<tr class="memdesc:a751e2803a23026fbb7e4b0b2c7673391"><td class="mdescLeft">&#160;</td><td class="mdescRight">Phase-field increments storage for double resolution mode.  <br /></td></tr>
<tr class="separator:a751e2803a23026fbb7e4b0b2c7673391"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9006e8f49762d851b52708b363ba14f2" id="r_a9006e8f49762d851b52708b363ba14f2"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a></td></tr>
<tr class="memdesc:a9006e8f49762d851b52708b363ba14f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Object's implementation class name.  <br /></td></tr>
<tr class="separator:a9006e8f49762d851b52708b363ba14f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8c040bdc306f76b58d5a79201e5df66" id="r_ac8c040bdc306f76b58d5a79201e5df66"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#ac8c040bdc306f76b58d5a79201e5df66">thisobjectname</a></td></tr>
<tr class="memdesc:ac8c040bdc306f76b58d5a79201e5df66"><td class="mdescLeft">&#160;</td><td class="mdescRight">Object's name.  <br /></td></tr>
<tr class="separator:ac8c040bdc306f76b58d5a79201e5df66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa112048d179026f359161b1f20e5e98e" id="r_aa112048d179026f359161b1f20e5e98e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#aa112048d179026f359161b1f20e5e98e">initialized</a> = false</td></tr>
<tr class="memdesc:aa112048d179026f359161b1f20e5e98e"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if obect's Initialize has been executed.  <br /></td></tr>
<tr class="separator:aa112048d179026f359161b1f20e5e98e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65ef7d7ae73be8f9a7fa626762c4937d" id="r_a65ef7d7ae73be8f9a7fa626762c4937d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#a65ef7d7ae73be8f9a7fa626762c4937d">input_read</a> = false</td></tr>
<tr class="memdesc:a65ef7d7ae73be8f9a7fa626762c4937d"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if obect's <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9c766ff0ddd3866b7c2f2f83ebebcf31">ReadInput()</a> has been executed.  <br /></td></tr>
<tr class="separator:a65ef7d7ae73be8f9a7fa626762c4937d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44d40bc5a3ef87d7c461b457e01091dd" id="r_a44d40bc5a3ef87d7c461b457e01091dd"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#a44d40bc5a3ef87d7c461b457e01091dd">remeshable</a> = false</td></tr>
<tr class="memdesc:a44d40bc5a3ef87d7c461b457e01091dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if the object has non-empty <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#af421c7d819be4718f586fb3f97c34583">Remesh()</a> method.  <br /></td></tr>
<tr class="separator:a44d40bc5a3ef87d7c461b457e01091dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f54d22dc59afcace6359f599fabcaac" id="r_a7f54d22dc59afcace6359f599fabcaac"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#a7f54d22dc59afcace6359f599fabcaac">advectable</a> = false</td></tr>
<tr class="memdesc:a7f54d22dc59afcace6359f599fabcaac"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if the object has non-empty <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#afd82ead485f6d9695aa733729100614c">Advect()</a> method.  <br /></td></tr>
<tr class="separator:a7f54d22dc59afcace6359f599fabcaac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5b7ff7b56e2d266c2fd59b620a1603b" id="r_aa5b7ff7b56e2d266c2fd59b620a1603b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#aa5b7ff7b56e2d266c2fd59b620a1603b">readable</a> = false</td></tr>
<tr class="memdesc:aa5b7ff7b56e2d266c2fd59b620a1603b"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if the object has non-empty <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#adbd36cc2fee5c391f60f52ecd6114d2c">Read()</a> method.  <br /></td></tr>
<tr class="separator:aa5b7ff7b56e2d266c2fd59b620a1603b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49a9d1e352e5dafc93f493012d527ee1" id="r_a49a9d1e352e5dafc93f493012d527ee1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#a49a9d1e352e5dafc93f493012d527ee1">boundary_conditions</a> = false</td></tr>
<tr class="memdesc:a49a9d1e352e5dafc93f493012d527ee1"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if the object has non-empty <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#a098bf706cf87cf06361ec9bca1c7d32c">SetBoundaryConditions()</a>  <br /></td></tr>
<tr class="separator:a49a9d1e352e5dafc93f493012d527ee1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a5000dec22fe09492067409dacda3ca59" id="r_a5000dec22fe09492067409dacda3ca59"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a5000dec22fe09492067409dacda3ca59">SetStencils</a> (<a class="el" href="../../dc/d18/classopenphase_1_1GridParameters.html">GridParameters</a> &amp;<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>)</td></tr>
<tr class="memdesc:a5000dec22fe09492067409dacda3ca59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets gradient and Laplacian stencils.  <br /></td></tr>
<tr class="separator:a5000dec22fe09492067409dacda3ca59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5cc5b72dd043ea82b19b8fd59956e07" id="r_af5cc5b72dd043ea82b19b8fd59956e07"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#af5cc5b72dd043ea82b19b8fd59956e07">SetFlagsSR</a> ()</td></tr>
<tr class="memdesc:af5cc5b72dd043ea82b19b8fd59956e07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the flags which mark interfaces.  <br /></td></tr>
<tr class="separator:af5cc5b72dd043ea82b19b8fd59956e07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6351df75321c5be52c45de4df6b0d9b9" id="r_a6351df75321c5be52c45de4df6b0d9b9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a6351df75321c5be52c45de4df6b0d9b9">SetFlagsDR</a> ()</td></tr>
<tr class="memdesc:a6351df75321c5be52c45de4df6b0d9b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the flags which mark interfaces in double resolution case.  <br /></td></tr>
<tr class="separator:a6351df75321c5be52c45de4df6b0d9b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3f42764ad1f345dc1b1924a01a051f6" id="r_ad3f42764ad1f345dc1b1924a01a051f6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#ad3f42764ad1f345dc1b1924a01a051f6">CalculateDerivativesSR</a> (void)</td></tr>
<tr class="memdesc:ad3f42764ad1f345dc1b1924a01a051f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates local phase-field derivatives.  <br /></td></tr>
<tr class="separator:ad3f42764ad1f345dc1b1924a01a051f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b95ea729b671ab91f24db60da68892b" id="r_a9b95ea729b671ab91f24db60da68892b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a9b95ea729b671ab91f24db60da68892b">CalculateDerivativesDR</a> (void)</td></tr>
<tr class="memdesc:a9b95ea729b671ab91f24db60da68892b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates local phase-field derivatives in double resolution.  <br /></td></tr>
<tr class="separator:a9b95ea729b671ab91f24db60da68892b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a506595d6236a96859a36b19bc7fbd165" id="r_a506595d6236a96859a36b19bc7fbd165"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a506595d6236a96859a36b19bc7fbd165">SetBoundaryConditionsSR</a> (const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="memdesc:a506595d6236a96859a36b19bc7fbd165"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set boundary conditions in single resolution case.  <br /></td></tr>
<tr class="separator:a506595d6236a96859a36b19bc7fbd165"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42e3e7cdc1c94edd6e7a4cc8ca90c93a" id="r_a42e3e7cdc1c94edd6e7a4cc8ca90c93a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a42e3e7cdc1c94edd6e7a4cc8ca90c93a">SetBoundaryConditionsDR</a> (const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="memdesc:a42e3e7cdc1c94edd6e7a4cc8ca90c93a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set boundary conditions in double resolution case.  <br /></td></tr>
<tr class="separator:a42e3e7cdc1c94edd6e7a4cc8ca90c93a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade001d95d4f0e391ffd5874a821f0966" id="r_ade001d95d4f0e391ffd5874a821f0966"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#ade001d95d4f0e391ffd5874a821f0966">SetIncrementsBoundaryConditionsSR</a> (const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="memdesc:ade001d95d4f0e391ffd5874a821f0966"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set boundary conditions for phase field increments.  <br /></td></tr>
<tr class="separator:ade001d95d4f0e391ffd5874a821f0966"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab672f946e05f95f825cba15304bbbdf5" id="r_ab672f946e05f95f825cba15304bbbdf5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#ab672f946e05f95f825cba15304bbbdf5">SetIncrementsBoundaryConditionsDR</a> (const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="memdesc:ab672f946e05f95f825cba15304bbbdf5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set boundary conditions for phase field increments in double resolution case.  <br /></td></tr>
<tr class="separator:ab672f946e05f95f825cba15304bbbdf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99e40d092617225b339b45475192cd7f" id="r_a99e40d092617225b339b45475192cd7f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a99e40d092617225b339b45475192cd7f">FinalizeSR</a> (const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, const bool finalize=true)</td></tr>
<tr class="memdesc:a99e40d092617225b339b45475192cd7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finalizing the phase fields calculations in this time step.  <br /></td></tr>
<tr class="separator:a99e40d092617225b339b45475192cd7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a114bc43de1eb04b19f3ead40c62cc583" id="r_a114bc43de1eb04b19f3ead40c62cc583"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a114bc43de1eb04b19f3ead40c62cc583">FinalizeDR</a> (const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, const bool finalize=true)</td></tr>
<tr class="memdesc:a114bc43de1eb04b19f3ead40c62cc583"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finalizing the phase fields calculations in this time step in double resolutions.  <br /></td></tr>
<tr class="separator:a114bc43de1eb04b19f3ead40c62cc583"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a299fe17f6a9c7e34827a97eeaa82226b" id="r_a299fe17f6a9c7e34827a97eeaa82226b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a299fe17f6a9c7e34827a97eeaa82226b">KeepPhaseVolumeSR</a> (<a class="el" href="../../d2/d51/classopenphase_1_1Tensor.html">Tensor</a>&lt; bool, 2 &gt; AllowedTransitions)</td></tr>
<tr class="memdesc:a299fe17f6a9c7e34827a97eeaa82226b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Keeps phases volume constant by allowing only grain shape change and grain transformations between the grains of the same phase (emulates coexistence of immiscible phases). Should be called before <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a8634488569676742857d5127adc23e20" title="Normalizes the interface fields such that resulting phase fields after merge do not escape interval [...">NormalizeIncrements()</a>  <br /></td></tr>
<tr class="separator:a299fe17f6a9c7e34827a97eeaa82226b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b47ac8a0e26375b6ab6e6ee871836e0" id="r_a5b47ac8a0e26375b6ab6e6ee871836e0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a5b47ac8a0e26375b6ab6e6ee871836e0">KeepPhaseVolumeDR</a> (<a class="el" href="../../d2/d51/classopenphase_1_1Tensor.html">Tensor</a>&lt; bool, 2 &gt; AllowedTransitions)</td></tr>
<tr class="memdesc:a5b47ac8a0e26375b6ab6e6ee871836e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Keeps phases volume constant by allowing only grain shape change and grain transformations between the grains of the same phase (emulates coexistence of immiscible phases). Should be called before <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a8634488569676742857d5127adc23e20" title="Normalizes the interface fields such that resulting phase fields after merge do not escape interval [...">NormalizeIncrements()</a>  <br /></td></tr>
<tr class="separator:a5b47ac8a0e26375b6ab6e6ee871836e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc48631e25443062d9fa47d59f793dc9" id="r_afc48631e25443062d9fa47d59f793dc9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#afc48631e25443062d9fa47d59f793dc9">NormalizeIncrementsSR</a> (const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, const double dt)</td></tr>
<tr class="memdesc:afc48631e25443062d9fa47d59f793dc9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Normalizes the interface fields such that resulting phase fields after merge do not escape interval [0,1] and sum up to 1.  <br /></td></tr>
<tr class="separator:afc48631e25443062d9fa47d59f793dc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afad83087d5475bb9d90d543b49ff7bb7" id="r_afad83087d5475bb9d90d543b49ff7bb7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#afad83087d5475bb9d90d543b49ff7bb7">NormalizeIncrementsDR</a> (const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, const double dt)</td></tr>
<tr class="memdesc:afad83087d5475bb9d90d543b49ff7bb7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Normalizes the interface fields such that resulting phase fields after merge do not escape interval [0,1] and sum up to 1.  <br /></td></tr>
<tr class="separator:afad83087d5475bb9d90d543b49ff7bb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a543b2cf36dd1d38b1ad4754cdb2deace" id="r_a543b2cf36dd1d38b1ad4754cdb2deace"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a543b2cf36dd1d38b1ad4754cdb2deace">MergeIncrementsSR</a> (const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, const double dt, const bool finalize=true, const bool clear=true)</td></tr>
<tr class="memdesc:a543b2cf36dd1d38b1ad4754cdb2deace"><td class="mdescLeft">&#160;</td><td class="mdescRight">Merges the increments into the phase fields in single resolution.  <br /></td></tr>
<tr class="separator:a543b2cf36dd1d38b1ad4754cdb2deace"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1179b4b4b3ba1529a00ed1b6f4ab7cbe" id="r_a1179b4b4b3ba1529a00ed1b6f4ab7cbe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a1179b4b4b3ba1529a00ed1b6f4ab7cbe">MergeIncrementsDR</a> (const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, const double dt, const bool finalize=true, const bool clear=true)</td></tr>
<tr class="memdesc:a1179b4b4b3ba1529a00ed1b6f4ab7cbe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Merges the increments into the phase fields in double resolution.  <br /></td></tr>
<tr class="separator:a1179b4b4b3ba1529a00ed1b6f4ab7cbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac291b9b76a403056b1b9831b0664021" id="r_aac291b9b76a403056b1b9831b0664021"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#aac291b9b76a403056b1b9831b0664021">MoveFrameSR</a> (const int dx, const int dy, const int dz, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="memdesc:aac291b9b76a403056b1b9831b0664021"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shifts the data in the storage by dx, dy and dz (they should be 0, -1 or +1) in x, y and or z directions correspondingly.  <br /></td></tr>
<tr class="separator:aac291b9b76a403056b1b9831b0664021"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e1910385649f9a3eda4a38062225d09" id="r_a9e1910385649f9a3eda4a38062225d09"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a9e1910385649f9a3eda4a38062225d09">MoveFrameDR</a> (const int dx, const int dy, const int dz, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="memdesc:a9e1910385649f9a3eda4a38062225d09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shifts the data in the storage by dx, dy and dz (they should be 0, -2 or +2) in x, y and or z directions correspondingly.  <br /></td></tr>
<tr class="separator:a9e1910385649f9a3eda4a38062225d09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa34a89b8acec2f5b93915ca3b95668c1" id="r_aa34a89b8acec2f5b93915ca3b95668c1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa34a89b8acec2f5b93915ca3b95668c1">ConsumePlaneSR</a> (const int dx, const int dy, const int dz, const int x, const int y, const int z, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="memdesc:aa34a89b8acec2f5b93915ca3b95668c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shifts the data in the single resolution storage by dx, dy and dz (they should be 0, -1 or +1) in the direction to/from (x, y, z) point.  <br /></td></tr>
<tr class="separator:aa34a89b8acec2f5b93915ca3b95668c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a174344940a72384a05ed1dbebef1967a" id="r_a174344940a72384a05ed1dbebef1967a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a174344940a72384a05ed1dbebef1967a">ConsumePlaneDR</a> (const int dx, const int dy, const int dz, const int x, const int y, const int z, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="memdesc:a174344940a72384a05ed1dbebef1967a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shifts the data in the double resolution storage by dx, dy and dz (they should be 0, -1 or +1) in the direction to/from (x, y, z) point.  <br /></td></tr>
<tr class="separator:a174344940a72384a05ed1dbebef1967a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5eda15b7ebd1a3025c27cceb9c896c17" id="r_a5eda15b7ebd1a3025c27cceb9c896c17"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a5eda15b7ebd1a3025c27cceb9c896c17">SelectiveCombinePhaseFieldsSR</a> (const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, const size_t TargetPFIndex, const size_t SourcePFIndex)</td></tr>
<tr class="separator:a5eda15b7ebd1a3025c27cceb9c896c17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac868ffd9ecfe979e5b0bac89cd85339" id="r_aac868ffd9ecfe979e5b0bac89cd85339"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#aac868ffd9ecfe979e5b0bac89cd85339">SelectiveCombinePhaseFieldsDR</a> (const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, const size_t TargetPFIndex, const size_t SourcePFIndex)</td></tr>
<tr class="separator:aac868ffd9ecfe979e5b0bac89cd85339"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a958b5b2d6aa752eab13281f17f43ff7b" id="r_a958b5b2d6aa752eab13281f17f43ff7b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a958b5b2d6aa752eab13281f17f43ff7b">Coarsen</a> (void)</td></tr>
<tr class="memdesc:a958b5b2d6aa752eab13281f17f43ff7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates single resolution phase-fields from the double resolution ones.  <br /></td></tr>
<tr class="separator:a958b5b2d6aa752eab13281f17f43ff7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30af10b1105bdbb7355613a312a41f1e" id="r_a30af10b1105bdbb7355613a312a41f1e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a30af10b1105bdbb7355613a312a41f1e">CoarsenDot</a> (void)</td></tr>
<tr class="memdesc:a30af10b1105bdbb7355613a312a41f1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates single resolution phase-field increments from the double resolution ones.  <br /></td></tr>
<tr class="separator:a30af10b1105bdbb7355613a312a41f1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabfe5a389c721d7146e5b9a9bf4ff05e" id="r_aabfe5a389c721d7146e5b9a9bf4ff05e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#aabfe5a389c721d7146e5b9a9bf4ff05e">CombinePhaseFields</a> (void)</td></tr>
<tr class="memdesc:aabfe5a389c721d7146e5b9a9bf4ff05e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Merge phase fields of same phase to phase field with index PhaseIndex.  <br /></td></tr>
<tr class="separator:aabfe5a389c721d7146e5b9a9bf4ff05e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a357ea817f60117eb924f107e77a482ef" id="r_a357ea817f60117eb924f107e77a482ef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a357ea817f60117eb924f107e77a482ef">CalculateFractions</a> (void)</td></tr>
<tr class="memdesc:a357ea817f60117eb924f107e77a482ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates phase fractions from phase-fields, populates Fractions storage.  <br /></td></tr>
<tr class="separator:a357ea817f60117eb924f107e77a482ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d1ccd2f7e084a0539d7134fb0c15b7c" id="r_a0d1ccd2f7e084a0539d7134fb0c15b7c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a0d1ccd2f7e084a0539d7134fb0c15b7c">CalculateGrainsVolume</a> (void)</td></tr>
<tr class="memdesc:a0d1ccd2f7e084a0539d7134fb0c15b7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Collects volume for each phase field.  <br /></td></tr>
<tr class="separator:a0d1ccd2f7e084a0539d7134fb0c15b7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca24a7b03b7fba39de79695ef541937e" id="r_aca24a7b03b7fba39de79695ef541937e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#aca24a7b03b7fba39de79695ef541937e">Advect</a> (<a class="el" href="../../dd/d95/classopenphase_1_1AdvectionHR.html">AdvectionHR</a> &amp;Adv, const <a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;Vel, <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a44913b19d54d780a4b9e00fcab11cbb6">Phi</a>, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, const double dt, const double tStep) override</td></tr>
<tr class="memdesc:aca24a7b03b7fba39de79695ef541937e"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt; Hidden standard advection method. Should not be used for <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html" title="&lt; Phase field class. It stores the phase fields, performs basic operations on them.">PhaseField</a>  <br /></td></tr>
<tr class="separator:aca24a7b03b7fba39de79695ef541937e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:aa63bc774f077e754f035dc1602e80574" id="r_aa63bc774f077e754f035dc1602e80574"><td class="memItemLeft" align="right" valign="top">std::vector&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa63bc774f077e754f035dc1602e80574">Combine</a></td></tr>
<tr class="memdesc:aa63bc774f077e754f035dc1602e80574"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicates which phase's phase fields should be combined.  <br /></td></tr>
<tr class="separator:aa63bc774f077e754f035dc1602e80574"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>&lt; Phase field class. It stores the phase fields, performs basic operations on them. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/dc5/PhaseField_8h_source.html#l00047">47</a> of file <a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a88f3cc02af2a27c2f56247ada4a419d1" name="a88f3cc02af2a27c2f56247ada4a419d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88f3cc02af2a27c2f56247ada4a419d1">&#9670;&#160;</a></span>PhaseField() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">openphase::PhaseField::PhaseField </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/dc5/PhaseField_8h_source.html#l00051">51</a> of file <a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   51</span>{};</div>
</div><!-- fragment -->
</div>
</div>
<a id="aded29116e630debd960b4bd0a0d33f3d" name="aded29116e630debd960b4bd0a0d33f3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aded29116e630debd960b4bd0a0d33f3d">&#9670;&#160;</a></span>PhaseField() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">openphase::PhaseField::PhaseField </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;&#160;</td>
          <td class="paramname"><em>locSettings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>InputFileName</em> = <code><a class="el" href="../../d0/d6c/namespaceopenphase.html#a9e087efe4525895243a5c0d3a7fb07c6">DefaultInputFileName</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/dc5/PhaseField_8h_source.html#l00052">52</a> of file <a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   53</span>    {</div>
<div class="line"><span class="lineno">   54</span>        <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a657703c88fcc2adf92532ffc1955661a">Initialize</a>(locSettings);</div>
<div class="line"><span class="lineno">   55</span>        <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a1a6511943316b1eebb1e5e345fc81588">ReadInput</a>(InputFileName);</div>
<div class="line"><span class="lineno">   56</span>    };</div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a1a6511943316b1eebb1e5e345fc81588"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a1a6511943316b1eebb1e5e345fc81588">openphase::PhaseField::ReadInput</a></div><div class="ttdeci">void ReadInput(const std::string InputFileName) override</div><div class="ttdoc">Reads input from the file.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l00075">PhaseField.cpp:75</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a657703c88fcc2adf92532ffc1955661a"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a657703c88fcc2adf92532ffc1955661a">openphase::PhaseField::Initialize</a></div><div class="ttdeci">void Initialize(Settings &amp;locSettings, std::string ObjectNameSuffix=&quot;&quot;) override</div><div class="ttdoc">Initializes the storage and initial variables of the driving force class.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l00044">PhaseField.cpp:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="acc7cec18fec3213263fc9703303d7842" name="acc7cec18fec3213263fc9703303d7842"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc7cec18fec3213263fc9703303d7842">&#9670;&#160;</a></span>AddGrainInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t openphase::PhaseField::AddGrainInfo </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>PhaseIndex</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds new grain information for a phase "PhaseIndex", returns resulting phase field index. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02970">2970</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2971</span>{</div>
<div class="line"><span class="lineno"> 2972</span>    <span class="keywordtype">size_t</span> locIndex = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>.<a class="code hl_function" href="../../d6/d90/classopenphase_1_1GrainsProperties.html#a139779e789b93dea1e1629d7c5b74386">add_grain</a>(PhaseIndex);</div>
<div class="line"><span class="lineno"> 2973</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[locIndex].RefVolume = <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3a500b45060139b7e51d305fb90c46e4">CalculateReferenceVolume</a>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6b4e77f0fe736794ab56285960cd7a1e">iWidth</a>);</div>
<div class="line"><span class="lineno"> 2974</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[locIndex].VolumeRatio = 0.0;</div>
<div class="line"><span class="lineno"> 2975</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[locIndex].State = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a18545778a21115cf2146d08dc86e2de4">PhaseAggregateStates</a>[PhaseIndex];</div>
<div class="line"><span class="lineno"> 2976</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[locIndex].Density = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a0c76a1996bda299c8471a126fb4f1f38">PhaseEquilibriumDensities</a>[PhaseIndex];</div>
<div class="line"><span class="lineno"> 2977</span> </div>
<div class="line"><span class="lineno"> 2978</span>    <span class="keywordflow">return</span> locIndex;</div>
<div class="line"><span class="lineno"> 2979</span>}</div>
<div class="ttc" id="aclassopenphase_1_1GrainsProperties_html_a139779e789b93dea1e1629d7c5b74386"><div class="ttname"><a href="../../d6/d90/classopenphase_1_1GrainsProperties.html#a139779e789b93dea1e1629d7c5b74386">openphase::GrainsProperties::add_grain</a></div><div class="ttdeci">size_t add_grain(const size_t PhaseIndex)</div><div class="ttdef"><b>Definition</b> <a href="../../da/dab/GrainsProperties_8h_source.html#l00708">GrainsProperties.h:708</a></div></div>
<div class="ttc" id="aclassopenphase_1_1GridParameters_html_a6b4e77f0fe736794ab56285960cd7a1e"><div class="ttname"><a href="../../dc/d18/classopenphase_1_1GridParameters.html#a6b4e77f0fe736794ab56285960cd7a1e">openphase::GridParameters::iWidth</a></div><div class="ttdeci">double iWidth</div><div class="ttdoc">Interface width in grid cells.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d68/GridParameters_8h_source.html#l00168">GridParameters.h:168</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a0c76a1996bda299c8471a126fb4f1f38"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a0c76a1996bda299c8471a126fb4f1f38">openphase::PhaseField::PhaseEquilibriumDensities</a></div><div class="ttdeci">std::vector&lt; double &gt; PhaseEquilibriumDensities</div><div class="ttdoc">Equilibrium densities for all phases.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc5/PhaseField_8h_source.html#l00240">PhaseField.h:240</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a18545778a21115cf2146d08dc86e2de4"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a18545778a21115cf2146d08dc86e2de4">openphase::PhaseField::PhaseAggregateStates</a></div><div class="ttdeci">std::vector&lt; AggregateStates &gt; PhaseAggregateStates</div><div class="ttdoc">Aggregate states of all phases.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc5/PhaseField_8h_source.html#l00239">PhaseField.h:239</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a3a500b45060139b7e51d305fb90c46e4"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a3a500b45060139b7e51d305fb90c46e4">openphase::PhaseField::CalculateReferenceVolume</a></div><div class="ttdeci">double CalculateReferenceVolume(double radius)</div><div class="ttdoc">Calculates reference volume (RefVolume) for nucleation.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l00367">PhaseField.cpp:367</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a7514a5f0d25deb090526b0a71ca95132"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">openphase::PhaseField::Grid</a></div><div class="ttdeci">GridParameters Grid</div><div class="ttdoc">Simulation grid parameters.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc5/PhaseField_8h_source.html#l00226">PhaseField.h:226</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_aa2c57b6e85a5364094952fd5257be9c5"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">openphase::PhaseField::FieldsProperties</a></div><div class="ttdeci">GrainsProperties FieldsProperties</div><div class="ttdoc">Phase fields properties. Contains information about location, velocity, orientation,...</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc5/PhaseField_8h_source.html#l00249">PhaseField.h:249</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a14459aef7e8f81944069f7aa68793864" name="a14459aef7e8f81944069f7aa68793864"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14459aef7e8f81944069f7aa68793864">&#9670;&#160;</a></span>Advect() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::Advect </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d95/classopenphase_1_1AdvectionHR.html">AdvectionHR</a> &amp;&#160;</td>
          <td class="paramname"><em>Adv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;&#160;</td>
          <td class="paramname"><em>Vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>tStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>finalize</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Advects phase-field when no LB solver is used. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03619">3619</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3623</span>{</div>
<div class="line"><span class="lineno"> 3624</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#abd10af2caa601ce82e2150bdc4d395b9">FieldsAdvectionDot</a>   .IsNotAllocated()) <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#abd10af2caa601ce82e2150bdc4d395b9">FieldsAdvectionDot</a>   .Allocate(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#aae205a52da44fe4c880a16b0f5a48cfb">Bcells</a>());</div>
<div class="line"><span class="lineno"> 3625</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#ae462950f95d4fc9a10834b300a721627">FieldsAdvectionBackup</a>.IsNotAllocated()) <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#ae462950f95d4fc9a10834b300a721627">FieldsAdvectionBackup</a>.Allocate(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#aae205a52da44fe4c880a16b0f5a48cfb">Bcells</a>());</div>
<div class="line"><span class="lineno"> 3626</span> </div>
<div class="line"><span class="lineno"> 3627</span>    <span class="keywordflow">if</span>(not <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#abd10af2caa601ce82e2150bdc4d395b9">FieldsAdvectionDot</a>   .IsSize(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>)) <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#abd10af2caa601ce82e2150bdc4d395b9">FieldsAdvectionDot</a>   .Reallocate(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>);</div>
<div class="line"><span class="lineno"> 3628</span>    <span class="keywordflow">if</span>(not <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#ae462950f95d4fc9a10834b300a721627">FieldsAdvectionBackup</a>.IsSize(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>)) <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#ae462950f95d4fc9a10834b300a721627">FieldsAdvectionBackup</a>.Reallocate(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>);</div>
<div class="line"><span class="lineno"> 3629</span> </div>
<div class="line"><span class="lineno"> 3630</span>    Adv.AdvectPhaseField(*<span class="keyword">this</span>, Vel, BC, dt, tStep, finalize);</div>
<div class="line"><span class="lineno"> 3631</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a357ea817f60117eb924f107e77a482ef">CalculateFractions</a>();</div>
<div class="line"><span class="lineno"> 3632</span>    <span class="comment">//ConsoleOutput::WriteStandard(thisclassname, &quot;Advected&quot;);</span></div>
<div class="line"><span class="lineno"> 3633</span>}</div>
<div class="ttc" id="aclassopenphase_1_1GridParameters_html_a0f169f4652c06b6e4328e31778885e9b"><div class="ttname"><a href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">openphase::GridParameters::Nz</a></div><div class="ttdeci">int Nz</div><div class="ttdoc">Number of grid cells in Z direction.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d68/GridParameters_8h_source.html#l00141">GridParameters.h:141</a></div></div>
<div class="ttc" id="aclassopenphase_1_1GridParameters_html_a5c1aae2c50ac8d4553575e73bea08105"><div class="ttname"><a href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">openphase::GridParameters::Nx</a></div><div class="ttdeci">int Nx</div><div class="ttdoc">Number of grid cells in X direction.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d68/GridParameters_8h_source.html#l00139">GridParameters.h:139</a></div></div>
<div class="ttc" id="aclassopenphase_1_1GridParameters_html_a6dc623672d1966056e21a45e859178b7"><div class="ttname"><a href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">openphase::GridParameters::Ny</a></div><div class="ttdeci">int Ny</div><div class="ttdoc">Number of grid cells in Y direction.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d68/GridParameters_8h_source.html#l00140">GridParameters.h:140</a></div></div>
<div class="ttc" id="aclassopenphase_1_1GridParameters_html_aae205a52da44fe4c880a16b0f5a48cfb"><div class="ttname"><a href="../../dc/d18/classopenphase_1_1GridParameters.html#aae205a52da44fe4c880a16b0f5a48cfb">openphase::GridParameters::Bcells</a></div><div class="ttdeci">int Bcells</div><div class="ttdoc">Number of boundary cells for setting the boundary conditions.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d68/GridParameters_8h_source.html#l00167">GridParameters.h:167</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a357ea817f60117eb924f107e77a482ef"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a357ea817f60117eb924f107e77a482ef">openphase::PhaseField::CalculateFractions</a></div><div class="ttdeci">void CalculateFractions(void)</div><div class="ttdoc">Calculates phase fractions from phase-fields, populates Fractions storage.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l00411">PhaseField.cpp:411</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_abd10af2caa601ce82e2150bdc4d395b9"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#abd10af2caa601ce82e2150bdc4d395b9">openphase::PhaseField::FieldsAdvectionDot</a></div><div class="ttdeci">Storage3D&lt; NodeA&lt; double &gt;, 0 &gt; FieldsAdvectionDot</div><div class="ttdoc">Phase-field storage for advection increments.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc5/PhaseField_8h_source.html#l00256">PhaseField.h:256</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_ae462950f95d4fc9a10834b300a721627"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#ae462950f95d4fc9a10834b300a721627">openphase::PhaseField::FieldsAdvectionBackup</a></div><div class="ttdeci">Storage3D&lt; NodePF, 0 &gt; FieldsAdvectionBackup</div><div class="ttdoc">Phase-field backup storage for advection.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc5/PhaseField_8h_source.html#l00257">PhaseField.h:257</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_aebd94a373c8ff15a6ca2296c8db48e18"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">openphase::PhaseField::Fields</a></div><div class="ttdeci">Storage3D&lt; NodePF, 0 &gt; Fields</div><div class="ttdoc">Phase-field storage.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc5/PhaseField_8h_source.html#l00253">PhaseField.h:253</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2c7aaf38cb25aec9c50089124d101961" name="a2c7aaf38cb25aec9c50089124d101961"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c7aaf38cb25aec9c50089124d101961">&#9670;&#160;</a></span>Advect() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::Advect </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d95/classopenphase_1_1AdvectionHR.html">AdvectionHR</a> &amp;&#160;</td>
          <td class="paramname"><em>Adv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;&#160;</td>
          <td class="paramname"><em>Vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/db8/classopenphase_1_1FlowSolverLBM.html">FlowSolverLBM</a> &amp;&#160;</td>
          <td class="paramname"><em>LBM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>tStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>finalize</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Advects phase-field when a LB solver is used. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03651">3651</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3655</span>{</div>
<div class="line"><span class="lineno"> 3656</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#abd10af2caa601ce82e2150bdc4d395b9">FieldsAdvectionDot</a>   .IsNotAllocated()) <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#abd10af2caa601ce82e2150bdc4d395b9">FieldsAdvectionDot</a>   .Allocate(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#aae205a52da44fe4c880a16b0f5a48cfb">Bcells</a>());</div>
<div class="line"><span class="lineno"> 3657</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#ae462950f95d4fc9a10834b300a721627">FieldsAdvectionBackup</a>.IsNotAllocated()) <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#ae462950f95d4fc9a10834b300a721627">FieldsAdvectionBackup</a>.Allocate(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#aae205a52da44fe4c880a16b0f5a48cfb">Bcells</a>());</div>
<div class="line"><span class="lineno"> 3658</span> </div>
<div class="line"><span class="lineno"> 3659</span>    <span class="keywordflow">if</span>(not <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#abd10af2caa601ce82e2150bdc4d395b9">FieldsAdvectionDot</a>   .IsSize(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>)) <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#abd10af2caa601ce82e2150bdc4d395b9">FieldsAdvectionDot</a>   .Reallocate(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>);</div>
<div class="line"><span class="lineno"> 3660</span>    <span class="keywordflow">if</span>(not <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#ae462950f95d4fc9a10834b300a721627">FieldsAdvectionBackup</a>.IsSize(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>)) <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#ae462950f95d4fc9a10834b300a721627">FieldsAdvectionBackup</a>.Reallocate(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>);</div>
<div class="line"><span class="lineno"> 3661</span> </div>
<div class="line"><span class="lineno"> 3662</span>    LBM.DetectObstacles(*<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3663</span>    Adv.AdvectPhaseField(*<span class="keyword">this</span>, Vel, BC, dt, tStep, finalize);</div>
<div class="line"><span class="lineno"> 3664</span>    LBM.DetectObstaclesAdvection(*<span class="keyword">this</span>,Vel,BC);</div>
<div class="line"><span class="lineno"> 3665</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a357ea817f60117eb924f107e77a482ef">CalculateFractions</a>();</div>
<div class="line"><span class="lineno"> 3666</span>    <span class="comment">//ConsoleOutput::WriteStandard(thisclassname, &quot;Advected&quot;);</span></div>
<div class="line"><span class="lineno"> 3667</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aca24a7b03b7fba39de79695ef541937e" name="aca24a7b03b7fba39de79695ef541937e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca24a7b03b7fba39de79695ef541937e">&#9670;&#160;</a></span>Advect() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::Advect </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d95/classopenphase_1_1AdvectionHR.html">AdvectionHR</a> &amp;&#160;</td>
          <td class="paramname"><em>Adv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;&#160;</td>
          <td class="paramname"><em>Vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>tStep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">private</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt; Hidden standard advection method. Should not be used for <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html" title="&lt; Phase field class. It stores the phase fields, performs basic operations on them.">PhaseField</a> </p>

<p>Reimplemented from <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#afd82ead485f6d9695aa733729100614c">openphase::OPObject</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/dc5/PhaseField_8h_source.html#l00338">338</a> of file <a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  341</span>    {</div>
<div class="line"><span class="lineno">  342</span>        (void) Adv; <span class="comment">//unused</span></div>
<div class="line"><span class="lineno">  343</span>        (void) Vel; <span class="comment">//unused</span></div>
<div class="line"><span class="lineno">  344</span>        (void) <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a44913b19d54d780a4b9e00fcab11cbb6">Phi</a>; <span class="comment">//unused</span></div>
<div class="line"><span class="lineno">  345</span>        (void) BC; <span class="comment">//unused</span></div>
<div class="line"><span class="lineno">  346</span>        (void) dt; <span class="comment">//unused</span></div>
<div class="line"><span class="lineno">  347</span>        (void) tStep; <span class="comment">//unused</span></div>
<div class="line"><span class="lineno">  348</span>    };</div>
<div class="ttc" id="anamespaceopenphase_html_a44913b19d54d780a4b9e00fcab11cbb6"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a44913b19d54d780a4b9e00fcab11cbb6">openphase::Phi</a></div><div class="ttdeci">double Phi(const double lbDensity, const double ReducedPressure, const double GasParameter)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00052">FlowSolverLBM.cpp:52</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8c0a168e690f7cb617ef0fc21bacd4a8" name="a8c0a168e690f7cb617ef0fc21bacd4a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c0a168e690f7cb617ef0fc21bacd4a8">&#9670;&#160;</a></span>AdvectALE()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::AdvectALE </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d95/classopenphase_1_1AdvectionHR.html">AdvectionHR</a> &amp;&#160;</td>
          <td class="paramname"><em>Adv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/ddd/classopenphase_1_1Velocities.html">Velocities</a> &amp;&#160;</td>
          <td class="paramname"><em>Vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>tStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>finalize</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Advects phase-field in the ALE scheme. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03635">3635</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3639</span>{</div>
<div class="line"><span class="lineno"> 3640</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#abd10af2caa601ce82e2150bdc4d395b9">FieldsAdvectionDot</a>   .IsNotAllocated()) <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#abd10af2caa601ce82e2150bdc4d395b9">FieldsAdvectionDot</a>   .Allocate(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#aae205a52da44fe4c880a16b0f5a48cfb">Bcells</a>());</div>
<div class="line"><span class="lineno"> 3641</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#ae462950f95d4fc9a10834b300a721627">FieldsAdvectionBackup</a>.IsNotAllocated()) <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#ae462950f95d4fc9a10834b300a721627">FieldsAdvectionBackup</a>.Allocate(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#aae205a52da44fe4c880a16b0f5a48cfb">Bcells</a>());</div>
<div class="line"><span class="lineno"> 3642</span> </div>
<div class="line"><span class="lineno"> 3643</span>    <span class="keywordflow">if</span>(not <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#abd10af2caa601ce82e2150bdc4d395b9">FieldsAdvectionDot</a>   .IsSize(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>)) <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#abd10af2caa601ce82e2150bdc4d395b9">FieldsAdvectionDot</a>   .Reallocate(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>);</div>
<div class="line"><span class="lineno"> 3644</span>    <span class="keywordflow">if</span>(not <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#ae462950f95d4fc9a10834b300a721627">FieldsAdvectionBackup</a>.IsSize(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>)) <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#ae462950f95d4fc9a10834b300a721627">FieldsAdvectionBackup</a>.Reallocate(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>);</div>
<div class="line"><span class="lineno"> 3645</span> </div>
<div class="line"><span class="lineno"> 3646</span>    Adv.AdvectPhaseFieldALE(*<span class="keyword">this</span>, Vel, BC, dt, tStep, finalize);</div>
<div class="line"><span class="lineno"> 3647</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#af8c994d103fffdf2f55db24ab6553cf1">Finalize</a>(BC);</div>
<div class="line"><span class="lineno"> 3648</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, <span class="stringliteral">&quot;Advected&quot;</span>);</div>
<div class="line"><span class="lineno"> 3649</span>}</div>
<div class="ttc" id="aclassopenphase_1_1ConsoleOutput_html_ae2753bb70e817b1bdd5ae2b99adf6e0f"><div class="ttname"><a href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">openphase::ConsoleOutput::WriteStandard</a></div><div class="ttdeci">static void WriteStandard(const std::string &amp;Left, const T Right, const int precision=StandardPrecision, floatfield notation=StandardNotation, const size_t ColumnWidth=StandardColumnWidth)</div><div class="ttdoc">Writes GetStandard result to std::cout if MPI-Rank 0.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/dfe/ConsoleOutput_8h_source.html#l00291">ConsoleOutput.h:291</a></div></div>
<div class="ttc" id="aclassopenphase_1_1OPObject_html_a9006e8f49762d851b52708b363ba14f2"><div class="ttname"><a href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">openphase::OPObject::thisclassname</a></div><div class="ttdeci">std::string thisclassname</div><div class="ttdoc">Object's implementation class name.</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d1c/OPObject_8h_source.html#l00054">OPObject.h:54</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_af8c994d103fffdf2f55db24ab6553cf1"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#af8c994d103fffdf2f55db24ab6553cf1">openphase::PhaseField::Finalize</a></div><div class="ttdeci">void Finalize(const BoundaryConditions &amp;BC, const bool finalize=true)</div><div class="ttdoc">Finalizing the phase fields calculations.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l00989">PhaseField.cpp:989</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa160891e608d26b6333bea5b1087b0bf" name="aa160891e608d26b6333bea5b1087b0bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa160891e608d26b6333bea5b1087b0bf">&#9670;&#160;</a></span>AllocateStorages()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::AllocateStorages </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/d18/classopenphase_1_1GridParameters.html">GridParameters</a> &amp;&#160;</td>
          <td class="paramname"><em>Grid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates internal storages. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l00341">341</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  342</span>{</div>
<div class="line"><span class="lineno">  343</span>    <span class="comment">// extra cells needed for driving force averaging</span></div>
<div class="line"><span class="lineno">  344</span>    <span class="keywordtype">size_t</span> Bcells = <a class="code hl_function" href="../../d1/d21/namespaceopenphase_1_1SystemOfLinearEquationsSolvers.html#a3c9fdec2355fde577142bf782e7c581c">max</a>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#aae205a52da44fe4c880a16b0f5a48cfb">Bcells</a>, <span class="keywordtype">int</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6b4e77f0fe736794ab56285960cd7a1e">iWidth</a>)-1);</div>
<div class="line"><span class="lineno">  345</span> </div>
<div class="line"><span class="lineno">  346</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#af0b28822d6a3aba3df4db780b51db71a">Resolution</a> == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>)</div>
<div class="line"><span class="lineno">  347</span>    {</div>
<div class="line"><span class="lineno">  348</span>        Bcells = <a class="code hl_function" href="../../d1/d21/namespaceopenphase_1_1SystemOfLinearEquationsSolvers.html#a3c9fdec2355fde577142bf782e7c581c">max</a>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#aae205a52da44fe4c880a16b0f5a48cfb">Bcells</a>, <span class="keywordtype">int</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6b4e77f0fe736794ab56285960cd7a1e">iWidth</a>/2));</div>
<div class="line"><span class="lineno">  349</span>    }</div>
<div class="line"><span class="lineno">  350</span> </div>
<div class="line"><span class="lineno">  351</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>   .Allocate(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>, Bcells);</div>
<div class="line"><span class="lineno">  352</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>.Allocate(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>, Bcells);</div>
<div class="line"><span class="lineno">  353</span> </div>
<div class="line"><span class="lineno">  354</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a784a4bea9a5379192bdf4f12ab12cf10">Fractions</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#af45dd4140586881f9ed201c3b795faff">Allocate</a>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>,{<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a>}, Bcells);</div>
<div class="line"><span class="lineno">  355</span> </div>
<div class="line"><span class="lineno">  356</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7f11e6f1f190ef9bb7e6c6013ec03101">FractionsTotal</a>.resize(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a>, 0.0);</div>
<div class="line"><span class="lineno">  357</span> </div>
<div class="line"><span class="lineno">  358</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#af0b28822d6a3aba3df4db780b51db71a">Resolution</a> == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>)</div>
<div class="line"><span class="lineno">  359</span>    {</div>
<div class="line"><span class="lineno">  360</span>        GridParameters DoubleDimensions = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_function" href="../../dc/d18/classopenphase_1_1GridParameters.html#aa24687417304e06716da10e732d708af">DoubleResolution</a>();</div>
<div class="line"><span class="lineno">  361</span> </div>
<div class="line"><span class="lineno">  362</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>   .Allocate(DoubleDimensions, Bcells*2);</div>
<div class="line"><span class="lineno">  363</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>.Allocate(DoubleDimensions, Bcells*2);</div>
<div class="line"><span class="lineno">  364</span>    }</div>
<div class="line"><span class="lineno">  365</span>}</div>
<div class="ttc" id="aclassopenphase_1_1GridParameters_html_aa24687417304e06716da10e732d708af"><div class="ttname"><a href="../../dc/d18/classopenphase_1_1GridParameters.html#aa24687417304e06716da10e732d708af">openphase::GridParameters::DoubleResolution</a></div><div class="ttdeci">GridParameters DoubleResolution(void) const</div><div class="ttdoc">Returns grid parameters in double resolution.</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d43/GridParameters_8cpp_source.html#l00170">GridParameters.cpp:170</a></div></div>
<div class="ttc" id="aclassopenphase_1_1GridParameters_html_af0b28822d6a3aba3df4db780b51db71a"><div class="ttname"><a href="../../dc/d18/classopenphase_1_1GridParameters.html#af0b28822d6a3aba3df4db780b51db71a">openphase::GridParameters::Resolution</a></div><div class="ttdeci">Resolutions Resolution</div><div class="ttdoc">Phase field resolution (Single or Double)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d68/GridParameters_8h_source.html#l00171">GridParameters.h:171</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a3562565ae829ac5ed575324eb92ce1e8"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">openphase::PhaseField::FieldsDot</a></div><div class="ttdeci">Storage3D&lt; NodeAB&lt; double, double &gt;, 0 &gt; FieldsDot</div><div class="ttdoc">Phase-field increments storage.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc5/PhaseField_8h_source.html#l00254">PhaseField.h:254</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a751e2803a23026fbb7e4b0b2c7673391"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">openphase::PhaseField::FieldsDotDR</a></div><div class="ttdeci">Storage3D&lt; NodeAB&lt; double, double &gt;, 0 &gt; FieldsDotDR</div><div class="ttdoc">Phase-field increments storage for double resolution mode.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc5/PhaseField_8h_source.html#l00260">PhaseField.h:260</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a784a4bea9a5379192bdf4f12ab12cf10"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a784a4bea9a5379192bdf4f12ab12cf10">openphase::PhaseField::Fractions</a></div><div class="ttdeci">Storage3D&lt; double, 1 &gt; Fractions</div><div class="ttdoc">Phase fractions storage.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc5/PhaseField_8h_source.html#l00251">PhaseField.h:251</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a7f11e6f1f190ef9bb7e6c6013ec03101"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a7f11e6f1f190ef9bb7e6c6013ec03101">openphase::PhaseField::FractionsTotal</a></div><div class="ttdeci">std::vector&lt; double &gt; FractionsTotal</div><div class="ttdoc">Total phase fractions in the entire simulation domain.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc5/PhaseField_8h_source.html#l00241">PhaseField.h:241</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a81113f3bf9c388a9ac8e31861902c40b"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">openphase::PhaseField::FieldsDR</a></div><div class="ttdeci">Storage3D&lt; NodePF, 0 &gt; FieldsDR</div><div class="ttdoc">Phase-field storage for double resolution mode.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc5/PhaseField_8h_source.html#l00259">PhaseField.h:259</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_aaeea2220078792baa302dc4300807029"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">openphase::PhaseField::Nphases</a></div><div class="ttdeci">size_t Nphases</div><div class="ttdoc">Number of thermodynamic phases.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc5/PhaseField_8h_source.html#l00228">PhaseField.h:228</a></div></div>
<div class="ttc" id="aclassopenphase_1_1Storage3D_html_af45dd4140586881f9ed201c3b795faff"><div class="ttname"><a href="../../da/d19/classopenphase_1_1Storage3D.html#af45dd4140586881f9ed201c3b795faff">openphase::Storage3D::Allocate</a></div><div class="ttdeci">void Allocate(const long int nx, const long int ny, const long int nz, const long int dnx, const long int dny, const long int dnz, const std::array&lt; size_t, Rank &gt; nn, const long int bc)</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d8e/Storage3D_8h_source.html#l00535">Storage3D.h:535</a></div></div>
<div class="ttc" id="anamespaceopenphase_1_1SystemOfLinearEquationsSolvers_html_a3c9fdec2355fde577142bf782e7c581c"><div class="ttname"><a href="../../d1/d21/namespaceopenphase_1_1SystemOfLinearEquationsSolvers.html#a3c9fdec2355fde577142bf782e7c581c">openphase::SystemOfLinearEquationsSolvers::max</a></div><div class="ttdeci">double OP_EXPORTS max(const Vector &amp;x)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d33/SystemOfLinearEquationsSolvers_8h_source.html#l00146">SystemOfLinearEquationsSolvers.h:146</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">openphase::Resolutions::Dual</a></div><div class="ttdeci">@ Dual</div><div class="ttdoc">Double resolution for phase fields.</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9b95ea729b671ab91f24db60da68892b" name="a9b95ea729b671ab91f24db60da68892b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b95ea729b671ab91f24db60da68892b">&#9670;&#160;</a></span>CalculateDerivativesDR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::CalculateDerivativesDR </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates local phase-field derivatives in double resolution. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l00617">617</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  618</span>{</div>
<div class="line"><span class="lineno">  619</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i, j, k, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.Bcells()-1,)</div>
<div class="line"><span class="lineno">  620</span>    {</div>
<div class="line"><span class="lineno">  621</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).wide_interface())</div>
<div class="line"><span class="lineno">  622</span>        {</div>
<div class="line"><span class="lineno">  623</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).set_temporary();</div>
<div class="line"><span class="lineno">  624</span> </div>
<div class="line"><span class="lineno">  625</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> ls = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a4099b0db42d5fcbf908eafe2a338032e">LStencil</a>.<a class="code hl_function" href="../../d8/d86/classopenphase_1_1LaplacianStencil.html#a343bd494c058f2d2541e4a08631f7619">cbegin</a>(); ls != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a4099b0db42d5fcbf908eafe2a338032e">LStencil</a>.<a class="code hl_function" href="../../d8/d86/classopenphase_1_1LaplacianStencil.html#a9f416dc378b9a7dd043eed7cb4a158a2">cend</a>(); ls++)</div>
<div class="line"><span class="lineno">  626</span>            {</div>
<div class="line"><span class="lineno">  627</span>                <span class="keywordtype">int</span> ii = ls-&gt;di;</div>
<div class="line"><span class="lineno">  628</span>                <span class="keywordtype">int</span> jj = ls-&gt;dj;</div>
<div class="line"><span class="lineno">  629</span>                <span class="keywordtype">int</span> kk = ls-&gt;dk;</div>
<div class="line"><span class="lineno">  630</span> </div>
<div class="line"><span class="lineno">  631</span>                <span class="keywordflow">for</span> (<span class="keyword">auto</span> it  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i + ii, j + jj, k + kk).cbegin();</div>
<div class="line"><span class="lineno">  632</span>                          it != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i + ii, j + jj, k + kk).cend(); ++it)</div>
<div class="line"><span class="lineno">  633</span>                <span class="keywordflow">if</span> (it-&gt;value != 0.0)</div>
<div class="line"><span class="lineno">  634</span>                {</div>
<div class="line"><span class="lineno">  635</span>                    <span class="keywordtype">double</span> laplacian = 4.0*ls-&gt;weight * it-&gt;value;</div>
<div class="line"><span class="lineno">  636</span>                    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).add_laplacian_tmp(it-&gt;index, laplacian);</div>
<div class="line"><span class="lineno">  637</span>                }</div>
<div class="line"><span class="lineno">  638</span>            }</div>
<div class="line"><span class="lineno">  639</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> gs = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a1f560b94dd8685e5f84363d403c5d495">GStencil</a>.<a class="code hl_function" href="../../d0/da4/classopenphase_1_1GradientStencil.html#a5ec4dfe46d684d6597bf546e32943bed">cbegin</a>(); gs != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a1f560b94dd8685e5f84363d403c5d495">GStencil</a>.<a class="code hl_function" href="../../d0/da4/classopenphase_1_1GradientStencil.html#afc6c12d29aa0df36b80cfa9132919cc1">cend</a>(); ++gs)</div>
<div class="line"><span class="lineno">  640</span>            {</div>
<div class="line"><span class="lineno">  641</span>                <span class="keywordtype">int</span> ii = gs-&gt;di;</div>
<div class="line"><span class="lineno">  642</span>                <span class="keywordtype">int</span> jj = gs-&gt;dj;</div>
<div class="line"><span class="lineno">  643</span>                <span class="keywordtype">int</span> kk = gs-&gt;dk;</div>
<div class="line"><span class="lineno">  644</span> </div>
<div class="line"><span class="lineno">  645</span>                <span class="keywordflow">for</span> (<span class="keyword">auto</span> it  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i + ii, j + jj, k + kk).cbegin();</div>
<div class="line"><span class="lineno">  646</span>                          it != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i + ii, j + jj, k + kk).cend(); ++it)</div>
<div class="line"><span class="lineno">  647</span>                <span class="keywordflow">if</span> (it-&gt;value != 0.0)</div>
<div class="line"><span class="lineno">  648</span>                {</div>
<div class="line"><span class="lineno">  649</span>                    <span class="keywordtype">double</span> value_x = 2.0*gs-&gt;weightX * it-&gt;value;</div>
<div class="line"><span class="lineno">  650</span>                    <span class="keywordtype">double</span> value_y = 2.0*gs-&gt;weightY * it-&gt;value;</div>
<div class="line"><span class="lineno">  651</span>                    <span class="keywordtype">double</span> value_z = 2.0*gs-&gt;weightZ * it-&gt;value;</div>
<div class="line"><span class="lineno">  652</span>                    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).add_gradient_tmp(it-&gt;index, (dVector3){value_x,value_y,value_z});</div>
<div class="line"><span class="lineno">  653</span>                }</div>
<div class="line"><span class="lineno">  654</span>            }</div>
<div class="line"><span class="lineno">  655</span>        }</div>
<div class="line"><span class="lineno">  656</span>    }</div>
<div class="line"><span class="lineno">  657</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  658</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i, j, k, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.Bcells()-1,)</div>
<div class="line"><span class="lineno">  659</span>    {</div>
<div class="line"><span class="lineno">  660</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).wide_interface())</div>
<div class="line"><span class="lineno">  661</span>        {</div>
<div class="line"><span class="lineno">  662</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).copy_from_temporary();</div>
<div class="line"><span class="lineno">  663</span>        }</div>
<div class="line"><span class="lineno">  664</span>    }</div>
<div class="line"><span class="lineno">  665</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  666</span>}</div>
<div class="ttc" id="aMacros_8h_html_a62927f995b0bd1de2eba0c018173118a"><div class="ttname"><a href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a></div><div class="ttdeci">#define OMP_PARALLEL_STORAGE_LOOP_BEGIN(i, j, k, T__, op_loop_bcells__,...)</div><div class="ttdef"><b>Definition</b> <a href="../../df/d0a/Macros_8h_source.html#l00090">Macros.h:90</a></div></div>
<div class="ttc" id="aMacros_8h_html_aeb62b2001f34442764a83858492dcff3"><div class="ttname"><a href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div><div class="ttdeci">#define OMP_PARALLEL_STORAGE_LOOP_END</div><div class="ttdef"><b>Definition</b> <a href="../../df/d0a/Macros_8h_source.html#l00112">Macros.h:112</a></div></div>
<div class="ttc" id="aclassopenphase_1_1GradientStencil_html_a5ec4dfe46d684d6597bf546e32943bed"><div class="ttname"><a href="../../d0/da4/classopenphase_1_1GradientStencil.html#a5ec4dfe46d684d6597bf546e32943bed">openphase::GradientStencil::cbegin</a></div><div class="ttdeci">citerator cbegin() const</div><div class="ttdoc">Iterator to the end of stencil.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d3e/GradientStencil_8h_source.html#l00166">GradientStencil.h:166</a></div></div>
<div class="ttc" id="aclassopenphase_1_1GradientStencil_html_afc6c12d29aa0df36b80cfa9132919cc1"><div class="ttname"><a href="../../d0/da4/classopenphase_1_1GradientStencil.html#afc6c12d29aa0df36b80cfa9132919cc1">openphase::GradientStencil::cend</a></div><div class="ttdeci">citerator cend() const</div><div class="ttdoc">Constant iterator to the begin of stencil.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d3e/GradientStencil_8h_source.html#l00167">GradientStencil.h:167</a></div></div>
<div class="ttc" id="aclassopenphase_1_1LaplacianStencil_html_a343bd494c058f2d2541e4a08631f7619"><div class="ttname"><a href="../../d8/d86/classopenphase_1_1LaplacianStencil.html#a343bd494c058f2d2541e4a08631f7619">openphase::LaplacianStencil::cbegin</a></div><div class="ttdeci">citerator cbegin() const</div><div class="ttdoc">Iterator to the end of stencil.</div><div class="ttdef"><b>Definition</b> <a href="../../df/da2/LaplacianStencil_8h_source.html#l00230">LaplacianStencil.h:230</a></div></div>
<div class="ttc" id="aclassopenphase_1_1LaplacianStencil_html_a9f416dc378b9a7dd043eed7cb4a158a2"><div class="ttname"><a href="../../d8/d86/classopenphase_1_1LaplacianStencil.html#a9f416dc378b9a7dd043eed7cb4a158a2">openphase::LaplacianStencil::cend</a></div><div class="ttdeci">citerator cend() const</div><div class="ttdoc">Constant iterator to the begin of stencil.</div><div class="ttdef"><b>Definition</b> <a href="../../df/da2/LaplacianStencil_8h_source.html#l00231">LaplacianStencil.h:231</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a1f560b94dd8685e5f84363d403c5d495"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a1f560b94dd8685e5f84363d403c5d495">openphase::PhaseField::GStencil</a></div><div class="ttdeci">GradientStencil GStencil</div><div class="ttdoc">Gradient stencil. Uses user specified stencil as the basis.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc5/PhaseField_8h_source.html#l00247">PhaseField.h:247</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a4099b0db42d5fcbf908eafe2a338032e"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a4099b0db42d5fcbf908eafe2a338032e">openphase::PhaseField::LStencil</a></div><div class="ttdeci">LaplacianStencil LStencil</div><div class="ttdoc">Laplacian stencil. Uses user specified stencil as the basis.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc5/PhaseField_8h_source.html#l00246">PhaseField.h:246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad3f42764ad1f345dc1b1924a01a051f6" name="ad3f42764ad1f345dc1b1924a01a051f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3f42764ad1f345dc1b1924a01a051f6">&#9670;&#160;</a></span>CalculateDerivativesSR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::CalculateDerivativesSR </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates local phase-field derivatives. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l00566">566</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  567</span>{</div>
<div class="line"><span class="lineno">  568</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i, j, k, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>.Bcells()-1,)</div>
<div class="line"><span class="lineno">  569</span>    {</div>
<div class="line"><span class="lineno">  570</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).wide_interface())</div>
<div class="line"><span class="lineno">  571</span>        {</div>
<div class="line"><span class="lineno">  572</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).set_temporary();</div>
<div class="line"><span class="lineno">  573</span> </div>
<div class="line"><span class="lineno">  574</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> ls = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a4099b0db42d5fcbf908eafe2a338032e">LStencil</a>.<a class="code hl_function" href="../../d8/d86/classopenphase_1_1LaplacianStencil.html#a343bd494c058f2d2541e4a08631f7619">cbegin</a>(); ls != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a4099b0db42d5fcbf908eafe2a338032e">LStencil</a>.<a class="code hl_function" href="../../d8/d86/classopenphase_1_1LaplacianStencil.html#a9f416dc378b9a7dd043eed7cb4a158a2">cend</a>(); ls++)</div>
<div class="line"><span class="lineno">  575</span>            {</div>
<div class="line"><span class="lineno">  576</span>                <span class="keywordtype">int</span> ii = ls-&gt;di;</div>
<div class="line"><span class="lineno">  577</span>                <span class="keywordtype">int</span> jj = ls-&gt;dj;</div>
<div class="line"><span class="lineno">  578</span>                <span class="keywordtype">int</span> kk = ls-&gt;dk;</div>
<div class="line"><span class="lineno">  579</span> </div>
<div class="line"><span class="lineno">  580</span>                <span class="keywordflow">for</span> (<span class="keyword">auto</span> it  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i + ii, j + jj, k + kk).cbegin();</div>
<div class="line"><span class="lineno">  581</span>                          it != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i + ii, j + jj, k + kk).cend(); ++it)</div>
<div class="line"><span class="lineno">  582</span>                <span class="keywordflow">if</span> (it-&gt;value != 0.0)</div>
<div class="line"><span class="lineno">  583</span>                {</div>
<div class="line"><span class="lineno">  584</span>                    <span class="keywordtype">double</span> laplacian = ls-&gt;weight * it-&gt;value;</div>
<div class="line"><span class="lineno">  585</span>                    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).add_laplacian_tmp(it-&gt;index, laplacian);</div>
<div class="line"><span class="lineno">  586</span>                }</div>
<div class="line"><span class="lineno">  587</span>            }</div>
<div class="line"><span class="lineno">  588</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> gs = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a1f560b94dd8685e5f84363d403c5d495">GStencil</a>.<a class="code hl_function" href="../../d0/da4/classopenphase_1_1GradientStencil.html#a5ec4dfe46d684d6597bf546e32943bed">cbegin</a>(); gs != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a1f560b94dd8685e5f84363d403c5d495">GStencil</a>.<a class="code hl_function" href="../../d0/da4/classopenphase_1_1GradientStencil.html#afc6c12d29aa0df36b80cfa9132919cc1">cend</a>(); ++gs)</div>
<div class="line"><span class="lineno">  589</span>            {</div>
<div class="line"><span class="lineno">  590</span>                <span class="keywordtype">int</span> ii = gs-&gt;di;</div>
<div class="line"><span class="lineno">  591</span>                <span class="keywordtype">int</span> jj = gs-&gt;dj;</div>
<div class="line"><span class="lineno">  592</span>                <span class="keywordtype">int</span> kk = gs-&gt;dk;</div>
<div class="line"><span class="lineno">  593</span> </div>
<div class="line"><span class="lineno">  594</span>                <span class="keywordflow">for</span> (<span class="keyword">auto</span> it  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i + ii, j + jj, k + kk).cbegin();</div>
<div class="line"><span class="lineno">  595</span>                          it != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i + ii, j + jj, k + kk).cend(); ++it)</div>
<div class="line"><span class="lineno">  596</span>                <span class="keywordflow">if</span> (it-&gt;value != 0.0)</div>
<div class="line"><span class="lineno">  597</span>                {</div>
<div class="line"><span class="lineno">  598</span>                    <span class="keywordtype">double</span> value_x = gs-&gt;weightX * it-&gt;value;</div>
<div class="line"><span class="lineno">  599</span>                    <span class="keywordtype">double</span> value_y = gs-&gt;weightY * it-&gt;value;</div>
<div class="line"><span class="lineno">  600</span>                    <span class="keywordtype">double</span> value_z = gs-&gt;weightZ * it-&gt;value;</div>
<div class="line"><span class="lineno">  601</span>                    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).add_gradient_tmp(it-&gt;index, (dVector3){value_x,value_y,value_z});</div>
<div class="line"><span class="lineno">  602</span>                }</div>
<div class="line"><span class="lineno">  603</span>            }</div>
<div class="line"><span class="lineno">  604</span>        }</div>
<div class="line"><span class="lineno">  605</span>    }</div>
<div class="line"><span class="lineno">  606</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  607</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i, j, k, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>.Bcells()-1,)</div>
<div class="line"><span class="lineno">  608</span>    {</div>
<div class="line"><span class="lineno">  609</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).wide_interface())</div>
<div class="line"><span class="lineno">  610</span>        {</div>
<div class="line"><span class="lineno">  611</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).copy_from_temporary();</div>
<div class="line"><span class="lineno">  612</span>        }</div>
<div class="line"><span class="lineno">  613</span>    }</div>
<div class="line"><span class="lineno">  614</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  615</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a357ea817f60117eb924f107e77a482ef" name="a357ea817f60117eb924f107e77a482ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a357ea817f60117eb924f107e77a482ef">&#9670;&#160;</a></span>CalculateFractions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::CalculateFractions </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates phase fractions from phase-fields, populates Fractions storage. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l00411">411</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  412</span>{</div>
<div class="line"><span class="lineno">  413</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>.Bcells(),)</div>
<div class="line"><span class="lineno">  414</span>    {</div>
<div class="line"><span class="lineno">  415</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a784a4bea9a5379192bdf4f12ab12cf10">Fractions</a>(i,j,k).set_to_zero();</div>
<div class="line"><span class="lineno">  416</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> it  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno">  417</span>                  it != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cend(); ++it)</div>
<div class="line"><span class="lineno">  418</span>        {</div>
<div class="line"><span class="lineno">  419</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a784a4bea9a5379192bdf4f12ab12cf10">Fractions</a>(i,j,k,{<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[it-&gt;index].Phase}) += it-&gt;value;</div>
<div class="line"><span class="lineno">  420</span>        }</div>
<div class="line"><span class="lineno">  421</span>    }</div>
<div class="line"><span class="lineno">  422</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  423</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0d1ccd2f7e084a0539d7134fb0c15b7c" name="a0d1ccd2f7e084a0539d7134fb0c15b7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d1ccd2f7e084a0539d7134fb0c15b7c">&#9670;&#160;</a></span>CalculateGrainsVolume()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::CalculateGrainsVolume </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Collects volume for each phase field. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l00812">812</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  813</span>{</div>
<div class="line"><span class="lineno">  814</span>    <span class="keywordtype">int</span> Nthreads = 1;</div>
<div class="line"><span class="lineno">  815</span> </div>
<div class="line"><span class="lineno">  816</span><span class="preprocessor">    #ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  817</span>    Nthreads = <a class="code hl_function" href="../../d9/df1/Globals_8h.html#a84e35f14fe6cb1b6648be757446483e2">omp_get_max_threads</a>();</div>
<div class="line"><span class="lineno">  818</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  819</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> size = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>.<a class="code hl_function" href="../../d6/d90/classopenphase_1_1GrainsProperties.html#abb458316f62ad7fda8d902015e081e9c">size</a>();</div>
<div class="line"><span class="lineno">  820</span>    vector&lt;vector&lt;double&gt;&gt; Volume(Nthreads);</div>
<div class="line"><span class="lineno">  821</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> t = 0; t &lt; Nthreads; t++)</div>
<div class="line"><span class="lineno">  822</span>    {</div>
<div class="line"><span class="lineno">  823</span>        Volume[t].resize(size, 0.0);</div>
<div class="line"><span class="lineno">  824</span>    }</div>
<div class="line"><span class="lineno">  825</span>    <span class="comment">// Calculate volumes in each OpenMP chunk</span></div>
<div class="line"><span class="lineno">  826</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>,0,)</div>
<div class="line"><span class="lineno">  827</span>    {</div>
<div class="line"><span class="lineno">  828</span>        <span class="keywordtype">int</span> thread = 0;</div>
<div class="line"><span class="lineno">  829</span> </div>
<div class="line"><span class="lineno">  830</span><span class="preprocessor">        #ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  831</span>        thread = <a class="code hl_function" href="../../d9/df1/Globals_8h.html#aba06990768c6b572ca3f69029334a9df">omp_get_thread_num</a>();</div>
<div class="line"><span class="lineno">  832</span><span class="preprocessor">        #endif</span></div>
<div class="line"><span class="lineno">  833</span> </div>
<div class="line"><span class="lineno">  834</span>        <span class="keywordflow">for</span>(<span class="keyword">auto</span> it  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno">  835</span>                 it != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cend(); ++it)</div>
<div class="line"><span class="lineno">  836</span>        {</div>
<div class="line"><span class="lineno">  837</span>            Volume[thread][it-&gt;index] += it-&gt;value;</div>
<div class="line"><span class="lineno">  838</span>        }</div>
<div class="line"><span class="lineno">  839</span>    }</div>
<div class="line"><span class="lineno">  840</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  841</span> </div>
<div class="line"><span class="lineno">  842</span>    <span class="comment">// Add volumes from different OpenMP chunks</span></div>
<div class="line"><span class="lineno">  843</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> idx = 0; idx &lt; size; idx++)</div>
<div class="line"><span class="lineno">  844</span>    {</div>
<div class="line"><span class="lineno">  845</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].Volume = 0.0;</div>
<div class="line"><span class="lineno">  846</span> </div>
<div class="line"><span class="lineno">  847</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> t = 0; t &lt; Nthreads; t++)</div>
<div class="line"><span class="lineno">  848</span>        {</div>
<div class="line"><span class="lineno">  849</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].Volume += Volume[t][idx];</div>
<div class="line"><span class="lineno">  850</span>        }</div>
<div class="line"><span class="lineno">  851</span>    }</div>
<div class="line"><span class="lineno">  852</span> </div>
<div class="line"><span class="lineno">  853</span>    <span class="comment">// Update FieldsProperties across MPI domains</span></div>
<div class="line"><span class="lineno">  854</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno">  855</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> loc_size = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>.<a class="code hl_function" href="../../d6/d90/classopenphase_1_1GrainsProperties.html#abb458316f62ad7fda8d902015e081e9c">size</a>();</div>
<div class="line"><span class="lineno">  856</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> max_size = loc_size;</div>
<div class="line"><span class="lineno">  857</span> </div>
<div class="line"><span class="lineno">  858</span>    OP_MPI_Allreduce(OP_MPI_IN_PLACE, &amp;max_size, 1, OP_MPI_UNSIGNED_LONG, OP_MPI_MAX, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  859</span>    <span class="keywordflow">if</span> (max_size &gt; loc_size)</div>
<div class="line"><span class="lineno">  860</span>    {</div>
<div class="line"><span class="lineno">  861</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>.<a class="code hl_function" href="../../d6/d90/classopenphase_1_1GrainsProperties.html#a962122738fa802f94bf93b38183b0595">Resize</a>(max_size);</div>
<div class="line"><span class="lineno">  862</span>    }</div>
<div class="line"><span class="lineno">  863</span> </div>
<div class="line"><span class="lineno">  864</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> idx = 0; idx &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>.<a class="code hl_function" href="../../d6/d90/classopenphase_1_1GrainsProperties.html#abb458316f62ad7fda8d902015e081e9c">size</a>(); idx++)</div>
<div class="line"><span class="lineno">  865</span>    {</div>
<div class="line"><span class="lineno">  866</span>        <span class="keywordtype">double</span> loc_volume = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].Volume;</div>
<div class="line"><span class="lineno">  867</span>        OP_MPI_Allreduce(OP_MPI_IN_PLACE, &amp;loc_volume, 1, OP_MPI_DOUBLE, OP_MPI_SUM, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  868</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].Volume = loc_volume;</div>
<div class="line"><span class="lineno">  869</span> </div>
<div class="line"><span class="lineno">  870</span>        <span class="keywordtype">double</span> loc_maxvolume = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].MAXVolume;</div>
<div class="line"><span class="lineno">  871</span>        OP_MPI_Allreduce(OP_MPI_IN_PLACE, &amp;loc_maxvolume, 1, OP_MPI_DOUBLE, OP_MPI_MAX, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  872</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].MAXVolume = loc_maxvolume;</div>
<div class="line"><span class="lineno">  873</span> </div>
<div class="line"><span class="lineno">  874</span>        <span class="keywordtype">double</span> loc_refvolume = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].RefVolume;</div>
<div class="line"><span class="lineno">  875</span>        OP_MPI_Allreduce(OP_MPI_IN_PLACE, &amp;loc_refvolume, 1, OP_MPI_DOUBLE, OP_MPI_MAX, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  876</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].RefVolume = loc_refvolume;</div>
<div class="line"><span class="lineno">  877</span> </div>
<div class="line"><span class="lineno">  878</span>        <span class="keywordtype">int</span> loc_stage = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].Stage);</div>
<div class="line"><span class="lineno">  879</span>        OP_MPI_Allreduce(OP_MPI_IN_PLACE, &amp;loc_stage, 1, OP_MPI_INT, OP_MPI_MAX, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  880</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].Stage = <span class="keyword">static_cast&lt;</span><a class="code hl_enumeration" href="../../d0/d6c/namespaceopenphase.html#af71cd9b36fd77e1eb90f17b95c04e52e">openphase::GrainStages</a><span class="keyword">&gt;</span>(loc_stage);</div>
<div class="line"><span class="lineno">  881</span> </div>
<div class="line"><span class="lineno">  882</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> loc_variant = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].Variant;</div>
<div class="line"><span class="lineno">  883</span>        OP_MPI_Allreduce(OP_MPI_IN_PLACE, &amp;loc_variant, 1, OP_MPI_UNSIGNED_LONG, OP_MPI_MAX, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  884</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].Variant = loc_variant;</div>
<div class="line"><span class="lineno">  885</span> </div>
<div class="line"><span class="lineno">  886</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> loc_phase = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].Phase;</div>
<div class="line"><span class="lineno">  887</span>        OP_MPI_Allreduce(OP_MPI_IN_PLACE, &amp;loc_phase, 1, OP_MPI_UNSIGNED_LONG, OP_MPI_MAX, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  888</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].Phase = loc_phase;</div>
<div class="line"><span class="lineno">  889</span> </div>
<div class="line"><span class="lineno">  890</span>        <span class="comment">//TODO: add other missing reductions</span></div>
<div class="line"><span class="lineno">  891</span>    }</div>
<div class="line"><span class="lineno">  892</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  893</span> </div>
<div class="line"><span class="lineno">  894</span>    <span class="comment">// Calculate MAXVolume and VolumeRatio for all phase fields</span></div>
<div class="line"><span class="lineno">  895</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> idx = 0; idx &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>.<a class="code hl_function" href="../../d6/d90/classopenphase_1_1GrainsProperties.html#abb458316f62ad7fda8d902015e081e9c">size</a>(); idx++)</div>
<div class="line"><span class="lineno">  896</span>    {</div>
<div class="line"><span class="lineno">  897</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].MAXVolume = <a class="code hl_function" href="../../d1/d21/namespaceopenphase_1_1SystemOfLinearEquationsSolvers.html#a3c9fdec2355fde577142bf782e7c581c">max</a>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].Volume,</div>
<div class="line"><span class="lineno">  898</span>                                              <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].MAXVolume);</div>
<div class="line"><span class="lineno">  899</span> </div>
<div class="line"><span class="lineno">  900</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].VolumeRatio = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].MAXVolume/</div>
<div class="line"><span class="lineno">  901</span>                                            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].RefVolume;</div>
<div class="line"><span class="lineno">  902</span>    }</div>
<div class="line"><span class="lineno">  903</span> </div>
<div class="line"><span class="lineno">  904</span>    <span class="comment">// Update statistics based on actual grains volume</span></div>
<div class="line"><span class="lineno">  905</span>    <span class="keywordtype">int</span> NumberOfNuclei = 0;</div>
<div class="line"><span class="lineno">  906</span> </div>
<div class="line"><span class="lineno">  907</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> idx = 0; idx &lt; size; idx++)</div>
<div class="line"><span class="lineno">  908</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].Exist and <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].Volume &lt;= 0.0)</div>
<div class="line"><span class="lineno">  909</span>    {</div>
<div class="line"><span class="lineno">  910</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].Exist  = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  911</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].Stage  = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#af71cd9b36fd77e1eb90f17b95c04e52eafa3aff3c185c6dc7754235f397c2099a">GrainStages::Stable</a>;</div>
<div class="line"><span class="lineno">  912</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].Volume = 0.0;</div>
<div class="line"><span class="lineno">  913</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].MAXVolume = 0.0;</div>
<div class="line"><span class="lineno">  914</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].VolumeRatio = 1.0;</div>
<div class="line"><span class="lineno">  915</span>    }</div>
<div class="line"><span class="lineno">  916</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].Volume &gt; 0.0)</div>
<div class="line"><span class="lineno">  917</span>    {</div>
<div class="line"><span class="lineno">  918</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].Exist = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  919</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].Stage == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#af71cd9b36fd77e1eb90f17b95c04e52eadba005190e58b252f9b5375cdf5655d9">GrainStages::Seed</a>)</div>
<div class="line"><span class="lineno">  920</span>        {</div>
<div class="line"><span class="lineno">  921</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].Stage = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#af71cd9b36fd77e1eb90f17b95c04e52eae0cbf1349b31b63d275d963e611b54c3">GrainStages::Nucleus</a>;</div>
<div class="line"><span class="lineno">  922</span>        }</div>
<div class="line"><span class="lineno">  923</span> </div>
<div class="line"><span class="lineno">  924</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].VolumeRatio &gt; 1.0)</div>
<div class="line"><span class="lineno">  925</span>        {</div>
<div class="line"><span class="lineno">  926</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].Stage = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#af71cd9b36fd77e1eb90f17b95c04e52eafa3aff3c185c6dc7754235f397c2099a">GrainStages::Stable</a>;</div>
<div class="line"><span class="lineno">  927</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].VolumeRatio = 1.0;</div>
<div class="line"><span class="lineno">  928</span>        }</div>
<div class="line"><span class="lineno">  929</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].Stage != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#af71cd9b36fd77e1eb90f17b95c04e52eafa3aff3c185c6dc7754235f397c2099a">GrainStages::Stable</a>)</div>
<div class="line"><span class="lineno">  930</span>        {</div>
<div class="line"><span class="lineno">  931</span>            NumberOfNuclei ++;</div>
<div class="line"><span class="lineno">  932</span>        }</div>
<div class="line"><span class="lineno">  933</span>    }</div>
<div class="line"><span class="lineno">  934</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a80736ea4892c99f7a189d1138252be4b">NucleationPresent</a> = (NumberOfNuclei &gt; 0);</div>
<div class="line"><span class="lineno">  935</span> </div>
<div class="line"><span class="lineno">  936</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a>; n++)</div>
<div class="line"><span class="lineno">  937</span>    {</div>
<div class="line"><span class="lineno">  938</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7f11e6f1f190ef9bb7e6c6013ec03101">FractionsTotal</a>[n] = 0.0;</div>
<div class="line"><span class="lineno">  939</span>    }</div>
<div class="line"><span class="lineno">  940</span> </div>
<div class="line"><span class="lineno">  941</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> idx = 0; idx &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>.<a class="code hl_function" href="../../d6/d90/classopenphase_1_1GrainsProperties.html#abb458316f62ad7fda8d902015e081e9c">size</a>(); idx++)</div>
<div class="line"><span class="lineno">  942</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].Exist)</div>
<div class="line"><span class="lineno">  943</span>    {</div>
<div class="line"><span class="lineno">  944</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7f11e6f1f190ef9bb7e6c6013ec03101">FractionsTotal</a>[<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].Phase] += <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].Volume;</div>
<div class="line"><span class="lineno">  945</span>    }</div>
<div class="line"><span class="lineno">  946</span> </div>
<div class="line"><span class="lineno">  947</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a>; n++)</div>
<div class="line"><span class="lineno">  948</span>    {</div>
<div class="line"><span class="lineno">  949</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7f11e6f1f190ef9bb7e6c6013ec03101">FractionsTotal</a>[n] /= double(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_function" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6e23bc9f72a10111916898b3641a8162">TotalNumberOfCells</a>());</div>
<div class="line"><span class="lineno">  950</span>    }</div>
<div class="line"><span class="lineno">  951</span>}</div>
<div class="ttc" id="aGlobals_8h_html_a84e35f14fe6cb1b6648be757446483e2"><div class="ttname"><a href="../../d9/df1/Globals_8h.html#a84e35f14fe6cb1b6648be757446483e2">omp_get_max_threads</a></div><div class="ttdeci">int omp_get_max_threads()</div><div class="ttdef"><b>Definition</b> <a href="../../d9/df1/Globals_8h_source.html#l00041">Globals.h:41</a></div></div>
<div class="ttc" id="aGlobals_8h_html_aba06990768c6b572ca3f69029334a9df"><div class="ttname"><a href="../../d9/df1/Globals_8h.html#aba06990768c6b572ca3f69029334a9df">omp_get_thread_num</a></div><div class="ttdeci">int omp_get_thread_num()</div><div class="ttdef"><b>Definition</b> <a href="../../d9/df1/Globals_8h_source.html#l00045">Globals.h:45</a></div></div>
<div class="ttc" id="aclassopenphase_1_1GrainsProperties_html_a962122738fa802f94bf93b38183b0595"><div class="ttname"><a href="../../d6/d90/classopenphase_1_1GrainsProperties.html#a962122738fa802f94bf93b38183b0595">openphase::GrainsProperties::Resize</a></div><div class="ttdeci">void Resize(const size_t size)</div><div class="ttdef"><b>Definition</b> <a href="../../da/dab/GrainsProperties_8h_source.html#l00425">GrainsProperties.h:425</a></div></div>
<div class="ttc" id="aclassopenphase_1_1GrainsProperties_html_abb458316f62ad7fda8d902015e081e9c"><div class="ttname"><a href="../../d6/d90/classopenphase_1_1GrainsProperties.html#abb458316f62ad7fda8d902015e081e9c">openphase::GrainsProperties::size</a></div><div class="ttdeci">size_t size() const</div><div class="ttdef"><b>Definition</b> <a href="../../da/dab/GrainsProperties_8h_source.html#l00449">GrainsProperties.h:449</a></div></div>
<div class="ttc" id="aclassopenphase_1_1GridParameters_html_a6e23bc9f72a10111916898b3641a8162"><div class="ttname"><a href="../../dc/d18/classopenphase_1_1GridParameters.html#a6e23bc9f72a10111916898b3641a8162">openphase::GridParameters::TotalNumberOfCells</a></div><div class="ttdeci">long int TotalNumberOfCells(void) const</div><div class="ttdoc">&lt; Number of grid cells in the entire simulation domain</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d68/GridParameters_8h_source.html#l00075">GridParameters.h:75</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a80736ea4892c99f7a189d1138252be4b"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a80736ea4892c99f7a189d1138252be4b">openphase::PhaseField::NucleationPresent</a></div><div class="ttdeci">bool NucleationPresent</div><div class="ttdoc">True if there are nuclei of any phase, false otherwise.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc5/PhaseField_8h_source.html#l00243">PhaseField.h:243</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_af71cd9b36fd77e1eb90f17b95c04e52e"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#af71cd9b36fd77e1eb90f17b95c04e52e">openphase::GrainStages</a></div><div class="ttdeci">GrainStages</div><div class="ttdef"><b>Definition</b> <a href="../../da/dab/GrainsProperties_8h_source.html#l00037">GrainsProperties.h:38</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_af71cd9b36fd77e1eb90f17b95c04e52eadba005190e58b252f9b5375cdf5655d9"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#af71cd9b36fd77e1eb90f17b95c04e52eadba005190e58b252f9b5375cdf5655d9">openphase::GrainStages::Seed</a></div><div class="ttdeci">@ Seed</div><div class="ttdoc">The state when the grain seed is just planted.</div></div>
<div class="ttc" id="anamespaceopenphase_html_af71cd9b36fd77e1eb90f17b95c04e52eae0cbf1349b31b63d275d963e611b54c3"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#af71cd9b36fd77e1eb90f17b95c04e52eae0cbf1349b31b63d275d963e611b54c3">openphase::GrainStages::Nucleus</a></div><div class="ttdeci">@ Nucleus</div><div class="ttdoc">The state when the grain seed started to grow but not yet overcome the critical size.</div></div>
<div class="ttc" id="anamespaceopenphase_html_af71cd9b36fd77e1eb90f17b95c04e52eafa3aff3c185c6dc7754235f397c2099a"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#af71cd9b36fd77e1eb90f17b95c04e52eafa3aff3c185c6dc7754235f397c2099a">openphase::GrainStages::Stable</a></div><div class="ttdeci">@ Stable</div><div class="ttdoc">The state of a stable grain (above critical size)</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af493fd0af6996f16f26a78732d3c3f04" name="af493fd0af6996f16f26a78732d3c3f04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af493fd0af6996f16f26a78732d3c3f04">&#9670;&#160;</a></span>CalculateNewFractions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d2/d51/classopenphase_1_1Tensor.html">Tensor</a>&lt; double, 1 &gt; openphase::PhaseField::CalculateNewFractions </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d51/classopenphase_1_1Tensor.html">Tensor</a>&lt; double, 1 &gt;&#160;</td>
          <td class="paramname"><em>oldFractions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/dc0/classopenphase_1_1NodeAB.html">NodeAB</a>&lt; double, double &gt; &amp;&#160;</td>
          <td class="paramname"><em>FieldsDot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>locdt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates new thermodynamic phase fractions as if Phi.MergeIncrements would have been applied. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03713">3713</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3716</span>{</div>
<div class="line"><span class="lineno"> 3717</span>    Tensor&lt;double,1&gt; newFractions = oldFractions;</div>
<div class="line"><span class="lineno"> 3718</span>    <span class="keywordflow">for</span>(<span class="keyword">auto</span> it = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>.begin(); it != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>.end(); ++it)</div>
<div class="line"><span class="lineno"> 3719</span>    {</div>
<div class="line"><span class="lineno"> 3720</span>        <span class="keywordtype">size_t</span> pIndexA = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[it-&gt;indexA].Phase;                    <span class="comment">// Index of thermodynamic phase alpha in the phase pair alpha-beta</span></div>
<div class="line"><span class="lineno"> 3721</span>        <span class="keywordtype">size_t</span> pIndexB = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[it-&gt;indexB].Phase;                    <span class="comment">// Index of thermodynamic phase beta in the phase pair alpha-beta</span></div>
<div class="line"><span class="lineno"> 3722</span>        <span class="keywordflow">if</span>(pIndexA != pIndexB)</div>
<div class="line"><span class="lineno"> 3723</span>        {</div>
<div class="line"><span class="lineno"> 3724</span>            newFractions({pIndexA}) += it-&gt;value1*locdt;</div>
<div class="line"><span class="lineno"> 3725</span>            newFractions({pIndexB}) -= it-&gt;value1*locdt;</div>
<div class="line"><span class="lineno"> 3726</span>        }</div>
<div class="line"><span class="lineno"> 3727</span>    }</div>
<div class="line"><span class="lineno"> 3728</span>    <span class="keywordflow">return</span> newFractions;</div>
<div class="line"><span class="lineno"> 3729</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9e5b8a08920660a502ce1ce80bf8372c" name="a9e5b8a08920660a502ce1ce80bf8372c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e5b8a08920660a502ce1ce80bf8372c">&#9670;&#160;</a></span>CalculatePsi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d2/d51/classopenphase_1_1Tensor.html">Tensor</a>&lt; double, 2 &gt; openphase::PhaseField::CalculatePsi </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/dc0/classopenphase_1_1NodeAB.html">NodeAB</a>&lt; double, double &gt; &amp;&#160;</td>
          <td class="paramname"><em>FieldsDot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>locdt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates Phi.FieldsDot for thermodynamic phases. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03731">3731</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3732</span>{</div>
<div class="line"><span class="lineno"> 3733</span>    Tensor&lt;double,2&gt; Psi({<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a>,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a>});</div>
<div class="line"><span class="lineno"> 3734</span>    Psi.set_to_zero();</div>
<div class="line"><span class="lineno"> 3735</span>    <span class="keywordflow">for</span>(<span class="keyword">auto</span> it = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>.begin(); it != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>.end(); ++it)</div>
<div class="line"><span class="lineno"> 3736</span>    {</div>
<div class="line"><span class="lineno"> 3737</span>        <span class="keywordtype">size_t</span> pIndexA = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[it-&gt;indexA].Phase;                    <span class="comment">// Index of thermodynamic phase alpha in the phase pair alpha-beta</span></div>
<div class="line"><span class="lineno"> 3738</span>        <span class="keywordtype">size_t</span> pIndexB = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[it-&gt;indexB].Phase;                    <span class="comment">// Index of thermodynamic phase beta in the phase pair alpha-beta</span></div>
<div class="line"><span class="lineno"> 3739</span>        <span class="keywordflow">if</span>(pIndexA != pIndexB)</div>
<div class="line"><span class="lineno"> 3740</span>        {</div>
<div class="line"><span class="lineno"> 3741</span>            Psi({pIndexA,pIndexB}) += it-&gt;value1*locdt;</div>
<div class="line"><span class="lineno"> 3742</span>            Psi({pIndexB,pIndexA}) -= it-&gt;value1*locdt;</div>
<div class="line"><span class="lineno"> 3743</span>        }</div>
<div class="line"><span class="lineno"> 3744</span>    }</div>
<div class="line"><span class="lineno"> 3745</span>    <span class="keywordflow">return</span> Psi;</div>
<div class="line"><span class="lineno"> 3746</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3a500b45060139b7e51d305fb90c46e4" name="a3a500b45060139b7e51d305fb90c46e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a500b45060139b7e51d305fb90c46e4">&#9670;&#160;</a></span>CalculateReferenceVolume()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::PhaseField::CalculateReferenceVolume </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates reference volume (RefVolume) for nucleation. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l00367">367</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  368</span>{</div>
<div class="line"><span class="lineno">  369</span>    <span class="keywordtype">double</span> ref_volume = 0.0;</div>
<div class="line"><span class="lineno">  370</span> </div>
<div class="line"><span class="lineno">  371</span>    <span class="keywordflow">switch</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_function" href="../../dc/d18/classopenphase_1_1GridParameters.html#a70ddf5c25482d7cdefe67b0d25dcd258">Active</a>())</div>
<div class="line"><span class="lineno">  372</span>    {</div>
<div class="line"><span class="lineno">  373</span>        <span class="keywordflow">case</span> 1:</div>
<div class="line"><span class="lineno">  374</span>        {</div>
<div class="line"><span class="lineno">  375</span>            ref_volume = radius;</div>
<div class="line"><span class="lineno">  376</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  377</span>        }</div>
<div class="line"><span class="lineno">  378</span>        <span class="keywordflow">case</span> 2:</div>
<div class="line"><span class="lineno">  379</span>        {</div>
<div class="line"><span class="lineno">  380</span>            ref_volume = <a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>*radius*radius;</div>
<div class="line"><span class="lineno">  381</span> </div>
<div class="line"><span class="lineno">  382</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  383</span>        }</div>
<div class="line"><span class="lineno">  384</span>        <span class="keywordflow">case</span> 3:</div>
<div class="line"><span class="lineno">  385</span>        {</div>
<div class="line"><span class="lineno">  386</span>            ref_volume = (4.0/3.0)*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>*radius*radius*radius;</div>
<div class="line"><span class="lineno">  387</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  388</span>        }</div>
<div class="line"><span class="lineno">  389</span>    }</div>
<div class="line"><span class="lineno">  390</span>    <span class="keywordflow">return</span> ref_volume*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a2f76b712f5418522f474928d17f453ef">NucleusVolumeFactor</a>;</div>
<div class="line"><span class="lineno">  391</span>}</div>
<div class="ttc" id="aclassopenphase_1_1GridParameters_html_a70ddf5c25482d7cdefe67b0d25dcd258"><div class="ttname"><a href="../../dc/d18/classopenphase_1_1GridParameters.html#a70ddf5c25482d7cdefe67b0d25dcd258">openphase::GridParameters::Active</a></div><div class="ttdeci">int Active(void) const</div><div class="ttdoc">&lt; Indicates dimensionality, e.g. 1D, 2D or 3D</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d68/GridParameters_8h_source.html#l00060">GridParameters.h:60</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a2f76b712f5418522f474928d17f453ef"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a2f76b712f5418522f474928d17f453ef">openphase::PhaseField::NucleusVolumeFactor</a></div><div class="ttdeci">double NucleusVolumeFactor</div><div class="ttdoc">Scales the critical nucleus volume.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc5/PhaseField_8h_source.html#l00230">PhaseField.h:230</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_a2c26ef9422df111d9487d3d34cf3d613"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">openphase::Pi</a></div><div class="ttdeci">static constexpr double Pi</div><div class="ttdoc">Pi constant value.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/df1/Globals_8h_source.html#l00124">Globals.h:124</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a815c29d3999f1fe26ed62b27bff4c019" name="a815c29d3999f1fe26ed62b27bff4c019"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a815c29d3999f1fe26ed62b27bff4c019">&#9670;&#160;</a></span>CalculateSolidMass()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::PhaseField::CalculateSolidMass </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates and returns SolidMass. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03881">3881</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3882</span>{</div>
<div class="line"><span class="lineno"> 3883</span>    <span class="keywordtype">double</span> locSolidMass = 0.0;</div>
<div class="line"><span class="lineno"> 3884</span> </div>
<div class="line"><span class="lineno"> 3885</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>,0,reduction(+:locSolidMass))</div>
<div class="line"><span class="lineno"> 3886</span>    {</div>
<div class="line"><span class="lineno"> 3887</span>        locSolidMass += <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a007421c86ce87f496fa4658e62d1f777">SolidMassDensity</a>(i,j,k);</div>
<div class="line"><span class="lineno"> 3888</span>    }</div>
<div class="line"><span class="lineno"> 3889</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 3890</span> </div>
<div class="line"><span class="lineno"> 3891</span>    <span class="keywordtype">double</span> SolidMass = locSolidMass;</div>
<div class="line"><span class="lineno"> 3892</span><span class="preprocessor">    #ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 3893</span>    OP_MPI_Allreduce(&amp;locSolidMass, &amp;(SolidMass), 1, OP_MPI_DOUBLE, OP_MPI_SUM, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 3894</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno"> 3895</span> </div>
<div class="line"><span class="lineno"> 3896</span>    SolidMass *= <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_function" href="../../dc/d18/classopenphase_1_1GridParameters.html#a9e96c156b3c12ba0bb402d5188dbf1c6">CellVolume</a>();</div>
<div class="line"><span class="lineno"> 3897</span>    <span class="keywordflow">return</span> SolidMass;</div>
<div class="line"><span class="lineno"> 3898</span>}</div>
<div class="ttc" id="aclassopenphase_1_1GridParameters_html_a9e96c156b3c12ba0bb402d5188dbf1c6"><div class="ttname"><a href="../../dc/d18/classopenphase_1_1GridParameters.html#a9e96c156b3c12ba0bb402d5188dbf1c6">openphase::GridParameters::CellVolume</a></div><div class="ttdeci">double CellVolume(bool ignore_active_dimensions=false) const</div><div class="ttdoc">&lt; Volume in 3D, area in 2D and length in 1D of a single grid cell unless ignore_active_dimensions == ...</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d68/GridParameters_8h_source.html#l00085">GridParameters.h:85</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a007421c86ce87f496fa4658e62d1f777"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a007421c86ce87f496fa4658e62d1f777">openphase::PhaseField::SolidMassDensity</a></div><div class="ttdeci">double SolidMassDensity(const int i, const int j, const int k) const</div><div class="ttdoc">Returns local solid mass density.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l03870">PhaseField.cpp:3870</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2503f8f70079ecf3f7899a1458acb6fc" name="a2503f8f70079ecf3f7899a1458acb6fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2503f8f70079ecf3f7899a1458acb6fc">&#9670;&#160;</a></span>Clear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::Clear </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clears the phase field storage. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l00393">393</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  394</span>{</div>
<div class="line"><span class="lineno">  395</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>.Bcells(),)</div>
<div class="line"><span class="lineno">  396</span>    {</div>
<div class="line"><span class="lineno">  397</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).clear();</div>
<div class="line"><span class="lineno">  398</span>    }</div>
<div class="line"><span class="lineno">  399</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  400</span> </div>
<div class="line"><span class="lineno">  401</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#af0b28822d6a3aba3df4db780b51db71a">Resolution</a> == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>)</div>
<div class="line"><span class="lineno">  402</span>    {</div>
<div class="line"><span class="lineno">  403</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.Bcells(),)</div>
<div class="line"><span class="lineno">  404</span>        {</div>
<div class="line"><span class="lineno">  405</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).clear();</div>
<div class="line"><span class="lineno">  406</span>        }</div>
<div class="line"><span class="lineno">  407</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  408</span>    }</div>
<div class="line"><span class="lineno">  409</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a83a0ea555927327924b0b5eda16537f4" name="a83a0ea555927327924b0b5eda16537f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83a0ea555927327924b0b5eda16537f4">&#9670;&#160;</a></span>ClearGrainsForcesAndAccelerations()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::ClearGrainsForcesAndAccelerations </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/dc5/PhaseField_8h_source.html#l00097">97</a> of file <a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   98</span>    {</div>
<div class="line"><span class="lineno">   99</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> pIdx = 0ul; pIdx &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>.<a class="code hl_function" href="../../d6/d90/classopenphase_1_1GrainsProperties.html#abb458316f62ad7fda8d902015e081e9c">size</a>(); pIdx++)</div>
<div class="line"><span class="lineno">  100</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[pIdx].Exist)</div>
<div class="line"><span class="lineno">  101</span>        {</div>
<div class="line"><span class="lineno">  102</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[pIdx].ClearForcesAndAccelerations();</div>
<div class="line"><span class="lineno">  103</span>        }</div>
<div class="line"><span class="lineno">  104</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a958b5b2d6aa752eab13281f17f43ff7b" name="a958b5b2d6aa752eab13281f17f43ff7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a958b5b2d6aa752eab13281f17f43ff7b">&#9670;&#160;</a></span>Coarsen()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::Coarsen </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates single resolution phase-fields from the double resolution ones. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l01096">1096</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1097</span>{</div>
<div class="line"><span class="lineno"> 1098</span>    <span class="keywordtype">double</span> norm = 1.0/pow(2.0,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_function" href="../../dc/d18/classopenphase_1_1GridParameters.html#a70ddf5c25482d7cdefe67b0d25dcd258">Active</a>());</div>
<div class="line"><span class="lineno"> 1099</span>    <span class="keywordtype">long</span> <span class="keywordtype">int</span> fx = 1 + <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>;</div>
<div class="line"><span class="lineno"> 1100</span>    <span class="keywordtype">long</span> <span class="keywordtype">int</span> fy = 1 + <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>;</div>
<div class="line"><span class="lineno"> 1101</span>    <span class="keywordtype">long</span> <span class="keywordtype">int</span> fz = 1 + <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>;</div>
<div class="line"><span class="lineno"> 1102</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>,0,)</div>
<div class="line"><span class="lineno"> 1103</span>    {</div>
<div class="line"><span class="lineno"> 1104</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).wide_interface())</div>
<div class="line"><span class="lineno"> 1105</span>        {</div>
<div class="line"><span class="lineno"> 1106</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).clear();</div>
<div class="line"><span class="lineno"> 1107</span> </div>
<div class="line"><span class="lineno"> 1108</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> di = -<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; di &lt;= <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; di+=2)</div>
<div class="line"><span class="lineno"> 1109</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> dj = -<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; dj &lt;= <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; dj+=2)</div>
<div class="line"><span class="lineno"> 1110</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> dk = -<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; dk &lt;= <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; dk+=2)</div>
<div class="line"><span class="lineno"> 1111</span>            {</div>
<div class="line"><span class="lineno"> 1112</span>                <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k) += <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(fx*i+(di+1)/2,fy*j+(dj+1)/2,fz*k+(dk+1)/2);</div>
<div class="line"><span class="lineno"> 1113</span>            }</div>
<div class="line"><span class="lineno"> 1114</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k) *= norm;</div>
<div class="line"><span class="lineno"> 1115</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).finalize();</div>
<div class="line"><span class="lineno"> 1116</span>        }</div>
<div class="line"><span class="lineno"> 1117</span>    }</div>
<div class="line"><span class="lineno"> 1118</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1119</span>}</div>
<div class="ttc" id="aclassopenphase_1_1GridParameters_html_a439e45fff271a1abab42efa02e9e3f1e"><div class="ttname"><a href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">openphase::GridParameters::dNz</a></div><div class="ttdeci">int dNz</div><div class="ttdoc">Stencil step in Z direction for reduced dimensions simulations.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d68/GridParameters_8h_source.html#l00146">GridParameters.h:146</a></div></div>
<div class="ttc" id="aclassopenphase_1_1GridParameters_html_ab1b588e300d68e6b4ae6307136a11b18"><div class="ttname"><a href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">openphase::GridParameters::dNx</a></div><div class="ttdeci">int dNx</div><div class="ttdoc">Stencil step in X direction for reduced dimensions simulations.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d68/GridParameters_8h_source.html#l00144">GridParameters.h:144</a></div></div>
<div class="ttc" id="aclassopenphase_1_1GridParameters_html_afa4d2acbf1237f1a1e3ca3511aed10fc"><div class="ttname"><a href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">openphase::GridParameters::dNy</a></div><div class="ttdeci">int dNy</div><div class="ttdoc">Stencil step in Y direction for reduced dimensions simulations.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d68/GridParameters_8h_source.html#l00145">GridParameters.h:145</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a30af10b1105bdbb7355613a312a41f1e" name="a30af10b1105bdbb7355613a312a41f1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30af10b1105bdbb7355613a312a41f1e">&#9670;&#160;</a></span>CoarsenDot()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::CoarsenDot </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates single resolution phase-field increments from the double resolution ones. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l01121">1121</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1122</span>{</div>
<div class="line"><span class="lineno"> 1123</span>    <span class="keywordtype">double</span> norm = 1.0/pow(2.0,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_function" href="../../dc/d18/classopenphase_1_1GridParameters.html#a70ddf5c25482d7cdefe67b0d25dcd258">Active</a>());</div>
<div class="line"><span class="lineno"> 1124</span>    <span class="keywordtype">long</span> <span class="keywordtype">int</span> fx = 1 + <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>;</div>
<div class="line"><span class="lineno"> 1125</span>    <span class="keywordtype">long</span> <span class="keywordtype">int</span> fy = 1 + <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>;</div>
<div class="line"><span class="lineno"> 1126</span>    <span class="keywordtype">long</span> <span class="keywordtype">int</span> fz = 1 + <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>;</div>
<div class="line"><span class="lineno"> 1127</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>,0,)</div>
<div class="line"><span class="lineno"> 1128</span>    {</div>
<div class="line"><span class="lineno"> 1129</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).wide_interface())</div>
<div class="line"><span class="lineno"> 1130</span>        {</div>
<div class="line"><span class="lineno"> 1131</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).clear();</div>
<div class="line"><span class="lineno"> 1132</span> </div>
<div class="line"><span class="lineno"> 1133</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> di = -<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; di &lt;= <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; di+=2)</div>
<div class="line"><span class="lineno"> 1134</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> dj = -<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; dj &lt;= <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; dj+=2)</div>
<div class="line"><span class="lineno"> 1135</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> dk = -<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; dk &lt;= <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; dk+=2)</div>
<div class="line"><span class="lineno"> 1136</span>            {</div>
<div class="line"><span class="lineno"> 1137</span>                <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).add_asym_pairs(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>(fx*i+(di+1)/2,fy*j+(dj+1)/2,fz*k+(dk+1)/2));</div>
<div class="line"><span class="lineno"> 1138</span>            }</div>
<div class="line"><span class="lineno"> 1139</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k) *= norm;</div>
<div class="line"><span class="lineno"> 1140</span>        }</div>
<div class="line"><span class="lineno"> 1141</span>    }</div>
<div class="line"><span class="lineno"> 1142</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1143</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aabfe5a389c721d7146e5b9a9bf4ff05e" name="aabfe5a389c721d7146e5b9a9bf4ff05e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabfe5a389c721d7146e5b9a9bf4ff05e">&#9670;&#160;</a></span>CombinePhaseFields()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::CombinePhaseFields </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Merge phase fields of same phase to phase field with index PhaseIndex. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03101">3101</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3102</span>{</div>
<div class="line"><span class="lineno"> 3103</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> p = 0; p &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a>; p++)</div>
<div class="line"><span class="lineno"> 3104</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa63bc774f077e754f035dc1602e80574">Combine</a>[p])</div>
<div class="line"><span class="lineno"> 3105</span>    {</div>
<div class="line"><span class="lineno"> 3106</span>        <span class="keywordtype">size_t</span> MajorityIndex  = 0;</div>
<div class="line"><span class="lineno"> 3107</span>        <span class="keywordtype">double</span> MajorityVolume = 0.0;</div>
<div class="line"><span class="lineno"> 3108</span>        <span class="keywordtype">bool</span>   MajorityFound  = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3109</span>        <span class="keywordtype">int</span>    Nfields        = 0;</div>
<div class="line"><span class="lineno"> 3110</span>        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>.<a class="code hl_function" href="../../d6/d90/classopenphase_1_1GrainsProperties.html#abb458316f62ad7fda8d902015e081e9c">size</a>(); n++)</div>
<div class="line"><span class="lineno"> 3111</span>        {</div>
<div class="line"><span class="lineno"> 3112</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[n].Exist and</div>
<div class="line"><span class="lineno"> 3113</span>               <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[n].<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a> == p and</div>
<div class="line"><span class="lineno"> 3114</span>               <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[n].Stage == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#af71cd9b36fd77e1eb90f17b95c04e52eafa3aff3c185c6dc7754235f397c2099a">GrainStages::Stable</a>)</div>
<div class="line"><span class="lineno"> 3115</span>            {</div>
<div class="line"><span class="lineno"> 3116</span>                Nfields ++;</div>
<div class="line"><span class="lineno"> 3117</span> </div>
<div class="line"><span class="lineno"> 3118</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[n].Volume &gt; MajorityVolume)</div>
<div class="line"><span class="lineno"> 3119</span>                {</div>
<div class="line"><span class="lineno"> 3120</span>                    MajorityIndex  = n;</div>
<div class="line"><span class="lineno"> 3121</span>                    MajorityVolume = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[n].Volume;</div>
<div class="line"><span class="lineno"> 3122</span>                    MajorityFound  = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 3123</span>                }</div>
<div class="line"><span class="lineno"> 3124</span>            }</div>
<div class="line"><span class="lineno"> 3125</span>        }</div>
<div class="line"><span class="lineno"> 3126</span> </div>
<div class="line"><span class="lineno"> 3127</span>        <span class="keywordflow">if</span>(MajorityFound and Nfields &gt; 1)</div>
<div class="line"><span class="lineno"> 3128</span>        <span class="keywordflow">switch</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#af0b28822d6a3aba3df4db780b51db71a">Resolution</a>)</div>
<div class="line"><span class="lineno"> 3129</span>        {</div>
<div class="line"><span class="lineno"> 3130</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e">Resolutions::Single</a>:</div>
<div class="line"><span class="lineno"> 3131</span>            {</div>
<div class="line"><span class="lineno"> 3132</span>                <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>.Bcells(),)</div>
<div class="line"><span class="lineno"> 3133</span>                {</div>
<div class="line"><span class="lineno"> 3134</span>                    <span class="keywordtype">double</span> value_to_combine = 0.0;</div>
<div class="line"><span class="lineno"> 3135</span> </div>
<div class="line"><span class="lineno"> 3136</span>                    <span class="keywordflow">for</span> (<span class="keyword">auto</span> it  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).begin();</div>
<div class="line"><span class="lineno"> 3137</span>                              it != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).end(); ++it)</div>
<div class="line"><span class="lineno"> 3138</span>                    {</div>
<div class="line"><span class="lineno"> 3139</span>                        <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[it-&gt;index].Phase == p and</div>
<div class="line"><span class="lineno"> 3140</span>                           <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[it-&gt;index].Stage == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#af71cd9b36fd77e1eb90f17b95c04e52eafa3aff3c185c6dc7754235f397c2099a">GrainStages::Stable</a> and</div>
<div class="line"><span class="lineno"> 3141</span>                           it-&gt;index != MajorityIndex)</div>
<div class="line"><span class="lineno"> 3142</span>                        {</div>
<div class="line"><span class="lineno"> 3143</span>                            value_to_combine += it-&gt;value;</div>
<div class="line"><span class="lineno"> 3144</span>                            it-&gt;value = 0.0;</div>
<div class="line"><span class="lineno"> 3145</span>                        }</div>
<div class="line"><span class="lineno"> 3146</span>                    }</div>
<div class="line"><span class="lineno"> 3147</span> </div>
<div class="line"><span class="lineno"> 3148</span>                    <span class="keywordflow">if</span>(value_to_combine &gt; DBL_EPSILON)</div>
<div class="line"><span class="lineno"> 3149</span>                    {</div>
<div class="line"><span class="lineno"> 3150</span>                        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).add_value(MajorityIndex, value_to_combine);</div>
<div class="line"><span class="lineno"> 3151</span>                    }</div>
<div class="line"><span class="lineno"> 3152</span>                }</div>
<div class="line"><span class="lineno"> 3153</span>                <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 3154</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3155</span>            }</div>
<div class="line"><span class="lineno"> 3156</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>:</div>
<div class="line"><span class="lineno"> 3157</span>            {</div>
<div class="line"><span class="lineno"> 3158</span>                <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.Bcells(),)</div>
<div class="line"><span class="lineno"> 3159</span>                {</div>
<div class="line"><span class="lineno"> 3160</span>                    <span class="keywordtype">double</span> value_to_combine = 0.0;</div>
<div class="line"><span class="lineno"> 3161</span> </div>
<div class="line"><span class="lineno"> 3162</span>                    <span class="keywordflow">for</span> (<span class="keyword">auto</span> it  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).begin();</div>
<div class="line"><span class="lineno"> 3163</span>                              it != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).end(); ++it)</div>
<div class="line"><span class="lineno"> 3164</span>                    {</div>
<div class="line"><span class="lineno"> 3165</span>                        <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[it-&gt;index].Phase == p and</div>
<div class="line"><span class="lineno"> 3166</span>                           <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[it-&gt;index].Stage == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#af71cd9b36fd77e1eb90f17b95c04e52eafa3aff3c185c6dc7754235f397c2099a">GrainStages::Stable</a> and</div>
<div class="line"><span class="lineno"> 3167</span>                           it-&gt;index != MajorityIndex)</div>
<div class="line"><span class="lineno"> 3168</span>                        {</div>
<div class="line"><span class="lineno"> 3169</span>                            value_to_combine += it-&gt;value;</div>
<div class="line"><span class="lineno"> 3170</span>                            it-&gt;value = 0.0;</div>
<div class="line"><span class="lineno"> 3171</span>                        }</div>
<div class="line"><span class="lineno"> 3172</span>                    }</div>
<div class="line"><span class="lineno"> 3173</span> </div>
<div class="line"><span class="lineno"> 3174</span>                    <span class="keywordflow">if</span>(value_to_combine &gt; DBL_EPSILON)</div>
<div class="line"><span class="lineno"> 3175</span>                    {</div>
<div class="line"><span class="lineno"> 3176</span>                        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).add_value(MajorityIndex, value_to_combine);</div>
<div class="line"><span class="lineno"> 3177</span>                    }</div>
<div class="line"><span class="lineno"> 3178</span>                }</div>
<div class="line"><span class="lineno"> 3179</span>                <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 3180</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3181</span>            }</div>
<div class="line"><span class="lineno"> 3182</span>        }</div>
<div class="line"><span class="lineno"> 3183</span>    }</div>
<div class="line"><span class="lineno"> 3184</span>}</div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_aa63bc774f077e754f035dc1602e80574"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#aa63bc774f077e754f035dc1602e80574">openphase::PhaseField::Combine</a></div><div class="ttdeci">std::vector&lt; bool &gt; Combine</div><div class="ttdoc">Indicates which phase's phase fields should be combined.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc5/PhaseField_8h_source.html#l00333">PhaseField.h:333</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e">openphase::Resolutions::Single</a></div><div class="ttdeci">@ Single</div><div class="ttdoc">Single resolution for all fields.</div></div>
<div class="ttc" id="anamespaceopenphase_html_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">openphase::HeatSourceTypes::Phase</a></div><div class="ttdeci">@ Phase</div><div class="ttdoc">Selected phase will act as a heat source.</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1f61075c4b485f20b5e6887150c310c6" name="a1f61075c4b485f20b5e6887150c310c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f61075c4b485f20b5e6887150c310c6">&#9670;&#160;</a></span>ConsumePlane()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::ConsumePlane </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>dz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Shifts the data in the storage by dx, dy and dz (they should be 0, -1 or +1) in the direction to/from (x, y, z) point. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02657">2657</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2660</span>{</div>
<div class="line"><span class="lineno"> 2661</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa34a89b8acec2f5b93915ca3b95668c1">ConsumePlaneSR</a>(dx,dy,dz,x,y,z,BC);</div>
<div class="line"><span class="lineno"> 2662</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#af0b28822d6a3aba3df4db780b51db71a">Resolution</a> == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>)</div>
<div class="line"><span class="lineno"> 2663</span>    {</div>
<div class="line"><span class="lineno"> 2664</span>        <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a174344940a72384a05ed1dbebef1967a">ConsumePlaneDR</a>(dx,dy,dz,x,y,z,BC);</div>
<div class="line"><span class="lineno"> 2665</span>    }</div>
<div class="line"><span class="lineno"> 2666</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#af8c994d103fffdf2f55db24ab6553cf1">Finalize</a>(BC);</div>
<div class="line"><span class="lineno"> 2667</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, <span class="stringliteral">&quot;Plane consumed&quot;</span>);</div>
<div class="line"><span class="lineno"> 2668</span>}</div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a174344940a72384a05ed1dbebef1967a"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a174344940a72384a05ed1dbebef1967a">openphase::PhaseField::ConsumePlaneDR</a></div><div class="ttdeci">void ConsumePlaneDR(const int dx, const int dy, const int dz, const int x, const int y, const int z, const BoundaryConditions &amp;BC)</div><div class="ttdoc">Shifts the data in the double resolution storage by dx, dy and dz (they should be 0,...</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l02717">PhaseField.cpp:2717</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_aa34a89b8acec2f5b93915ca3b95668c1"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#aa34a89b8acec2f5b93915ca3b95668c1">openphase::PhaseField::ConsumePlaneSR</a></div><div class="ttdeci">void ConsumePlaneSR(const int dx, const int dy, const int dz, const int x, const int y, const int z, const BoundaryConditions &amp;BC)</div><div class="ttdoc">Shifts the data in the single resolution storage by dx, dy and dz (they should be 0,...</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l02670">PhaseField.cpp:2670</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a174344940a72384a05ed1dbebef1967a" name="a174344940a72384a05ed1dbebef1967a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a174344940a72384a05ed1dbebef1967a">&#9670;&#160;</a></span>ConsumePlaneDR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::ConsumePlaneDR </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>dz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Shifts the data in the double resolution storage by dx, dy and dz (they should be 0, -1 or +1) in the direction to/from (x, y, z) point. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02717">2717</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2720</span>{</div>
<div class="line"><span class="lineno"> 2721</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n = 0; n &lt;= 1; n++)</div>
<div class="line"><span class="lineno"> 2722</span>    {</div>
<div class="line"><span class="lineno"> 2723</span>        <span class="keywordtype">int</span> xBeg = (dx &gt;= 0) + (dx &lt; 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.sizeX()) - 1;</div>
<div class="line"><span class="lineno"> 2724</span>        <span class="keywordtype">int</span> xEnd = (dx &gt;= 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.sizeX()) + (dx &lt; 0) - 1;</div>
<div class="line"><span class="lineno"> 2725</span>        <span class="keywordtype">int</span> xInc = 1 - 2*(dx &lt; 0);</div>
<div class="line"><span class="lineno"> 2726</span> </div>
<div class="line"><span class="lineno"> 2727</span>        <span class="keywordtype">int</span> yBeg = (dy &gt;= 0) + (dy &lt; 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.sizeY()) - 1;</div>
<div class="line"><span class="lineno"> 2728</span>        <span class="keywordtype">int</span> yEnd = (dy &gt;= 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.sizeY()) + (dy &lt; 0) - 1;</div>
<div class="line"><span class="lineno"> 2729</span>        <span class="keywordtype">int</span> yInc = 1 - 2*(dy &lt; 0);</div>
<div class="line"><span class="lineno"> 2730</span> </div>
<div class="line"><span class="lineno"> 2731</span>        <span class="keywordtype">int</span> zBeg = (dz &gt;= 0) + (dz &lt; 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.sizeZ()) - 1;</div>
<div class="line"><span class="lineno"> 2732</span>        <span class="keywordtype">int</span> zEnd = (dz &gt;= 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.sizeZ()) + (dz &lt; 0) - 1;</div>
<div class="line"><span class="lineno"> 2733</span>        <span class="keywordtype">int</span> zInc = 1 - 2*(dz &lt; 0);</div>
<div class="line"><span class="lineno"> 2734</span> </div>
<div class="line"><span class="lineno"> 2735</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = xBeg; ((dx &gt;= 0) and (i &lt;= xEnd)) or ((dx &lt; 0) and (i &gt;= xEnd)); i += xInc)</div>
<div class="line"><span class="lineno"> 2736</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = yBeg; ((dy &gt;= 0) and (j &lt;= yEnd)) or ((dy &lt; 0) and (j &gt;= yEnd)); j += yInc)</div>
<div class="line"><span class="lineno"> 2737</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = zBeg; ((dz &gt;= 0) and (k &lt;= zEnd)) or ((dz &lt; 0) and (k &gt;= zEnd)); k += zInc)</div>
<div class="line"><span class="lineno"> 2738</span>        <span class="keywordflow">if</span>((i-x)*dx+(j-y)*dy+(k-z)*dz &gt;= 0)</div>
<div class="line"><span class="lineno"> 2739</span>        {</div>
<div class="line"><span class="lineno"> 2740</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i, j, k) = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i + dx*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>, j + dy*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>, k + dz*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>);</div>
<div class="line"><span class="lineno"> 2741</span>        }</div>
<div class="line"><span class="lineno"> 2742</span>        xBeg = (dx &gt;= 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.sizeX()) + (dx &lt; 0) - 1;</div>
<div class="line"><span class="lineno"> 2743</span>        xEnd = (dx &gt;= 0) + (dx &lt; 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.sizeX()) - 1;</div>
<div class="line"><span class="lineno"> 2744</span>        xInc = 2*(dx &lt; 0) - 1;</div>
<div class="line"><span class="lineno"> 2745</span> </div>
<div class="line"><span class="lineno"> 2746</span>        yBeg = (dy &gt;= 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.sizeY()) + (dy &lt; 0) - 1;</div>
<div class="line"><span class="lineno"> 2747</span>        yEnd = (dy &gt;= 0) + (dy &lt; 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.sizeY()) - 1;</div>
<div class="line"><span class="lineno"> 2748</span>        yInc = 2*(dy &lt; 0) - 1;</div>
<div class="line"><span class="lineno"> 2749</span> </div>
<div class="line"><span class="lineno"> 2750</span>        zBeg = (dz &gt;= 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.sizeZ()) + (dz &lt; 0) - 1;</div>
<div class="line"><span class="lineno"> 2751</span>        zEnd = (dz &gt;= 0) + (dz &lt; 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.sizeZ()) - 1;</div>
<div class="line"><span class="lineno"> 2752</span>        zInc = 2*(dz &lt; 0) - 1;</div>
<div class="line"><span class="lineno"> 2753</span> </div>
<div class="line"><span class="lineno"> 2754</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = xBeg; ((dx &gt;= 0) and (i &gt;= xEnd)) or ((dx &lt; 0) and (i &lt;= xEnd)); i += xInc)</div>
<div class="line"><span class="lineno"> 2755</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = yBeg; ((dy &gt;= 0) and (j &gt;= yEnd)) or ((dy &lt; 0) and (j &lt;= yEnd)); j += yInc)</div>
<div class="line"><span class="lineno"> 2756</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = zBeg; ((dz &gt;= 0) and (k &gt;= zEnd)) or ((dz &lt; 0) and (k &lt;= zEnd)); k += zInc)</div>
<div class="line"><span class="lineno"> 2757</span>        <span class="keywordflow">if</span>((i-x)*dx+(j-y)*dy+(k-z)*dz &lt; 0)</div>
<div class="line"><span class="lineno"> 2758</span>        {</div>
<div class="line"><span class="lineno"> 2759</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i, j, k) = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i - dx*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>, j - dy*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>, k - dz*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>);</div>
<div class="line"><span class="lineno"> 2760</span>        }</div>
<div class="line"><span class="lineno"> 2761</span>    }</div>
<div class="line"><span class="lineno"> 2762</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a42e3e7cdc1c94edd6e7a4cc8ca90c93a">SetBoundaryConditionsDR</a>(BC);</div>
<div class="line"><span class="lineno"> 2763</span>}</div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a42e3e7cdc1c94edd6e7a4cc8ca90c93a"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a42e3e7cdc1c94edd6e7a4cc8ca90c93a">openphase::PhaseField::SetBoundaryConditionsDR</a></div><div class="ttdeci">void SetBoundaryConditionsDR(const BoundaryConditions &amp;BC)</div><div class="ttdoc">Set boundary conditions in double resolution case.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l02090">PhaseField.cpp:2090</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa34a89b8acec2f5b93915ca3b95668c1" name="aa34a89b8acec2f5b93915ca3b95668c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa34a89b8acec2f5b93915ca3b95668c1">&#9670;&#160;</a></span>ConsumePlaneSR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::ConsumePlaneSR </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>dz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Shifts the data in the single resolution storage by dx, dy and dz (they should be 0, -1 or +1) in the direction to/from (x, y, z) point. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02670">2670</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2673</span>{</div>
<div class="line"><span class="lineno"> 2674</span>    <span class="keywordtype">int</span> xBeg = (dx &gt;= 0) + (dx &lt; 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>) - 1;</div>
<div class="line"><span class="lineno"> 2675</span>    <span class="keywordtype">int</span> xEnd = (dx &gt;= 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>) + (dx &lt; 0) - 1;</div>
<div class="line"><span class="lineno"> 2676</span>    <span class="keywordtype">int</span> xInc = 1 - 2*(dx &lt; 0);</div>
<div class="line"><span class="lineno"> 2677</span> </div>
<div class="line"><span class="lineno"> 2678</span>    <span class="keywordtype">int</span> yBeg = (dy &gt;= 0) + (dy &lt; 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>) - 1;</div>
<div class="line"><span class="lineno"> 2679</span>    <span class="keywordtype">int</span> yEnd = (dy &gt;= 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>) + (dy &lt; 0) - 1;</div>
<div class="line"><span class="lineno"> 2680</span>    <span class="keywordtype">int</span> yInc = 1 - 2*(dy &lt; 0);</div>
<div class="line"><span class="lineno"> 2681</span> </div>
<div class="line"><span class="lineno"> 2682</span>    <span class="keywordtype">int</span> zBeg = (dz &gt;= 0) + (dz &lt; 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>) - 1;</div>
<div class="line"><span class="lineno"> 2683</span>    <span class="keywordtype">int</span> zEnd = (dz &gt;= 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>) + (dz &lt; 0) - 1;</div>
<div class="line"><span class="lineno"> 2684</span>    <span class="keywordtype">int</span> zInc = 1 - 2*(dz &lt; 0);</div>
<div class="line"><span class="lineno"> 2685</span> </div>
<div class="line"><span class="lineno"> 2686</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = xBeg; ((dx &gt;= 0) and (i &lt;= xEnd)) or ((dx &lt; 0) and (i &gt;= xEnd)); i += xInc)</div>
<div class="line"><span class="lineno"> 2687</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = yBeg; ((dy &gt;= 0) and (j &lt;= yEnd)) or ((dy &lt; 0) and (j &gt;= yEnd)); j += yInc)</div>
<div class="line"><span class="lineno"> 2688</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = zBeg; ((dz &gt;= 0) and (k &lt;= zEnd)) or ((dz &lt; 0) and (k &gt;= zEnd)); k += zInc)</div>
<div class="line"><span class="lineno"> 2689</span>    <span class="keywordflow">if</span>((i-x)*dx+(j-y)*dy+(k-z)*dz &gt;= 0)</div>
<div class="line"><span class="lineno"> 2690</span>    {</div>
<div class="line"><span class="lineno"> 2691</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i, j, k) = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i + dx*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>, j + dy*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>, k + dz*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>);</div>
<div class="line"><span class="lineno"> 2692</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a784a4bea9a5379192bdf4f12ab12cf10">Fractions</a>(i, j, k) = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a784a4bea9a5379192bdf4f12ab12cf10">Fractions</a>(i + dx*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>, j + dy*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>, k + dz*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>);</div>
<div class="line"><span class="lineno"> 2693</span>    }</div>
<div class="line"><span class="lineno"> 2694</span>    xBeg = (dx &gt;= 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>) + (dx &lt; 0) - 1;</div>
<div class="line"><span class="lineno"> 2695</span>    xEnd = (dx &gt;= 0) + (dx &lt; 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>) - 1;</div>
<div class="line"><span class="lineno"> 2696</span>    xInc = 2*(dx &lt; 0) - 1;</div>
<div class="line"><span class="lineno"> 2697</span> </div>
<div class="line"><span class="lineno"> 2698</span>    yBeg = (dy &gt;= 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>) + (dy &lt; 0) - 1;</div>
<div class="line"><span class="lineno"> 2699</span>    yEnd = (dy &gt;= 0) + (dy &lt; 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>) - 1;</div>
<div class="line"><span class="lineno"> 2700</span>    yInc = 2*(dy &lt; 0) - 1;</div>
<div class="line"><span class="lineno"> 2701</span> </div>
<div class="line"><span class="lineno"> 2702</span>    zBeg = (dz &gt;= 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>) + (dz &lt; 0) - 1;</div>
<div class="line"><span class="lineno"> 2703</span>    zEnd = (dz &gt;= 0) + (dz &lt; 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>) - 1;</div>
<div class="line"><span class="lineno"> 2704</span>    zInc = 2*(dz &lt; 0) - 1;</div>
<div class="line"><span class="lineno"> 2705</span> </div>
<div class="line"><span class="lineno"> 2706</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = xBeg; ((dx &gt;= 0) and (i &gt;= xEnd)) or ((dx &lt; 0) and (i &lt;= xEnd)); i += xInc)</div>
<div class="line"><span class="lineno"> 2707</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = yBeg; ((dy &gt;= 0) and (j &gt;= yEnd)) or ((dy &lt; 0) and (j &lt;= yEnd)); j += yInc)</div>
<div class="line"><span class="lineno"> 2708</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = zBeg; ((dz &gt;= 0) and (k &gt;= zEnd)) or ((dz &lt; 0) and (k &lt;= zEnd)); k += zInc)</div>
<div class="line"><span class="lineno"> 2709</span>    <span class="keywordflow">if</span>((i-x)*dx+(j-y)*dy+(k-z)*dz &lt; 0)</div>
<div class="line"><span class="lineno"> 2710</span>    {</div>
<div class="line"><span class="lineno"> 2711</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i, j, k) = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i - dx*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>, j - dy*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>, k - dz*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>);</div>
<div class="line"><span class="lineno"> 2712</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a784a4bea9a5379192bdf4f12ab12cf10">Fractions</a>(i, j, k) = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a784a4bea9a5379192bdf4f12ab12cf10">Fractions</a>(i - dx*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>, j - dy*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>, k - dz*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>);</div>
<div class="line"><span class="lineno"> 2713</span>    }</div>
<div class="line"><span class="lineno"> 2714</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a825ae7162676d2a690c3e072d0a49581">SetBoundaryConditions</a>(BC);</div>
<div class="line"><span class="lineno"> 2715</span>}</div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a825ae7162676d2a690c3e072d0a49581"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a825ae7162676d2a690c3e072d0a49581">openphase::PhaseField::SetBoundaryConditions</a></div><div class="ttdeci">void SetBoundaryConditions(const BoundaryConditions &amp;BC) override</div><div class="ttdoc">Set boundary conditions.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l02074">PhaseField.cpp:2074</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac7aaf1025baa44ad0a3308376d719da9" name="ac7aaf1025baa44ad0a3308376d719da9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7aaf1025baa44ad0a3308376d719da9">&#9670;&#160;</a></span>CurvaturePhase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::PhaseField::CurvaturePhase </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>Index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Curvature for each thermodynamic phase <a class="el" href="../../d3/d89/structopenphase_1_1VTK.html" title="&lt; static class to write VTK data in xml format">VTK</a> output. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03423">3423</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3424</span>{</div>
<div class="line"><span class="lineno"> 3425</span>    <span class="keywordtype">double</span> locKappa = 0.0;</div>
<div class="line"><span class="lineno"> 3426</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> gs = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a1f560b94dd8685e5f84363d403c5d495">GStencil</a>.<a class="code hl_function" href="../../d0/da4/classopenphase_1_1GradientStencil.html#a5ec4dfe46d684d6597bf546e32943bed">cbegin</a>(); gs != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a1f560b94dd8685e5f84363d403c5d495">GStencil</a>.<a class="code hl_function" href="../../d0/da4/classopenphase_1_1GradientStencil.html#afc6c12d29aa0df36b80cfa9132919cc1">cend</a>(); ++gs)</div>
<div class="line"><span class="lineno"> 3427</span>    {</div>
<div class="line"><span class="lineno"> 3428</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> ii = gs-&gt;di;</div>
<div class="line"><span class="lineno"> 3429</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> jj = gs-&gt;dj;</div>
<div class="line"><span class="lineno"> 3430</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> kk = gs-&gt;dk;</div>
<div class="line"><span class="lineno"> 3431</span>        <span class="keyword">const</span> NodeA&lt;dVector3&gt; locNormals = <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3d160e3ff1782e6f87f67a64193d7a30">NormalsPhase</a>(i + ii, j + jj, k + kk);</div>
<div class="line"><span class="lineno"> 3432</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = locNormals.cbegin(); it != locNormals.cend(); ++it)</div>
<div class="line"><span class="lineno"> 3433</span>        <span class="keywordflow">if</span> (it-&gt;index == phase)</div>
<div class="line"><span class="lineno"> 3434</span>        {</div>
<div class="line"><span class="lineno"> 3435</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> vx = gs-&gt;weightX * it-&gt;value[0];</div>
<div class="line"><span class="lineno"> 3436</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> vy = gs-&gt;weightY * it-&gt;value[1];</div>
<div class="line"><span class="lineno"> 3437</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> vz = gs-&gt;weightZ * it-&gt;value[2];</div>
<div class="line"><span class="lineno"> 3438</span>            locKappa += vx+vy+vz;</div>
<div class="line"><span class="lineno"> 3439</span>        }</div>
<div class="line"><span class="lineno"> 3440</span>    }</div>
<div class="line"><span class="lineno"> 3441</span>    <span class="keywordflow">return</span> locKappa;</div>
<div class="line"><span class="lineno"> 3442</span>}</div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a3d160e3ff1782e6f87f67a64193d7a30"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a3d160e3ff1782e6f87f67a64193d7a30">openphase::PhaseField::NormalsPhase</a></div><div class="ttdeci">NodeA&lt; dVector3 &gt; NormalsPhase(const int i, const int j, const int k) const</div><div class="ttdoc">Returns interface normals for all pairs of phase fields at a given position.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l00766">PhaseField.cpp:766</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afe08f3c4509a459e08932ed2c17cf21c" name="afe08f3c4509a459e08932ed2c17cf21c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe08f3c4509a459e08932ed2c17cf21c">&#9670;&#160;</a></span>CurvaturePhaseDR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::PhaseField::CurvaturePhaseDR </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>Index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Curvature for each thermodynamic phase <a class="el" href="../../d3/d89/structopenphase_1_1VTK.html" title="&lt; static class to write VTK data in xml format">VTK</a> output. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03444">3444</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3445</span>{</div>
<div class="line"><span class="lineno"> 3446</span>    <span class="keywordtype">double</span> locKappa = 0.0;</div>
<div class="line"><span class="lineno"> 3447</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> gs = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a1f560b94dd8685e5f84363d403c5d495">GStencil</a>.<a class="code hl_function" href="../../d0/da4/classopenphase_1_1GradientStencil.html#a5ec4dfe46d684d6597bf546e32943bed">cbegin</a>(); gs != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a1f560b94dd8685e5f84363d403c5d495">GStencil</a>.<a class="code hl_function" href="../../d0/da4/classopenphase_1_1GradientStencil.html#afc6c12d29aa0df36b80cfa9132919cc1">cend</a>(); ++gs)</div>
<div class="line"><span class="lineno"> 3448</span>    {</div>
<div class="line"><span class="lineno"> 3449</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> ii = gs-&gt;di;</div>
<div class="line"><span class="lineno"> 3450</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> jj = gs-&gt;dj;</div>
<div class="line"><span class="lineno"> 3451</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> kk = gs-&gt;dk;</div>
<div class="line"><span class="lineno"> 3452</span>        <span class="keyword">const</span> NodeA&lt;dVector3&gt; locNormals = <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#acdd6a035437a9feef3b603ef694c3a55">NormalsPhaseDR</a>(i + ii, j + jj, k + kk);</div>
<div class="line"><span class="lineno"> 3453</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = locNormals.cbegin(); it != locNormals.cend(); ++it)</div>
<div class="line"><span class="lineno"> 3454</span>        <span class="keywordflow">if</span> (it-&gt;index == phase)</div>
<div class="line"><span class="lineno"> 3455</span>        {</div>
<div class="line"><span class="lineno"> 3456</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> vx = gs-&gt;weightX * it-&gt;value[0];</div>
<div class="line"><span class="lineno"> 3457</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> vy = gs-&gt;weightY * it-&gt;value[1];</div>
<div class="line"><span class="lineno"> 3458</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> vz = gs-&gt;weightZ * it-&gt;value[2];</div>
<div class="line"><span class="lineno"> 3459</span>            locKappa += vx+vy+vz;</div>
<div class="line"><span class="lineno"> 3460</span>        }</div>
<div class="line"><span class="lineno"> 3461</span>    }</div>
<div class="line"><span class="lineno"> 3462</span>    <span class="keywordflow">return</span> locKappa;</div>
<div class="line"><span class="lineno"> 3463</span>}</div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_acdd6a035437a9feef3b603ef694c3a55"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#acdd6a035437a9feef3b603ef694c3a55">openphase::PhaseField::NormalsPhaseDR</a></div><div class="ttdeci">NodeA&lt; dVector3 &gt; NormalsPhaseDR(const int i, const int j, const int k) const</div><div class="ttdoc">Returns interface normals for all pairs of phase fields at a given position.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l00778">PhaseField.cpp:778</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6484859b48f04ff0ec8d8bc8c53943d3" name="a6484859b48f04ff0ec8d8bc8c53943d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6484859b48f04ff0ec8d8bc8c53943d3">&#9670;&#160;</a></span>Dot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d8/d8b/classopenphase_1_1NodeA.html">NodeA</a>&lt; double &gt; openphase::PhaseField::Dot </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the upcoming derivatives of Fields with respect to time including finalization! (NOTE: Dot = Dot1 + Dot2) </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l01164">1164</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1165</span>{</div>
<div class="line"><span class="lineno"> 1166</span>    NodeA&lt;double&gt; value;</div>
<div class="line"><span class="lineno"> 1167</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).wide_interface())</div>
<div class="line"><span class="lineno"> 1168</span>    {</div>
<div class="line"><span class="lineno"> 1169</span>        NodePF OldFields = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k);</div>
<div class="line"><span class="lineno"> 1170</span>        NodePF NewFields = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k);</div>
<div class="line"><span class="lineno"> 1171</span>        NodePF tmp;</div>
<div class="line"><span class="lineno"> 1172</span> </div>
<div class="line"><span class="lineno"> 1173</span>        <span class="keywordflow">for</span>(<span class="keyword">auto</span> <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a> = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).cbegin(); <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a> != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).cend(); ++<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>)</div>
<div class="line"><span class="lineno"> 1174</span>        {</div>
<div class="line"><span class="lineno"> 1175</span>            <span class="keywordflow">if</span>(<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;value1 != 0.0)</div>
<div class="line"><span class="lineno"> 1176</span>            {</div>
<div class="line"><span class="lineno"> 1177</span>                NewFields.add_value(<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;indexA,  <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;value1*dt);</div>
<div class="line"><span class="lineno"> 1178</span>                NewFields.add_value(<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;indexB, -<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;value1*dt);</div>
<div class="line"><span class="lineno"> 1179</span>            }</div>
<div class="line"><span class="lineno"> 1180</span>            <span class="keywordflow">if</span>(<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;value2 != 0.0)</div>
<div class="line"><span class="lineno"> 1181</span>            {</div>
<div class="line"><span class="lineno"> 1182</span>                NewFields.add_value(<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;indexA,  <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;value2*dt);</div>
<div class="line"><span class="lineno"> 1183</span>                NewFields.add_value(<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;indexB, -<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;value2*dt);</div>
<div class="line"><span class="lineno"> 1184</span>            }</div>
<div class="line"><span class="lineno"> 1185</span>        }</div>
<div class="line"><span class="lineno"> 1186</span>        NodePF NewFieldsFinalized = NewFields;</div>
<div class="line"><span class="lineno"> 1187</span>        NewFieldsFinalized.finalize();</div>
<div class="line"><span class="lineno"> 1188</span> </div>
<div class="line"><span class="lineno"> 1189</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> alpha = NewFields.cbegin(); alpha != NewFields.end(); ++alpha)</div>
<div class="line"><span class="lineno"> 1190</span>        {</div>
<div class="line"><span class="lineno"> 1191</span>            value.add_value(alpha-&gt;index, (NewFieldsFinalized.get_value(alpha-&gt;index)-OldFields.get_value(alpha-&gt;index))/dt);</div>
<div class="line"><span class="lineno"> 1192</span>        }</div>
<div class="line"><span class="lineno"> 1193</span>    }</div>
<div class="line"><span class="lineno"> 1194</span>    <span class="keywordflow">return</span> value;</div>
<div class="line"><span class="lineno"> 1195</span>}</div>
<div class="ttc" id="anamespaceopenphase_html_a00cfeac3044187955c0b5786f4b6eb3f"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">openphase::psi</a></div><div class="ttdeci">double psi(double rho, double rho0)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d72/FlowSolverLBM_8cpp_source.html#l00046">FlowSolverLBM.cpp:46</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af77624912d453d5dcbc7466ec6250baf" name="af77624912d453d5dcbc7466ec6250baf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af77624912d453d5dcbc7466ec6250baf">&#9670;&#160;</a></span>Dot1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d8/d8b/classopenphase_1_1NodeA.html">NodeA</a>&lt; double &gt; openphase::PhaseField::Dot1 </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>(used for semi-implicit solver Grand Potential solver!) </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l01197">1197</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1198</span>{</div>
<div class="line"><span class="lineno"> 1199</span>    NodeA&lt;double&gt; value;</div>
<div class="line"><span class="lineno"> 1200</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).wide_interface())</div>
<div class="line"><span class="lineno"> 1201</span>    {</div>
<div class="line"><span class="lineno"> 1202</span>        NodePF OldFields = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k);</div>
<div class="line"><span class="lineno"> 1203</span>        NodePF NewFields = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k);</div>
<div class="line"><span class="lineno"> 1204</span>        <span class="comment">//NodePF tmp;</span></div>
<div class="line"><span class="lineno"> 1205</span> </div>
<div class="line"><span class="lineno"> 1206</span>        <span class="keywordflow">for</span>(<span class="keyword">auto</span> <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a> = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).cbegin(); <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a> != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).cend(); ++<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>)</div>
<div class="line"><span class="lineno"> 1207</span>        {</div>
<div class="line"><span class="lineno"> 1208</span>            <span class="keywordflow">if</span>(<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;value1 != 0.0)</div>
<div class="line"><span class="lineno"> 1209</span>            {</div>
<div class="line"><span class="lineno"> 1210</span>                NewFields.add_value(<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;indexA,  <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;value1*dt);</div>
<div class="line"><span class="lineno"> 1211</span>                NewFields.add_value(<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;indexB, -<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;value1*dt);</div>
<div class="line"><span class="lineno"> 1212</span>                <span class="comment">//tmp.add_value(psi-&gt;indexA, 1);</span></div>
<div class="line"><span class="lineno"> 1213</span>                <span class="comment">//tmp.add_value(psi-&gt;indexB, 1);</span></div>
<div class="line"><span class="lineno"> 1214</span>            }</div>
<div class="line"><span class="lineno"> 1215</span>        }</div>
<div class="line"><span class="lineno"> 1216</span>        <span class="comment">//NewFields.finalize();</span></div>
<div class="line"><span class="lineno"> 1217</span> </div>
<div class="line"><span class="lineno"> 1218</span>        <span class="comment">//for (auto alpha = tmp.cbegin(); alpha != tmp.end(); ++alpha)</span></div>
<div class="line"><span class="lineno"> 1219</span>        <span class="keywordflow">for</span>(<span class="keyword">auto</span> alpha = NewFields.cbegin(); alpha != NewFields.cend(); ++alpha)</div>
<div class="line"><span class="lineno"> 1220</span>        {</div>
<div class="line"><span class="lineno"> 1221</span>            value.add_value(alpha-&gt;index, (NewFields.get_value(alpha-&gt;index)-OldFields.get_value(alpha-&gt;index))/dt);</div>
<div class="line"><span class="lineno"> 1222</span>        }</div>
<div class="line"><span class="lineno"> 1223</span>    }</div>
<div class="line"><span class="lineno"> 1224</span>    <span class="keywordflow">return</span> value;</div>
<div class="line"><span class="lineno"> 1225</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a75b9fbb10df069d24ad28d5c27db4eaa" name="a75b9fbb10df069d24ad28d5c27db4eaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75b9fbb10df069d24ad28d5c27db4eaa">&#9670;&#160;</a></span>Dot2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d8/d8b/classopenphase_1_1NodeA.html">NodeA</a>&lt; double &gt; openphase::PhaseField::Dot2 </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>(used for semi-implicit solver Grand Potential solver!) </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l01227">1227</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1228</span>{</div>
<div class="line"><span class="lineno"> 1229</span>    NodeA&lt;double&gt; value;</div>
<div class="line"><span class="lineno"> 1230</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).wide_interface())</div>
<div class="line"><span class="lineno"> 1231</span>    {</div>
<div class="line"><span class="lineno"> 1232</span>        NodeA&lt;double&gt; locDot1 = <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#af77624912d453d5dcbc7466ec6250baf">Dot1</a>(i,j,k,dt);</div>
<div class="line"><span class="lineno"> 1233</span>        NodeA&lt;double&gt; locDot  = <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a6484859b48f04ff0ec8d8bc8c53943d3">Dot</a> (i,j,k,dt);</div>
<div class="line"><span class="lineno"> 1234</span> </div>
<div class="line"><span class="lineno"> 1235</span>        NodeA&lt;double&gt; tmp;</div>
<div class="line"><span class="lineno"> 1236</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> it : locDot1) if (it.value != 0.0) tmp.add_value(it.index, 1);</div>
<div class="line"><span class="lineno"> 1237</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> it : locDot ) if (it.value != 0.0) tmp.add_value(it.index, 1);</div>
<div class="line"><span class="lineno"> 1238</span> </div>
<div class="line"><span class="lineno"> 1239</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> alpha = tmp.cbegin(); alpha != tmp.end(); ++alpha)</div>
<div class="line"><span class="lineno"> 1240</span>        {</div>
<div class="line"><span class="lineno"> 1241</span>            <span class="keywordtype">double</span> locDot2Alpha = locDot.get_value(alpha-&gt;index)-locDot1.get_value(alpha-&gt;index);</div>
<div class="line"><span class="lineno"> 1242</span>            value.add_value(alpha-&gt;index,locDot2Alpha);</div>
<div class="line"><span class="lineno"> 1243</span>        }</div>
<div class="line"><span class="lineno"> 1244</span>    }</div>
<div class="line"><span class="lineno"> 1245</span>    <span class="keywordflow">return</span> value;</div>
<div class="line"><span class="lineno"> 1246</span>}</div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a6484859b48f04ff0ec8d8bc8c53943d3"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a6484859b48f04ff0ec8d8bc8c53943d3">openphase::PhaseField::Dot</a></div><div class="ttdeci">NodeA&lt; double &gt; Dot(const int i, const int j, const int k, const double dt) const</div><div class="ttdoc">Calculates the upcoming derivatives of Fields with respect to time including finalization!...</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l01164">PhaseField.cpp:1164</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_af77624912d453d5dcbc7466ec6250baf"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#af77624912d453d5dcbc7466ec6250baf">openphase::PhaseField::Dot1</a></div><div class="ttdeci">NodeA&lt; double &gt; Dot1(const int i, const int j, const int k, const double dt) const</div><div class="ttdoc">(used for semi-implicit solver Grand Potential solver!)</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l01197">PhaseField.cpp:1197</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8c5e8c77192dca99d865d6f01c7b72d8" name="a8c5e8c77192dca99d865d6f01c7b72d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c5e8c77192dca99d865d6f01c7b72d8">&#9670;&#160;</a></span>EffectiveOrientation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a> openphase::PhaseField::EffectiveOrientation </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns averaged grain rotations, averaging is done via quaternions. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l00790">790</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  791</span>{</div>
<div class="line"><span class="lineno">  792</span>    Quaternion locQuaternion;</div>
<div class="line"><span class="lineno">  793</span> </div>
<div class="line"><span class="lineno">  794</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).interface())</div>
<div class="line"><span class="lineno">  795</span>    {</div>
<div class="line"><span class="lineno">  796</span>        <span class="keywordtype">int</span> index = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).majority_index();</div>
<div class="line"><span class="lineno">  797</span>        locQuaternion = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[index].Orientation;</div>
<div class="line"><span class="lineno">  798</span>    }</div>
<div class="line"><span class="lineno">  799</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  800</span>    {</div>
<div class="line"><span class="lineno">  801</span>        locQuaternion.set(0.0,0.0,0.0,0.0);</div>
<div class="line"><span class="lineno">  802</span> </div>
<div class="line"><span class="lineno">  803</span>        <span class="keywordflow">for</span>(<span class="keyword">auto</span> alpha  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno">  804</span>                 alpha != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cend(); alpha++)</div>
<div class="line"><span class="lineno">  805</span>        {</div>
<div class="line"><span class="lineno">  806</span>            locQuaternion += <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[alpha-&gt;index].Orientation*alpha-&gt;value;</div>
<div class="line"><span class="lineno">  807</span>        }</div>
<div class="line"><span class="lineno">  808</span>    }</div>
<div class="line"><span class="lineno">  809</span>    <span class="keywordflow">return</span> locQuaternion.RotationMatrix;</div>
<div class="line"><span class="lineno">  810</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af8c994d103fffdf2f55db24ab6553cf1" name="af8c994d103fffdf2f55db24ab6553cf1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8c994d103fffdf2f55db24ab6553cf1">&#9670;&#160;</a></span>Finalize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::Finalize </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>finalize</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finalizing the phase fields calculations. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l00989">989</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  990</span>{</div>
<div class="line"><span class="lineno">  991</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#aabfe5a389c721d7146e5b9a9bf4ff05e">CombinePhaseFields</a>();</div>
<div class="line"><span class="lineno">  992</span> </div>
<div class="line"><span class="lineno">  993</span>    <span class="keywordflow">switch</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#af0b28822d6a3aba3df4db780b51db71a">Resolution</a>)</div>
<div class="line"><span class="lineno">  994</span>    {</div>
<div class="line"><span class="lineno">  995</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e">Resolutions::Single</a>:</div>
<div class="line"><span class="lineno">  996</span>        {</div>
<div class="line"><span class="lineno">  997</span>            <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a99e40d092617225b339b45475192cd7f">FinalizeSR</a>(BC, finalize);</div>
<div class="line"><span class="lineno">  998</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  999</span>        }</div>
<div class="line"><span class="lineno"> 1000</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>:</div>
<div class="line"><span class="lineno"> 1001</span>        {</div>
<div class="line"><span class="lineno"> 1002</span>            <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a114bc43de1eb04b19f3ead40c62cc583">FinalizeDR</a>(BC, finalize);</div>
<div class="line"><span class="lineno"> 1003</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1004</span>        }</div>
<div class="line"><span class="lineno"> 1005</span>    }</div>
<div class="line"><span class="lineno"> 1006</span>}</div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a114bc43de1eb04b19f3ead40c62cc583"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a114bc43de1eb04b19f3ead40c62cc583">openphase::PhaseField::FinalizeDR</a></div><div class="ttdeci">void FinalizeDR(const BoundaryConditions &amp;BC, const bool finalize=true)</div><div class="ttdoc">Finalizing the phase fields calculations in this time step in double resolutions.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l01035">PhaseField.cpp:1035</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a99e40d092617225b339b45475192cd7f"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a99e40d092617225b339b45475192cd7f">openphase::PhaseField::FinalizeSR</a></div><div class="ttdeci">void FinalizeSR(const BoundaryConditions &amp;BC, const bool finalize=true)</div><div class="ttdoc">Finalizing the phase fields calculations in this time step.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l01008">PhaseField.cpp:1008</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_aabfe5a389c721d7146e5b9a9bf4ff05e"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#aabfe5a389c721d7146e5b9a9bf4ff05e">openphase::PhaseField::CombinePhaseFields</a></div><div class="ttdeci">void CombinePhaseFields(void)</div><div class="ttdoc">Merge phase fields of same phase to phase field with index PhaseIndex.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l03101">PhaseField.cpp:3101</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a114bc43de1eb04b19f3ead40c62cc583" name="a114bc43de1eb04b19f3ead40c62cc583"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a114bc43de1eb04b19f3ead40c62cc583">&#9670;&#160;</a></span>FinalizeDR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::FinalizeDR </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>finalize</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Finalizing the phase fields calculations in this time step in double resolutions. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l01035">1035</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1036</span>{</div>
<div class="line"><span class="lineno"> 1037</span>    <span class="keywordflow">if</span>(finalize)</div>
<div class="line"><span class="lineno"> 1038</span>    {</div>
<div class="line"><span class="lineno"> 1039</span><span class="preprocessor">        #ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 1040</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.Bcells(),)</div>
<div class="line"><span class="lineno"> 1041</span>        <span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 1042</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>,0,)</div>
<div class="line"><span class="lineno"> 1043</span>        <span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1044</span>        {</div>
<div class="line"><span class="lineno"> 1045</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).wide_interface())</div>
<div class="line"><span class="lineno"> 1046</span>            {</div>
<div class="line"><span class="lineno"> 1047</span>                <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).finalize();</div>
<div class="line"><span class="lineno"> 1048</span>            }</div>
<div class="line"><span class="lineno"> 1049</span>        }</div>
<div class="line"><span class="lineno"> 1050</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1051</span>    }</div>
<div class="line"><span class="lineno"> 1052</span> </div>
<div class="line"><span class="lineno"> 1053</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a42e3e7cdc1c94edd6e7a4cc8ca90c93a">SetBoundaryConditionsDR</a>(BC);</div>
<div class="line"><span class="lineno"> 1054</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a6351df75321c5be52c45de4df6b0d9b9">SetFlagsDR</a>();</div>
<div class="line"><span class="lineno"> 1055</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a9b95ea729b671ab91f24db60da68892b">CalculateDerivativesDR</a>();</div>
<div class="line"><span class="lineno"> 1056</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a42e3e7cdc1c94edd6e7a4cc8ca90c93a">SetBoundaryConditionsDR</a>(BC);</div>
<div class="line"><span class="lineno"> 1057</span> </div>
<div class="line"><span class="lineno"> 1058</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a958b5b2d6aa752eab13281f17f43ff7b">Coarsen</a>();</div>
<div class="line"><span class="lineno"> 1059</span> </div>
<div class="line"><span class="lineno"> 1060</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a506595d6236a96859a36b19bc7fbd165">SetBoundaryConditionsSR</a>(BC);</div>
<div class="line"><span class="lineno"> 1061</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#af5cc5b72dd043ea82b19b8fd59956e07">SetFlagsSR</a>();</div>
<div class="line"><span class="lineno"> 1062</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a506595d6236a96859a36b19bc7fbd165">SetBoundaryConditionsSR</a>(BC);</div>
<div class="line"><span class="lineno"> 1063</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#ad3f42764ad1f345dc1b1924a01a051f6">CalculateDerivativesSR</a>();</div>
<div class="line"><span class="lineno"> 1064</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a357ea817f60117eb924f107e77a482ef">CalculateFractions</a>();</div>
<div class="line"><span class="lineno"> 1065</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a0d1ccd2f7e084a0539d7134fb0c15b7c">CalculateGrainsVolume</a>();</div>
<div class="line"><span class="lineno"> 1066</span>}</div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a0d1ccd2f7e084a0539d7134fb0c15b7c"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a0d1ccd2f7e084a0539d7134fb0c15b7c">openphase::PhaseField::CalculateGrainsVolume</a></div><div class="ttdeci">void CalculateGrainsVolume(void)</div><div class="ttdoc">Collects volume for each phase field.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l00812">PhaseField.cpp:812</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a506595d6236a96859a36b19bc7fbd165"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a506595d6236a96859a36b19bc7fbd165">openphase::PhaseField::SetBoundaryConditionsSR</a></div><div class="ttdeci">void SetBoundaryConditionsSR(const BoundaryConditions &amp;BC)</div><div class="ttdoc">Set boundary conditions in single resolution case.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l02083">PhaseField.cpp:2083</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a6351df75321c5be52c45de4df6b0d9b9"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a6351df75321c5be52c45de4df6b0d9b9">openphase::PhaseField::SetFlagsDR</a></div><div class="ttdeci">void SetFlagsDR()</div><div class="ttdoc">Sets the flags which mark interfaces in double resolution case.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l00971">PhaseField.cpp:971</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a958b5b2d6aa752eab13281f17f43ff7b"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a958b5b2d6aa752eab13281f17f43ff7b">openphase::PhaseField::Coarsen</a></div><div class="ttdeci">void Coarsen(void)</div><div class="ttdoc">Calculates single resolution phase-fields from the double resolution ones.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l01096">PhaseField.cpp:1096</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a9b95ea729b671ab91f24db60da68892b"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a9b95ea729b671ab91f24db60da68892b">openphase::PhaseField::CalculateDerivativesDR</a></div><div class="ttdeci">void CalculateDerivativesDR(void)</div><div class="ttdoc">Calculates local phase-field derivatives in double resolution.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l00617">PhaseField.cpp:617</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_ad3f42764ad1f345dc1b1924a01a051f6"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#ad3f42764ad1f345dc1b1924a01a051f6">openphase::PhaseField::CalculateDerivativesSR</a></div><div class="ttdeci">void CalculateDerivativesSR(void)</div><div class="ttdoc">Calculates local phase-field derivatives.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l00566">PhaseField.cpp:566</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_af5cc5b72dd043ea82b19b8fd59956e07"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#af5cc5b72dd043ea82b19b8fd59956e07">openphase::PhaseField::SetFlagsSR</a></div><div class="ttdeci">void SetFlagsSR()</div><div class="ttdoc">Sets the flags which mark interfaces.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l00953">PhaseField.cpp:953</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac1b22713f51e2761503ac0e16af0cb8b" name="ac1b22713f51e2761503ac0e16af0cb8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1b22713f51e2761503ac0e16af0cb8b">&#9670;&#160;</a></span>FinalizeInitialization()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::FinalizeInitialization </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finalizing the phase fields after initialization. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l01068">1068</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1069</span>{</div>
<div class="line"><span class="lineno"> 1070</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a99e40d092617225b339b45475192cd7f">FinalizeSR</a>(BC);</div>
<div class="line"><span class="lineno"> 1071</span> </div>
<div class="line"><span class="lineno"> 1072</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#af0b28822d6a3aba3df4db780b51db71a">Resolution</a> == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>)</div>
<div class="line"><span class="lineno"> 1073</span>    {</div>
<div class="line"><span class="lineno"> 1074</span>        <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a631209c7492c13b5575850ae2a809d5c">Refine</a>();</div>
<div class="line"><span class="lineno"> 1075</span>        <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a114bc43de1eb04b19f3ead40c62cc583">FinalizeDR</a>(BC);</div>
<div class="line"><span class="lineno"> 1076</span>    }</div>
<div class="line"><span class="lineno"> 1077</span>}</div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a631209c7492c13b5575850ae2a809d5c"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a631209c7492c13b5575850ae2a809d5c">openphase::PhaseField::Refine</a></div><div class="ttdeci">void Refine(void)</div><div class="ttdoc">Calculates double resolution phase-fields from the single resolution ones.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l01145">PhaseField.cpp:1145</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a99e40d092617225b339b45475192cd7f" name="a99e40d092617225b339b45475192cd7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99e40d092617225b339b45475192cd7f">&#9670;&#160;</a></span>FinalizeSR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::FinalizeSR </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>finalize</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Finalizing the phase fields calculations in this time step. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l01008">1008</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1009</span>{</div>
<div class="line"><span class="lineno"> 1010</span>    <span class="keywordflow">if</span>(finalize)</div>
<div class="line"><span class="lineno"> 1011</span>    {</div>
<div class="line"><span class="lineno"> 1012</span><span class="preprocessor">        #ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 1013</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>.Bcells(),)</div>
<div class="line"><span class="lineno"> 1014</span>        <span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 1015</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>,0,)</div>
<div class="line"><span class="lineno"> 1016</span>        <span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1017</span>        {</div>
<div class="line"><span class="lineno"> 1018</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).wide_interface())</div>
<div class="line"><span class="lineno"> 1019</span>            {</div>
<div class="line"><span class="lineno"> 1020</span>                <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).finalize();</div>
<div class="line"><span class="lineno"> 1021</span>            }</div>
<div class="line"><span class="lineno"> 1022</span>        }</div>
<div class="line"><span class="lineno"> 1023</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1024</span>    }</div>
<div class="line"><span class="lineno"> 1025</span> </div>
<div class="line"><span class="lineno"> 1026</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a506595d6236a96859a36b19bc7fbd165">SetBoundaryConditionsSR</a>(BC);</div>
<div class="line"><span class="lineno"> 1027</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#af5cc5b72dd043ea82b19b8fd59956e07">SetFlagsSR</a>();</div>
<div class="line"><span class="lineno"> 1028</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a506595d6236a96859a36b19bc7fbd165">SetBoundaryConditionsSR</a>(BC);</div>
<div class="line"><span class="lineno"> 1029</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#ad3f42764ad1f345dc1b1924a01a051f6">CalculateDerivativesSR</a>();</div>
<div class="line"><span class="lineno"> 1030</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a506595d6236a96859a36b19bc7fbd165">SetBoundaryConditionsSR</a>(BC);</div>
<div class="line"><span class="lineno"> 1031</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a357ea817f60117eb924f107e77a482ef">CalculateFractions</a>();</div>
<div class="line"><span class="lineno"> 1032</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a0d1ccd2f7e084a0539d7134fb0c15b7c">CalculateGrainsVolume</a>();</div>
<div class="line"><span class="lineno"> 1033</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af6910712da7e1d8d4df869a36cc41fb1" name="af6910712da7e1d8d4df869a36cc41fb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6910712da7e1d8d4df869a36cc41fb1">&#9670;&#160;</a></span>FindObject()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html">OPObject</a> * openphase::OPObject::FindObject </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html">OPObject</a> * &gt;&#160;</td>
          <td class="paramname"><em>ObjectList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>ObjectName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>thisclassname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>thisfunctionname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>necessary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>verbose</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d1c/OPObject_8h_source.html#l00130">130</a> of file <a class="el" href="../../d5/d1c/OPObject_8h_source.html">OPObject.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  138</span>    {</div>
<div class="line"><span class="lineno">  139</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; ObjectList.size(); i++)</div>
<div class="line"><span class="lineno">  140</span>        {</div>
<div class="line"><span class="lineno">  141</span>            <span class="keywordflow">if</span>(ObjectList[i]-&gt;<a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>.size() &gt;= ObjectName.size())</div>
<div class="line"><span class="lineno">  142</span>            {</div>
<div class="line"><span class="lineno">  143</span>                std::string locObjectName = ObjectList[i]-&gt;thisclassname;</div>
<div class="line"><span class="lineno">  144</span>                locObjectName.resize(ObjectName.size());</div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>                <span class="keywordflow">if</span>(locObjectName == ObjectName)</div>
<div class="line"><span class="lineno">  147</span>                {</div>
<div class="line"><span class="lineno">  148</span>                    <span class="keywordflow">return</span> ObjectList[i];</div>
<div class="line"><span class="lineno">  149</span>                }</div>
<div class="line"><span class="lineno">  150</span>            }</div>
<div class="line"><span class="lineno">  151</span>        }</div>
<div class="line"><span class="lineno">  152</span>        <span class="keywordflow">if</span> (verbose)</div>
<div class="line"><span class="lineno">  153</span>        {</div>
<div class="line"><span class="lineno">  154</span>            std::cout &lt;&lt; <span class="stringliteral">&quot;No &quot;</span> &lt;&lt; ObjectName &lt;&lt; <span class="stringliteral">&quot; object found! &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a></div>
<div class="line"><span class="lineno">  155</span>                      &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; thisfunctionname &lt;&lt; <span class="stringliteral">&quot;()&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  156</span>        }</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>        <span class="keywordflow">if</span>(necessary)</div>
<div class="line"><span class="lineno">  159</span>        {</div>
<div class="line"><span class="lineno">  160</span>            <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a4d6fed4ab71c6edf2a0bd5dabecc6ec6">OP_Exit</a>(13);</div>
<div class="line"><span class="lineno">  161</span>        }</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  164</span>    }</div>
<div class="ttc" id="anamespaceopenphase_html_a4d6fed4ab71c6edf2a0bd5dabecc6ec6"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a4d6fed4ab71c6edf2a0bd5dabecc6ec6">openphase::OP_Exit</a></div><div class="ttdeci">void OP_Exit(int exit_code)</div><div class="ttdef"><b>Definition</b> <a href="../../d9/df1/Globals_8h_source.html#l00098">Globals.h:98</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa710a4052d686aac0b3f38a9a615682e" name="aa710a4052d686aac0b3f38a9a615682e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa710a4052d686aac0b3f38a9a615682e">&#9670;&#160;</a></span>FindObjects()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static std::vector&lt; <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html">OPObject</a> * &gt; openphase::OPObject::FindObjects </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html">OPObject</a> * &gt;&#160;</td>
          <td class="paramname"><em>ObjectList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>ObjectName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>thisclassname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>thisfunctionname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>necessary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>verbose</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d1c/OPObject_8h_source.html#l00166">166</a> of file <a class="el" href="../../d5/d1c/OPObject_8h_source.html">OPObject.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  175</span>    {</div>
<div class="line"><span class="lineno">  176</span>        std::vector&lt;OPObject*&gt; result;</div>
<div class="line"><span class="lineno">  177</span> </div>
<div class="line"><span class="lineno">  178</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; ObjectList.size(); i++)</div>
<div class="line"><span class="lineno">  179</span>        {</div>
<div class="line"><span class="lineno">  180</span>            <span class="keywordflow">if</span>(ObjectList[i]-&gt;<a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>.size() &gt;= ObjectName.size())</div>
<div class="line"><span class="lineno">  181</span>            {</div>
<div class="line"><span class="lineno">  182</span>                std::string locObjectName = ObjectList[i]-&gt;thisclassname;</div>
<div class="line"><span class="lineno">  183</span>                locObjectName.resize(ObjectName.size());</div>
<div class="line"><span class="lineno">  184</span> </div>
<div class="line"><span class="lineno">  185</span>                <span class="keywordflow">if</span>(locObjectName == ObjectName)</div>
<div class="line"><span class="lineno">  186</span>                {</div>
<div class="line"><span class="lineno">  187</span>                    result.push_back(ObjectList[i]);</div>
<div class="line"><span class="lineno">  188</span>                }</div>
<div class="line"><span class="lineno">  189</span>            }</div>
<div class="line"><span class="lineno">  190</span>        }</div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span>        <span class="keywordflow">if</span>(result.size() == 0)</div>
<div class="line"><span class="lineno">  193</span>        {</div>
<div class="line"><span class="lineno">  194</span>            <span class="keywordflow">if</span> (verbose)</div>
<div class="line"><span class="lineno">  195</span>            {</div>
<div class="line"><span class="lineno">  196</span>                std::cout &lt;&lt; <span class="stringliteral">&quot;No &quot;</span> &lt;&lt; ObjectName &lt;&lt; <span class="stringliteral">&quot; objects found! &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a></div>
<div class="line"><span class="lineno">  197</span>                          &lt;&lt; thisfunctionname &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  198</span>            }</div>
<div class="line"><span class="lineno">  199</span>            <span class="keywordflow">if</span>(necessary)</div>
<div class="line"><span class="lineno">  200</span>            {</div>
<div class="line"><span class="lineno">  201</span>                <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a4d6fed4ab71c6edf2a0bd5dabecc6ec6">OP_Exit</a>(13);</div>
<div class="line"><span class="lineno">  202</span>            }</div>
<div class="line"><span class="lineno">  203</span>        }</div>
<div class="line"><span class="lineno">  204</span>        <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  205</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a33dcb60f605e77f9e5b1489c903dff44" name="a33dcb60f605e77f9e5b1489c903dff44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33dcb60f605e77f9e5b1489c903dff44">&#9670;&#160;</a></span>FixSpreading()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::FixSpreading </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cutoff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Removes phase-fields with values below the cutoff (used for reducing parasitic diffusion in advection) </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l01079">1079</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1080</span>{</div>
<div class="line"><span class="lineno"> 1081</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>,0,)</div>
<div class="line"><span class="lineno"> 1082</span>    {</div>
<div class="line"><span class="lineno"> 1083</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> alpha  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).begin();</div>
<div class="line"><span class="lineno"> 1084</span>                  alpha != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).end(); alpha++)</div>
<div class="line"><span class="lineno"> 1085</span>        {</div>
<div class="line"><span class="lineno"> 1086</span>            <span class="keywordflow">if</span>(alpha-&gt;value &lt; cutoff and <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[alpha-&gt;index].Stage == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#af71cd9b36fd77e1eb90f17b95c04e52eafa3aff3c185c6dc7754235f397c2099a">GrainStages::Stable</a>)</div>
<div class="line"><span class="lineno"> 1087</span>            {</div>
<div class="line"><span class="lineno"> 1088</span>                alpha-&gt;value = 0.0;</div>
<div class="line"><span class="lineno"> 1089</span>            }</div>
<div class="line"><span class="lineno"> 1090</span>        }</div>
<div class="line"><span class="lineno"> 1091</span>    }</div>
<div class="line"><span class="lineno"> 1092</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1093</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#af8c994d103fffdf2f55db24ab6553cf1">Finalize</a>(BC);</div>
<div class="line"><span class="lineno"> 1094</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aded773d18aecc0080ceee7e3daddbef5" name="aded773d18aecc0080ceee7e3daddbef5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aded773d18aecc0080ceee7e3daddbef5">&#9670;&#160;</a></span>FractionsPsi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d2/d51/classopenphase_1_1Tensor.html">Tensor</a>&lt; double, 2 &gt; openphase::PhaseField::FractionsPsi </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>locdt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates Phi.FieldsDot for thermodynamic phases. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03694">3694</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3695</span>{</div>
<div class="line"><span class="lineno"> 3696</span>    Tensor&lt;double,2&gt; Psi({<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a>,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a>});</div>
<div class="line"><span class="lineno"> 3697</span>    Psi.set_to_zero();</div>
<div class="line"><span class="lineno"> 3698</span>    <span class="keywordflow">for</span>(<span class="keyword">auto</span> it = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(x,y,z).cbegin();</div>
<div class="line"><span class="lineno"> 3699</span>             it != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(x,y,z).cend(); ++it)</div>
<div class="line"><span class="lineno"> 3700</span>    {</div>
<div class="line"><span class="lineno"> 3701</span>        <span class="keywordtype">size_t</span> pIndexA = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[it-&gt;indexA].Phase;                    <span class="comment">// Index of thermodynamic phase alpha in the phase pair alpha-beta</span></div>
<div class="line"><span class="lineno"> 3702</span>        <span class="keywordtype">size_t</span> pIndexB = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[it-&gt;indexB].Phase;                    <span class="comment">// Index of thermodynamic phase beta in the phase pair alpha-beta</span></div>
<div class="line"><span class="lineno"> 3703</span> </div>
<div class="line"><span class="lineno"> 3704</span>        <span class="keywordflow">if</span>(pIndexA != pIndexB)</div>
<div class="line"><span class="lineno"> 3705</span>        {</div>
<div class="line"><span class="lineno"> 3706</span>            Psi({pIndexA,pIndexB}) += it-&gt;value1*locdt;</div>
<div class="line"><span class="lineno"> 3707</span>            Psi({pIndexB,pIndexA}) -= it-&gt;value1*locdt;</div>
<div class="line"><span class="lineno"> 3708</span>        }</div>
<div class="line"><span class="lineno"> 3709</span>    }</div>
<div class="line"><span class="lineno"> 3710</span>    <span class="keywordflow">return</span> Psi;</div>
<div class="line"><span class="lineno"> 3711</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1d70acca43b1fd05174f9c24893f2172" name="a1d70acca43b1fd05174f9c24893f2172"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d70acca43b1fd05174f9c24893f2172">&#9670;&#160;</a></span>GetMaxPhaseFieldOverlap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; int &gt; openphase::PhaseField::GetMaxPhaseFieldOverlap </td>
          <td>(</td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>thPhase1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>thPhase2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thPhase1</td><td>Returns a vector containing the phase indices thPhase1 and thPhase2 that have the biggest overlap, also the number of interface points between the phasefields. vector contains 1. phasefield of thPhase1, 2. phasefield of thePhase2, 3. number of overlap points. All values are -1 if no overlap is found. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03522">3522</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3524</span>{</div>
<div class="line"><span class="lineno"> 3525</span>    std::vector&lt;int&gt; maxOverlap;</div>
<div class="line"><span class="lineno"> 3526</span>    Matrix&lt;int&gt; Overlap;</div>
<div class="line"><span class="lineno"> 3527</span>    <span class="keywordtype">size_t</span> numberOfGrains = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>.<a class="code hl_function" href="../../d6/d90/classopenphase_1_1GrainsProperties.html#abb458316f62ad7fda8d902015e081e9c">size</a>();</div>
<div class="line"><span class="lineno"> 3528</span>    Overlap.Allocate(numberOfGrains, numberOfGrains);</div>
<div class="line"><span class="lineno"> 3529</span> </div>
<div class="line"><span class="lineno"> 3530</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>,0,)</div>
<div class="line"><span class="lineno"> 3531</span>    {</div>
<div class="line"><span class="lineno"> 3532</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).interface())</div>
<div class="line"><span class="lineno"> 3533</span>        {</div>
<div class="line"><span class="lineno"> 3534</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> it  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 3535</span>                      it != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cend(); ++it)</div>
<div class="line"><span class="lineno"> 3536</span>            {</div>
<div class="line"><span class="lineno"> 3537</span>                <span class="keywordtype">size_t</span> locIndex1 = it-&gt;index;</div>
<div class="line"><span class="lineno"> 3538</span>                <span class="keywordtype">size_t</span> thPhaseIndex1 = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[locIndex1].Phase;</div>
<div class="line"><span class="lineno"> 3539</span>                <span class="keywordflow">if</span> (thPhaseIndex1 == thPhase1)</div>
<div class="line"><span class="lineno"> 3540</span>                {</div>
<div class="line"><span class="lineno"> 3541</span>                    <span class="keywordflow">for</span> (<span class="keyword">auto</span> jt = it+1; jt != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cend(); ++jt)</div>
<div class="line"><span class="lineno"> 3542</span>                    {</div>
<div class="line"><span class="lineno"> 3543</span>                        <span class="keywordtype">size_t</span> locIndex2 = jt-&gt;index;</div>
<div class="line"><span class="lineno"> 3544</span>                        <span class="keywordtype">size_t</span> thPhaseIndex2 = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[locIndex2].Phase;</div>
<div class="line"><span class="lineno"> 3545</span>                        <span class="keywordflow">if</span> (thPhaseIndex2 == thPhase2)</div>
<div class="line"><span class="lineno"> 3546</span>                        {</div>
<div class="line"><span class="lineno"> 3547</span>                            Overlap.add(locIndex1, locIndex2, 1);</div>
<div class="line"><span class="lineno"> 3548</span>                        }</div>
<div class="line"><span class="lineno"> 3549</span>                    }</div>
<div class="line"><span class="lineno"> 3550</span>                }</div>
<div class="line"><span class="lineno"> 3551</span>            }</div>
<div class="line"><span class="lineno"> 3552</span>        }</div>
<div class="line"><span class="lineno"> 3553</span>    }</div>
<div class="line"><span class="lineno"> 3554</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 3555</span> </div>
<div class="line"><span class="lineno"> 3556</span>    <span class="keywordtype">int</span> maxNx = -1;</div>
<div class="line"><span class="lineno"> 3557</span>    <span class="keywordtype">int</span> maxNy = -1;</div>
<div class="line"><span class="lineno"> 3558</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> it = 0; it &lt; numberOfGrains-1; it++)</div>
<div class="line"><span class="lineno"> 3559</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> jt = it+1; jt &lt; numberOfGrains; jt++)</div>
<div class="line"><span class="lineno"> 3560</span>    {</div>
<div class="line"><span class="lineno"> 3561</span>        <span class="keywordflow">if</span> (maxNx &lt; Overlap.get(it, jt))</div>
<div class="line"><span class="lineno"> 3562</span>        {</div>
<div class="line"><span class="lineno"> 3563</span>            maxNx = it;</div>
<div class="line"><span class="lineno"> 3564</span>            maxNy = jt;</div>
<div class="line"><span class="lineno"> 3565</span>        }</div>
<div class="line"><span class="lineno"> 3566</span>    }</div>
<div class="line"><span class="lineno"> 3567</span> </div>
<div class="line"><span class="lineno"> 3568</span>    <span class="keywordflow">if</span> (maxNx == -1 or maxNy == -1)</div>
<div class="line"><span class="lineno"> 3569</span>    {</div>
<div class="line"><span class="lineno"> 3570</span>        maxOverlap.push_back(-1);</div>
<div class="line"><span class="lineno"> 3571</span>        maxOverlap.push_back(-1);</div>
<div class="line"><span class="lineno"> 3572</span>        maxOverlap.push_back(-1);</div>
<div class="line"><span class="lineno"> 3573</span>        <span class="keywordflow">return</span> maxOverlap;</div>
<div class="line"><span class="lineno"> 3574</span>    }</div>
<div class="line"><span class="lineno"> 3575</span>    maxOverlap.push_back(maxNx);</div>
<div class="line"><span class="lineno"> 3576</span>    maxOverlap.push_back(maxNy);</div>
<div class="line"><span class="lineno"> 3577</span>    maxOverlap.push_back(Overlap.get(maxNx, maxNy));</div>
<div class="line"><span class="lineno"> 3578</span>    <span class="keywordflow">return</span> maxOverlap;</div>
<div class="line"><span class="lineno"> 3579</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2c4019fa7a39d6ad521011483e222e9b" name="a2c4019fa7a39d6ad521011483e222e9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c4019fa7a39d6ad521011483e222e9b">&#9670;&#160;</a></span>GetPhaseFieldOverlap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d1/d51/classopenphase_1_1Matrix.html">Matrix</a>&lt; int &gt; openphase::PhaseField::GetPhaseFieldOverlap </td>
          <td>(</td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>thPhase1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>thPhase2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thPhase1</td><td>Returns a <a class="el" href="../../d1/d51/classopenphase_1_1Matrix.html" title="&lt; Matrix template class. Can handle any type of values except &quot;bool&quot;">Matrix</a> containing overlap of phase indices denoted in the columns and rows of the matrix. Only values above the diagonal are set. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03581">3581</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3583</span>{</div>
<div class="line"><span class="lineno"> 3584</span>    Matrix&lt;int&gt; Overlap;</div>
<div class="line"><span class="lineno"> 3585</span>    <span class="keywordtype">int</span> numberOfGrains = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>.<a class="code hl_function" href="../../d6/d90/classopenphase_1_1GrainsProperties.html#abb458316f62ad7fda8d902015e081e9c">size</a>();</div>
<div class="line"><span class="lineno"> 3586</span>    Overlap.Allocate(numberOfGrains, numberOfGrains);</div>
<div class="line"><span class="lineno"> 3587</span> </div>
<div class="line"><span class="lineno"> 3588</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>,0,)</div>
<div class="line"><span class="lineno"> 3589</span>    {</div>
<div class="line"><span class="lineno"> 3590</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).interface())</div>
<div class="line"><span class="lineno"> 3591</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> it  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 3592</span>                  it != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cend(); ++it)</div>
<div class="line"><span class="lineno"> 3593</span>        {</div>
<div class="line"><span class="lineno"> 3594</span>            <span class="keywordtype">size_t</span> phaseIndex = it-&gt;index;</div>
<div class="line"><span class="lineno"> 3595</span>            <span class="keywordtype">size_t</span> thPhaseIndex = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[phaseIndex].Phase;</div>
<div class="line"><span class="lineno"> 3596</span>            <span class="keywordflow">if</span> (thPhaseIndex == thPhase1)</div>
<div class="line"><span class="lineno"> 3597</span>            {</div>
<div class="line"><span class="lineno"> 3598</span>                <span class="keywordflow">for</span> (<span class="keyword">auto</span> jt = it+1;</div>
<div class="line"><span class="lineno"> 3599</span>                          jt &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cend(); ++jt)</div>
<div class="line"><span class="lineno"> 3600</span>                {</div>
<div class="line"><span class="lineno"> 3601</span>                    <span class="keywordtype">size_t</span> phaseIndex2 = jt-&gt;index;</div>
<div class="line"><span class="lineno"> 3602</span>                    <span class="keywordtype">size_t</span> thPhaseIndex2 = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[phaseIndex2].Phase;</div>
<div class="line"><span class="lineno"> 3603</span> </div>
<div class="line"><span class="lineno"> 3604</span><span class="preprocessor">                    #ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3605</span><span class="preprocessor">                    #pragma omp critical</span></div>
<div class="line"><span class="lineno"> 3606</span><span class="preprocessor">                    #endif</span></div>
<div class="line"><span class="lineno"> 3607</span>                    <span class="keywordflow">if</span> (thPhaseIndex2 == thPhase2)</div>
<div class="line"><span class="lineno"> 3608</span>                    {</div>
<div class="line"><span class="lineno"> 3609</span>                        Overlap.add(phaseIndex, phaseIndex2, 1);</div>
<div class="line"><span class="lineno"> 3610</span>                    }</div>
<div class="line"><span class="lineno"> 3611</span>                }</div>
<div class="line"><span class="lineno"> 3612</span>            }</div>
<div class="line"><span class="lineno"> 3613</span>        }</div>
<div class="line"><span class="lineno"> 3614</span>    }</div>
<div class="line"><span class="lineno"> 3615</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 3616</span>    <span class="keywordflow">return</span> Overlap;</div>
<div class="line"><span class="lineno"> 3617</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="accb74fb9f428cc7eeffc38a4aae626da" name="accb74fb9f428cc7eeffc38a4aae626da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accb74fb9f428cc7eeffc38a4aae626da">&#9670;&#160;</a></span>GetPresentPhaseFields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; int &gt; openphase::PhaseField::GetPresentPhaseFields </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns an ordered list with indices of present phase fields. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03061">3061</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3062</span>{</div>
<div class="line"><span class="lineno"> 3063</span>    std::vector&lt;int&gt; indeces;</div>
<div class="line"><span class="lineno"> 3064</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = 0; n &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>.<a class="code hl_function" href="../../d6/d90/classopenphase_1_1GrainsProperties.html#abb458316f62ad7fda8d902015e081e9c">size</a>(); n++)</div>
<div class="line"><span class="lineno"> 3065</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[n].Exist)</div>
<div class="line"><span class="lineno"> 3066</span>    {</div>
<div class="line"><span class="lineno"> 3067</span>        indeces.push_back(n);</div>
<div class="line"><span class="lineno"> 3068</span>    }</div>
<div class="line"><span class="lineno"> 3069</span> </div>
<div class="line"><span class="lineno"> 3070</span>    <span class="keywordflow">return</span> indeces;</div>
<div class="line"><span class="lineno"> 3071</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a657703c88fcc2adf92532ffc1955661a" name="a657703c88fcc2adf92532ffc1955661a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a657703c88fcc2adf92532ffc1955661a">&#9670;&#160;</a></span>Initialize()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::Initialize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;&#160;</td>
          <td class="paramname"><em>locSettings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>ObjectNameSuffix</em> = <code>&quot;&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initializes the storage and initial variables of the driving force class. </p>

<p>Reimplemented from <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#ab7b5d4fd526d189f269fade8896a789c">openphase::OPObject</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l00044">44</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   45</span>{</div>
<div class="line"><span class="lineno">   46</span>    <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a> = <span class="stringliteral">&quot;PhaseField&quot;</span>;</div>
<div class="line"><span class="lineno">   47</span>    <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#ac8c040bdc306f76b58d5a79201e5df66">thisobjectname</a> = <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a> + ObjectNameSuffix;</div>
<div class="line"><span class="lineno">   48</span> </div>
<div class="line"><span class="lineno">   49</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a80736ea4892c99f7a189d1138252be4b">NucleationPresent</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   50</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#acff69bbd27278034e9ecce362211ff29">InterfaceNormalModel</a> = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a5148c5d7019baf33d0a115bcb065772ca9babac0e9016d89ccebadf43556eb513">InterfaceNormalModels::AverageGradient</a>;</div>
<div class="line"><span class="lineno">   51</span> </div>
<div class="line"><span class="lineno">   52</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a> = locSettings.Grid;</div>
<div class="line"><span class="lineno">   53</span> </div>
<div class="line"><span class="lineno">   54</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a> = locSettings.Nphases;</div>
<div class="line"><span class="lineno">   55</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a00842a7df5798d0d7e5c677949ec5600">PhaseNames</a> = locSettings.PhaseNames;</div>
<div class="line"><span class="lineno">   56</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a18545778a21115cf2146d08dc86e2de4">PhaseAggregateStates</a> = locSettings.PhaseAggregateStates;</div>
<div class="line"><span class="lineno">   57</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a0c76a1996bda299c8471a126fb4f1f38">PhaseEquilibriumDensities</a> = locSettings.PhaseEquilibriumDensities;</div>
<div class="line"><span class="lineno">   58</span> </div>
<div class="line"><span class="lineno">   59</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a2f76b712f5418522f474928d17f453ef">NucleusVolumeFactor</a> = 1.0;</div>
<div class="line"><span class="lineno">   60</span> </div>
<div class="line"><span class="lineno">   61</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aae9497091c72d48f9c660f24a4b4749b">ConsiderNucleusVolume</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   62</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa63bc774f077e754f035dc1602e80574">Combine</a>.resize(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">   63</span> </div>
<div class="line"><span class="lineno">   64</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a65cf354fce580b8677302a60babdc3b2">PhaseFieldLaplacianStencil</a> = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#aa3d45caada142bcd6850f4ba4aebc678a14b5edf8fb82e568afeb4413c67fa479">LaplacianStencils::Isotropic</a>;</div>
<div class="line"><span class="lineno">   65</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a6d205eece17c945a4b51869b49184e1a">PhaseFieldGradientStencil</a> = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a210cb929dad1ae2aed26a10365a10b3da14b5edf8fb82e568afeb4413c67fa479">GradientStencils::Isotropic</a>;</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>    locSettings.AddForAdvection(*<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno">   68</span>    locSettings.AddForRemeshing(*<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno">   69</span>    locSettings.AddForReading(*<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno">   70</span> </div>
<div class="line"><span class="lineno">   71</span>    <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#aa112048d179026f359161b1f20e5e98e">initialized</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   72</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, <span class="stringliteral">&quot;Initialized&quot;</span>);</div>
<div class="line"><span class="lineno">   73</span>}</div>
<div class="ttc" id="aclassopenphase_1_1OPObject_html_aa112048d179026f359161b1f20e5e98e"><div class="ttname"><a href="../../d6/dcd/classopenphase_1_1OPObject.html#aa112048d179026f359161b1f20e5e98e">openphase::OPObject::initialized</a></div><div class="ttdeci">bool initialized</div><div class="ttdoc">True if obect's Initialize has been executed.</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d1c/OPObject_8h_source.html#l00057">OPObject.h:57</a></div></div>
<div class="ttc" id="aclassopenphase_1_1OPObject_html_ac8c040bdc306f76b58d5a79201e5df66"><div class="ttname"><a href="../../d6/dcd/classopenphase_1_1OPObject.html#ac8c040bdc306f76b58d5a79201e5df66">openphase::OPObject::thisobjectname</a></div><div class="ttdeci">std::string thisobjectname</div><div class="ttdoc">Object's name.</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d1c/OPObject_8h_source.html#l00055">OPObject.h:55</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a00842a7df5798d0d7e5c677949ec5600"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a00842a7df5798d0d7e5c677949ec5600">openphase::PhaseField::PhaseNames</a></div><div class="ttdeci">std::vector&lt; std::string &gt; PhaseNames</div><div class="ttdoc">Names of phases for subset selection.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc5/PhaseField_8h_source.html#l00238">PhaseField.h:238</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a65cf354fce580b8677302a60babdc3b2"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a65cf354fce580b8677302a60babdc3b2">openphase::PhaseField::PhaseFieldLaplacianStencil</a></div><div class="ttdeci">LaplacianStencils PhaseFieldLaplacianStencil</div><div class="ttdoc">Phase-field Laplacian stencil selector.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc5/PhaseField_8h_source.html#l00233">PhaseField.h:233</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a6d205eece17c945a4b51869b49184e1a"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a6d205eece17c945a4b51869b49184e1a">openphase::PhaseField::PhaseFieldGradientStencil</a></div><div class="ttdeci">GradientStencils PhaseFieldGradientStencil</div><div class="ttdoc">Phase-field gradient stencil selector.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc5/PhaseField_8h_source.html#l00234">PhaseField.h:234</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_aae9497091c72d48f9c660f24a4b4749b"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#aae9497091c72d48f9c660f24a4b4749b">openphase::PhaseField::ConsiderNucleusVolume</a></div><div class="ttdeci">bool ConsiderNucleusVolume</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc5/PhaseField_8h_source.html#l00244">PhaseField.h:244</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_acff69bbd27278034e9ecce362211ff29"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#acff69bbd27278034e9ecce362211ff29">openphase::PhaseField::InterfaceNormalModel</a></div><div class="ttdeci">InterfaceNormalModels InterfaceNormalModel</div><div class="ttdoc">Model selector for the interface normal calculation.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc5/PhaseField_8h_source.html#l00232">PhaseField.h:232</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_a210cb929dad1ae2aed26a10365a10b3da14b5edf8fb82e568afeb4413c67fa479"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a210cb929dad1ae2aed26a10365a10b3da14b5edf8fb82e568afeb4413c67fa479">openphase::GradientStencils::Isotropic</a></div><div class="ttdeci">@ Isotropic</div></div>
<div class="ttc" id="anamespaceopenphase_html_a5148c5d7019baf33d0a115bcb065772ca9babac0e9016d89ccebadf43556eb513"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a5148c5d7019baf33d0a115bcb065772ca9babac0e9016d89ccebadf43556eb513">openphase::InterfaceNormalModels::AverageGradient</a></div><div class="ttdeci">@ AverageGradient</div><div class="ttdoc">Use normalized average phase-field gradient for a pair of grains as their interface normal.</div></div>
<div class="ttc" id="anamespaceopenphase_html_aa3d45caada142bcd6850f4ba4aebc678a14b5edf8fb82e568afeb4413c67fa479"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#aa3d45caada142bcd6850f4ba4aebc678a14b5edf8fb82e568afeb4413c67fa479">openphase::LaplacianStencils::Isotropic</a></div><div class="ttdeci">@ Isotropic</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af250fd36715996014455d03cf2054239" name="af250fd36715996014455d03cf2054239"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af250fd36715996014455d03cf2054239">&#9670;&#160;</a></span>Interfaces()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::PhaseField::Interfaces </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Indicates interfaces for <a class="el" href="../../d3/d89/structopenphase_1_1VTK.html" title="&lt; static class to write VTK data in xml format">VTK</a> output. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03765">3765</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3766</span>{</div>
<div class="line"><span class="lineno"> 3767</span>    <span class="keywordtype">double</span> sum = 0.5;</div>
<div class="line"><span class="lineno"> 3768</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).interface())</div>
<div class="line"><span class="lineno"> 3769</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> alpha  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 3770</span>              alpha != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cend(); ++alpha)</div>
<div class="line"><span class="lineno"> 3771</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>  beta  = alpha + 1;</div>
<div class="line"><span class="lineno"> 3772</span>               beta != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cend(); ++beta)</div>
<div class="line"><span class="lineno"> 3773</span>    {</div>
<div class="line"><span class="lineno"> 3774</span>        sum -= alpha-&gt;value*beta-&gt;value;</div>
<div class="line"><span class="lineno"> 3775</span>    }</div>
<div class="line"><span class="lineno"> 3776</span>    <span class="keywordflow">return</span> 1.0/(sum*2.0);</div>
<div class="line"><span class="lineno"> 3777</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a486fdf527759c74e5a2cad6d183f3dff" name="a486fdf527759c74e5a2cad6d183f3dff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a486fdf527759c74e5a2cad6d183f3dff">&#9670;&#160;</a></span>InterfacesDR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::PhaseField::InterfacesDR </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Indicates interfaces for <a class="el" href="../../d3/d89/structopenphase_1_1VTK.html" title="&lt; static class to write VTK data in xml format">VTK</a> output in double resolution. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03779">3779</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3780</span>{</div>
<div class="line"><span class="lineno"> 3781</span>    <span class="keywordtype">double</span> sum = 0.5;</div>
<div class="line"><span class="lineno"> 3782</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).interface())</div>
<div class="line"><span class="lineno"> 3783</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> alpha  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 3784</span>              alpha != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).cend(); ++alpha)</div>
<div class="line"><span class="lineno"> 3785</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>  beta  = alpha + 1;</div>
<div class="line"><span class="lineno"> 3786</span>               beta != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).cend(); ++beta)</div>
<div class="line"><span class="lineno"> 3787</span>    {</div>
<div class="line"><span class="lineno"> 3788</span>        sum -= alpha-&gt;value*beta-&gt;value;</div>
<div class="line"><span class="lineno"> 3789</span>    }</div>
<div class="line"><span class="lineno"> 3790</span>    <span class="keywordflow">return</span> 1.0/(sum*2.0);</div>
<div class="line"><span class="lineno"> 3791</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae696c115461770a961448e429988a1dc" name="ae696c115461770a961448e429988a1dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae696c115461770a961448e429988a1dc">&#9670;&#160;</a></span>KeepPhaseFieldsVolume()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::KeepPhaseFieldsVolume </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Keeps phase fields volume constant by allowing only grain shape change. Should be called before <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a8634488569676742857d5127adc23e20" title="Normalizes the interface fields such that resulting phase fields after merge do not escape interval [...">NormalizeIncrements()</a> </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l01921">1921</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1922</span>{</div>
<div class="line"><span class="lineno"> 1923</span>    Tensor&lt;bool,2&gt; AllowedTransitions({<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a>,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a>});</div>
<div class="line"><span class="lineno"> 1924</span>    <span class="comment">// Disallow all transitions</span></div>
<div class="line"><span class="lineno"> 1925</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a>; n++)</div>
<div class="line"><span class="lineno"> 1926</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> m = 0; m &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a>; m++)</div>
<div class="line"><span class="lineno"> 1927</span>    {</div>
<div class="line"><span class="lineno"> 1928</span>        AllowedTransitions({n,m}) = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1929</span>    }</div>
<div class="line"><span class="lineno"> 1930</span> </div>
<div class="line"><span class="lineno"> 1931</span>    <span class="keywordflow">switch</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#af0b28822d6a3aba3df4db780b51db71a">Resolution</a>)</div>
<div class="line"><span class="lineno"> 1932</span>    {</div>
<div class="line"><span class="lineno"> 1933</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e">Resolutions::Single</a>:</div>
<div class="line"><span class="lineno"> 1934</span>        {</div>
<div class="line"><span class="lineno"> 1935</span>            <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a299fe17f6a9c7e34827a97eeaa82226b">KeepPhaseVolumeSR</a>(AllowedTransitions);</div>
<div class="line"><span class="lineno"> 1936</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1937</span>        }</div>
<div class="line"><span class="lineno"> 1938</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>:</div>
<div class="line"><span class="lineno"> 1939</span>        {</div>
<div class="line"><span class="lineno"> 1940</span>            <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a5b47ac8a0e26375b6ab6e6ee871836e0">KeepPhaseVolumeDR</a>(AllowedTransitions);</div>
<div class="line"><span class="lineno"> 1941</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1942</span>        }</div>
<div class="line"><span class="lineno"> 1943</span>    }</div>
<div class="line"><span class="lineno"> 1944</span>}</div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a299fe17f6a9c7e34827a97eeaa82226b"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a299fe17f6a9c7e34827a97eeaa82226b">openphase::PhaseField::KeepPhaseVolumeSR</a></div><div class="ttdeci">void KeepPhaseVolumeSR(Tensor&lt; bool, 2 &gt; AllowedTransitions)</div><div class="ttdoc">Keeps phases volume constant by allowing only grain shape change and grain transformations between th...</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l01946">PhaseField.cpp:1946</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a5b47ac8a0e26375b6ab6e6ee871836e0"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a5b47ac8a0e26375b6ab6e6ee871836e0">openphase::PhaseField::KeepPhaseVolumeDR</a></div><div class="ttdeci">void KeepPhaseVolumeDR(Tensor&lt; bool, 2 &gt; AllowedTransitions)</div><div class="ttdoc">Keeps phases volume constant by allowing only grain shape change and grain transformations between th...</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l02009">PhaseField.cpp:2009</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5b47ac8a0e26375b6ab6e6ee871836e0" name="a5b47ac8a0e26375b6ab6e6ee871836e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b47ac8a0e26375b6ab6e6ee871836e0">&#9670;&#160;</a></span>KeepPhaseVolumeDR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::KeepPhaseVolumeDR </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d51/classopenphase_1_1Tensor.html">Tensor</a>&lt; bool, 2 &gt;&#160;</td>
          <td class="paramname"><em>AllowedTransitions</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Keeps phases volume constant by allowing only grain shape change and grain transformations between the grains of the same phase (emulates coexistence of immiscible phases). Should be called before <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a8634488569676742857d5127adc23e20" title="Normalizes the interface fields such that resulting phase fields after merge do not escape interval [...">NormalizeIncrements()</a> </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02009">2009</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2010</span>{</div>
<div class="line"><span class="lineno"> 2011</span>    vector&lt;NodeAB&lt;double,double&gt;&gt; PairwiseVolumeChange;</div>
<div class="line"><span class="lineno"> 2012</span> </div>
<div class="line"><span class="lineno"> 2013</span>    <span class="keywordtype">size_t</span> Nthreads = 1;</div>
<div class="line"><span class="lineno"> 2014</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2015</span>    Nthreads = <a class="code hl_function" href="../../d9/df1/Globals_8h.html#a84e35f14fe6cb1b6648be757446483e2">omp_get_max_threads</a>();</div>
<div class="line"><span class="lineno"> 2016</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2017</span>    PairwiseVolumeChange.resize(Nthreads);</div>
<div class="line"><span class="lineno"> 2018</span> </div>
<div class="line"><span class="lineno"> 2019</span>    <span class="comment">// Collect pairwise increments and corresponding weights</span></div>
<div class="line"><span class="lineno"> 2020</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i, j, k, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>, 0, )</div>
<div class="line"><span class="lineno"> 2021</span>    {</div>
<div class="line"><span class="lineno"> 2022</span>        <span class="keywordtype">int</span> thNum = 0;</div>
<div class="line"><span class="lineno"> 2023</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2024</span>        thNum = <a class="code hl_function" href="../../d9/df1/Globals_8h.html#aba06990768c6b572ca3f69029334a9df">omp_get_thread_num</a>();</div>
<div class="line"><span class="lineno"> 2025</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2026</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).wide_interface())</div>
<div class="line"><span class="lineno"> 2027</span>        <span class="keywordflow">for</span>(<span class="keyword">auto</span> alpha = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 2028</span>                 alpha != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).cend() - 1; ++alpha)</div>
<div class="line"><span class="lineno"> 2029</span>        <span class="keywordflow">for</span>(<span class="keyword">auto</span>  beta = alpha + 1;</div>
<div class="line"><span class="lineno"> 2030</span>                  beta != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).cend(); ++beta)</div>
<div class="line"><span class="lineno"> 2031</span>        {</div>
<div class="line"><span class="lineno"> 2032</span>            <span class="keywordtype">size_t</span> pIndexA = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[alpha-&gt;index].Phase;</div>
<div class="line"><span class="lineno"> 2033</span>            <span class="keywordtype">size_t</span> pIndexB = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[ beta-&gt;index].Phase;</div>
<div class="line"><span class="lineno"> 2034</span>            <span class="keywordflow">if</span>(not AllowedTransitions({pIndexA, pIndexB}))</div>
<div class="line"><span class="lineno"> 2035</span>            {</div>
<div class="line"><span class="lineno"> 2036</span>                <span class="keywordtype">double</span> locPhiDot = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>(i,j,k).get_asym1(alpha-&gt;index, beta-&gt;index);</div>
<div class="line"><span class="lineno"> 2037</span>                PairwiseVolumeChange[thNum].add_asym1(alpha-&gt;index, beta-&gt;index, locPhiDot);</div>
<div class="line"><span class="lineno"> 2038</span>                PairwiseVolumeChange[thNum].add_sym2(alpha-&gt;index, beta-&gt;index, sqrt(alpha-&gt;value*beta-&gt;value));</div>
<div class="line"><span class="lineno"> 2039</span>            }</div>
<div class="line"><span class="lineno"> 2040</span>        }</div>
<div class="line"><span class="lineno"> 2041</span>    }</div>
<div class="line"><span class="lineno"> 2042</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 2043</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> th = 1; th &lt; Nthreads; th++)</div>
<div class="line"><span class="lineno"> 2044</span>    {</div>
<div class="line"><span class="lineno"> 2045</span>        PairwiseVolumeChange[0].add_asym1(PairwiseVolumeChange[th]);</div>
<div class="line"><span class="lineno"> 2046</span>        PairwiseVolumeChange[0].add_sym2(PairwiseVolumeChange[th]);</div>
<div class="line"><span class="lineno"> 2047</span>    }</div>
<div class="line"><span class="lineno"> 2048</span>    <span class="comment">// Distribute pairwise increments using corresponding weights</span></div>
<div class="line"><span class="lineno"> 2049</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i, j, k, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>, 0, )</div>
<div class="line"><span class="lineno"> 2050</span>    {</div>
<div class="line"><span class="lineno"> 2051</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).interface())</div>
<div class="line"><span class="lineno"> 2052</span>        <span class="keywordflow">for</span>(<span class="keyword">auto</span> alpha = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 2053</span>                 alpha != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).cend() - 1; ++alpha)</div>
<div class="line"><span class="lineno"> 2054</span>        <span class="keywordflow">for</span>(<span class="keyword">auto</span>  beta = alpha + 1;</div>
<div class="line"><span class="lineno"> 2055</span>                  beta != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).cend(); ++beta)</div>
<div class="line"><span class="lineno"> 2056</span>        <span class="keywordflow">if</span>(alpha-&gt;value*beta-&gt;value != 0.0)</div>
<div class="line"><span class="lineno"> 2057</span>        {</div>
<div class="line"><span class="lineno"> 2058</span>            <span class="keywordtype">size_t</span> pIndexA = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[alpha-&gt;index].Phase;</div>
<div class="line"><span class="lineno"> 2059</span>            <span class="keywordtype">size_t</span> pIndexB = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[ beta-&gt;index].Phase;</div>
<div class="line"><span class="lineno"> 2060</span>            <span class="keywordflow">if</span>(not AllowedTransitions({pIndexA, pIndexB}))</div>
<div class="line"><span class="lineno"> 2061</span>            {</div>
<div class="line"><span class="lineno"> 2062</span>                <span class="keywordflow">if</span>(PairwiseVolumeChange[0].get_sym2(alpha-&gt;index,beta-&gt;index) != 0.0)</div>
<div class="line"><span class="lineno"> 2063</span>                {</div>
<div class="line"><span class="lineno"> 2064</span>                    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>(i,j,k).add_asym1(alpha-&gt;index, beta-&gt;index,</div>
<div class="line"><span class="lineno"> 2065</span>                        -PairwiseVolumeChange[0].get_asym1(alpha-&gt;index,beta-&gt;index)*sqrt(alpha-&gt;value*beta-&gt;value)/</div>
<div class="line"><span class="lineno"> 2066</span>                         PairwiseVolumeChange[0].get_sym2(alpha-&gt;index,beta-&gt;index));</div>
<div class="line"><span class="lineno"> 2067</span>                }</div>
<div class="line"><span class="lineno"> 2068</span>            }</div>
<div class="line"><span class="lineno"> 2069</span>        }</div>
<div class="line"><span class="lineno"> 2070</span>    }</div>
<div class="line"><span class="lineno"> 2071</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 2072</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a299fe17f6a9c7e34827a97eeaa82226b" name="a299fe17f6a9c7e34827a97eeaa82226b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a299fe17f6a9c7e34827a97eeaa82226b">&#9670;&#160;</a></span>KeepPhaseVolumeSR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::KeepPhaseVolumeSR </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d51/classopenphase_1_1Tensor.html">Tensor</a>&lt; bool, 2 &gt;&#160;</td>
          <td class="paramname"><em>AllowedTransitions</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Keeps phases volume constant by allowing only grain shape change and grain transformations between the grains of the same phase (emulates coexistence of immiscible phases). Should be called before <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a8634488569676742857d5127adc23e20" title="Normalizes the interface fields such that resulting phase fields after merge do not escape interval [...">NormalizeIncrements()</a> </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l01946">1946</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1947</span>{</div>
<div class="line"><span class="lineno"> 1948</span>    vector&lt;NodeAB&lt;double,double&gt;&gt; PairwiseVolumeChange;</div>
<div class="line"><span class="lineno"> 1949</span> </div>
<div class="line"><span class="lineno"> 1950</span>    <span class="keywordtype">size_t</span> Nthreads = 1;</div>
<div class="line"><span class="lineno"> 1951</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1952</span>    Nthreads = <a class="code hl_function" href="../../d9/df1/Globals_8h.html#a84e35f14fe6cb1b6648be757446483e2">omp_get_max_threads</a>();</div>
<div class="line"><span class="lineno"> 1953</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1954</span>    PairwiseVolumeChange.resize(Nthreads);</div>
<div class="line"><span class="lineno"> 1955</span> </div>
<div class="line"><span class="lineno"> 1956</span>    <span class="comment">// Collect pairwise increments and corresponding weights</span></div>
<div class="line"><span class="lineno"> 1957</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i, j, k, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>, 0, )</div>
<div class="line"><span class="lineno"> 1958</span>    {</div>
<div class="line"><span class="lineno"> 1959</span>        <span class="keywordtype">int</span> thNum = 0;</div>
<div class="line"><span class="lineno"> 1960</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1961</span>        thNum = <a class="code hl_function" href="../../d9/df1/Globals_8h.html#aba06990768c6b572ca3f69029334a9df">omp_get_thread_num</a>();</div>
<div class="line"><span class="lineno"> 1962</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1963</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).wide_interface())</div>
<div class="line"><span class="lineno"> 1964</span>        <span class="keywordflow">for</span>(<span class="keyword">auto</span> alpha = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 1965</span>                 alpha != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cend() - 1; ++alpha)</div>
<div class="line"><span class="lineno"> 1966</span>        <span class="keywordflow">for</span>(<span class="keyword">auto</span>  beta = alpha + 1;</div>
<div class="line"><span class="lineno"> 1967</span>                  beta != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cend(); ++beta)</div>
<div class="line"><span class="lineno"> 1968</span>        {</div>
<div class="line"><span class="lineno"> 1969</span>            <span class="keywordtype">size_t</span> pIndexA = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[alpha-&gt;index].Phase;</div>
<div class="line"><span class="lineno"> 1970</span>            <span class="keywordtype">size_t</span> pIndexB = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[ beta-&gt;index].Phase;</div>
<div class="line"><span class="lineno"> 1971</span>            <span class="keywordflow">if</span>(not AllowedTransitions({pIndexA, pIndexB}))</div>
<div class="line"><span class="lineno"> 1972</span>            {</div>
<div class="line"><span class="lineno"> 1973</span>                <span class="keywordtype">double</span> locPhiDot = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).get_asym1(alpha-&gt;index, beta-&gt;index);</div>
<div class="line"><span class="lineno"> 1974</span>                PairwiseVolumeChange[thNum].add_asym1(alpha-&gt;index, beta-&gt;index, locPhiDot);</div>
<div class="line"><span class="lineno"> 1975</span>                PairwiseVolumeChange[thNum].add_sym2(alpha-&gt;index, beta-&gt;index, sqrt(alpha-&gt;value*beta-&gt;value));</div>
<div class="line"><span class="lineno"> 1976</span>            }</div>
<div class="line"><span class="lineno"> 1977</span>        }</div>
<div class="line"><span class="lineno"> 1978</span>    }</div>
<div class="line"><span class="lineno"> 1979</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1980</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> th = 1; th &lt; Nthreads; th++)</div>
<div class="line"><span class="lineno"> 1981</span>    {</div>
<div class="line"><span class="lineno"> 1982</span>        PairwiseVolumeChange[0].add_asym1(PairwiseVolumeChange[th]);</div>
<div class="line"><span class="lineno"> 1983</span>        PairwiseVolumeChange[0].add_sym2(PairwiseVolumeChange[th]);</div>
<div class="line"><span class="lineno"> 1984</span>    }</div>
<div class="line"><span class="lineno"> 1985</span>    <span class="comment">// Distribute pairwise increments using corresponding weights</span></div>
<div class="line"><span class="lineno"> 1986</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i, j, k, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>, 0, )</div>
<div class="line"><span class="lineno"> 1987</span>    {</div>
<div class="line"><span class="lineno"> 1988</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).interface())</div>
<div class="line"><span class="lineno"> 1989</span>        <span class="keywordflow">for</span>(<span class="keyword">auto</span> alpha = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cbegin();  alpha != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cend(); ++alpha)</div>
<div class="line"><span class="lineno"> 1990</span>        <span class="keywordflow">for</span>(<span class="keyword">auto</span>  beta = alpha + 1; beta != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cend(); ++beta)</div>
<div class="line"><span class="lineno"> 1991</span>        <span class="keywordflow">if</span>(alpha-&gt;value*beta-&gt;value != 0.0)</div>
<div class="line"><span class="lineno"> 1992</span>        {</div>
<div class="line"><span class="lineno"> 1993</span>            <span class="keywordtype">size_t</span> pIndexA = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[alpha-&gt;index].Phase;</div>
<div class="line"><span class="lineno"> 1994</span>            <span class="keywordtype">size_t</span> pIndexB = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[ beta-&gt;index].Phase;</div>
<div class="line"><span class="lineno"> 1995</span>            <span class="keywordflow">if</span>(not AllowedTransitions({pIndexA, pIndexB}))</div>
<div class="line"><span class="lineno"> 1996</span>            {</div>
<div class="line"><span class="lineno"> 1997</span>                <span class="keywordflow">if</span>(PairwiseVolumeChange[0].get_sym2(alpha-&gt;index,beta-&gt;index) != 0.0)</div>
<div class="line"><span class="lineno"> 1998</span>                {</div>
<div class="line"><span class="lineno"> 1999</span>                    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).add_asym1(alpha-&gt;index, beta-&gt;index,</div>
<div class="line"><span class="lineno"> 2000</span>                        -PairwiseVolumeChange[0].get_asym1(alpha-&gt;index,beta-&gt;index)*sqrt(alpha-&gt;value*beta-&gt;value)/</div>
<div class="line"><span class="lineno"> 2001</span>                         PairwiseVolumeChange[0].get_sym2(alpha-&gt;index,beta-&gt;index));</div>
<div class="line"><span class="lineno"> 2002</span>                }</div>
<div class="line"><span class="lineno"> 2003</span>            }</div>
<div class="line"><span class="lineno"> 2004</span>        }</div>
<div class="line"><span class="lineno"> 2005</span>    }</div>
<div class="line"><span class="lineno"> 2006</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 2007</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="adb6a39a1c39844061f3858d21170f3c0" name="adb6a39a1c39844061f3858d21170f3c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb6a39a1c39844061f3858d21170f3c0">&#9670;&#160;</a></span>LocalN()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::PhaseField::LocalN </td>
          <td>(</td>
          <td class="paramtype">const T &amp;&#160;</td>
          <td class="paramname"><em>locPF</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/dc5/PhaseField_8h_source.html#l00085">85</a> of file <a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   86</span>    {</div>
<div class="line"><span class="lineno">   87</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aae9497091c72d48f9c660f24a4b4749b">ConsiderNucleusVolume</a>) <span class="keywordflow">return</span> locPF.size();</div>
<div class="line"><span class="lineno">   88</span>        <span class="keywordtype">double</span> norm = 0.0;</div>
<div class="line"><span class="lineno">   89</span>        <span class="keywordflow">for</span>(<span class="keyword">auto</span> alpha  = locPF.cbegin();</div>
<div class="line"><span class="lineno">   90</span>                 alpha != locPF.cend(); ++alpha)</div>
<div class="line"><span class="lineno">   91</span>        {</div>
<div class="line"><span class="lineno">   92</span>            norm += <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[alpha-&gt;index].VolumeRatio;</div>
<div class="line"><span class="lineno">   93</span>        }</div>
<div class="line"><span class="lineno">   94</span>        <span class="keywordflow">return</span> norm;</div>
<div class="line"><span class="lineno">   95</span>    };</div>
</div><!-- fragment -->
</div>
</div>
<a id="afc8bd5f899b5a035ec29b8ac061a1a90" name="afc8bd5f899b5a035ec29b8ac061a1a90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc8bd5f899b5a035ec29b8ac061a1a90">&#9670;&#160;</a></span>MergeIncrements()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::MergeIncrements </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>finalize</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>clear</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Merges the increments into the phase fields. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l01248">1248</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1252</span>{</div>
<div class="line"><span class="lineno"> 1253</span>    <span class="keywordflow">switch</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#af0b28822d6a3aba3df4db780b51db71a">Resolution</a>)</div>
<div class="line"><span class="lineno"> 1254</span>    {</div>
<div class="line"><span class="lineno"> 1255</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e">Resolutions::Single</a>:</div>
<div class="line"><span class="lineno"> 1256</span>        {</div>
<div class="line"><span class="lineno"> 1257</span>            <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a543b2cf36dd1d38b1ad4754cdb2deace">MergeIncrementsSR</a>(BC, dt, finalize, clear);</div>
<div class="line"><span class="lineno"> 1258</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1259</span>        }</div>
<div class="line"><span class="lineno"> 1260</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>:</div>
<div class="line"><span class="lineno"> 1261</span>        {</div>
<div class="line"><span class="lineno"> 1262</span>            <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a1179b4b4b3ba1529a00ed1b6f4ab7cbe">MergeIncrementsDR</a>(BC, dt, finalize, clear);</div>
<div class="line"><span class="lineno"> 1263</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1264</span>        }</div>
<div class="line"><span class="lineno"> 1265</span>    }</div>
<div class="line"><span class="lineno"> 1266</span>}</div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a1179b4b4b3ba1529a00ed1b6f4ab7cbe"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a1179b4b4b3ba1529a00ed1b6f4ab7cbe">openphase::PhaseField::MergeIncrementsDR</a></div><div class="ttdeci">void MergeIncrementsDR(const BoundaryConditions &amp;BC, const double dt, const bool finalize=true, const bool clear=true)</div><div class="ttdoc">Merges the increments into the phase fields in double resolution.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l01301">PhaseField.cpp:1301</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a543b2cf36dd1d38b1ad4754cdb2deace"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a543b2cf36dd1d38b1ad4754cdb2deace">openphase::PhaseField::MergeIncrementsSR</a></div><div class="ttdeci">void MergeIncrementsSR(const BoundaryConditions &amp;BC, const double dt, const bool finalize=true, const bool clear=true)</div><div class="ttdoc">Merges the increments into the phase fields in single resolution.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l01268">PhaseField.cpp:1268</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1179b4b4b3ba1529a00ed1b6f4ab7cbe" name="a1179b4b4b3ba1529a00ed1b6f4ab7cbe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1179b4b4b3ba1529a00ed1b6f4ab7cbe">&#9670;&#160;</a></span>MergeIncrementsDR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::MergeIncrementsDR </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>finalize</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>clear</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Merges the increments into the phase fields in double resolution. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l01301">1301</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1305</span>{</div>
<div class="line"><span class="lineno"> 1306</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>,0,)</div>
<div class="line"><span class="lineno"> 1307</span>    {</div>
<div class="line"><span class="lineno"> 1308</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).wide_interface())</div>
<div class="line"><span class="lineno"> 1309</span>        {</div>
<div class="line"><span class="lineno"> 1310</span>            <span class="keywordflow">for</span>(<span class="keyword">auto</span> <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 1311</span>                     <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a> != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>(i,j,k).cend(); ++<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>)</div>
<div class="line"><span class="lineno"> 1312</span>            {</div>
<div class="line"><span class="lineno"> 1313</span>                <span class="keywordtype">double</span> factor = 1.0;</div>
<div class="line"><span class="lineno"> 1314</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;indexA].GrowthConstraintsViolation != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a8903fc4d47c4e62c087ff1f4f8f76529a6adf97f83acf6453d4a6a4b1070f3754">GrowthConstraintsViolations::None</a> and</div>
<div class="line"><span class="lineno"> 1315</span>                   <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;indexB].GrowthConstraintsViolation != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a8903fc4d47c4e62c087ff1f4f8f76529a6adf97f83acf6453d4a6a4b1070f3754">GrowthConstraintsViolations::None</a>)</div>
<div class="line"><span class="lineno"> 1316</span>                {</div>
<div class="line"><span class="lineno"> 1317</span>                    factor *= <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3390ad72b1d99545de2cb145cdc35118">PairwiseGrowthFactors</a>.<a class="code hl_function" href="../../d3/dc0/classopenphase_1_1NodeAB.html#a90c0581ed8df7ac73674c22927b68c42">get_sym1</a>(<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;indexA,<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;indexB);</div>
<div class="line"><span class="lineno"> 1318</span>                }</div>
<div class="line"><span class="lineno"> 1319</span> </div>
<div class="line"><span class="lineno"> 1320</span>                <span class="keywordtype">double</span> value = factor*(<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;value1 + <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;value2)*dt;</div>
<div class="line"><span class="lineno"> 1321</span>                <span class="keywordflow">if</span>(fabs(value) &gt;= DBL_EPSILON)</div>
<div class="line"><span class="lineno"> 1322</span>                {</div>
<div class="line"><span class="lineno"> 1323</span>                    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).add_value(<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;indexA,  value);</div>
<div class="line"><span class="lineno"> 1324</span>                    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).add_value(<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;indexB, -value);</div>
<div class="line"><span class="lineno"> 1325</span>                }</div>
<div class="line"><span class="lineno"> 1326</span>            }</div>
<div class="line"><span class="lineno"> 1327</span>            <span class="keywordflow">if</span>(clear) <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>(i,j,k).clear();</div>
<div class="line"><span class="lineno"> 1328</span>        }</div>
<div class="line"><span class="lineno"> 1329</span>    }</div>
<div class="line"><span class="lineno"> 1330</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1331</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#af8c994d103fffdf2f55db24ab6553cf1">Finalize</a>(BC, finalize);</div>
<div class="line"><span class="lineno"> 1332</span>}</div>
<div class="ttc" id="aclassopenphase_1_1NodeAB_html_a90c0581ed8df7ac73674c22927b68c42"><div class="ttname"><a href="../../d3/dc0/classopenphase_1_1NodeAB.html#a90c0581ed8df7ac73674c22927b68c42">openphase::NodeAB::get_sym1</a></div><div class="ttdeci">T1 get_sym1(const size_t n, const size_t m) const</div><div class="ttdoc">Returns value1 in symmetric case: f(n,m) = f(m,n).</div><div class="ttdef"><b>Definition</b> <a href="../../da/d87/NodeAB_8h_source.html#l00397">NodeAB.h:397</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a3390ad72b1d99545de2cb145cdc35118"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a3390ad72b1d99545de2cb145cdc35118">openphase::PhaseField::PairwiseGrowthFactors</a></div><div class="ttdeci">NodeAB&lt; double, double &gt; PairwiseGrowthFactors</div><div class="ttdoc">Pairwise growth reduction factors to deal with stoichiometric and other constraints.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc5/PhaseField_8h_source.html#l00236">PhaseField.h:236</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_a8903fc4d47c4e62c087ff1f4f8f76529a6adf97f83acf6453d4a6a4b1070f3754"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a8903fc4d47c4e62c087ff1f4f8f76529a6adf97f83acf6453d4a6a4b1070f3754">openphase::GrowthConstraintsViolations::None</a></div><div class="ttdeci">@ None</div><div class="ttdoc">There is currently no violation.</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a543b2cf36dd1d38b1ad4754cdb2deace" name="a543b2cf36dd1d38b1ad4754cdb2deace"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a543b2cf36dd1d38b1ad4754cdb2deace">&#9670;&#160;</a></span>MergeIncrementsSR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::MergeIncrementsSR </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>finalize</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>clear</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Merges the increments into the phase fields in single resolution. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l01268">1268</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1272</span>{</div>
<div class="line"><span class="lineno"> 1273</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>,0,)</div>
<div class="line"><span class="lineno"> 1274</span>    {</div>
<div class="line"><span class="lineno"> 1275</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).wide_interface())</div>
<div class="line"><span class="lineno"> 1276</span>        {</div>
<div class="line"><span class="lineno"> 1277</span>            <span class="keywordflow">for</span>(<span class="keyword">auto</span> <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 1278</span>                     <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a> != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).cend(); ++<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>)</div>
<div class="line"><span class="lineno"> 1279</span>            {</div>
<div class="line"><span class="lineno"> 1280</span>                <span class="keywordtype">double</span> factor = 1.0;</div>
<div class="line"><span class="lineno"> 1281</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;indexA].GrowthConstraintsViolation != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a8903fc4d47c4e62c087ff1f4f8f76529a6adf97f83acf6453d4a6a4b1070f3754">GrowthConstraintsViolations::None</a> and</div>
<div class="line"><span class="lineno"> 1282</span>                   <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;indexB].GrowthConstraintsViolation != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a8903fc4d47c4e62c087ff1f4f8f76529a6adf97f83acf6453d4a6a4b1070f3754">GrowthConstraintsViolations::None</a>)</div>
<div class="line"><span class="lineno"> 1283</span>                {</div>
<div class="line"><span class="lineno"> 1284</span>                    factor *= <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3390ad72b1d99545de2cb145cdc35118">PairwiseGrowthFactors</a>.<a class="code hl_function" href="../../d3/dc0/classopenphase_1_1NodeAB.html#a90c0581ed8df7ac73674c22927b68c42">get_sym1</a>(<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;indexA,<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;indexB);</div>
<div class="line"><span class="lineno"> 1285</span>                }</div>
<div class="line"><span class="lineno"> 1286</span>            </div>
<div class="line"><span class="lineno"> 1287</span>                <span class="keywordtype">double</span> value = factor*(<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;value1 + <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;value2)*dt;</div>
<div class="line"><span class="lineno"> 1288</span>                <span class="keywordflow">if</span>(fabs(value) &gt;= DBL_EPSILON)</div>
<div class="line"><span class="lineno"> 1289</span>                {</div>
<div class="line"><span class="lineno"> 1290</span>                    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).add_value(<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;indexA,  value);</div>
<div class="line"><span class="lineno"> 1291</span>                    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).add_value(<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;indexB, -value);</div>
<div class="line"><span class="lineno"> 1292</span>                }</div>
<div class="line"><span class="lineno"> 1293</span>            }</div>
<div class="line"><span class="lineno"> 1294</span>            <span class="keywordflow">if</span>(clear) <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).clear();</div>
<div class="line"><span class="lineno"> 1295</span>        }</div>
<div class="line"><span class="lineno"> 1296</span>    }</div>
<div class="line"><span class="lineno"> 1297</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1298</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#af8c994d103fffdf2f55db24ab6553cf1">Finalize</a>(BC, finalize);</div>
<div class="line"><span class="lineno"> 1299</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aac075854614724322a8b23dfb874ea2f" name="aac075854614724322a8b23dfb874ea2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac075854614724322a8b23dfb874ea2f">&#9670;&#160;</a></span>MoveFrame()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::MoveFrame </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>dz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Shifts the data in the storage by dx, dy and dz (they should be 0, -1 or +1) in x, y and or z directions correspondingly. </p>

<p>Reimplemented from <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#a2dbefda68bf2a6123a095d4776f67cab">openphase::OPObject</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02592">2592</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2594</span>{</div>
<div class="line"><span class="lineno"> 2595</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#aac291b9b76a403056b1b9831b0664021">MoveFrameSR</a>(dx,dy,dz,BC);</div>
<div class="line"><span class="lineno"> 2596</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#af0b28822d6a3aba3df4db780b51db71a">Resolution</a> == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>)</div>
<div class="line"><span class="lineno"> 2597</span>    {</div>
<div class="line"><span class="lineno"> 2598</span>        <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a9e1910385649f9a3eda4a38062225d09">MoveFrameDR</a>(dx,dy,dz,BC);</div>
<div class="line"><span class="lineno"> 2599</span>    }</div>
<div class="line"><span class="lineno"> 2600</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#af8c994d103fffdf2f55db24ab6553cf1">Finalize</a>(BC);</div>
<div class="line"><span class="lineno"> 2601</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, <span class="stringliteral">&quot;Frame moved&quot;</span>);</div>
<div class="line"><span class="lineno"> 2602</span>}</div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a9e1910385649f9a3eda4a38062225d09"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a9e1910385649f9a3eda4a38062225d09">openphase::PhaseField::MoveFrameDR</a></div><div class="ttdeci">void MoveFrameDR(const int dx, const int dy, const int dz, const BoundaryConditions &amp;BC)</div><div class="ttdoc">Shifts the data in the storage by dx, dy and dz (they should be 0, -2 or +2) in x,...</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l02630">PhaseField.cpp:2630</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_aac291b9b76a403056b1b9831b0664021"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#aac291b9b76a403056b1b9831b0664021">openphase::PhaseField::MoveFrameSR</a></div><div class="ttdeci">void MoveFrameSR(const int dx, const int dy, const int dz, const BoundaryConditions &amp;BC)</div><div class="ttdoc">Shifts the data in the storage by dx, dy and dz (they should be 0, -1 or +1) in x,...</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l02604">PhaseField.cpp:2604</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9e1910385649f9a3eda4a38062225d09" name="a9e1910385649f9a3eda4a38062225d09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e1910385649f9a3eda4a38062225d09">&#9670;&#160;</a></span>MoveFrameDR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::MoveFrameDR </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>dz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Shifts the data in the storage by dx, dy and dz (they should be 0, -2 or +2) in x, y and or z directions correspondingly. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02630">2630</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2632</span>{</div>
<div class="line"><span class="lineno"> 2633</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n = 0; n &lt;= 1; n++)</div>
<div class="line"><span class="lineno"> 2634</span>    {</div>
<div class="line"><span class="lineno"> 2635</span>        <span class="keywordtype">int</span> xBeg = (dx &gt;= 0) + (dx &lt; 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.sizeX()) - 1;</div>
<div class="line"><span class="lineno"> 2636</span>        <span class="keywordtype">int</span> xEnd = (dx &gt;= 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.sizeX()) + (dx &lt; 0) - 1;</div>
<div class="line"><span class="lineno"> 2637</span>        <span class="keywordtype">int</span> xInc = 1 - 2*(dx &lt; 0);</div>
<div class="line"><span class="lineno"> 2638</span> </div>
<div class="line"><span class="lineno"> 2639</span>        <span class="keywordtype">int</span> yBeg = (dy &gt;= 0) + (dy &lt; 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.sizeY()) - 1;</div>
<div class="line"><span class="lineno"> 2640</span>        <span class="keywordtype">int</span> yEnd = (dy &gt;= 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.sizeY()) + (dy &lt; 0) - 1;</div>
<div class="line"><span class="lineno"> 2641</span>        <span class="keywordtype">int</span> yInc = 1 - 2*(dy &lt; 0);</div>
<div class="line"><span class="lineno"> 2642</span> </div>
<div class="line"><span class="lineno"> 2643</span>        <span class="keywordtype">int</span> zBeg = (dz &gt;= 0) + (dz &lt; 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.sizeZ()) - 1;</div>
<div class="line"><span class="lineno"> 2644</span>        <span class="keywordtype">int</span> zEnd = (dz &gt;= 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.sizeZ()) + (dz &lt; 0) - 1;</div>
<div class="line"><span class="lineno"> 2645</span>        <span class="keywordtype">int</span> zInc = 1 - 2*(dz &lt; 0);</div>
<div class="line"><span class="lineno"> 2646</span> </div>
<div class="line"><span class="lineno"> 2647</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = xBeg; ((dx &gt;= 0) and (i &lt;= xEnd)) or ((dx &lt; 0) and (i &gt;= xEnd)); i += xInc)</div>
<div class="line"><span class="lineno"> 2648</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = yBeg; ((dy &gt;= 0) and (j &lt;= yEnd)) or ((dy &lt; 0) and (j &gt;= yEnd)); j += yInc)</div>
<div class="line"><span class="lineno"> 2649</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = zBeg; ((dz &gt;= 0) and (k &lt;= zEnd)) or ((dz &lt; 0) and (k &gt;= zEnd)); k += zInc)</div>
<div class="line"><span class="lineno"> 2650</span>        {</div>
<div class="line"><span class="lineno"> 2651</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i, j, k) = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i + dx*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>, j + dy*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>, k + dz*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>);</div>
<div class="line"><span class="lineno"> 2652</span>        }</div>
<div class="line"><span class="lineno"> 2653</span>    }</div>
<div class="line"><span class="lineno"> 2654</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a42e3e7cdc1c94edd6e7a4cc8ca90c93a">SetBoundaryConditionsDR</a>(BC);</div>
<div class="line"><span class="lineno"> 2655</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aac291b9b76a403056b1b9831b0664021" name="aac291b9b76a403056b1b9831b0664021"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac291b9b76a403056b1b9831b0664021">&#9670;&#160;</a></span>MoveFrameSR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::MoveFrameSR </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>dz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Shifts the data in the storage by dx, dy and dz (they should be 0, -1 or +1) in x, y and or z directions correspondingly. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02604">2604</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2606</span>{</div>
<div class="line"><span class="lineno"> 2607</span>    <span class="keywordtype">int</span> xBeg = (dx &gt;= 0) + (dx &lt; 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>) - 1;</div>
<div class="line"><span class="lineno"> 2608</span>    <span class="keywordtype">int</span> xEnd = (dx &gt;= 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>) + (dx &lt; 0) - 1;</div>
<div class="line"><span class="lineno"> 2609</span>    <span class="keywordtype">int</span> xInc = 1 - 2*(dx &lt; 0);</div>
<div class="line"><span class="lineno"> 2610</span> </div>
<div class="line"><span class="lineno"> 2611</span>    <span class="keywordtype">int</span> yBeg = (dy &gt;= 0) + (dy &lt; 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>) - 1;</div>
<div class="line"><span class="lineno"> 2612</span>    <span class="keywordtype">int</span> yEnd = (dy &gt;= 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>) + (dy &lt; 0) - 1;</div>
<div class="line"><span class="lineno"> 2613</span>    <span class="keywordtype">int</span> yInc = 1 - 2*(dy &lt; 0);</div>
<div class="line"><span class="lineno"> 2614</span> </div>
<div class="line"><span class="lineno"> 2615</span>    <span class="keywordtype">int</span> zBeg = (dz &gt;= 0) + (dz &lt; 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>) - 1;</div>
<div class="line"><span class="lineno"> 2616</span>    <span class="keywordtype">int</span> zEnd = (dz &gt;= 0)*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>) + (dz &lt; 0) - 1;</div>
<div class="line"><span class="lineno"> 2617</span>    <span class="keywordtype">int</span> zInc = 1 - 2*(dz &lt; 0);</div>
<div class="line"><span class="lineno"> 2618</span> </div>
<div class="line"><span class="lineno"> 2619</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = xBeg; ((dx &gt;= 0) and (i &lt;= xEnd)) or ((dx &lt; 0) and (i &gt;= xEnd)); i += xInc)</div>
<div class="line"><span class="lineno"> 2620</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = yBeg; ((dy &gt;= 0) and (j &lt;= yEnd)) or ((dy &lt; 0) and (j &gt;= yEnd)); j += yInc)</div>
<div class="line"><span class="lineno"> 2621</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = zBeg; ((dz &gt;= 0) and (k &lt;= zEnd)) or ((dz &lt; 0) and (k &gt;= zEnd)); k += zInc)</div>
<div class="line"><span class="lineno"> 2622</span>    {</div>
<div class="line"><span class="lineno"> 2623</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i, j, k) = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i + dx*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>, j + dy*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>, k + dz*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>);</div>
<div class="line"><span class="lineno"> 2624</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a784a4bea9a5379192bdf4f12ab12cf10">Fractions</a>(i, j, k) = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a784a4bea9a5379192bdf4f12ab12cf10">Fractions</a>(i + dx*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>, j + dy*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>, k + dz*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>);</div>
<div class="line"><span class="lineno"> 2625</span> </div>
<div class="line"><span class="lineno"> 2626</span>    }</div>
<div class="line"><span class="lineno"> 2627</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a506595d6236a96859a36b19bc7fbd165">SetBoundaryConditionsSR</a>(BC);</div>
<div class="line"><span class="lineno"> 2628</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a83abda8ee8c2ac7c1252db160ea767da" name="a83abda8ee8c2ac7c1252db160ea767da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83abda8ee8c2ac7c1252db160ea767da">&#9670;&#160;</a></span>NewFractions() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d2/d51/classopenphase_1_1Tensor.html">Tensor</a>&lt; double, 1 &gt; openphase::PhaseField::NewFractions </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>locdt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates new thermodynamic phase fractions as if Phi.MergeIncrements would have been applied. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03669">3669</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3670</span>{</div>
<div class="line"><span class="lineno"> 3671</span>    Tensor&lt;double,1&gt; newFractions = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a784a4bea9a5379192bdf4f12ab12cf10">Fractions</a>(x,y,z);</div>
<div class="line"><span class="lineno"> 3672</span>    <span class="keywordflow">for</span>(<span class="keyword">auto</span> it = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(x,y,z).cbegin();</div>
<div class="line"><span class="lineno"> 3673</span>             it != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(x,y,z).cend(); ++it)</div>
<div class="line"><span class="lineno"> 3674</span>    {</div>
<div class="line"><span class="lineno"> 3675</span>        <span class="keywordtype">size_t</span> pIndexA = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[it-&gt;indexA].Phase;                    <span class="comment">// Index of thermodynamic phase alpha in the phase pair alpha-beta</span></div>
<div class="line"><span class="lineno"> 3676</span>        <span class="keywordtype">size_t</span> pIndexB = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[it-&gt;indexB].Phase;                    <span class="comment">// Index of thermodynamic phase beta in the phase pair alpha-beta</span></div>
<div class="line"><span class="lineno"> 3677</span> </div>
<div class="line"><span class="lineno"> 3678</span>        <span class="keywordflow">if</span>(pIndexA != pIndexB)</div>
<div class="line"><span class="lineno"> 3679</span>        {</div>
<div class="line"><span class="lineno"> 3680</span>            <span class="keywordtype">double</span> factor = 1.0;</div>
<div class="line"><span class="lineno"> 3681</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[it-&gt;indexA].GrowthConstraintsViolation != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a8903fc4d47c4e62c087ff1f4f8f76529a6adf97f83acf6453d4a6a4b1070f3754">GrowthConstraintsViolations::None</a> and</div>
<div class="line"><span class="lineno"> 3682</span>               <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[it-&gt;indexB].GrowthConstraintsViolation != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a8903fc4d47c4e62c087ff1f4f8f76529a6adf97f83acf6453d4a6a4b1070f3754">GrowthConstraintsViolations::None</a>)</div>
<div class="line"><span class="lineno"> 3683</span>            {</div>
<div class="line"><span class="lineno"> 3684</span>                factor *= <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3390ad72b1d99545de2cb145cdc35118">PairwiseGrowthFactors</a>.<a class="code hl_function" href="../../d3/dc0/classopenphase_1_1NodeAB.html#a90c0581ed8df7ac73674c22927b68c42">get_sym1</a>(it-&gt;indexA,it-&gt;indexB);</div>
<div class="line"><span class="lineno"> 3685</span>            }</div>
<div class="line"><span class="lineno"> 3686</span>        </div>
<div class="line"><span class="lineno"> 3687</span>            newFractions({pIndexA}) += factor*it-&gt;value1*locdt;</div>
<div class="line"><span class="lineno"> 3688</span>            newFractions({pIndexB}) -= factor*it-&gt;value1*locdt;</div>
<div class="line"><span class="lineno"> 3689</span>        }</div>
<div class="line"><span class="lineno"> 3690</span>    }</div>
<div class="line"><span class="lineno"> 3691</span>    <span class="keywordflow">return</span> newFractions;</div>
<div class="line"><span class="lineno"> 3692</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a75bb00cffe9873812da4a2554e80ec20" name="a75bb00cffe9873812da4a2554e80ec20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75bb00cffe9873812da4a2554e80ec20">&#9670;&#160;</a></span>NewFractions() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; double, 1 &gt; openphase::PhaseField::NewFractions </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Phase fractions at next time step. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03748">3748</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3749</span>{</div>
<div class="line"><span class="lineno"> 3750</span>    Storage3D&lt;double,1&gt; result(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>,{<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a>},0);</div>
<div class="line"><span class="lineno"> 3751</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(x,y,z,result,0,)</div>
<div class="line"><span class="lineno"> 3752</span>    if(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(x,y,z).wide_interface())</div>
<div class="line"><span class="lineno"> 3753</span>    {</div>
<div class="line"><span class="lineno"> 3754</span>        result(x,y,z) = <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#af493fd0af6996f16f26a78732d3c3f04">CalculateNewFractions</a>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a784a4bea9a5379192bdf4f12ab12cf10">Fractions</a>(x,y,z),</div>
<div class="line"><span class="lineno"> 3755</span>                                              <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(x,y,z),dt);</div>
<div class="line"><span class="lineno"> 3756</span>    }</div>
<div class="line"><span class="lineno"> 3757</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3758</span>    {</div>
<div class="line"><span class="lineno"> 3759</span>        result(x,y,z) = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a784a4bea9a5379192bdf4f12ab12cf10">Fractions</a>(x,y,z);</div>
<div class="line"><span class="lineno"> 3760</span>    }</div>
<div class="line"><span class="lineno"> 3761</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 3762</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno"> 3763</span>}</div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_af493fd0af6996f16f26a78732d3c3f04"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#af493fd0af6996f16f26a78732d3c3f04">openphase::PhaseField::CalculateNewFractions</a></div><div class="ttdeci">Tensor&lt; double, 1 &gt; CalculateNewFractions(Tensor&lt; double, 1 &gt; oldFractions, NodeAB&lt; double, double &gt; &amp;FieldsDot, double locdt)</div><div class="ttdoc">Calculates new thermodynamic phase fractions as if Phi.MergeIncrements would have been applied.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l03713">PhaseField.cpp:3713</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab8490e436f96b55e460658686ef4c203" name="ab8490e436f96b55e460658686ef4c203"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8490e436f96b55e460658686ef4c203">&#9670;&#160;</a></span>Normal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> openphase::PhaseField::Normal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/ddf/classopenphase_1_1NodePF.html#ab9d86bf0658a44de5aff74d71bd46363">NodePF::citerator</a>&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/ddf/classopenphase_1_1NodePF.html#ab9d86bf0658a44de5aff74d71bd46363">NodePF::citerator</a>&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns interface normal for a given pair of phase fields at a given position in double resolution. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l00714">714</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  715</span>{</div>
<div class="line"><span class="lineno">  716</span>    dVector3 locNormal;</div>
<div class="line"><span class="lineno">  717</span> </div>
<div class="line"><span class="lineno">  718</span>    <span class="keywordflow">switch</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#acff69bbd27278034e9ecce362211ff29">InterfaceNormalModel</a>)</div>
<div class="line"><span class="lineno">  719</span>    {</div>
<div class="line"><span class="lineno">  720</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a5148c5d7019baf33d0a115bcb065772ca9babac0e9016d89ccebadf43556eb513">InterfaceNormalModels::AverageGradient</a>:</div>
<div class="line"><span class="lineno">  721</span>        {</div>
<div class="line"><span class="lineno">  722</span>            locNormal = beta-&gt;gradient - alpha-&gt;gradient;</div>
<div class="line"><span class="lineno">  723</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  724</span>        }</div>
<div class="line"><span class="lineno">  725</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a5148c5d7019baf33d0a115bcb065772ca2eef6557154574f8d93facc1f3002cb1">InterfaceNormalModels::WeightedGradient</a>:</div>
<div class="line"><span class="lineno">  726</span>        {</div>
<div class="line"><span class="lineno">  727</span>            locNormal = beta-&gt;gradient*alpha-&gt;value - alpha-&gt;gradient*beta-&gt;value;</div>
<div class="line"><span class="lineno">  728</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  729</span>        }</div>
<div class="line"><span class="lineno">  730</span>    }</div>
<div class="line"><span class="lineno">  731</span>    locNormal.normalize();</div>
<div class="line"><span class="lineno">  732</span> </div>
<div class="line"><span class="lineno">  733</span>    <span class="keywordflow">return</span> locNormal;</div>
<div class="line"><span class="lineno">  734</span>}</div>
<div class="ttc" id="anamespaceopenphase_html_a5148c5d7019baf33d0a115bcb065772ca2eef6557154574f8d93facc1f3002cb1"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a5148c5d7019baf33d0a115bcb065772ca2eef6557154574f8d93facc1f3002cb1">openphase::InterfaceNormalModels::WeightedGradient</a></div><div class="ttdeci">@ WeightedGradient</div><div class="ttdoc">Use normalized weighted average phase-field gradient for a pair of grains as their interface normal.</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8634488569676742857d5127adc23e20" name="a8634488569676742857d5127adc23e20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8634488569676742857d5127adc23e20">&#9670;&#160;</a></span>NormalizeIncrements()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::NormalizeIncrements </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Normalizes the interface fields such that resulting phase fields after merge do not escape interval [0,1] and sum up to 1. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l01334">1334</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1335</span>{</div>
<div class="line"><span class="lineno"> 1336</span>    <span class="keywordflow">switch</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#af0b28822d6a3aba3df4db780b51db71a">Resolution</a>)</div>
<div class="line"><span class="lineno"> 1337</span>    {</div>
<div class="line"><span class="lineno"> 1338</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e">Resolutions::Single</a>:</div>
<div class="line"><span class="lineno"> 1339</span>        {</div>
<div class="line"><span class="lineno"> 1340</span>            <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#afc48631e25443062d9fa47d59f793dc9">NormalizeIncrementsSR</a>(BC, dt);</div>
<div class="line"><span class="lineno"> 1341</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1342</span>        }</div>
<div class="line"><span class="lineno"> 1343</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>:</div>
<div class="line"><span class="lineno"> 1344</span>        {</div>
<div class="line"><span class="lineno"> 1345</span>            <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#afad83087d5475bb9d90d543b49ff7bb7">NormalizeIncrementsDR</a>(BC, dt);</div>
<div class="line"><span class="lineno"> 1346</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1347</span>        }</div>
<div class="line"><span class="lineno"> 1348</span>    }</div>
<div class="line"><span class="lineno"> 1349</span>}</div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_afad83087d5475bb9d90d543b49ff7bb7"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#afad83087d5475bb9d90d543b49ff7bb7">openphase::PhaseField::NormalizeIncrementsDR</a></div><div class="ttdeci">void NormalizeIncrementsDR(const BoundaryConditions &amp;BC, const double dt)</div><div class="ttdoc">Normalizes the interface fields such that resulting phase fields after merge do not escape interval [...</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l01634">PhaseField.cpp:1634</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_afc48631e25443062d9fa47d59f793dc9"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#afc48631e25443062d9fa47d59f793dc9">openphase::PhaseField::NormalizeIncrementsSR</a></div><div class="ttdeci">void NormalizeIncrementsSR(const BoundaryConditions &amp;BC, const double dt)</div><div class="ttdoc">Normalizes the interface fields such that resulting phase fields after merge do not escape interval [...</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l01351">PhaseField.cpp:1351</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afad83087d5475bb9d90d543b49ff7bb7" name="afad83087d5475bb9d90d543b49ff7bb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afad83087d5475bb9d90d543b49ff7bb7">&#9670;&#160;</a></span>NormalizeIncrementsDR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::NormalizeIncrementsDR </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Normalizes the interface fields such that resulting phase fields after merge do not escape interval [0,1] and sum up to 1. </p>
<p>This function limits phase-field increments for all present phase-field pairs, so that the actual phase-field values are within their natural limits of 0.0 and 1.0.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l01634">1634</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1635</span>{</div>
<div class="line"><span class="lineno"> 1640</span>    <span class="keywordtype">double</span> precision = FLT_EPSILON;</div>
<div class="line"><span class="lineno"> 1641</span> </div>
<div class="line"><span class="lineno"> 1642</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>,0,)</div>
<div class="line"><span class="lineno"> 1643</span>    if (<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).wide_interface())</div>
<div class="line"><span class="lineno"> 1644</span>    {</div>
<div class="line"><span class="lineno"> 1645</span>        <span class="keywordflow">switch</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>(i,j,k).size())</div>
<div class="line"><span class="lineno"> 1646</span>        {</div>
<div class="line"><span class="lineno"> 1647</span>            <span class="keywordflow">case</span> 0:</div>
<div class="line"><span class="lineno"> 1648</span>            {</div>
<div class="line"><span class="lineno"> 1649</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1650</span>            }</div>
<div class="line"><span class="lineno"> 1651</span>            <span class="keywordflow">case</span> 1:</div>
<div class="line"><span class="lineno"> 1652</span>            {</div>
<div class="line"><span class="lineno"> 1653</span>                <span class="keywordtype">size_t</span> indexA = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>(i,j,k).front().indexA;</div>
<div class="line"><span class="lineno"> 1654</span>                <span class="keywordtype">double</span> valueA = (<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>(i,j,k).front().value1</div>
<div class="line"><span class="lineno"> 1655</span>                              +  <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>(i,j,k).front().value2)*dt;</div>
<div class="line"><span class="lineno"> 1656</span>                <span class="keywordtype">double</span> old_value = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).get_value(indexA);</div>
<div class="line"><span class="lineno"> 1657</span> </div>
<div class="line"><span class="lineno"> 1658</span>                <span class="keywordflow">if</span>((old_value == 0.0 and valueA &lt; 0.0) or</div>
<div class="line"><span class="lineno"> 1659</span>                   (old_value == 1.0 and valueA &gt; 0.0))</div>
<div class="line"><span class="lineno"> 1660</span>                {</div>
<div class="line"><span class="lineno"> 1661</span>                    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>(i,j,k).clear();</div>
<div class="line"><span class="lineno"> 1662</span>                }</div>
<div class="line"><span class="lineno"> 1663</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1664</span>                {</div>
<div class="line"><span class="lineno"> 1665</span>                    <span class="keywordtype">double</span> new_value = old_value + valueA;</div>
<div class="line"><span class="lineno"> 1666</span> </div>
<div class="line"><span class="lineno"> 1667</span>                    <span class="keywordtype">double</span> norm = 1.0;</div>
<div class="line"><span class="lineno"> 1668</span>                    <span class="keywordflow">if</span>(new_value &lt; 0.0)</div>
<div class="line"><span class="lineno"> 1669</span>                    {</div>
<div class="line"><span class="lineno"> 1670</span>                        norm *= -old_value/valueA;</div>
<div class="line"><span class="lineno"> 1671</span>                    }</div>
<div class="line"><span class="lineno"> 1672</span>                    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(new_value &gt; 1.0)</div>
<div class="line"><span class="lineno"> 1673</span>                    {</div>
<div class="line"><span class="lineno"> 1674</span>                        norm *= (1.0 - old_value)/valueA;</div>
<div class="line"><span class="lineno"> 1675</span>                    }</div>
<div class="line"><span class="lineno"> 1676</span> </div>
<div class="line"><span class="lineno"> 1677</span>                    <span class="keywordflow">if</span>(norm &gt; DBL_EPSILON)</div>
<div class="line"><span class="lineno"> 1678</span>                    {</div>
<div class="line"><span class="lineno"> 1679</span>                        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>(i,j,k) *= norm;</div>
<div class="line"><span class="lineno"> 1680</span>                    }</div>
<div class="line"><span class="lineno"> 1681</span>                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1682</span>                    {</div>
<div class="line"><span class="lineno"> 1683</span>                        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>(i,j,k).clear();</div>
<div class="line"><span class="lineno"> 1684</span>                    }</div>
<div class="line"><span class="lineno"> 1685</span>                }</div>
<div class="line"><span class="lineno"> 1686</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1687</span>            }</div>
<div class="line"><span class="lineno"> 1688</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1689</span>            {</div>
<div class="line"><span class="lineno"> 1690</span> </div>
<div class="line"><span class="lineno"> 1691</span>                <span class="keywordflow">for</span>(<span class="keyword">auto</span> alpha  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 1692</span>                         alpha != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).cend(); ++alpha)</div>
<div class="line"><span class="lineno"> 1693</span>                {</div>
<div class="line"><span class="lineno"> 1694</span>                    <span class="keywordtype">double</span> dPsiAlpha = 0.0;</div>
<div class="line"><span class="lineno"> 1695</span>                    <span class="keywordflow">for</span>(<span class="keyword">auto</span> beta  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 1696</span>                             beta != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).cend(); ++beta)</div>
<div class="line"><span class="lineno"> 1697</span>                    <span class="keywordflow">if</span>(alpha != beta)</div>
<div class="line"><span class="lineno"> 1698</span>                    {</div>
<div class="line"><span class="lineno"> 1699</span>                        dPsiAlpha += <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>(i,j,k).get_asym1(alpha-&gt;index,</div>
<div class="line"><span class="lineno"> 1700</span>                                                                   beta-&gt;index);</div>
<div class="line"><span class="lineno"> 1701</span>                        dPsiAlpha += <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>(i,j,k).get_asym2(alpha-&gt;index,</div>
<div class="line"><span class="lineno"> 1702</span>                                                                   beta-&gt;index);</div>
<div class="line"><span class="lineno"> 1703</span>                    }</div>
<div class="line"><span class="lineno"> 1704</span>                    <span class="comment">/* Set out of bounds sets to zero */</span></div>
<div class="line"><span class="lineno"> 1705</span>                    <span class="keywordflow">if</span>((alpha-&gt;value == 0.0 and dPsiAlpha &lt; 0.0)</div>
<div class="line"><span class="lineno"> 1706</span>                    or (alpha-&gt;value == 1.0 and dPsiAlpha &gt; 0.0))</div>
<div class="line"><span class="lineno"> 1707</span>                    {</div>
<div class="line"><span class="lineno"> 1708</span>                        <span class="keywordflow">for</span>(<span class="keyword">auto</span> beta  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 1709</span>                                 beta != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).cend(); ++beta)</div>
<div class="line"><span class="lineno"> 1710</span>                        <span class="keywordflow">if</span>(alpha != beta)</div>
<div class="line"><span class="lineno"> 1711</span>                        {</div>
<div class="line"><span class="lineno"> 1712</span>                            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>(i,j,k).set_sym_pair(alpha-&gt;index, beta-&gt;index, 0.0, 0.0);</div>
<div class="line"><span class="lineno"> 1713</span>                        }</div>
<div class="line"><span class="lineno"> 1714</span>                    }</div>
<div class="line"><span class="lineno"> 1715</span>                }</div>
<div class="line"><span class="lineno"> 1716</span>                <span class="keywordflow">for</span>(<span class="keyword">auto</span> alpha  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>(i,j,k).begin();</div>
<div class="line"><span class="lineno"> 1717</span>                         alpha != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>(i,j,k).end();)</div>
<div class="line"><span class="lineno"> 1718</span>                {</div>
<div class="line"><span class="lineno"> 1719</span>                    <span class="comment">/* Remove zero-sets from the storage */</span></div>
<div class="line"><span class="lineno"> 1720</span>                    <span class="keywordflow">if</span>(alpha-&gt;value1 == 0.0 and alpha-&gt;value2 == 0.0)</div>
<div class="line"><span class="lineno"> 1721</span>                    {</div>
<div class="line"><span class="lineno"> 1722</span>                        alpha = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>(i,j,k).erase(alpha);</div>
<div class="line"><span class="lineno"> 1723</span>                    }</div>
<div class="line"><span class="lineno"> 1724</span>                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1725</span>                    {</div>
<div class="line"><span class="lineno"> 1726</span>                        ++alpha;</div>
<div class="line"><span class="lineno"> 1727</span>                    }</div>
<div class="line"><span class="lineno"> 1728</span>                }</div>
<div class="line"><span class="lineno"> 1729</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>(i,j,k).size())</div>
<div class="line"><span class="lineno"> 1730</span>                {</div>
<div class="line"><span class="lineno"> 1731</span>                    <span class="comment">//cout &lt;&lt; &quot;while loop!&quot; &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1732</span>                    <span class="comment">/* Limit increments! This is done in a while loop, to acknowledge all</span></div>
<div class="line"><span class="lineno"> 1733</span><span class="comment">                    existing pair-contributions.*/</span></div>
<div class="line"><span class="lineno"> 1734</span>                    <span class="keywordtype">int</span> number_of_iterations = 0;</div>
<div class="line"><span class="lineno"> 1735</span>                    <span class="keywordtype">bool</span> LimitingNeeded = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1736</span>                    <span class="keywordflow">while</span> (LimitingNeeded)</div>
<div class="line"><span class="lineno"> 1737</span>                    {</div>
<div class="line"><span class="lineno"> 1738</span>                        number_of_iterations++;</div>
<div class="line"><span class="lineno"> 1739</span>                        LimitingNeeded = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1740</span>                        NodeAB&lt;double,double&gt; locIncrements;</div>
<div class="line"><span class="lineno"> 1741</span>                        <span class="keywordflow">for</span>(<span class="keyword">auto</span> it  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 1742</span>                                 it != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>(i,j,k).cend(); ++it)</div>
<div class="line"><span class="lineno"> 1743</span>                        {</div>
<div class="line"><span class="lineno"> 1744</span>                            <span class="comment">/* Collect increments */</span></div>
<div class="line"><span class="lineno"> 1745</span>                            <span class="keywordflow">if</span>(it-&gt;value1 &lt; 0.0)</div>
<div class="line"><span class="lineno"> 1746</span>                            {</div>
<div class="line"><span class="lineno"> 1747</span>                                locIncrements.add_sym2(it-&gt;indexA,0,  it-&gt;value1);</div>
<div class="line"><span class="lineno"> 1748</span>                                locIncrements.add_sym1(it-&gt;indexB,0, -it-&gt;value1);</div>
<div class="line"><span class="lineno"> 1749</span>                            }</div>
<div class="line"><span class="lineno"> 1750</span>                            <span class="keywordflow">if</span>(it-&gt;value1 &gt; 0.0)</div>
<div class="line"><span class="lineno"> 1751</span>                            {</div>
<div class="line"><span class="lineno"> 1752</span>                                locIncrements.add_sym1(it-&gt;indexA,0,  it-&gt;value1);</div>
<div class="line"><span class="lineno"> 1753</span>                                locIncrements.add_sym2(it-&gt;indexB,0, -it-&gt;value1);</div>
<div class="line"><span class="lineno"> 1754</span>                            }</div>
<div class="line"><span class="lineno"> 1755</span>                        }</div>
<div class="line"><span class="lineno"> 1756</span>                        NodeAB&lt;double,double&gt; locLimits;</div>
<div class="line"><span class="lineno"> 1757</span>                        <span class="keywordflow">for</span>(<span class="keyword">auto</span> alpha  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 1758</span>                                 alpha != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).cend(); ++alpha)</div>
<div class="line"><span class="lineno"> 1759</span>                        {</div>
<div class="line"><span class="lineno"> 1760</span>                            <span class="comment">/* Calculate limits */</span></div>
<div class="line"><span class="lineno"> 1761</span>                            <span class="keywordtype">double</span> posIncrement = locIncrements.get_sym1(alpha-&gt;index,0);</div>
<div class="line"><span class="lineno"> 1762</span>                            <span class="keywordtype">double</span> negIncrement = locIncrements.get_sym2(alpha-&gt;index,0);</div>
<div class="line"><span class="lineno"> 1763</span>                            <span class="keywordtype">double</span> newPFvalue = alpha-&gt;value+(posIncrement+negIncrement)*dt;</div>
<div class="line"><span class="lineno"> 1764</span>                            locLimits.set_sym2(alpha-&gt;index,0,1.0);</div>
<div class="line"><span class="lineno"> 1765</span>                            locLimits.set_sym1(alpha-&gt;index,0,1.0);</div>
<div class="line"><span class="lineno"> 1766</span>                            <span class="keywordflow">if</span>(newPFvalue &lt; 0.0)</div>
<div class="line"><span class="lineno"> 1767</span>                            {</div>
<div class="line"><span class="lineno"> 1768</span>                                <span class="keywordtype">double</span> tmpLim = locLimits.get_sym2(alpha-&gt;index,0);</div>
<div class="line"><span class="lineno"> 1769</span>                                <span class="keywordtype">double</span> tmpLim2 = min(tmpLim,-(alpha-&gt;value+posIncrement*dt)</div>
<div class="line"><span class="lineno"> 1770</span>                                                              /(negIncrement*dt));</div>
<div class="line"><span class="lineno"> 1771</span>                                locLimits.set_sym2(alpha-&gt;index,0, tmpLim2);</div>
<div class="line"><span class="lineno"> 1772</span>                            }</div>
<div class="line"><span class="lineno"> 1773</span>                            <span class="keywordflow">if</span>(newPFvalue &gt; 1.0)</div>
<div class="line"><span class="lineno"> 1774</span>                            {</div>
<div class="line"><span class="lineno"> 1775</span>                                <span class="keywordtype">double</span> tmpLim = locLimits.get_sym1(alpha-&gt;index,0);</div>
<div class="line"><span class="lineno"> 1776</span>                                <span class="keywordtype">double</span> tmpLim2 = min(tmpLim,(1.0-(alpha-&gt;value+negIncrement*dt))</div>
<div class="line"><span class="lineno"> 1777</span>                                                                /(posIncrement*dt));</div>
<div class="line"><span class="lineno"> 1778</span>                                locLimits.set_sym1(alpha-&gt;index,0,tmpLim2);</div>
<div class="line"><span class="lineno"> 1779</span>                            }</div>
<div class="line"><span class="lineno"> 1780</span>                        }</div>
<div class="line"><span class="lineno"> 1781</span>                        <span class="keywordflow">for</span>(<span class="keyword">auto</span> it  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>(i,j,k).begin();</div>
<div class="line"><span class="lineno"> 1782</span>                                 it != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>(i,j,k).end(); ++it)</div>
<div class="line"><span class="lineno"> 1783</span>                        {</div>
<div class="line"><span class="lineno"> 1784</span>                            <span class="comment">/* Limit increments */</span></div>
<div class="line"><span class="lineno"> 1785</span>                            <span class="keywordflow">if</span>(it-&gt;value1 &lt; 0.0)</div>
<div class="line"><span class="lineno"> 1786</span>                            {</div>
<div class="line"><span class="lineno"> 1787</span>                                <span class="keywordtype">double</span> tmpLim = min(locLimits.get_sym2(it-&gt;indexA,0),</div>
<div class="line"><span class="lineno"> 1788</span>                                                    locLimits.get_sym1(it-&gt;indexB,0));</div>
<div class="line"><span class="lineno"> 1789</span>                                it-&gt;value1 *= tmpLim;</div>
<div class="line"><span class="lineno"> 1790</span>                                <span class="keywordflow">if</span> (tmpLim &lt; 1.0)</div>
<div class="line"><span class="lineno"> 1791</span>                                LimitingNeeded = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1792</span>                            }</div>
<div class="line"><span class="lineno"> 1793</span>                            <span class="keywordflow">if</span>(it-&gt;value1 &gt; 0.0)</div>
<div class="line"><span class="lineno"> 1794</span>                            {</div>
<div class="line"><span class="lineno"> 1795</span>                                <span class="keywordtype">double</span> tmpLim = min(locLimits.get_sym1(it-&gt;indexA,0),</div>
<div class="line"><span class="lineno"> 1796</span>                                                    locLimits.get_sym2(it-&gt;indexB,0));</div>
<div class="line"><span class="lineno"> 1797</span>                                it-&gt;value1 *= tmpLim;</div>
<div class="line"><span class="lineno"> 1798</span>                                <span class="keywordflow">if</span> (tmpLim &lt; 1.0)</div>
<div class="line"><span class="lineno"> 1799</span>                                LimitingNeeded = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1800</span>                            }</div>
<div class="line"><span class="lineno"> 1801</span>                        }</div>
<div class="line"><span class="lineno"> 1802</span>                        <span class="comment">/* Exit limiting loop, if no convergence after 24 iterations*/</span></div>
<div class="line"><span class="lineno"> 1803</span>                        <span class="keywordflow">if</span> (number_of_iterations &gt; 24)</div>
<div class="line"><span class="lineno"> 1804</span>                        LimitingNeeded = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1805</span>                    }</div>
<div class="line"><span class="lineno"> 1806</span>                    <span class="keywordflow">for</span>(<span class="keyword">auto</span> alpha  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>(i,j,k).begin();</div>
<div class="line"><span class="lineno"> 1807</span>                             alpha != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>(i,j,k).end(); )</div>
<div class="line"><span class="lineno"> 1808</span>                    {</div>
<div class="line"><span class="lineno"> 1809</span>                        <span class="comment">/* Clean up values which are too small */</span></div>
<div class="line"><span class="lineno"> 1810</span>                        <span class="keywordflow">if</span>(fabs(alpha-&gt;value1) &lt; DBL_EPSILON)</div>
<div class="line"><span class="lineno"> 1811</span>                        {</div>
<div class="line"><span class="lineno"> 1812</span>                            alpha = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>(i,j,k).erase(alpha);</div>
<div class="line"><span class="lineno"> 1813</span>                        }</div>
<div class="line"><span class="lineno"> 1814</span>                        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1815</span>                        {</div>
<div class="line"><span class="lineno"> 1816</span>                            ++alpha;</div>
<div class="line"><span class="lineno"> 1817</span>                        }</div>
<div class="line"><span class="lineno"> 1818</span>                    }</div>
<div class="line"><span class="lineno"> 1819</span> </div>
<div class="line"><span class="lineno"> 1820</span>                    <span class="comment">/* End plausibility check */</span></div>
<div class="line"><span class="lineno"> 1821</span>                    NodePF tmpPF = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k);</div>
<div class="line"><span class="lineno"> 1822</span>                    <span class="keywordflow">for</span>(<span class="keyword">auto</span> <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 1823</span>                             <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a> != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>(i,j,k).cend(); ++<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>)</div>
<div class="line"><span class="lineno"> 1824</span>                    <span class="keywordflow">if</span>(<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;value1 != 0.0)</div>
<div class="line"><span class="lineno"> 1825</span>                    {</div>
<div class="line"><span class="lineno"> 1826</span>                        tmpPF.add_value(<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;indexA,  <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;value1 * dt);</div>
<div class="line"><span class="lineno"> 1827</span>                        tmpPF.add_value(<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;indexB, -<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;value1 * dt);</div>
<div class="line"><span class="lineno"> 1828</span>                    }</div>
<div class="line"><span class="lineno"> 1829</span>                    <span class="keywordflow">for</span>(<span class="keyword">auto</span> it  = tmpPF.cbegin();</div>
<div class="line"><span class="lineno"> 1830</span>                             it != tmpPF.cend(); ++it)</div>
<div class="line"><span class="lineno"> 1831</span>                    <span class="keywordflow">if</span>(it-&gt;value &lt; -precision or it-&gt;value &gt; 1.0 + precision)</div>
<div class="line"><span class="lineno"> 1832</span>                    {</div>
<div class="line"><span class="lineno"> 1833</span>                        <span class="keywordtype">double</span> oldFields = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).get_value(it-&gt;index);</div>
<div class="line"><span class="lineno"> 1834</span>                        <span class="keywordtype">string</span> msg = <span class="stringliteral">&quot;Normalizing of phase field increments failed in point (&quot;</span></div>
<div class="line"><span class="lineno"> 1835</span>                                   + to_string(i) + <span class="stringliteral">&quot;,&quot;</span> + to_string(j) + <span class="stringliteral">&quot;,&quot;</span> + to_string(k)</div>
<div class="line"><span class="lineno"> 1836</span>                                   + <span class="stringliteral">&quot;). &quot;</span> + to_string(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).size())</div>
<div class="line"><span class="lineno"> 1837</span>                                   + <span class="stringliteral">&quot; fields present. Grain &quot;</span></div>
<div class="line"><span class="lineno"> 1838</span>                                   + to_string(it-&gt;index) + <span class="stringliteral">&quot; with a fields-value of &quot;</span></div>
<div class="line"><span class="lineno"> 1839</span>                                   + to_string(oldFields)</div>
<div class="line"><span class="lineno"> 1840</span>                                   + <span class="stringliteral">&quot; is incremented by &quot;</span></div>
<div class="line"><span class="lineno"> 1841</span>                                   + to_string(it-&gt;value-oldFields)</div>
<div class="line"><span class="lineno"> 1842</span>                                   + <span class="stringliteral">&quot;, which results in a fields-value of &quot;</span></div>
<div class="line"><span class="lineno"> 1843</span>                                   + to_string(it-&gt;value)</div>
<div class="line"><span class="lineno"> 1844</span>                                   + <span class="stringliteral">&quot;. This will result in undefined behavior!&quot;</span>;</div>
<div class="line"><span class="lineno"> 1845</span>                        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">ConsoleOutput::WriteWarning</a>(msg,<a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>,<span class="stringliteral">&quot;NormalizeIncrements&quot;</span>);</div>
<div class="line"><span class="lineno"> 1846</span>                    }</div>
<div class="line"><span class="lineno"> 1847</span>                }</div>
<div class="line"><span class="lineno"> 1848</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1849</span>            }</div>
<div class="line"><span class="lineno"> 1850</span>        }</div>
<div class="line"><span class="lineno"> 1851</span>    }</div>
<div class="line"><span class="lineno"> 1852</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1853</span>    <span class="comment">//SetIncrementsBoundaryConditionsDR(BC);</span></div>
<div class="line"><span class="lineno"> 1854</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a30af10b1105bdbb7355613a312a41f1e">CoarsenDot</a>();</div>
<div class="line"><span class="lineno"> 1855</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#ade001d95d4f0e391ffd5874a821f0966">SetIncrementsBoundaryConditionsSR</a>(BC);</div>
<div class="line"><span class="lineno"> 1856</span> </div>
<div class="line"><span class="lineno"> 1857</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno"> 1858</span> </div>
<div class="line"><span class="lineno"> 1859</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>,0,)</div>
<div class="line"><span class="lineno"> 1860</span>    if(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).flag)</div>
<div class="line"><span class="lineno"> 1861</span>    {</div>
<div class="line"><span class="lineno"> 1862</span>        <span class="keywordtype">double</span> zero = 1.0;</div>
<div class="line"><span class="lineno"> 1863</span> </div>
<div class="line"><span class="lineno"> 1864</span>        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a>; n++)</div>
<div class="line"><span class="lineno"> 1865</span>        {</div>
<div class="line"><span class="lineno"> 1866</span>            <span class="keywordtype">double</span> fraction = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a784a4bea9a5379192bdf4f12ab12cf10">Fractions</a>(i,j,k,{n});</div>
<div class="line"><span class="lineno"> 1867</span>            <span class="keywordtype">double</span> newfraction = fraction;</div>
<div class="line"><span class="lineno"> 1868</span> </div>
<div class="line"><span class="lineno"> 1869</span>            zero -= fraction;</div>
<div class="line"><span class="lineno"> 1870</span> </div>
<div class="line"><span class="lineno"> 1871</span>            <span class="keywordflow">for</span>(<span class="keyword">auto</span> it = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).begin();</div>
<div class="line"><span class="lineno"> 1872</span>                     it != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).end(); ++it)</div>
<div class="line"><span class="lineno"> 1873</span>            {</div>
<div class="line"><span class="lineno"> 1874</span>                <span class="keywordflow">if</span>((<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[it-&gt;indexA].Phase == n)</div>
<div class="line"><span class="lineno"> 1875</span>                and(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[it-&gt;indexB].Phase != n))</div>
<div class="line"><span class="lineno"> 1876</span>                {</div>
<div class="line"><span class="lineno"> 1877</span>                    newfraction += it-&gt;value1*dt;</div>
<div class="line"><span class="lineno"> 1878</span>                }</div>
<div class="line"><span class="lineno"> 1879</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span>((<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[it-&gt;indexA].Phase != n)</div>
<div class="line"><span class="lineno"> 1880</span>                     and(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[it-&gt;indexB].Phase == n))</div>
<div class="line"><span class="lineno"> 1881</span>                {</div>
<div class="line"><span class="lineno"> 1882</span>                    newfraction -= it-&gt;value1*dt;</div>
<div class="line"><span class="lineno"> 1883</span>                }</div>
<div class="line"><span class="lineno"> 1884</span>            }</div>
<div class="line"><span class="lineno"> 1885</span> </div>
<div class="line"><span class="lineno"> 1886</span>            <span class="keywordflow">if</span>((newfraction &lt; -precision)</div>
<div class="line"><span class="lineno"> 1887</span>            or (newfraction &gt;  precision+1.0)</div>
<div class="line"><span class="lineno"> 1888</span>            or (fraction &lt; -precision)</div>
<div class="line"><span class="lineno"> 1889</span>            or (fraction &gt;  precision+1.0))</div>
<div class="line"><span class="lineno"> 1890</span>            {</div>
<div class="line"><span class="lineno"> 1891</span>                <span class="keywordtype">string</span> msg = <span class="stringliteral">&quot;Redistribution of composition not possible. &quot;</span></div>
<div class="line"><span class="lineno"> 1892</span>                             <span class="stringliteral">&quot;Phase-field broke in point (&quot;</span></div>
<div class="line"><span class="lineno"> 1893</span>                           + to_string(i) + <span class="stringliteral">&quot;,&quot;</span> + to_string(j) + <span class="stringliteral">&quot;,&quot;</span></div>
<div class="line"><span class="lineno"> 1894</span>                           + to_string(k) + <span class="stringliteral">&quot;) for phase &quot;</span> + to_string(n)</div>
<div class="line"><span class="lineno"> 1895</span>                           + <span class="stringliteral">&quot;. Old fraction &quot;</span></div>
<div class="line"><span class="lineno"> 1896</span>                           + to_string(fraction)</div>
<div class="line"><span class="lineno"> 1897</span>                           + <span class="stringliteral">&quot; New fraction &quot;</span> + to_string(newfraction)</div>
<div class="line"><span class="lineno"> 1898</span>                           + <span class="stringliteral">&quot;. This will break mass conservation!&quot;</span>;</div>
<div class="line"><span class="lineno"> 1899</span> </div>
<div class="line"><span class="lineno"> 1900</span>                <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">ConsoleOutput::WriteWarning</a>(msg,<a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>,<span class="stringliteral">&quot;NormalizeIncrements&quot;</span>);</div>
<div class="line"><span class="lineno"> 1901</span>                <span class="comment">//OP_Exit(EXIT_FAILURE);</span></div>
<div class="line"><span class="lineno"> 1902</span>            }</div>
<div class="line"><span class="lineno"> 1903</span>        }</div>
<div class="line"><span class="lineno"> 1904</span> </div>
<div class="line"><span class="lineno"> 1905</span>        <span class="keywordflow">if</span>(zero &lt; -precision or zero &gt; precision)</div>
<div class="line"><span class="lineno"> 1906</span>        {</div>
<div class="line"><span class="lineno"> 1907</span>            <span class="keywordtype">string</span> msg = <span class="stringliteral">&quot;Redistribution of composition not possible. &quot;</span></div>
<div class="line"><span class="lineno"> 1908</span>                         <span class="stringliteral">&quot;Phase-field broke in point (&quot;</span></div>
<div class="line"><span class="lineno"> 1909</span>                       + to_string(i) + <span class="stringliteral">&quot;,&quot;</span> + to_string(j) + <span class="stringliteral">&quot;,&quot;</span></div>
<div class="line"><span class="lineno"> 1910</span>                       + to_string(k) + <span class="stringliteral">&quot;). Phase fractions don&#39;t add up to &quot;</span></div>
<div class="line"><span class="lineno"> 1911</span>                         <span class="stringliteral">&quot;unity, difference is &quot;</span> + to_string(zero);</div>
<div class="line"><span class="lineno"> 1912</span> </div>
<div class="line"><span class="lineno"> 1913</span>           <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">ConsoleOutput::WriteWarning</a>(msg,<a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>,<span class="stringliteral">&quot;NormalizeIncrements&quot;</span>);</div>
<div class="line"><span class="lineno"> 1914</span>           <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a4d6fed4ab71c6edf2a0bd5dabecc6ec6">OP_Exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 1915</span>        }</div>
<div class="line"><span class="lineno"> 1916</span>    }</div>
<div class="line"><span class="lineno"> 1917</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1918</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1919</span>}</div>
<div class="ttc" id="aclassopenphase_1_1ConsoleOutput_html_a3d39f6f01e37b75d360090aa734bc1bd"><div class="ttname"><a href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">openphase::ConsoleOutput::WriteWarning</a></div><div class="ttdeci">static void WriteWarning(const std::string Message, const std::string Instance=&quot;&quot;, const std::string Method=&quot;&quot;)</div><div class="ttdef"><b>Definition</b> <a href="../../da/da0/ConsoleOutput_8cpp_source.html#l00176">ConsoleOutput.cpp:176</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a30af10b1105bdbb7355613a312a41f1e"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a30af10b1105bdbb7355613a312a41f1e">openphase::PhaseField::CoarsenDot</a></div><div class="ttdeci">void CoarsenDot(void)</div><div class="ttdoc">Calculates single resolution phase-field increments from the double resolution ones.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l01121">PhaseField.cpp:1121</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_ade001d95d4f0e391ffd5874a821f0966"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#ade001d95d4f0e391ffd5874a821f0966">openphase::PhaseField::SetIncrementsBoundaryConditionsSR</a></div><div class="ttdeci">void SetIncrementsBoundaryConditionsSR(const BoundaryConditions &amp;BC)</div><div class="ttdoc">Set boundary conditions for phase field increments.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l02097">PhaseField.cpp:2097</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afc48631e25443062d9fa47d59f793dc9" name="afc48631e25443062d9fa47d59f793dc9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc48631e25443062d9fa47d59f793dc9">&#9670;&#160;</a></span>NormalizeIncrementsSR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::NormalizeIncrementsSR </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Normalizes the interface fields such that resulting phase fields after merge do not escape interval [0,1] and sum up to 1. </p>
<p>This function limits phase-field increments for all present phase-field pairs, so that the actual phase-field values are within their natural limits of 0.0 and 1.0.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l01351">1351</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1352</span>{</div>
<div class="line"><span class="lineno"> 1357</span>    <span class="keywordtype">double</span> precision = FLT_EPSILON;</div>
<div class="line"><span class="lineno"> 1358</span> </div>
<div class="line"><span class="lineno"> 1359</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>,0,)</div>
<div class="line"><span class="lineno"> 1360</span>    if (<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).wide_interface())</div>
<div class="line"><span class="lineno"> 1361</span>    {</div>
<div class="line"><span class="lineno"> 1362</span>        <span class="keywordflow">switch</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).size())</div>
<div class="line"><span class="lineno"> 1363</span>        {</div>
<div class="line"><span class="lineno"> 1364</span>            <span class="keywordflow">case</span> 0:</div>
<div class="line"><span class="lineno"> 1365</span>            {</div>
<div class="line"><span class="lineno"> 1366</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1367</span>            }</div>
<div class="line"><span class="lineno"> 1368</span>            <span class="keywordflow">case</span> 1:</div>
<div class="line"><span class="lineno"> 1369</span>            {</div>
<div class="line"><span class="lineno"> 1370</span>                <span class="keywordtype">size_t</span> indexA = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).front().indexA;</div>
<div class="line"><span class="lineno"> 1371</span>                <span class="keywordtype">double</span> valueA = (<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).front().value1</div>
<div class="line"><span class="lineno"> 1372</span>                              +  <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).front().value2)*dt;</div>
<div class="line"><span class="lineno"> 1373</span>                <span class="keywordtype">double</span> old_value = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).get_value(indexA);</div>
<div class="line"><span class="lineno"> 1374</span> </div>
<div class="line"><span class="lineno"> 1375</span>                <span class="keywordflow">if</span>((old_value == 0.0 and valueA &lt; 0.0) or</div>
<div class="line"><span class="lineno"> 1376</span>                   (old_value == 1.0 and valueA &gt; 0.0))</div>
<div class="line"><span class="lineno"> 1377</span>                {</div>
<div class="line"><span class="lineno"> 1378</span>                    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).clear();</div>
<div class="line"><span class="lineno"> 1379</span>                }</div>
<div class="line"><span class="lineno"> 1380</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1381</span>                {</div>
<div class="line"><span class="lineno"> 1382</span>                    <span class="keywordtype">double</span> new_value = old_value + valueA;</div>
<div class="line"><span class="lineno"> 1383</span> </div>
<div class="line"><span class="lineno"> 1384</span>                    <span class="keywordtype">double</span> norm = 1.0;</div>
<div class="line"><span class="lineno"> 1385</span>                    <span class="keywordflow">if</span>(new_value &lt; 0.0)</div>
<div class="line"><span class="lineno"> 1386</span>                    {</div>
<div class="line"><span class="lineno"> 1387</span>                        norm *= -old_value/valueA;</div>
<div class="line"><span class="lineno"> 1388</span>                    }</div>
<div class="line"><span class="lineno"> 1389</span>                    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(new_value &gt; 1.0)</div>
<div class="line"><span class="lineno"> 1390</span>                    {</div>
<div class="line"><span class="lineno"> 1391</span>                        norm *= (1.0 - old_value)/valueA;</div>
<div class="line"><span class="lineno"> 1392</span>                    }</div>
<div class="line"><span class="lineno"> 1393</span> </div>
<div class="line"><span class="lineno"> 1394</span>                    <span class="keywordflow">if</span>(norm &gt; DBL_EPSILON)</div>
<div class="line"><span class="lineno"> 1395</span>                    {</div>
<div class="line"><span class="lineno"> 1396</span>                        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k) *= norm;</div>
<div class="line"><span class="lineno"> 1397</span>                    }</div>
<div class="line"><span class="lineno"> 1398</span>                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1399</span>                    {</div>
<div class="line"><span class="lineno"> 1400</span>                        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).clear();</div>
<div class="line"><span class="lineno"> 1401</span>                    }</div>
<div class="line"><span class="lineno"> 1402</span>                }</div>
<div class="line"><span class="lineno"> 1403</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1404</span>            }</div>
<div class="line"><span class="lineno"> 1405</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1406</span>            {</div>
<div class="line"><span class="lineno"> 1407</span>                <span class="keywordflow">for</span>(<span class="keyword">auto</span> alpha  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 1408</span>                         alpha != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cend(); ++alpha)</div>
<div class="line"><span class="lineno"> 1409</span>                {</div>
<div class="line"><span class="lineno"> 1410</span>                    <span class="keywordtype">double</span> dPsiAlpha = 0.0;</div>
<div class="line"><span class="lineno"> 1411</span>                    <span class="keywordflow">for</span>(<span class="keyword">auto</span> beta  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 1412</span>                             beta != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cend(); ++beta)</div>
<div class="line"><span class="lineno"> 1413</span>                    <span class="keywordflow">if</span>(alpha != beta)</div>
<div class="line"><span class="lineno"> 1414</span>                    {</div>
<div class="line"><span class="lineno"> 1415</span>                        dPsiAlpha += <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).get_asym1(alpha-&gt;index,</div>
<div class="line"><span class="lineno"> 1416</span>                                                                 beta-&gt;index);</div>
<div class="line"><span class="lineno"> 1417</span>                        dPsiAlpha += <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).get_asym2(alpha-&gt;index,</div>
<div class="line"><span class="lineno"> 1418</span>                                                                 beta-&gt;index);</div>
<div class="line"><span class="lineno"> 1419</span>                    }</div>
<div class="line"><span class="lineno"> 1420</span>                    <span class="comment">/* Set out of bounds sets to zero */</span></div>
<div class="line"><span class="lineno"> 1421</span>                    <span class="keywordflow">if</span>((alpha-&gt;value == 0.0 and dPsiAlpha &lt; 0.0)</div>
<div class="line"><span class="lineno"> 1422</span>                    or (alpha-&gt;value == 1.0 and dPsiAlpha &gt; 0.0))</div>
<div class="line"><span class="lineno"> 1423</span>                    {</div>
<div class="line"><span class="lineno"> 1424</span>                        <span class="keywordflow">for</span>(<span class="keyword">auto</span> beta  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 1425</span>                                 beta != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cend(); ++beta)</div>
<div class="line"><span class="lineno"> 1426</span>                        <span class="keywordflow">if</span>(alpha != beta)</div>
<div class="line"><span class="lineno"> 1427</span>                        {</div>
<div class="line"><span class="lineno"> 1428</span>                            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).set_sym_pair(alpha-&gt;index, beta-&gt;index, 0.0, 0.0);</div>
<div class="line"><span class="lineno"> 1429</span>                        }</div>
<div class="line"><span class="lineno"> 1430</span>                    }</div>
<div class="line"><span class="lineno"> 1431</span>                }</div>
<div class="line"><span class="lineno"> 1432</span> </div>
<div class="line"><span class="lineno"> 1433</span>                <span class="keywordflow">for</span>(<span class="keyword">auto</span> alpha  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).begin();</div>
<div class="line"><span class="lineno"> 1434</span>                         alpha != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).end();)</div>
<div class="line"><span class="lineno"> 1435</span>                {</div>
<div class="line"><span class="lineno"> 1436</span>                    <span class="comment">/* Remove zero-sets from the storage */</span></div>
<div class="line"><span class="lineno"> 1437</span>                    <span class="keywordflow">if</span>(alpha-&gt;value1 == 0.0 and alpha-&gt;value2 == 0.0)</div>
<div class="line"><span class="lineno"> 1438</span>                    {</div>
<div class="line"><span class="lineno"> 1439</span>                        alpha = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).erase(alpha);</div>
<div class="line"><span class="lineno"> 1440</span>                    }</div>
<div class="line"><span class="lineno"> 1441</span>                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1442</span>                    {</div>
<div class="line"><span class="lineno"> 1443</span>                        ++alpha;</div>
<div class="line"><span class="lineno"> 1444</span>                    }</div>
<div class="line"><span class="lineno"> 1445</span>                }</div>
<div class="line"><span class="lineno"> 1446</span> </div>
<div class="line"><span class="lineno"> 1447</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).size())</div>
<div class="line"><span class="lineno"> 1448</span>                {</div>
<div class="line"><span class="lineno"> 1449</span>                    <span class="comment">/* Limit increments! This is done in a while loop to account for all</span></div>
<div class="line"><span class="lineno"> 1450</span><span class="comment">                    existing pair-contributions.*/</span></div>
<div class="line"><span class="lineno"> 1451</span>                    <span class="keywordtype">int</span> number_of_iterations = 0;</div>
<div class="line"><span class="lineno"> 1452</span>                    <span class="keywordtype">bool</span> LimitingNeeded = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1453</span>                    <span class="keywordflow">while</span> (LimitingNeeded)</div>
<div class="line"><span class="lineno"> 1454</span>                    {</div>
<div class="line"><span class="lineno"> 1455</span>                        number_of_iterations++;</div>
<div class="line"><span class="lineno"> 1456</span>                        LimitingNeeded = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1457</span>                        NodeAB&lt;double,double&gt; locIncrements;</div>
<div class="line"><span class="lineno"> 1458</span>                        <span class="keywordflow">for</span>(<span class="keyword">auto</span> it  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 1459</span>                                 it != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).cend(); ++it)</div>
<div class="line"><span class="lineno"> 1460</span>                        {</div>
<div class="line"><span class="lineno"> 1461</span>                            <span class="comment">/* Collect increments */</span></div>
<div class="line"><span class="lineno"> 1462</span>                            <span class="keywordflow">if</span>(it-&gt;value1 &lt; 0.0)</div>
<div class="line"><span class="lineno"> 1463</span>                            {</div>
<div class="line"><span class="lineno"> 1464</span>                                locIncrements.add_sym2(it-&gt;indexA,0, it-&gt;value1);</div>
<div class="line"><span class="lineno"> 1465</span>                                locIncrements.add_sym1(it-&gt;indexB,0, -it-&gt;value1);</div>
<div class="line"><span class="lineno"> 1466</span>                            }</div>
<div class="line"><span class="lineno"> 1467</span>                            <span class="keywordflow">if</span>(it-&gt;value1 &gt; 0.0)</div>
<div class="line"><span class="lineno"> 1468</span>                            {</div>
<div class="line"><span class="lineno"> 1469</span>                                locIncrements.add_sym1(it-&gt;indexA,0, it-&gt;value1);</div>
<div class="line"><span class="lineno"> 1470</span>                                locIncrements.add_sym2(it-&gt;indexB,0, -it-&gt;value1);</div>
<div class="line"><span class="lineno"> 1471</span>                            }</div>
<div class="line"><span class="lineno"> 1472</span>                        }</div>
<div class="line"><span class="lineno"> 1473</span>                        NodeAB&lt;double,double&gt; locLimits;</div>
<div class="line"><span class="lineno"> 1474</span>                        <span class="keywordflow">for</span>(<span class="keyword">auto</span> alpha  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 1475</span>                                 alpha != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cend(); ++alpha)</div>
<div class="line"><span class="lineno"> 1476</span>                        {</div>
<div class="line"><span class="lineno"> 1477</span>                            <span class="comment">/* Calculate limits */</span></div>
<div class="line"><span class="lineno"> 1478</span>                            <span class="keywordtype">double</span> posIncrement = locIncrements.get_sym1(alpha-&gt;index,0);</div>
<div class="line"><span class="lineno"> 1479</span>                            <span class="keywordtype">double</span> negIncrement = locIncrements.get_sym2(alpha-&gt;index,0);</div>
<div class="line"><span class="lineno"> 1480</span>                            <span class="keywordtype">double</span> newPFvalue = alpha-&gt;value+(posIncrement+negIncrement)*dt;</div>
<div class="line"><span class="lineno"> 1481</span>                            locLimits.set_sym2(alpha-&gt;index,0, 1.0);</div>
<div class="line"><span class="lineno"> 1482</span>                            locLimits.set_sym1(alpha-&gt;index,0, 1.0);</div>
<div class="line"><span class="lineno"> 1483</span>                            <span class="keywordflow">if</span>(newPFvalue &lt; 0.0)</div>
<div class="line"><span class="lineno"> 1484</span>                            {</div>
<div class="line"><span class="lineno"> 1485</span>                                <span class="keywordtype">double</span> tmpLim = locLimits.get_sym2(alpha-&gt;index,0);</div>
<div class="line"><span class="lineno"> 1486</span>                                <span class="keywordtype">double</span> tmpLim2 = min(tmpLim,-(alpha-&gt;value+posIncrement*dt)</div>
<div class="line"><span class="lineno"> 1487</span>                                                              /(negIncrement*dt));</div>
<div class="line"><span class="lineno"> 1488</span>                                locLimits.set_sym2(alpha-&gt;index,0, tmpLim2);</div>
<div class="line"><span class="lineno"> 1489</span>                            }</div>
<div class="line"><span class="lineno"> 1490</span>                            <span class="keywordflow">if</span>(newPFvalue &gt; 1.0)</div>
<div class="line"><span class="lineno"> 1491</span>                            {</div>
<div class="line"><span class="lineno"> 1492</span>                                <span class="keywordtype">double</span> tmpLim = locLimits.get_sym1(alpha-&gt;index,0);</div>
<div class="line"><span class="lineno"> 1493</span>                                <span class="keywordtype">double</span> tmpLim2 = min(tmpLim,(1.0-(alpha-&gt;value+negIncrement</div>
<div class="line"><span class="lineno"> 1494</span>                                                             *dt))/(posIncrement*dt));</div>
<div class="line"><span class="lineno"> 1495</span>                                locLimits.set_sym1(alpha-&gt;index,0, tmpLim2);</div>
<div class="line"><span class="lineno"> 1496</span>                            }</div>
<div class="line"><span class="lineno"> 1497</span>                        }</div>
<div class="line"><span class="lineno"> 1498</span>                        <span class="keywordflow">for</span>(<span class="keyword">auto</span> it  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).begin();</div>
<div class="line"><span class="lineno"> 1499</span>                                 it != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).end(); ++it)</div>
<div class="line"><span class="lineno"> 1500</span>                        {</div>
<div class="line"><span class="lineno"> 1501</span>                            <span class="comment">/* Limit increments */</span></div>
<div class="line"><span class="lineno"> 1502</span>                            <span class="keywordflow">if</span>(it-&gt;value1 &lt; 0.0)</div>
<div class="line"><span class="lineno"> 1503</span>                            {</div>
<div class="line"><span class="lineno"> 1504</span>                                <span class="keywordtype">double</span> tmpLim = min(locLimits.get_sym2(it-&gt;indexA,0),</div>
<div class="line"><span class="lineno"> 1505</span>                                                    locLimits.get_sym1(it-&gt;indexB,0));</div>
<div class="line"><span class="lineno"> 1506</span>                                it-&gt;value1 *= tmpLim;</div>
<div class="line"><span class="lineno"> 1507</span>                                <span class="keywordflow">if</span> (tmpLim &lt; 1.0) LimitingNeeded = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1508</span>                            }</div>
<div class="line"><span class="lineno"> 1509</span>                            <span class="keywordflow">if</span>(it-&gt;value1 &gt; 0.0)</div>
<div class="line"><span class="lineno"> 1510</span>                            {</div>
<div class="line"><span class="lineno"> 1511</span>                                <span class="keywordtype">double</span> tmpLim = min(locLimits.get_sym1(it-&gt;indexA,0),</div>
<div class="line"><span class="lineno"> 1512</span>                                                    locLimits.get_sym2(it-&gt;indexB,0));</div>
<div class="line"><span class="lineno"> 1513</span>                                it-&gt;value1 *= tmpLim;</div>
<div class="line"><span class="lineno"> 1514</span>                                <span class="keywordflow">if</span> (tmpLim &lt; 1.0) LimitingNeeded = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1515</span>                            }</div>
<div class="line"><span class="lineno"> 1516</span>                        }</div>
<div class="line"><span class="lineno"> 1517</span>                        <span class="comment">/* Exit limiting loop, if no convergence after 24 iterations*/</span></div>
<div class="line"><span class="lineno"> 1518</span>                        <span class="keywordflow">if</span> (number_of_iterations &gt; 24) LimitingNeeded = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1519</span>                    }</div>
<div class="line"><span class="lineno"> 1520</span> </div>
<div class="line"><span class="lineno"> 1521</span>                    <span class="keywordflow">for</span>(<span class="keyword">auto</span> alpha  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).begin();</div>
<div class="line"><span class="lineno"> 1522</span>                             alpha != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).end(); )</div>
<div class="line"><span class="lineno"> 1523</span>                    {</div>
<div class="line"><span class="lineno"> 1524</span>                        <span class="comment">/* Clean up values which are too small */</span></div>
<div class="line"><span class="lineno"> 1525</span>                        <span class="keywordflow">if</span>(fabs(alpha-&gt;value1*dt) &lt; DBL_EPSILON)</div>
<div class="line"><span class="lineno"> 1526</span>                        {</div>
<div class="line"><span class="lineno"> 1527</span>                            alpha = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).erase(alpha);</div>
<div class="line"><span class="lineno"> 1528</span>                        }</div>
<div class="line"><span class="lineno"> 1529</span>                        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1530</span>                        {</div>
<div class="line"><span class="lineno"> 1531</span>                            ++alpha;</div>
<div class="line"><span class="lineno"> 1532</span>                        }</div>
<div class="line"><span class="lineno"> 1533</span>                    }</div>
<div class="line"><span class="lineno"> 1534</span> </div>
<div class="line"><span class="lineno"> 1535</span>                    <span class="comment">/* End plausibility check */</span></div>
<div class="line"><span class="lineno"> 1536</span>                    NodePF tmpPF = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k);</div>
<div class="line"><span class="lineno"> 1537</span>                    <span class="keywordflow">for</span>(<span class="keyword">auto</span> <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 1538</span>                             <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a> != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).cend(); ++<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>)</div>
<div class="line"><span class="lineno"> 1539</span>                    <span class="keywordflow">if</span>(<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;value1 != 0.0)</div>
<div class="line"><span class="lineno"> 1540</span>                    {</div>
<div class="line"><span class="lineno"> 1541</span>                        tmpPF.add_value(<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;indexA,  <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;value1 * dt);</div>
<div class="line"><span class="lineno"> 1542</span>                        tmpPF.add_value(<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;indexB, -<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a00cfeac3044187955c0b5786f4b6eb3f">psi</a>-&gt;value1 * dt);</div>
<div class="line"><span class="lineno"> 1543</span>                    }</div>
<div class="line"><span class="lineno"> 1544</span>                    <span class="keywordflow">for</span>(<span class="keyword">auto</span> it  = tmpPF.cbegin();</div>
<div class="line"><span class="lineno"> 1545</span>                             it != tmpPF.cend(); ++it)</div>
<div class="line"><span class="lineno"> 1546</span>                    <span class="keywordflow">if</span>(it-&gt;value &lt; -precision or it-&gt;value &gt; 1.0 + precision)</div>
<div class="line"><span class="lineno"> 1547</span>                    {</div>
<div class="line"><span class="lineno"> 1548</span>                        <span class="keywordtype">double</span> oldFields = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).get_value(it-&gt;index);</div>
<div class="line"><span class="lineno"> 1549</span>                        <span class="keywordtype">string</span> msg = <span class="stringliteral">&quot;Normalizing of phase field increments failed in point (&quot;</span></div>
<div class="line"><span class="lineno"> 1550</span>                                   + to_string(i) + <span class="stringliteral">&quot;,&quot;</span> + to_string(j) + <span class="stringliteral">&quot;,&quot;</span> + to_string(k)</div>
<div class="line"><span class="lineno"> 1551</span>                                   + <span class="stringliteral">&quot;). &quot;</span> + to_string(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).size())</div>
<div class="line"><span class="lineno"> 1552</span>                                   + <span class="stringliteral">&quot; fields present. Grain &quot;</span></div>
<div class="line"><span class="lineno"> 1553</span>                                   + to_string(it-&gt;index) + <span class="stringliteral">&quot; with a fields-value of &quot;</span></div>
<div class="line"><span class="lineno"> 1554</span>                                   + to_string(oldFields)</div>
<div class="line"><span class="lineno"> 1555</span>                                   + <span class="stringliteral">&quot; is incremented by &quot;</span></div>
<div class="line"><span class="lineno"> 1556</span>                                   + to_string(it-&gt;value-oldFields)</div>
<div class="line"><span class="lineno"> 1557</span>                                   + <span class="stringliteral">&quot;, which results in a fields-value of &quot;</span></div>
<div class="line"><span class="lineno"> 1558</span>                                   + to_string(it-&gt;value)</div>
<div class="line"><span class="lineno"> 1559</span>                                   + <span class="stringliteral">&quot;. This will result in undefined behavior!&quot;</span>;</div>
<div class="line"><span class="lineno"> 1560</span>                        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">ConsoleOutput::WriteWarning</a>(msg,<a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>,<span class="stringliteral">&quot;NormalizeIncrements&quot;</span>);</div>
<div class="line"><span class="lineno"> 1561</span>                    }</div>
<div class="line"><span class="lineno"> 1562</span>                }</div>
<div class="line"><span class="lineno"> 1563</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1564</span>            }</div>
<div class="line"><span class="lineno"> 1565</span>        }</div>
<div class="line"><span class="lineno"> 1566</span>    }</div>
<div class="line"><span class="lineno"> 1567</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1568</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#ade001d95d4f0e391ffd5874a821f0966">SetIncrementsBoundaryConditionsSR</a>(BC);</div>
<div class="line"><span class="lineno"> 1569</span> </div>
<div class="line"><span class="lineno"> 1570</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno"> 1571</span> </div>
<div class="line"><span class="lineno"> 1572</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>,0,)</div>
<div class="line"><span class="lineno"> 1573</span>    if(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).flag)</div>
<div class="line"><span class="lineno"> 1574</span>    {</div>
<div class="line"><span class="lineno"> 1575</span>        <span class="keywordtype">double</span> zero = 1.0;</div>
<div class="line"><span class="lineno"> 1576</span> </div>
<div class="line"><span class="lineno"> 1577</span>        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a>; n++)</div>
<div class="line"><span class="lineno"> 1578</span>        {</div>
<div class="line"><span class="lineno"> 1579</span>            <span class="keywordtype">double</span> fraction = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a784a4bea9a5379192bdf4f12ab12cf10">Fractions</a>(i,j,k)({n});</div>
<div class="line"><span class="lineno"> 1580</span>            <span class="keywordtype">double</span> newfraction = fraction;</div>
<div class="line"><span class="lineno"> 1581</span> </div>
<div class="line"><span class="lineno"> 1582</span>            zero -= fraction;</div>
<div class="line"><span class="lineno"> 1583</span> </div>
<div class="line"><span class="lineno"> 1584</span>            <span class="keywordflow">for</span>(<span class="keyword">auto</span> it = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).begin();</div>
<div class="line"><span class="lineno"> 1585</span>                     it != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k).end(); ++it)</div>
<div class="line"><span class="lineno"> 1586</span>            {</div>
<div class="line"><span class="lineno"> 1587</span>                <span class="keywordflow">if</span>((<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[it-&gt;indexA].Phase == n)</div>
<div class="line"><span class="lineno"> 1588</span>                and(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[it-&gt;indexB].Phase != n))</div>
<div class="line"><span class="lineno"> 1589</span>                {</div>
<div class="line"><span class="lineno"> 1590</span>                    newfraction += it-&gt;value1*dt;</div>
<div class="line"><span class="lineno"> 1591</span>                }</div>
<div class="line"><span class="lineno"> 1592</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span>((<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[it-&gt;indexA].Phase != n)</div>
<div class="line"><span class="lineno"> 1593</span>                     and(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[it-&gt;indexB].Phase == n))</div>
<div class="line"><span class="lineno"> 1594</span>                {</div>
<div class="line"><span class="lineno"> 1595</span>                    newfraction -= it-&gt;value1*dt;</div>
<div class="line"><span class="lineno"> 1596</span>                }</div>
<div class="line"><span class="lineno"> 1597</span>            }</div>
<div class="line"><span class="lineno"> 1598</span> </div>
<div class="line"><span class="lineno"> 1599</span>            <span class="keywordflow">if</span>((newfraction &lt; -precision)</div>
<div class="line"><span class="lineno"> 1600</span>            or (newfraction &gt;  precision + 1.0)</div>
<div class="line"><span class="lineno"> 1601</span>            or (fraction &lt; -precision)</div>
<div class="line"><span class="lineno"> 1602</span>            or (fraction &gt;  precision + 1.0))</div>
<div class="line"><span class="lineno"> 1603</span>            {</div>
<div class="line"><span class="lineno"> 1604</span>                <span class="keywordtype">string</span> msg = <span class="stringliteral">&quot;Redistribution of composition not possible. &quot;</span></div>
<div class="line"><span class="lineno"> 1605</span>                             <span class="stringliteral">&quot;Phase-field broke in point (&quot;</span></div>
<div class="line"><span class="lineno"> 1606</span>                           + to_string(i) + <span class="stringliteral">&quot;,&quot;</span> + to_string(j) + <span class="stringliteral">&quot;,&quot;</span></div>
<div class="line"><span class="lineno"> 1607</span>                           + to_string(k) + <span class="stringliteral">&quot;) for phase &quot;</span> + to_string(n)</div>
<div class="line"><span class="lineno"> 1608</span>                           + <span class="stringliteral">&quot;. Old fraction &quot;</span></div>
<div class="line"><span class="lineno"> 1609</span>                           + to_string(fraction)</div>
<div class="line"><span class="lineno"> 1610</span>                           + <span class="stringliteral">&quot; New fraction &quot;</span> + to_string(newfraction)</div>
<div class="line"><span class="lineno"> 1611</span>                           + <span class="stringliteral">&quot;. This will break mass conservation!&quot;</span>;</div>
<div class="line"><span class="lineno"> 1612</span> </div>
<div class="line"><span class="lineno"> 1613</span>                <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">ConsoleOutput::WriteWarning</a>(msg,<a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>,<span class="stringliteral">&quot;NormalizeIncrements&quot;</span>);</div>
<div class="line"><span class="lineno"> 1614</span>                <span class="comment">//OP_Exit(EXIT_FAILURE);</span></div>
<div class="line"><span class="lineno"> 1615</span>            }</div>
<div class="line"><span class="lineno"> 1616</span>        }</div>
<div class="line"><span class="lineno"> 1617</span> </div>
<div class="line"><span class="lineno"> 1618</span>        <span class="keywordflow">if</span>(zero &lt; -precision or zero &gt; precision)</div>
<div class="line"><span class="lineno"> 1619</span>        {</div>
<div class="line"><span class="lineno"> 1620</span>            <span class="keywordtype">string</span> msg = <span class="stringliteral">&quot;Redistribution of composition not possible. &quot;</span></div>
<div class="line"><span class="lineno"> 1621</span>                         <span class="stringliteral">&quot;Phase-field broke in point (&quot;</span></div>
<div class="line"><span class="lineno"> 1622</span>                       + to_string(i) + <span class="stringliteral">&quot;,&quot;</span> + to_string(j) + <span class="stringliteral">&quot;,&quot;</span></div>
<div class="line"><span class="lineno"> 1623</span>                       + to_string(k) + <span class="stringliteral">&quot;). Phase fractions don&#39;t add up to &quot;</span></div>
<div class="line"><span class="lineno"> 1624</span>                         <span class="stringliteral">&quot;unity, difference is &quot;</span> + to_string(zero);</div>
<div class="line"><span class="lineno"> 1625</span> </div>
<div class="line"><span class="lineno"> 1626</span>           <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">ConsoleOutput::WriteWarning</a>(msg,<a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>,<span class="stringliteral">&quot;NormalizeIncrements&quot;</span>);</div>
<div class="line"><span class="lineno"> 1627</span>           <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a4d6fed4ab71c6edf2a0bd5dabecc6ec6">OP_Exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 1628</span>        }</div>
<div class="line"><span class="lineno"> 1629</span>    }</div>
<div class="line"><span class="lineno"> 1630</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1631</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1632</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a94f58f14335a53fbe1d61f4486004534" name="a94f58f14335a53fbe1d61f4486004534"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94f58f14335a53fbe1d61f4486004534">&#9670;&#160;</a></span>Normals()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d3/dc0/classopenphase_1_1NodeAB.html">NodeAB</a>&lt; <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a>, <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> &gt; openphase::PhaseField::Normals </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns interface normals for all pairs of phase fields at a given position. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l00736">736</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  737</span>{</div>
<div class="line"><span class="lineno">  738</span>    NodeAB&lt;dVector3,dVector3&gt; locNormals;</div>
<div class="line"><span class="lineno">  739</span> </div>
<div class="line"><span class="lineno">  740</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> alpha  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno">  741</span>              alpha != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cend(); ++alpha)</div>
<div class="line"><span class="lineno">  742</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>  beta  = alpha + 1;</div>
<div class="line"><span class="lineno">  743</span>               beta != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cend(); ++beta)</div>
<div class="line"><span class="lineno">  744</span>    {</div>
<div class="line"><span class="lineno">  745</span>        dVector3 value = <a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a256ba6049dec35a02207e5171ae8a5cb">Normal</a>(alpha,beta);</div>
<div class="line"><span class="lineno">  746</span>        locNormals.set_asym1(alpha-&gt;index, beta-&gt;index, value);</div>
<div class="line"><span class="lineno">  747</span>    }</div>
<div class="line"><span class="lineno">  748</span>    <span class="keywordflow">return</span> locNormals;</div>
<div class="line"><span class="lineno">  749</span>}</div>
<div class="ttc" id="anamespaceopenphase_html_a256ba6049dec35a02207e5171ae8a5cb"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a256ba6049dec35a02207e5171ae8a5cb">openphase::Normal</a></div><div class="ttdeci">enum OP_EXPORTS Normal</div><div class="ttdoc">All outputs are enabled.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/dfe/ConsoleOutput_8h_source.html#l00047">ConsoleOutput.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c9dc9f31745cc5aa910e0a4e4a76326" name="a7c9dc9f31745cc5aa910e0a4e4a76326"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c9dc9f31745cc5aa910e0a4e4a76326">&#9670;&#160;</a></span>NormalsDR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d3/dc0/classopenphase_1_1NodeAB.html">NodeAB</a>&lt; <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a>, <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> &gt; openphase::PhaseField::NormalsDR </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns interface normals for all pairs of phase fields at a given position in double resolution. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l00751">751</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  752</span>{</div>
<div class="line"><span class="lineno">  753</span>    NodeAB&lt;dVector3,dVector3&gt; locNormals;</div>
<div class="line"><span class="lineno">  754</span> </div>
<div class="line"><span class="lineno">  755</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> alpha  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno">  756</span>              alpha != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).cend(); ++alpha)</div>
<div class="line"><span class="lineno">  757</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>  beta  = alpha + 1;</div>
<div class="line"><span class="lineno">  758</span>               beta != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).cend(); ++beta)</div>
<div class="line"><span class="lineno">  759</span>    {</div>
<div class="line"><span class="lineno">  760</span>        dVector3 value = <a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a256ba6049dec35a02207e5171ae8a5cb">Normal</a>(alpha,beta);</div>
<div class="line"><span class="lineno">  761</span>        locNormals.set_asym1(alpha-&gt;index, beta-&gt;index, value);</div>
<div class="line"><span class="lineno">  762</span>    }</div>
<div class="line"><span class="lineno">  763</span>    <span class="keywordflow">return</span> locNormals;</div>
<div class="line"><span class="lineno">  764</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3d160e3ff1782e6f87f67a64193d7a30" name="a3d160e3ff1782e6f87f67a64193d7a30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d160e3ff1782e6f87f67a64193d7a30">&#9670;&#160;</a></span>NormalsPhase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d8/d8b/classopenphase_1_1NodeA.html">NodeA</a>&lt; <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> &gt; openphase::PhaseField::NormalsPhase </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns interface normals for all pairs of phase fields at a given position. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l00766">766</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  767</span>{</div>
<div class="line"><span class="lineno">  768</span>    NodeA&lt;dVector3&gt; locNormals = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).get_gradients();</div>
<div class="line"><span class="lineno">  769</span> </div>
<div class="line"><span class="lineno">  770</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> alpha  = locNormals.begin();</div>
<div class="line"><span class="lineno">  771</span>              alpha != locNormals.end(); ++alpha)</div>
<div class="line"><span class="lineno">  772</span>    {</div>
<div class="line"><span class="lineno">  773</span>        alpha-&gt;value.normalize();</div>
<div class="line"><span class="lineno">  774</span>    }</div>
<div class="line"><span class="lineno">  775</span>    <span class="keywordflow">return</span> locNormals;</div>
<div class="line"><span class="lineno">  776</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="acdd6a035437a9feef3b603ef694c3a55" name="acdd6a035437a9feef3b603ef694c3a55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acdd6a035437a9feef3b603ef694c3a55">&#9670;&#160;</a></span>NormalsPhaseDR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d8/d8b/classopenphase_1_1NodeA.html">NodeA</a>&lt; <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> &gt; openphase::PhaseField::NormalsPhaseDR </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns interface normals for all pairs of phase fields at a given position. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l00778">778</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  779</span>{</div>
<div class="line"><span class="lineno">  780</span>    NodeA&lt;dVector3&gt; locNormals = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).get_gradients();</div>
<div class="line"><span class="lineno">  781</span> </div>
<div class="line"><span class="lineno">  782</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> alpha  = locNormals.begin();</div>
<div class="line"><span class="lineno">  783</span>              alpha != locNormals.end(); ++alpha)</div>
<div class="line"><span class="lineno">  784</span>    {</div>
<div class="line"><span class="lineno">  785</span>        alpha-&gt;value.normalize();</div>
<div class="line"><span class="lineno">  786</span>    }</div>
<div class="line"><span class="lineno">  787</span>    <span class="keywordflow">return</span> locNormals;</div>
<div class="line"><span class="lineno">  788</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a44d63a0e1824696eeffb1ef348d24b81" name="a44d63a0e1824696eeffb1ef348d24b81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44d63a0e1824696eeffb1ef348d24b81">&#9670;&#160;</a></span>operator=()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp; openphase::PhaseField::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>rhs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copy operator for <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html" title="&lt; Phase field class. It stores the phase fields, performs basic operations on them.">PhaseField</a> class. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02981">2981</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2982</span>{</div>
<div class="line"><span class="lineno"> 2983</span>    <span class="comment">// protect against self-assignment and copy of uninitialized object</span></div>
<div class="line"><span class="lineno"> 2984</span>    <span class="keywordflow">if</span> (<span class="keyword">this</span> != &amp;rhs and rhs.thisclassname == <span class="stringliteral">&quot;PhaseField&quot;</span>)</div>
<div class="line"><span class="lineno"> 2985</span>    {</div>
<div class="line"><span class="lineno"> 2986</span>        <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a> = rhs.thisclassname;</div>
<div class="line"><span class="lineno"> 2987</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a80736ea4892c99f7a189d1138252be4b">NucleationPresent</a> = rhs.NucleationPresent;</div>
<div class="line"><span class="lineno"> 2988</span> </div>
<div class="line"><span class="lineno"> 2989</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a> = rhs.Grid;</div>
<div class="line"><span class="lineno"> 2990</span> </div>
<div class="line"><span class="lineno"> 2991</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a> = rhs.Nphases;</div>
<div class="line"><span class="lineno"> 2992</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a00842a7df5798d0d7e5c677949ec5600">PhaseNames</a> = rhs.PhaseNames;</div>
<div class="line"><span class="lineno"> 2993</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a18545778a21115cf2146d08dc86e2de4">PhaseAggregateStates</a> = rhs.PhaseAggregateStates;</div>
<div class="line"><span class="lineno"> 2994</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a0c76a1996bda299c8471a126fb4f1f38">PhaseEquilibriumDensities</a> = rhs.PhaseEquilibriumDensities;</div>
<div class="line"><span class="lineno"> 2995</span> </div>
<div class="line"><span class="lineno"> 2996</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7f11e6f1f190ef9bb7e6c6013ec03101">FractionsTotal</a> = rhs.FractionsTotal;</div>
<div class="line"><span class="lineno"> 2997</span> </div>
<div class="line"><span class="lineno"> 2998</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aae9497091c72d48f9c660f24a4b4749b">ConsiderNucleusVolume</a> = rhs.ConsiderNucleusVolume;</div>
<div class="line"><span class="lineno"> 2999</span> </div>
<div class="line"><span class="lineno"> 3000</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a65cf354fce580b8677302a60babdc3b2">PhaseFieldLaplacianStencil</a> = rhs.PhaseFieldLaplacianStencil;</div>
<div class="line"><span class="lineno"> 3001</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a6d205eece17c945a4b51869b49184e1a">PhaseFieldGradientStencil</a> = rhs.PhaseFieldGradientStencil;</div>
<div class="line"><span class="lineno"> 3002</span> </div>
<div class="line"><span class="lineno"> 3003</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a4099b0db42d5fcbf908eafe2a338032e">LStencil</a> = rhs.LStencil;</div>
<div class="line"><span class="lineno"> 3004</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a1f560b94dd8685e5f84363d403c5d495">GStencil</a> = rhs.GStencil;</div>
<div class="line"><span class="lineno"> 3005</span> </div>
<div class="line"><span class="lineno"> 3006</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a> = rhs.FieldsProperties;</div>
<div class="line"><span class="lineno"> 3007</span> </div>
<div class="line"><span class="lineno"> 3008</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3390ad72b1d99545de2cb145cdc35118">PairwiseGrowthFactors</a> = rhs.PairwiseGrowthFactors;</div>
<div class="line"><span class="lineno"> 3009</span> </div>
<div class="line"><span class="lineno"> 3010</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>.IsNotAllocated())</div>
<div class="line"><span class="lineno"> 3011</span>        {</div>
<div class="line"><span class="lineno"> 3012</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>.Allocate(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>, rhs.Fields.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#aae205a52da44fe4c880a16b0f5a48cfb">Bcells</a>());</div>
<div class="line"><span class="lineno"> 3013</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>.Allocate(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>, rhs.FieldsDot.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#aae205a52da44fe4c880a16b0f5a48cfb">Bcells</a>());</div>
<div class="line"><span class="lineno"> 3014</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a784a4bea9a5379192bdf4f12ab12cf10">Fractions</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#af45dd4140586881f9ed201c3b795faff">Allocate</a>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>, {<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a>},rhs.Fractions.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#aae205a52da44fe4c880a16b0f5a48cfb">Bcells</a>());</div>
<div class="line"><span class="lineno"> 3015</span>        }</div>
<div class="line"><span class="lineno"> 3016</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (not <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>.IsSize(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>))</div>
<div class="line"><span class="lineno"> 3017</span>        {</div>
<div class="line"><span class="lineno"> 3018</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>.Reallocate(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>);</div>
<div class="line"><span class="lineno"> 3019</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>.Reallocate(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>);</div>
<div class="line"><span class="lineno"> 3020</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a784a4bea9a5379192bdf4f12ab12cf10">Fractions</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#a0d8d0ac8475f544e2e72929d4b9bae12">Reallocate</a>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>);</div>
<div class="line"><span class="lineno"> 3021</span>        }</div>
<div class="line"><span class="lineno"> 3022</span> </div>
<div class="line"><span class="lineno"> 3023</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>.Bcells(),)</div>
<div class="line"><span class="lineno"> 3024</span>        {</div>
<div class="line"><span class="lineno"> 3025</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k) = rhs.Fields(i,j,k);</div>
<div class="line"><span class="lineno"> 3026</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>(i,j,k) = rhs.FieldsDot(i,j,k);</div>
<div class="line"><span class="lineno"> 3027</span> </div>
<div class="line"><span class="lineno"> 3028</span>        }</div>
<div class="line"><span class="lineno"> 3029</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 3030</span>        <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a357ea817f60117eb924f107e77a482ef">CalculateFractions</a>();</div>
<div class="line"><span class="lineno"> 3031</span> </div>
<div class="line"><span class="lineno"> 3032</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#af0b28822d6a3aba3df4db780b51db71a">Resolution</a> == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>)</div>
<div class="line"><span class="lineno"> 3033</span>        {</div>
<div class="line"><span class="lineno"> 3034</span>            GridParameters DoubleDimensions = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_function" href="../../dc/d18/classopenphase_1_1GridParameters.html#aa24687417304e06716da10e732d708af">DoubleResolution</a>();</div>
<div class="line"><span class="lineno"> 3035</span> </div>
<div class="line"><span class="lineno"> 3036</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.IsNotAllocated())</div>
<div class="line"><span class="lineno"> 3037</span>            {</div>
<div class="line"><span class="lineno"> 3038</span>                <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.Allocate(DoubleDimensions, rhs.Fields.Bcells());</div>
<div class="line"><span class="lineno"> 3039</span>                <span class="comment">//FieldsDerivativesDR.Allocate(DoubleDimensions, rhs.Fields.Bcells());</span></div>
<div class="line"><span class="lineno"> 3040</span>                <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>.Allocate(DoubleDimensions, rhs.FieldsDot.Bcells());</div>
<div class="line"><span class="lineno"> 3041</span>            }</div>
<div class="line"><span class="lineno"> 3042</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (not <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.IsSize(DoubleDimensions.Nx, DoubleDimensions.Ny, DoubleDimensions.Nz))</div>
<div class="line"><span class="lineno"> 3043</span>            {</div>
<div class="line"><span class="lineno"> 3044</span>                <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.Reallocate(DoubleDimensions.Nx, DoubleDimensions.Ny, DoubleDimensions.Nz);</div>
<div class="line"><span class="lineno"> 3045</span>                <span class="comment">//FieldsDerivativesDR.Reallocate(DoubleDimensions.Nx, DoubleDimensions.Ny, DoubleDimensions.Nz);</span></div>
<div class="line"><span class="lineno"> 3046</span>                <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>.Reallocate(DoubleDimensions.Nx, DoubleDimensions.Ny, DoubleDimensions.Nz);</div>
<div class="line"><span class="lineno"> 3047</span>            }</div>
<div class="line"><span class="lineno"> 3048</span> </div>
<div class="line"><span class="lineno"> 3049</span>            <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.Bcells(),)</div>
<div class="line"><span class="lineno"> 3050</span>            {</div>
<div class="line"><span class="lineno"> 3051</span>                <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k) = rhs.FieldsDR(i,j,k);</div>
<div class="line"><span class="lineno"> 3052</span>                <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>(i,j,k) = rhs.FieldsDotDR(i,j,k);</div>
<div class="line"><span class="lineno"> 3053</span>            }</div>
<div class="line"><span class="lineno"> 3054</span>            <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 3055</span>            <span class="comment">//CopyDerivativesDR();</span></div>
<div class="line"><span class="lineno"> 3056</span>        }</div>
<div class="line"><span class="lineno"> 3057</span>    }</div>
<div class="line"><span class="lineno"> 3058</span>    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 3059</span>}</div>
<div class="ttc" id="aclassopenphase_1_1Storage3D_html_a0d8d0ac8475f544e2e72929d4b9bae12"><div class="ttname"><a href="../../da/d19/classopenphase_1_1Storage3D.html#a0d8d0ac8475f544e2e72929d4b9bae12">openphase::Storage3D::Reallocate</a></div><div class="ttdeci">void Reallocate(const long int nx, const long int ny, const long int nz)</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d8e/Storage3D_8h_source.html#l00814">Storage3D.h:814</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aef4cc644c0c70be7ff72707535cd0d52" name="aef4cc644c0c70be7ff72707535cd0d52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef4cc644c0c70be7ff72707535cd0d52">&#9670;&#160;</a></span>ParentGrain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::PhaseField::ParentGrain </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parent grain index for <a class="el" href="../../d3/d89/structopenphase_1_1VTK.html" title="&lt; static class to write VTK data in xml format">VTK</a> output. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03825">3825</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3826</span>{</div>
<div class="line"><span class="lineno"> 3827</span>    <span class="keywordtype">int</span> <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#aef4cc644c0c70be7ff72707535cd0d52">ParentGrain</a> = 0;</div>
<div class="line"><span class="lineno"> 3828</span>    <span class="keywordtype">double</span> locValue = 0.0;</div>
<div class="line"><span class="lineno"> 3829</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> alpha  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 3830</span>              alpha != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cend(); ++alpha)</div>
<div class="line"><span class="lineno"> 3831</span>    {</div>
<div class="line"><span class="lineno"> 3832</span>        <span class="keywordflow">if</span>(alpha-&gt;value &gt; locValue)</div>
<div class="line"><span class="lineno"> 3833</span>        {</div>
<div class="line"><span class="lineno"> 3834</span>            locValue = alpha-&gt;value;</div>
<div class="line"><span class="lineno"> 3835</span>            <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#aef4cc644c0c70be7ff72707535cd0d52">ParentGrain</a> = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[alpha-&gt;index].Parent;</div>
<div class="line"><span class="lineno"> 3836</span>        }</div>
<div class="line"><span class="lineno"> 3837</span>    }</div>
<div class="line"><span class="lineno"> 3838</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#aef4cc644c0c70be7ff72707535cd0d52">ParentGrain</a>;</div>
<div class="line"><span class="lineno"> 3839</span>}</div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_aef4cc644c0c70be7ff72707535cd0d52"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#aef4cc644c0c70be7ff72707535cd0d52">openphase::PhaseField::ParentGrain</a></div><div class="ttdeci">double ParentGrain(const int i, const int j, const int k) const</div><div class="ttdoc">Parent grain index for VTK output.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l03825">PhaseField.cpp:3825</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0d16abfb203f146a81ff92a2d3a68cfb" name="a0d16abfb203f146a81ff92a2d3a68cfb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d16abfb203f146a81ff92a2d3a68cfb">&#9670;&#160;</a></span>ParentGrainDR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::PhaseField::ParentGrainDR </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parent grain index for <a class="el" href="../../d3/d89/structopenphase_1_1VTK.html" title="&lt; static class to write VTK data in xml format">VTK</a> output in double resolution. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03841">3841</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3842</span>{</div>
<div class="line"><span class="lineno"> 3843</span>    <span class="keywordtype">int</span> <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#aef4cc644c0c70be7ff72707535cd0d52">ParentGrain</a> = 0;</div>
<div class="line"><span class="lineno"> 3844</span>    <span class="keywordtype">double</span> locValue = 0.0;</div>
<div class="line"><span class="lineno"> 3845</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> alpha  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 3846</span>              alpha != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).cend(); ++alpha)</div>
<div class="line"><span class="lineno"> 3847</span>    {</div>
<div class="line"><span class="lineno"> 3848</span>        <span class="keywordflow">if</span>(alpha-&gt;value &gt; locValue)</div>
<div class="line"><span class="lineno"> 3849</span>        {</div>
<div class="line"><span class="lineno"> 3850</span>            locValue = alpha-&gt;value;</div>
<div class="line"><span class="lineno"> 3851</span>            <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#aef4cc644c0c70be7ff72707535cd0d52">ParentGrain</a> = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[alpha-&gt;index].Parent;</div>
<div class="line"><span class="lineno"> 3852</span>        }</div>
<div class="line"><span class="lineno"> 3853</span>    }</div>
<div class="line"><span class="lineno"> 3854</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#aef4cc644c0c70be7ff72707535cd0d52">ParentGrain</a>;</div>
<div class="line"><span class="lineno"> 3855</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a113417761f840a9748831c84aff8e692" name="a113417761f840a9748831c84aff8e692"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a113417761f840a9748831c84aff8e692">&#9670;&#160;</a></span>PhaseFieldPresent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::PhaseField::PhaseFieldPresent </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>Index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if phase field is present in a grid cell with coordinates (i,j,k) </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03465">3465</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3467</span>{</div>
<div class="line"><span class="lineno"> 3468</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).interface())</div>
<div class="line"><span class="lineno"> 3469</span>    {</div>
<div class="line"><span class="lineno"> 3470</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).front().index == Index) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 3471</span>    }</div>
<div class="line"><span class="lineno"> 3472</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3473</span>    {</div>
<div class="line"><span class="lineno"> 3474</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> alpha  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 3475</span>                  alpha != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cend(); ++alpha)</div>
<div class="line"><span class="lineno"> 3476</span>        {</div>
<div class="line"><span class="lineno"> 3477</span>            <span class="keywordflow">if</span> (alpha-&gt;index == Index) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 3478</span>        }</div>
<div class="line"><span class="lineno"> 3479</span>    }</div>
<div class="line"><span class="lineno"> 3480</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3481</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a39bca279acb9052993508886a5fe3ca1" name="a39bca279acb9052993508886a5fe3ca1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39bca279acb9052993508886a5fe3ca1">&#9670;&#160;</a></span>PlantGrainNucleus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t openphase::PhaseField::PlantGrainNucleus </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>PhaseIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Plants grain nucleus at position (x,y,z) of a phase "PhaseIndex", returns resulting phase field index. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02930">2930</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2931</span>{</div>
<div class="line"><span class="lineno"> 2932</span>    <span class="keywordtype">size_t</span> locIndex = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>.<a class="code hl_function" href="../../d6/d90/classopenphase_1_1GrainsProperties.html#a139779e789b93dea1e1629d7c5b74386">add_grain</a>(PhaseIndex);</div>
<div class="line"><span class="lineno"> 2933</span> </div>
<div class="line"><span class="lineno"> 2934</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[locIndex].Stage  = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#af71cd9b36fd77e1eb90f17b95c04e52eadba005190e58b252f9b5375cdf5655d9">GrainStages::Seed</a>;</div>
<div class="line"><span class="lineno"> 2935</span> </div>
<div class="line"><span class="lineno"> 2936</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[locIndex].Rcm[0] = x;</div>
<div class="line"><span class="lineno"> 2937</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[locIndex].Rcm[1] = y;</div>
<div class="line"><span class="lineno"> 2938</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[locIndex].Rcm[2] = z;</div>
<div class="line"><span class="lineno"> 2939</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[locIndex].RefVolume = <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3a500b45060139b7e51d305fb90c46e4">CalculateReferenceVolume</a>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6b4e77f0fe736794ab56285960cd7a1e">iWidth</a>);</div>
<div class="line"><span class="lineno"> 2940</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[locIndex].VolumeRatio = 0.0;</div>
<div class="line"><span class="lineno"> 2941</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[locIndex].State = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a18545778a21115cf2146d08dc86e2de4">PhaseAggregateStates</a>[PhaseIndex];</div>
<div class="line"><span class="lineno"> 2942</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[locIndex].Density = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a0c76a1996bda299c8471a126fb4f1f38">PhaseEquilibriumDensities</a>[PhaseIndex];</div>
<div class="line"><span class="lineno"> 2943</span> </div>
<div class="line"><span class="lineno"> 2944</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a80736ea4892c99f7a189d1138252be4b">NucleationPresent</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2945</span> </div>
<div class="line"><span class="lineno"> 2946</span>    <span class="keywordflow">if</span> (x - <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a77c3cc57b7a3f3bf027c4009086c41c5">OffsetX</a> &gt;= 0 &amp;&amp; x - <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a77c3cc57b7a3f3bf027c4009086c41c5">OffsetX</a> &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a> and</div>
<div class="line"><span class="lineno"> 2947</span>        y - <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ade25b3c7a0f4e0349382f6854cad2a88">OffsetY</a> &gt;= 0 &amp;&amp; y - <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ade25b3c7a0f4e0349382f6854cad2a88">OffsetY</a> &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a> and</div>
<div class="line"><span class="lineno"> 2948</span>        z - <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab2d101b7c8a941d0895566156c706e5a">OffsetZ</a> &gt;= 0 &amp;&amp; z - <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab2d101b7c8a941d0895566156c706e5a">OffsetZ</a> &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>)</div>
<div class="line"><span class="lineno"> 2949</span>    {</div>
<div class="line"><span class="lineno"> 2950</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(x - <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a77c3cc57b7a3f3bf027c4009086c41c5">OffsetX</a>, y - <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ade25b3c7a0f4e0349382f6854cad2a88">OffsetY</a>, z - <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab2d101b7c8a941d0895566156c706e5a">OffsetZ</a>).set_value(locIndex, 0.0);</div>
<div class="line"><span class="lineno"> 2951</span> </div>
<div class="line"><span class="lineno"> 2952</span>        <span class="keywordtype">long</span> <span class="keywordtype">int</span> fx = 1 + <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>;</div>
<div class="line"><span class="lineno"> 2953</span>        <span class="keywordtype">long</span> <span class="keywordtype">int</span> fy = 1 + <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>;</div>
<div class="line"><span class="lineno"> 2954</span>        <span class="keywordtype">long</span> <span class="keywordtype">int</span> fz = 1 + <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>;</div>
<div class="line"><span class="lineno"> 2955</span> </div>
<div class="line"><span class="lineno"> 2956</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#af0b28822d6a3aba3df4db780b51db71a">Resolution</a> == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>)</div>
<div class="line"><span class="lineno"> 2957</span>        {</div>
<div class="line"><span class="lineno"> 2958</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> di = -<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; di &lt;= <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; di+=2)</div>
<div class="line"><span class="lineno"> 2959</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> dj = -<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; dj &lt;= <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; dj+=2)</div>
<div class="line"><span class="lineno"> 2960</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> dk = -<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; dk &lt;= <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; dk+=2)</div>
<div class="line"><span class="lineno"> 2961</span>            {</div>
<div class="line"><span class="lineno"> 2962</span>                <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(fx*(x - <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a77c3cc57b7a3f3bf027c4009086c41c5">OffsetX</a>)+(di+1)/2,fy*(y - <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ade25b3c7a0f4e0349382f6854cad2a88">OffsetY</a>)+(dj+1)/2,fz*(z - <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab2d101b7c8a941d0895566156c706e5a">OffsetZ</a>)+(dk+1)/2).set_value(locIndex, 0.0);</div>
<div class="line"><span class="lineno"> 2963</span>            }</div>
<div class="line"><span class="lineno"> 2964</span>        }</div>
<div class="line"><span class="lineno"> 2965</span>    }</div>
<div class="line"><span class="lineno"> 2966</span> </div>
<div class="line"><span class="lineno"> 2967</span>    <span class="keywordflow">return</span> locIndex;</div>
<div class="line"><span class="lineno"> 2968</span>}</div>
<div class="ttc" id="aclassopenphase_1_1GridParameters_html_a77c3cc57b7a3f3bf027c4009086c41c5"><div class="ttname"><a href="../../dc/d18/classopenphase_1_1GridParameters.html#a77c3cc57b7a3f3bf027c4009086c41c5">openphase::GridParameters::OffsetX</a></div><div class="ttdeci">int OffsetX</div><div class="ttdoc">X coordinate of the local domain coordinate system origin (in case of MPI parallelism)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d68/GridParameters_8h_source.html#l00149">GridParameters.h:149</a></div></div>
<div class="ttc" id="aclassopenphase_1_1GridParameters_html_ab2d101b7c8a941d0895566156c706e5a"><div class="ttname"><a href="../../dc/d18/classopenphase_1_1GridParameters.html#ab2d101b7c8a941d0895566156c706e5a">openphase::GridParameters::OffsetZ</a></div><div class="ttdeci">int OffsetZ</div><div class="ttdoc">Z coordinate of the local domain coordinate system origin (in case of MPI parallelism)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d68/GridParameters_8h_source.html#l00155">GridParameters.h:155</a></div></div>
<div class="ttc" id="aclassopenphase_1_1GridParameters_html_ade25b3c7a0f4e0349382f6854cad2a88"><div class="ttname"><a href="../../dc/d18/classopenphase_1_1GridParameters.html#ade25b3c7a0f4e0349382f6854cad2a88">openphase::GridParameters::OffsetY</a></div><div class="ttdeci">int OffsetY</div><div class="ttdoc">Y coordinate of the local domain coordinate system origin (in case of MPI parallelism)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d68/GridParameters_8h_source.html#l00152">GridParameters.h:152</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad1eb4ab9b20c8618ab7db82fee65d03a" name="ad1eb4ab9b20c8618ab7db82fee65d03a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1eb4ab9b20c8618ab7db82fee65d03a">&#9670;&#160;</a></span>PrincipalCurvatures() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pair&lt; <a class="el" href="../../d8/d8b/classopenphase_1_1NodeA.html">NodeA</a>&lt; double &gt;, <a class="el" href="../../d8/d8b/classopenphase_1_1NodeA.html">NodeA</a>&lt; double &gt; &gt; openphase::PhaseField::PrincipalCurvatures </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns principal curvatures of all phase fields at a given position. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03261">3261</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3264</span>{</div>
<div class="line"><span class="lineno"> 3265</span>    NodeA&lt;double&gt; kappa1;</div>
<div class="line"><span class="lineno"> 3266</span>    NodeA&lt;double&gt; kappa2;</div>
<div class="line"><span class="lineno"> 3267</span> </div>
<div class="line"><span class="lineno"> 3268</span>    kappa1.clear();</div>
<div class="line"><span class="lineno"> 3269</span>    kappa2.clear();</div>
<div class="line"><span class="lineno"> 3270</span> </div>
<div class="line"><span class="lineno"> 3271</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> GWeights[3] = {-0.5/<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>, 0.0, 0.5/<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">dx</a>};</div>
<div class="line"><span class="lineno"> 3272</span> </div>
<div class="line"><span class="lineno"> 3273</span>    <span class="comment">// Check if neighbour cell are also in the interface</span></div>
<div class="line"><span class="lineno"> 3274</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).interface())</div>
<div class="line"><span class="lineno"> 3275</span>    {</div>
<div class="line"><span class="lineno"> 3276</span>        <span class="comment">// Calculate gradients of phase normal fields (Jacobian matrix)</span></div>
<div class="line"><span class="lineno"> 3277</span>        Tensor&lt;NodeA&lt;double&gt;, 2 &gt; NormalGradient;</div>
<div class="line"><span class="lineno"> 3278</span>        NormalGradient.Allocate({3,3});</div>
<div class="line"><span class="lineno"> 3279</span>        NormalGradient.set_to_zero();</div>
<div class="line"><span class="lineno"> 3280</span> </div>
<div class="line"><span class="lineno"> 3281</span>        <span class="comment">// Calculate gradients of normals</span></div>
<div class="line"><span class="lineno"> 3282</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = -1; ii &lt;= +1; ii += 2)</div>
<div class="line"><span class="lineno"> 3283</span>        {</div>
<div class="line"><span class="lineno"> 3284</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> GWeight = GWeights[ii+1];</div>
<div class="line"><span class="lineno"> 3285</span> </div>
<div class="line"><span class="lineno"> 3286</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>)</div>
<div class="line"><span class="lineno"> 3287</span>            {</div>
<div class="line"><span class="lineno"> 3288</span>                NodeA&lt;dVector3&gt; locNormalsX = <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3d160e3ff1782e6f87f67a64193d7a30">NormalsPhase</a>(i+ii,j,k);</div>
<div class="line"><span class="lineno"> 3289</span>                <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = locNormalsX.cbegin(); it &lt; locNormalsX.cend(); ++it)</div>
<div class="line"><span class="lineno"> 3290</span>                {</div>
<div class="line"><span class="lineno"> 3291</span>                    NormalGradient({0,0}).add_value(it-&gt;index, GWeight*(it-&gt;value[0]));</div>
<div class="line"><span class="lineno"> 3292</span>                    NormalGradient({1,0}).add_value(it-&gt;index, GWeight*(it-&gt;value[1]));</div>
<div class="line"><span class="lineno"> 3293</span>                    NormalGradient({2,0}).add_value(it-&gt;index, GWeight*(it-&gt;value[2]));</div>
<div class="line"><span class="lineno"> 3294</span>                }</div>
<div class="line"><span class="lineno"> 3295</span>            }</div>
<div class="line"><span class="lineno"> 3296</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>)</div>
<div class="line"><span class="lineno"> 3297</span>            {</div>
<div class="line"><span class="lineno"> 3298</span>                NodeA&lt;dVector3&gt; locNormalsY = <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3d160e3ff1782e6f87f67a64193d7a30">NormalsPhase</a>(i,j+ii,k);</div>
<div class="line"><span class="lineno"> 3299</span>                <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = locNormalsY.cbegin(); it &lt; locNormalsY.cend(); ++it)</div>
<div class="line"><span class="lineno"> 3300</span>                {</div>
<div class="line"><span class="lineno"> 3301</span>                    NormalGradient({0,1}).add_value(it-&gt;index, GWeight*(it-&gt;value[0]));</div>
<div class="line"><span class="lineno"> 3302</span>                    NormalGradient({1,1}).add_value(it-&gt;index, GWeight*(it-&gt;value[1]));</div>
<div class="line"><span class="lineno"> 3303</span>                    NormalGradient({2,1}).add_value(it-&gt;index, GWeight*(it-&gt;value[2]));</div>
<div class="line"><span class="lineno"> 3304</span>                }</div>
<div class="line"><span class="lineno"> 3305</span>            }</div>
<div class="line"><span class="lineno"> 3306</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>)</div>
<div class="line"><span class="lineno"> 3307</span>            {</div>
<div class="line"><span class="lineno"> 3308</span>                NodeA&lt;dVector3&gt; locNormalsZ = <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3d160e3ff1782e6f87f67a64193d7a30">NormalsPhase</a>(i,j,k+ii);</div>
<div class="line"><span class="lineno"> 3309</span>                <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = locNormalsZ.cbegin(); it &lt; locNormalsZ.cend(); ++it)</div>
<div class="line"><span class="lineno"> 3310</span>                {</div>
<div class="line"><span class="lineno"> 3311</span>                    NormalGradient({0,2}).add_value(it-&gt;index, GWeight*(it-&gt;value[0]));</div>
<div class="line"><span class="lineno"> 3312</span>                    NormalGradient({1,2}).add_value(it-&gt;index, GWeight*(it-&gt;value[1]));</div>
<div class="line"><span class="lineno"> 3313</span>                    NormalGradient({2,2}).add_value(it-&gt;index, GWeight*(it-&gt;value[2]));</div>
<div class="line"><span class="lineno"> 3314</span>                }</div>
<div class="line"><span class="lineno"> 3315</span>            }</div>
<div class="line"><span class="lineno"> 3316</span>        }</div>
<div class="line"><span class="lineno"> 3317</span> </div>
<div class="line"><span class="lineno"> 3318</span>        <span class="comment">// Calculate basis of tangent space at (i,j,k)</span></div>
<div class="line"><span class="lineno"> 3319</span>        <span class="comment">// the basis of a spherical coordinate system at (i,j,k) will be</span></div>
<div class="line"><span class="lineno"> 3320</span>        <span class="comment">// used here. The phase normal vector is in this case equal to the</span></div>
<div class="line"><span class="lineno"> 3321</span>        <span class="comment">// radial normal vector of the spherical coordinate and the</span></div>
<div class="line"><span class="lineno"> 3322</span>        <span class="comment">// remaining basis vectors will be the basis of the tangent space</span></div>
<div class="line"><span class="lineno"> 3323</span> </div>
<div class="line"><span class="lineno"> 3324</span>        NodeA&lt;dVector3&gt; locNormals = <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3d160e3ff1782e6f87f67a64193d7a30">NormalsPhase</a>(i,j,k);</div>
<div class="line"><span class="lineno"> 3325</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = locNormals.cbegin(); it &lt; locNormals.cend(); ++it)</div>
<div class="line"><span class="lineno"> 3326</span>        {</div>
<div class="line"><span class="lineno"> 3327</span>            <span class="keywordtype">double</span> phi   = atan2(it-&gt;value[1],it-&gt;value[0]);</div>
<div class="line"><span class="lineno"> 3328</span>            <span class="keywordtype">double</span> theta = acos(it-&gt;value[2]);</div>
<div class="line"><span class="lineno"> 3329</span> </div>
<div class="line"><span class="lineno"> 3330</span>            <span class="comment">// Calculate basis vectors of tangent space</span></div>
<div class="line"><span class="lineno"> 3331</span>            dVector3 e_n;</div>
<div class="line"><span class="lineno"> 3332</span>            e_n.set_to_zero();</div>
<div class="line"><span class="lineno"> 3333</span>            e_n[0] = it-&gt;value[0];</div>
<div class="line"><span class="lineno"> 3334</span>            e_n[1] = it-&gt;value[1];</div>
<div class="line"><span class="lineno"> 3335</span>            e_n[2] = it-&gt;value[2];</div>
<div class="line"><span class="lineno"> 3336</span> </div>
<div class="line"><span class="lineno"> 3337</span>            dVector3 e_theta;</div>
<div class="line"><span class="lineno"> 3338</span>            e_theta.set_to_zero();</div>
<div class="line"><span class="lineno"> 3339</span>            e_theta[0] = cos(theta) * cos(phi);</div>
<div class="line"><span class="lineno"> 3340</span>            e_theta[1] = cos(theta) * sin(phi);</div>
<div class="line"><span class="lineno"> 3341</span>            e_theta[2] =            - sin(theta);</div>
<div class="line"><span class="lineno"> 3342</span> </div>
<div class="line"><span class="lineno"> 3343</span>            dVector3 e_phi;</div>
<div class="line"><span class="lineno"> 3344</span>            e_phi.set_to_zero();</div>
<div class="line"><span class="lineno"> 3345</span>            e_phi[0] = - sin(phi);</div>
<div class="line"><span class="lineno"> 3346</span>            e_phi[1] =   cos(phi);</div>
<div class="line"><span class="lineno"> 3347</span> </div>
<div class="line"><span class="lineno"> 3348</span>            <span class="comment">// Calculate projection and inclusion matrices</span></div>
<div class="line"><span class="lineno"> 3349</span>            <span class="keywordtype">double</span> Projection [2][3];</div>
<div class="line"><span class="lineno"> 3350</span>            <span class="keywordtype">double</span> Inclusion  [3][2];</div>
<div class="line"><span class="lineno"> 3351</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> m = 0; m &lt; 3; ++m)</div>
<div class="line"><span class="lineno"> 3352</span>            {</div>
<div class="line"><span class="lineno"> 3353</span>                Projection[1][m] = e_phi  [m];</div>
<div class="line"><span class="lineno"> 3354</span>                Projection[0][m] = e_theta[m];</div>
<div class="line"><span class="lineno"> 3355</span> </div>
<div class="line"><span class="lineno"> 3356</span>                Inclusion[m][1] = Projection[1][m];</div>
<div class="line"><span class="lineno"> 3357</span>                Inclusion[m][0] = Projection[0][m];</div>
<div class="line"><span class="lineno"> 3358</span>            }</div>
<div class="line"><span class="lineno"> 3359</span> </div>
<div class="line"><span class="lineno"> 3360</span>            <span class="comment">// Calculate local Weingarten map W</span></div>
<div class="line"><span class="lineno"> 3361</span>            complex&lt;double&gt; W[2][2];</div>
<div class="line"><span class="lineno"> 3362</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> l = 0; l &lt; 2; ++l)</div>
<div class="line"><span class="lineno"> 3363</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> m = 0; m &lt; 2; ++m)</div>
<div class="line"><span class="lineno"> 3364</span>            {</div>
<div class="line"><span class="lineno"> 3365</span>                W[l][m] = 0.0;</div>
<div class="line"><span class="lineno"> 3366</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; 3; ++n)</div>
<div class="line"><span class="lineno"> 3367</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> o = 0; o &lt; 3; ++o)</div>
<div class="line"><span class="lineno"> 3368</span>                {</div>
<div class="line"><span class="lineno"> 3369</span>                    W[l][m] -= Projection[l][n] *</div>
<div class="line"><span class="lineno"> 3370</span>                        NormalGradient({n,o}).get_value(it-&gt;index)</div>
<div class="line"><span class="lineno"> 3371</span>                        * Inclusion[o][m];</div>
<div class="line"><span class="lineno"> 3372</span>                }</div>
<div class="line"><span class="lineno"> 3373</span>            }</div>
<div class="line"><span class="lineno"> 3374</span> </div>
<div class="line"><span class="lineno"> 3375</span>            <span class="comment">// Calculate eigenvalues of local Weingarten map</span></div>
<div class="line"><span class="lineno"> 3376</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> part1 = real((W[0][0] + W[1][1])/2.0);</div>
<div class="line"><span class="lineno"> 3377</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> W2    = real((W[0][0] - W[1][1]) * (W[0][0] - W[1][1]));</div>
<div class="line"><span class="lineno"> 3378</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> part2 = real(0.5 * sqrt(W2) + 4.0*W[0][1] * W[1][0]);</div>
<div class="line"><span class="lineno"> 3379</span> </div>
<div class="line"><span class="lineno"> 3380</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> locKappa1 = real(part1 - part2);</div>
<div class="line"><span class="lineno"> 3381</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> locKappa2 = real(part1 + part2);</div>
<div class="line"><span class="lineno"> 3382</span> </div>
<div class="line"><span class="lineno"> 3383</span>            <span class="comment">// Add eigenvalues to Node storage</span></div>
<div class="line"><span class="lineno"> 3384</span>            kappa1.add_value(it-&gt;index, locKappa1);</div>
<div class="line"><span class="lineno"> 3385</span>            kappa2.add_value(it-&gt;index, locKappa2);</div>
<div class="line"><span class="lineno"> 3386</span>        }</div>
<div class="line"><span class="lineno"> 3387</span>    }</div>
<div class="line"><span class="lineno"> 3388</span> </div>
<div class="line"><span class="lineno"> 3389</span>    <span class="keywordflow">return</span> make_pair(kappa1, kappa2);</div>
<div class="line"><span class="lineno"> 3390</span>}</div>
<div class="ttc" id="aclassopenphase_1_1GridParameters_html_a1b2728d875d39b6eed2284849e95956c"><div class="ttname"><a href="../../dc/d18/classopenphase_1_1GridParameters.html#a1b2728d875d39b6eed2284849e95956c">openphase::GridParameters::dx</a></div><div class="ttdeci">double dx</div><div class="ttdoc">Grid spacing in true units.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d68/GridParameters_8h_source.html#l00165">GridParameters.h:165</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a41426a7a8ececf8e6ecb7724e13bd793" name="a41426a7a8ececf8e6ecb7724e13bd793"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41426a7a8ececf8e6ecb7724e13bd793">&#9670;&#160;</a></span>PrincipalCurvatures() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::array&lt; double, 2 &gt; openphase::PhaseField::PrincipalCurvatures </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>phase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Principle Curvatures for plotting <a class="el" href="../../d3/d89/structopenphase_1_1VTK.html" title="&lt; static class to write VTK data in xml format">VTK</a>. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03392">3392</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3393</span>{</div>
<div class="line"><span class="lineno"> 3394</span>    <span class="keywordtype">double</span> phaseKappa1 = 0; <span class="comment">// principle curvature phase</span></div>
<div class="line"><span class="lineno"> 3395</span>    <span class="keywordtype">double</span> phaseKappa2 = 0; <span class="comment">// principle curvature phase</span></div>
<div class="line"><span class="lineno"> 3396</span> </div>
<div class="line"><span class="lineno"> 3397</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).interface())</div>
<div class="line"><span class="lineno"> 3398</span>    {</div>
<div class="line"><span class="lineno"> 3399</span>          NodeA&lt;double&gt; locKappa1; <span class="comment">// principle curvature of each phase field</span></div>
<div class="line"><span class="lineno"> 3400</span>          NodeA&lt;double&gt; locKappa2; <span class="comment">// principle curvature of each phase field</span></div>
<div class="line"><span class="lineno"> 3401</span>          <span class="comment">// Calculate curvature of all phase fields</span></div>
<div class="line"><span class="lineno"> 3402</span>          tie(locKappa1, locKappa2) = <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a41426a7a8ececf8e6ecb7724e13bd793">PrincipalCurvatures</a>(i,j,k);</div>
<div class="line"><span class="lineno"> 3403</span> </div>
<div class="line"><span class="lineno"> 3404</span>          <span class="comment">// Calculate curvature of desired phase</span></div>
<div class="line"><span class="lineno"> 3405</span>          <span class="keywordflow">for</span> (<span class="keyword">auto</span> it  = locKappa1.cbegin();</div>
<div class="line"><span class="lineno"> 3406</span>                    it != locKappa1.cend(); it++)</div>
<div class="line"><span class="lineno"> 3407</span>          {</div>
<div class="line"><span class="lineno"> 3408</span>              <span class="keywordtype">size_t</span> pIndex = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[it-&gt;index].Phase;</div>
<div class="line"><span class="lineno"> 3409</span>              <span class="keywordflow">if</span> (pIndex == phase) phaseKappa1 += it-&gt;value;</div>
<div class="line"><span class="lineno"> 3410</span>          }</div>
<div class="line"><span class="lineno"> 3411</span>          <span class="keywordflow">for</span> (<span class="keyword">auto</span> it  = locKappa2.cbegin();</div>
<div class="line"><span class="lineno"> 3412</span>                    it != locKappa2.cend(); it++)</div>
<div class="line"><span class="lineno"> 3413</span>          {</div>
<div class="line"><span class="lineno"> 3414</span>              <span class="keywordtype">size_t</span> pIndex = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[it-&gt;index].Phase;</div>
<div class="line"><span class="lineno"> 3415</span>              <span class="keywordflow">if</span> (pIndex == phase) phaseKappa2 += it-&gt;value;</div>
<div class="line"><span class="lineno"> 3416</span>          }</div>
<div class="line"><span class="lineno"> 3417</span>    }</div>
<div class="line"><span class="lineno"> 3418</span> </div>
<div class="line"><span class="lineno"> 3419</span>    std::array&lt;double,2&gt; result({phaseKappa1,phaseKappa2});</div>
<div class="line"><span class="lineno"> 3420</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno"> 3421</span>}</div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a41426a7a8ececf8e6ecb7724e13bd793"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a41426a7a8ececf8e6ecb7724e13bd793">openphase::PhaseField::PrincipalCurvatures</a></div><div class="ttdeci">std::array&lt; double, 2 &gt; PrincipalCurvatures(const int i, const int j, const int k, const size_t phase) const</div><div class="ttdoc">Principle Curvatures for plotting VTK.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l03392">PhaseField.cpp:3392</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6359a182e5f0bd698966129a427320ce" name="a6359a182e5f0bd698966129a427320ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6359a182e5f0bd698966129a427320ce">&#9670;&#160;</a></span>PrintPFVolumes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::PrintPFVolumes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints volume of all phase fields. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02765">2765</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2766</span>{</div>
<div class="line"><span class="lineno"> 2767</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3adb3c1b74bf9ac814922b7a8283707e">ConsoleOutput::WriteLineInsert</a>(<span class="stringliteral">&quot;Phase-field volumes&quot;</span>,<span class="stringliteral">&quot;=&quot;</span>);</div>
<div class="line"><span class="lineno"> 2768</span> </div>
<div class="line"><span class="lineno"> 2769</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> idx = 0; idx &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>.<a class="code hl_function" href="../../d6/d90/classopenphase_1_1GrainsProperties.html#abb458316f62ad7fda8d902015e081e9c">size</a>(); idx++)</div>
<div class="line"><span class="lineno"> 2770</span>    {</div>
<div class="line"><span class="lineno"> 2771</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].Volume &gt; 0.0)</div>
<div class="line"><span class="lineno"> 2772</span>        {</div>
<div class="line"><span class="lineno"> 2773</span>            <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3e51a698b31b9d3634b8cbedd2a4ffb5">ConsoleOutput::WriteStandardNarrow</a>(<span class="stringliteral">&quot;PF&quot;</span>,      idx);</div>
<div class="line"><span class="lineno"> 2774</span>            <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3e51a698b31b9d3634b8cbedd2a4ffb5">ConsoleOutput::WriteStandardNarrow</a>(<span class="stringliteral">&quot;Variant&quot;</span>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].Variant);</div>
<div class="line"><span class="lineno"> 2775</span>            <span class="keywordflow">switch</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].Stage)</div>
<div class="line"><span class="lineno"> 2776</span>            {</div>
<div class="line"><span class="lineno"> 2777</span>                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#af71cd9b36fd77e1eb90f17b95c04e52eadba005190e58b252f9b5375cdf5655d9">GrainStages::Seed</a>:</div>
<div class="line"><span class="lineno"> 2778</span>                {</div>
<div class="line"><span class="lineno"> 2779</span>                    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3e51a698b31b9d3634b8cbedd2a4ffb5">ConsoleOutput::WriteStandardNarrow</a>(<span class="stringliteral">&quot;Stage&quot;</span>, <span class="stringliteral">&quot;Seed&quot;</span>);</div>
<div class="line"><span class="lineno"> 2780</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2781</span>                }</div>
<div class="line"><span class="lineno"> 2782</span>                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#af71cd9b36fd77e1eb90f17b95c04e52eae0cbf1349b31b63d275d963e611b54c3">GrainStages::Nucleus</a>:</div>
<div class="line"><span class="lineno"> 2783</span>                {</div>
<div class="line"><span class="lineno"> 2784</span>                    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3e51a698b31b9d3634b8cbedd2a4ffb5">ConsoleOutput::WriteStandardNarrow</a>(<span class="stringliteral">&quot;Stage&quot;</span>, <span class="stringliteral">&quot;Nucleus&quot;</span>);</div>
<div class="line"><span class="lineno"> 2785</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2786</span>                }</div>
<div class="line"><span class="lineno"> 2787</span>                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#af71cd9b36fd77e1eb90f17b95c04e52eafa3aff3c185c6dc7754235f397c2099a">GrainStages::Stable</a>:</div>
<div class="line"><span class="lineno"> 2788</span>                {</div>
<div class="line"><span class="lineno"> 2789</span>                    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3e51a698b31b9d3634b8cbedd2a4ffb5">ConsoleOutput::WriteStandardNarrow</a>(<span class="stringliteral">&quot;Stage&quot;</span>, <span class="stringliteral">&quot;Stable&quot;</span>);</div>
<div class="line"><span class="lineno"> 2790</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2791</span>                }</div>
<div class="line"><span class="lineno"> 2792</span>            }</div>
<div class="line"><span class="lineno"> 2793</span>            <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3e51a698b31b9d3634b8cbedd2a4ffb5">ConsoleOutput::WriteStandardNarrow</a>(<span class="stringliteral">&quot;Volume&quot;</span>,  <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[idx].Volume);</div>
<div class="line"><span class="lineno"> 2794</span>            <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ad86f674a75177eed4dd6cd8c06fcba47">ConsoleOutput::WriteLine</a>(<span class="stringliteral">&quot;-&quot;</span>);</div>
<div class="line"><span class="lineno"> 2795</span>        }</div>
<div class="line"><span class="lineno"> 2796</span>    }</div>
<div class="line"><span class="lineno"> 2797</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ad86f674a75177eed4dd6cd8c06fcba47">ConsoleOutput::WriteLine</a>(<span class="stringliteral">&quot;=&quot;</span>);</div>
<div class="line"><span class="lineno"> 2798</span>}</div>
<div class="ttc" id="aclassopenphase_1_1ConsoleOutput_html_a3adb3c1b74bf9ac814922b7a8283707e"><div class="ttname"><a href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3adb3c1b74bf9ac814922b7a8283707e">openphase::ConsoleOutput::WriteLineInsert</a></div><div class="ttdeci">static void WriteLineInsert(const std::string Insert, const std::string LineType=&quot;-&quot;)</div><div class="ttdef"><b>Definition</b> <a href="../../da/da0/ConsoleOutput_8cpp_source.html#l00117">ConsoleOutput.cpp:117</a></div></div>
<div class="ttc" id="aclassopenphase_1_1ConsoleOutput_html_a3e51a698b31b9d3634b8cbedd2a4ffb5"><div class="ttname"><a href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3e51a698b31b9d3634b8cbedd2a4ffb5">openphase::ConsoleOutput::WriteStandardNarrow</a></div><div class="ttdeci">static void WriteStandardNarrow(const std::string &amp;Left, const T Right, const int precision=StandardPrecision, floatfield notation=StandardNotation)</div><div class="ttdoc">Writes GetStandardNarrow result to std::cout if MPI-Rank 0.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/dfe/ConsoleOutput_8h_source.html#l00307">ConsoleOutput.h:307</a></div></div>
<div class="ttc" id="aclassopenphase_1_1ConsoleOutput_html_ad86f674a75177eed4dd6cd8c06fcba47"><div class="ttname"><a href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ad86f674a75177eed4dd6cd8c06fcba47">openphase::ConsoleOutput::WriteLine</a></div><div class="ttdeci">static void WriteLine(const std::string LineType=&quot;-&quot;)</div><div class="ttdef"><b>Definition</b> <a href="../../da/da0/ConsoleOutput_8cpp_source.html#l00106">ConsoleOutput.cpp:106</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae711f820ad536a4f25a9c100dbab990f" name="ae711f820ad536a4f25a9c100dbab990f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae711f820ad536a4f25a9c100dbab990f">&#9670;&#160;</a></span>PrintPointStatistics()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::PrintPointStatistics </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints the locally present phase fields and their values to the screen. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02111">2111</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2112</span>{</div>
<div class="line"><span class="lineno"> 2113</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Point&quot;</span>, iVector3{x,y,z});</div>
<div class="line"><span class="lineno"> 2114</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> alpha  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(x,y,z).cbegin();</div>
<div class="line"><span class="lineno"> 2115</span>              alpha != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(x,y,z).cend(); ++alpha)</div>
<div class="line"><span class="lineno"> 2116</span>    {</div>
<div class="line"><span class="lineno"> 2117</span>        std::string vname = <span class="stringliteral">&quot;Phase Field &quot;</span> + std::to_string(alpha-&gt;index);</div>
<div class="line"><span class="lineno"> 2118</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(vname, alpha-&gt;value);</div>
<div class="line"><span class="lineno"> 2119</span>    }</div>
<div class="line"><span class="lineno"> 2120</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> PhaseIdx = 0; PhaseIdx != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a>; PhaseIdx++)</div>
<div class="line"><span class="lineno"> 2121</span>    {</div>
<div class="line"><span class="lineno"> 2122</span>        std::string vname = <span class="stringliteral">&quot;Phase Fraction &quot;</span> + <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a00842a7df5798d0d7e5c677949ec5600">PhaseNames</a>[PhaseIdx];</div>
<div class="line"><span class="lineno"> 2123</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(vname, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a784a4bea9a5379192bdf4f12ab12cf10">Fractions</a>(x,y,z,{PhaseIdx}));</div>
<div class="line"><span class="lineno"> 2124</span>    }</div>
<div class="line"><span class="lineno"> 2125</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#acf973fcf791b7ed17177550d8a7175e9">ConsoleOutput::WriteBlankLine</a>();</div>
<div class="line"><span class="lineno"> 2126</span>}</div>
<div class="ttc" id="aclassopenphase_1_1ConsoleOutput_html_acf973fcf791b7ed17177550d8a7175e9"><div class="ttname"><a href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#acf973fcf791b7ed17177550d8a7175e9">openphase::ConsoleOutput::WriteBlankLine</a></div><div class="ttdeci">static void WriteBlankLine(void)</div><div class="ttdef"><b>Definition</b> <a href="../../da/da0/ConsoleOutput_8cpp_source.html#l00129">ConsoleOutput.cpp:129</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a371e195bf6d984bc64f6492956de914b" name="a371e195bf6d984bc64f6492956de914b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a371e195bf6d984bc64f6492956de914b">&#9670;&#160;</a></span>PrintVolumeFractions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::PrintVolumeFractions </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints volume fraction of all thermodynamic phases. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02800">2800</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2801</span>{</div>
<div class="line"><span class="lineno"> 2802</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a607154bed184a8633e4a43e37e98a4d9">ConsoleOutput::WriteSimple</a>(<span class="stringliteral">&quot;Phase fractions:&quot;</span>);</div>
<div class="line"><span class="lineno"> 2803</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a>; n++)</div>
<div class="line"><span class="lineno"> 2804</span>    {</div>
<div class="line"><span class="lineno"> 2805</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3e51a698b31b9d3634b8cbedd2a4ffb5">ConsoleOutput::WriteStandardNarrow</a>(<span class="stringliteral">&quot;Phase &quot;</span> + std::to_string(n) + <span class="stringliteral">&quot; (&quot;</span> + <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a00842a7df5798d0d7e5c677949ec5600">PhaseNames</a>[n] + <span class="stringliteral">&quot;) [%]&quot;</span>, 100.0*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7f11e6f1f190ef9bb7e6c6013ec03101">FractionsTotal</a>[n]);</div>
<div class="line"><span class="lineno"> 2806</span>    }</div>
<div class="line"><span class="lineno"> 2807</span>}</div>
<div class="ttc" id="aclassopenphase_1_1ConsoleOutput_html_a607154bed184a8633e4a43e37e98a4d9"><div class="ttname"><a href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a607154bed184a8633e4a43e37e98a4d9">openphase::ConsoleOutput::WriteSimple</a></div><div class="ttdeci">static void WriteSimple(const std::string Message)</div><div class="ttdef"><b>Definition</b> <a href="../../da/da0/ConsoleOutput_8cpp_source.html#l00140">ConsoleOutput.cpp:140</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa2130b8b55885da8bfe082c1ec1021b0" name="aa2130b8b55885da8bfe082c1ec1021b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2130b8b55885da8bfe082c1ec1021b0">&#9670;&#160;</a></span>Read() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::PhaseField::Read </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;&#160;</td>
          <td class="paramname"><em>locSettings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>tStep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read raw (binary) phase fields from the file of specific time step. </p>

<p>Reimplemented from <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#adbd36cc2fee5c391f60f52ecd6114d2c">openphase::OPObject</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02541">2541</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2542</span>{</div>
<div class="line"><span class="lineno"> 2543</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 2544</span>    <span class="keywordtype">string</span> FileName =</div>
<div class="line"><span class="lineno"> 2545</span>        <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a19ed8803c3eb456f4708ccc6c6edd995">FileInterface::MakeFileName</a>(locSettings.InputRawDataDir,<a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>+<span class="stringliteral">&quot;_&quot;</span>+ std::to_string(MPI_RANK) + <span class="stringliteral">&quot;_&quot;</span>, tStep, <span class="stringliteral">&quot;.dat&quot;</span>);</div>
<div class="line"><span class="lineno"> 2546</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 2547</span>    <span class="keywordtype">string</span> FileName =</div>
<div class="line"><span class="lineno"> 2548</span>        <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a19ed8803c3eb456f4708ccc6c6edd995">FileInterface::MakeFileName</a>(locSettings.InputRawDataDir,<a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>+<span class="stringliteral">&quot;_&quot;</span>, tStep, <span class="stringliteral">&quot;.dat&quot;</span>);</div>
<div class="line"><span class="lineno"> 2549</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2550</span> </div>
<div class="line"><span class="lineno"> 2551</span>    <span class="keywordtype">bool</span> read_status = <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a9e62b1271b2e4238f55d5aaaae201fcf">Read</a>(FileName);</div>
<div class="line"><span class="lineno"> 2552</span>    read_status = read_status &amp;&amp; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>.<a class="code hl_function" href="../../d6/d90/classopenphase_1_1GrainsProperties.html#a25d0863fd396569ab3e6b577be3e801c">Read</a>(locSettings, tStep);</div>
<div class="line"><span class="lineno"> 2553</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#af8c994d103fffdf2f55db24ab6553cf1">Finalize</a>(BC);</div>
<div class="line"><span class="lineno"> 2554</span>    <span class="keywordflow">return</span> read_status;</div>
<div class="line"><span class="lineno"> 2555</span>}</div>
<div class="ttc" id="aclassopenphase_1_1FileInterface_html_a19ed8803c3eb456f4708ccc6c6edd995"><div class="ttname"><a href="../../d2/d61/classopenphase_1_1FileInterface.html#a19ed8803c3eb456f4708ccc6c6edd995">openphase::FileInterface::MakeFileName</a></div><div class="ttdeci">static std::string MakeFileName(std::string Directory, std::string NameBase, int Index, std::string FileExtension)</div><div class="ttdoc">Creates full filename string using the location directory, name base, running index and file extensio...</div><div class="ttdef"><b>Definition</b> <a href="../../df/de6/FileInterface_8cpp_source.html#l00108">FileInterface.cpp:108</a></div></div>
<div class="ttc" id="aclassopenphase_1_1GrainsProperties_html_a25d0863fd396569ab3e6b577be3e801c"><div class="ttname"><a href="../../d6/d90/classopenphase_1_1GrainsProperties.html#a25d0863fd396569ab3e6b577be3e801c">openphase::GrainsProperties::Read</a></div><div class="ttdeci">bool Read(const std::string FileName)</div><div class="ttdef"><b>Definition</b> <a href="../../da/dab/GrainsProperties_8h_source.html#l00800">GrainsProperties.h:800</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a9e62b1271b2e4238f55d5aaaae201fcf"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a9e62b1271b2e4238f55d5aaaae201fcf">openphase::PhaseField::Read</a></div><div class="ttdeci">bool Read(std::string FileName)</div><div class="ttdoc">Read raw (binary) phase fields from the file named FileName.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l02477">PhaseField.cpp:2477</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9e62b1271b2e4238f55d5aaaae201fcf" name="a9e62b1271b2e4238f55d5aaaae201fcf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e62b1271b2e4238f55d5aaaae201fcf">&#9670;&#160;</a></span>Read() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::PhaseField::Read </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>FileName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read raw (binary) phase fields from the file named FileName. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02477">2477</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2478</span>{</div>
<div class="line"><span class="lineno"> 2479</span>    ifstream inp(FileName.c_str(), ios::in | ios::binary);</div>
<div class="line"><span class="lineno"> 2480</span> </div>
<div class="line"><span class="lineno"> 2481</span>    <span class="keywordflow">if</span> (!inp)</div>
<div class="line"><span class="lineno"> 2482</span>    {</div>
<div class="line"><span class="lineno"> 2483</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">ConsoleOutput::WriteWarning</a>(FileName + <span class="stringliteral">&quot; could not be opened&quot;</span>,</div>
<div class="line"><span class="lineno"> 2484</span>                <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, <span class="stringliteral">&quot;Read()&quot;</span>);</div>
<div class="line"><span class="lineno"> 2485</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2486</span>    };</div>
<div class="line"><span class="lineno"> 2487</span> </div>
<div class="line"><span class="lineno"> 2488</span>    <span class="keywordtype">int</span> locNx = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>;</div>
<div class="line"><span class="lineno"> 2489</span>    <span class="keywordtype">int</span> locNy = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>;</div>
<div class="line"><span class="lineno"> 2490</span>    <span class="keywordtype">int</span> locNz = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>;</div>
<div class="line"><span class="lineno"> 2491</span>    inp.read(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;locNx), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><span class="lineno"> 2492</span>    inp.read(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;locNy), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><span class="lineno"> 2493</span>    inp.read(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;locNz), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><span class="lineno"> 2494</span>    <span class="keywordflow">if</span>(locNx != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a> or locNy != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a> or locNz != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>)</div>
<div class="line"><span class="lineno"> 2495</span>    {</div>
<div class="line"><span class="lineno"> 2496</span>        stringstream message;</div>
<div class="line"><span class="lineno"> 2497</span>        message &lt;&lt; <span class="stringliteral">&quot;Inconsistent system dimensions!\n&quot;</span></div>
<div class="line"><span class="lineno"> 2498</span>                &lt;&lt; <span class="stringliteral">&quot;Input data dimensions: (&quot;</span></div>
<div class="line"><span class="lineno"> 2499</span>                &lt;&lt; locNx &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><span class="lineno"> 2500</span>                &lt;&lt; locNy &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><span class="lineno"> 2501</span>                &lt;&lt; locNz &lt;&lt; <span class="stringliteral">&quot;) grid points.\n&quot;</span></div>
<div class="line"><span class="lineno"> 2502</span>                &lt;&lt; <span class="stringliteral">&quot;Required data dimensions: (&quot;</span></div>
<div class="line"><span class="lineno"> 2503</span>                &lt;&lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a> &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><span class="lineno"> 2504</span>                &lt;&lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a> &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><span class="lineno"> 2505</span>                &lt;&lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a> &lt;&lt; <span class="stringliteral">&quot;) grid points.\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 2506</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">ConsoleOutput::WriteWarning</a>(message.str(), <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, <span class="stringliteral">&quot;Read()&quot;</span>);</div>
<div class="line"><span class="lineno"> 2507</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2508</span>    }</div>
<div class="line"><span class="lineno"> 2509</span>    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#af0b28822d6a3aba3df4db780b51db71a">Resolution</a>)</div>
<div class="line"><span class="lineno"> 2510</span>    {</div>
<div class="line"><span class="lineno"> 2511</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e">Resolutions::Single</a>:</div>
<div class="line"><span class="lineno"> 2512</span>        {</div>
<div class="line"><span class="lineno"> 2513</span>            <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a71aed4b94e116454c7b11985a91e49ec">STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>,0)</div>
<div class="line"><span class="lineno"> 2514</span>            {</div>
<div class="line"><span class="lineno"> 2515</span>                <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).read(inp);</div>
<div class="line"><span class="lineno"> 2516</span>            }</div>
<div class="line"><span class="lineno"> 2517</span>            <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a6ad2c83345f230517a1770304d7b39ad">STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 2518</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2519</span>        }</div>
<div class="line"><span class="lineno"> 2520</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>:</div>
<div class="line"><span class="lineno"> 2521</span>        {</div>
<div class="line"><span class="lineno"> 2522</span>            <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a71aed4b94e116454c7b11985a91e49ec">STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>,0)</div>
<div class="line"><span class="lineno"> 2523</span>            {</div>
<div class="line"><span class="lineno"> 2524</span>                <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).read(inp);</div>
<div class="line"><span class="lineno"> 2525</span>            }</div>
<div class="line"><span class="lineno"> 2526</span>            <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a6ad2c83345f230517a1770304d7b39ad">STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 2527</span> </div>
<div class="line"><span class="lineno"> 2528</span>            <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a71aed4b94e116454c7b11985a91e49ec">STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>,0)</div>
<div class="line"><span class="lineno"> 2529</span>            {</div>
<div class="line"><span class="lineno"> 2530</span>                <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).read(inp);</div>
<div class="line"><span class="lineno"> 2531</span>            }</div>
<div class="line"><span class="lineno"> 2532</span>            <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a6ad2c83345f230517a1770304d7b39ad">STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 2533</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2534</span>        }</div>
<div class="line"><span class="lineno"> 2535</span>    }</div>
<div class="line"><span class="lineno"> 2536</span>    inp.close();</div>
<div class="line"><span class="lineno"> 2537</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, <span class="stringliteral">&quot;Binary input loaded&quot;</span>);</div>
<div class="line"><span class="lineno"> 2538</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2539</span>}</div>
<div class="ttc" id="aMacros_8h_html_a6ad2c83345f230517a1770304d7b39ad"><div class="ttname"><a href="../../df/d0a/Macros_8h.html#a6ad2c83345f230517a1770304d7b39ad">STORAGE_LOOP_END</a></div><div class="ttdeci">#define STORAGE_LOOP_END</div><div class="ttdef"><b>Definition</b> <a href="../../df/d0a/Macros_8h_source.html#l00074">Macros.h:74</a></div></div>
<div class="ttc" id="aMacros_8h_html_a71aed4b94e116454c7b11985a91e49ec"><div class="ttname"><a href="../../df/d0a/Macros_8h.html#a71aed4b94e116454c7b11985a91e49ec">STORAGE_LOOP_BEGIN</a></div><div class="ttdeci">#define STORAGE_LOOP_BEGIN(i, j, k, T__, op_loop_bcells__)</div><div class="ttdef"><b>Definition</b> <a href="../../df/d0a/Macros_8h_source.html#l00053">Macros.h:53</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac883490c74b78489443cc705013c5214" name="ac883490c74b78489443cc705013c5214"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac883490c74b78489443cc705013c5214">&#9670;&#160;</a></span>ReadH5()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::PhaseField::ReadH5 </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dc/d89/classopenphase_1_1H5Interface.html">H5Interface</a> &amp;&#160;</td>
          <td class="paramname"><em>H5</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>tStep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read raw data from HDF5 file. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02435">2435</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2436</span>{</div>
<div class="line"><span class="lineno"> 2437</span><span class="preprocessor">    #ifdef H5OP</span></div>
<div class="line"><span class="lineno"> 2438</span>    std::vector&lt;double&gt; dbuffer;</div>
<div class="line"><span class="lineno"> 2439</span>    H5.ReadCheckPoint(tStep, <span class="stringliteral">&quot;PFDomain&quot;</span>, dbuffer);</div>
<div class="line"><span class="lineno"> 2440</span>    <span class="keywordtype">int</span> locNx = dbuffer[0];</div>
<div class="line"><span class="lineno"> 2441</span>    <span class="keywordtype">int</span> locNy = dbuffer[1];</div>
<div class="line"><span class="lineno"> 2442</span>    <span class="keywordtype">int</span> locNz = dbuffer[2];</div>
<div class="line"><span class="lineno"> 2443</span>    dbuffer.clear();</div>
<div class="line"><span class="lineno"> 2444</span>    <span class="keywordflow">if</span>(locNx != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a> or locNy != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a> or locNz != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>)</div>
<div class="line"><span class="lineno"> 2445</span>    {</div>
<div class="line"><span class="lineno"> 2446</span>        stringstream message;</div>
<div class="line"><span class="lineno"> 2447</span>        message &lt;&lt; <span class="stringliteral">&quot;Inconsistent system dimensions!\n&quot;</span></div>
<div class="line"><span class="lineno"> 2448</span>                &lt;&lt; <span class="stringliteral">&quot;Input data dimensions: (&quot;</span> &lt;&lt; locNx &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; locNy &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; locNz &lt;&lt; <span class="stringliteral">&quot;) grid points.\n&quot;</span></div>
<div class="line"><span class="lineno"> 2449</span>                &lt;&lt; <span class="stringliteral">&quot;Required data dimensions: (&quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a> &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a> &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a> &lt;&lt; <span class="stringliteral">&quot;) grid points.\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 2450</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">ConsoleOutput::WriteWarning</a>(message.str(), <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, <span class="stringliteral">&quot;Read()&quot;</span>);</div>
<div class="line"><span class="lineno"> 2451</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2452</span>    }</div>
<div class="line"><span class="lineno"> 2453</span>    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#af0b28822d6a3aba3df4db780b51db71a">Resolution</a>)</div>
<div class="line"><span class="lineno"> 2454</span>    {</div>
<div class="line"><span class="lineno"> 2455</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e">Resolutions::Single</a>:</div>
<div class="line"><span class="lineno"> 2456</span>        {</div>
<div class="line"><span class="lineno"> 2457</span>            H5.ReadCheckPoint(tStep, <span class="stringliteral">&quot;Fields&quot;</span>, dbuffer);</div>
<div class="line"><span class="lineno"> 2458</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>.unpack(dbuffer);</div>
<div class="line"><span class="lineno"> 2459</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2460</span>        }</div>
<div class="line"><span class="lineno"> 2461</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>:</div>
<div class="line"><span class="lineno"> 2462</span>        {</div>
<div class="line"><span class="lineno"> 2463</span>            H5.ReadCheckPoint(tStep, <span class="stringliteral">&quot;FieldsDR&quot;</span>, dbuffer);</div>
<div class="line"><span class="lineno"> 2464</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.unpack(dbuffer);</div>
<div class="line"><span class="lineno"> 2465</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2466</span>        }</div>
<div class="line"><span class="lineno"> 2467</span>    }</div>
<div class="line"><span class="lineno"> 2468</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>.<a class="code hl_function" href="../../d6/d90/classopenphase_1_1GrainsProperties.html#a21a2daf0f3fd32b29259f174f298b36d">ReadH5</a>(tStep,H5);</div>
<div class="line"><span class="lineno"> 2469</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#af8c994d103fffdf2f55db24ab6553cf1">Finalize</a>(BC);</div>
<div class="line"><span class="lineno"> 2470</span><span class="preprocessor">    #else</span></div>
<div class="line"><span class="lineno"> 2471</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">ConsoleOutput::WriteWarning</a>(<span class="stringliteral">&quot;OpenPhase is not compiled with HDF5 support, use: make Settings=\&quot;H5\&quot;&quot;</span>, <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, <span class="stringliteral">&quot;ReadH5()&quot;</span>);</div>
<div class="line"><span class="lineno"> 2472</span>    <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a4d6fed4ab71c6edf2a0bd5dabecc6ec6">OP_Exit</a>(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#ab73d51f3247521914daf0d578fc97a05">EXIT_H5_ERROR</a>);</div>
<div class="line"><span class="lineno"> 2473</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno"> 2474</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2475</span>}</div>
<div class="ttc" id="aclassopenphase_1_1GrainsProperties_html_a21a2daf0f3fd32b29259f174f298b36d"><div class="ttname"><a href="../../d6/d90/classopenphase_1_1GrainsProperties.html#a21a2daf0f3fd32b29259f174f298b36d">openphase::GrainsProperties::ReadH5</a></div><div class="ttdeci">void ReadH5(const long int tStep, H5Interface &amp;H5)</div><div class="ttdef"><b>Definition</b> <a href="../../da/dab/GrainsProperties_8h_source.html#l00929">GrainsProperties.h:929</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_ab73d51f3247521914daf0d578fc97a05"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#ab73d51f3247521914daf0d578fc97a05">openphase::EXIT_H5_ERROR</a></div><div class="ttdeci">static constexpr int EXIT_H5_ERROR</div><div class="ttdoc">OpenPhase not compiled for HDF5 support.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/df1/Globals_8h_source.html#l00113">Globals.h:113</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1a6511943316b1eebb1e5e345fc81588" name="a1a6511943316b1eebb1e5e345fc81588"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a6511943316b1eebb1e5e345fc81588">&#9670;&#160;</a></span>ReadInput() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::ReadInput </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>InputFileName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reads input from the file. </p>

<p>Reimplemented from <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9c766ff0ddd3866b7c2f2f83ebebcf31">openphase::OPObject</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l00075">75</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   76</span>{</div>
<div class="line"><span class="lineno">   77</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3adb3c1b74bf9ac814922b7a8283707e">ConsoleOutput::WriteLineInsert</a>(<span class="stringliteral">&quot;PhaseField input&quot;</span>);</div>
<div class="line"><span class="lineno">   78</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Source&quot;</span>, InputFileName.c_str());</div>
<div class="line"><span class="lineno">   79</span>    std::string filetype = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a09fe0f4b7796b141b23b39a06c854faa">FileInterface::getFileExtension</a>(InputFileName);</div>
<div class="line"><span class="lineno">   80</span>    <span class="keywordflow">if</span> (filetype == <span class="stringliteral">&quot;opi&quot;</span>)</div>
<div class="line"><span class="lineno">   81</span>    {</div>
<div class="line"><span class="lineno">   82</span>        fstream inp(InputFileName.c_str(), ios::in | ios_base::binary);</div>
<div class="line"><span class="lineno">   83</span> </div>
<div class="line"><span class="lineno">   84</span>        <span class="keywordflow">if</span> (!inp)</div>
<div class="line"><span class="lineno">   85</span>        {</div>
<div class="line"><span class="lineno">   86</span>            <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a421faa2fe5d86991328b2b06041a326d">ConsoleOutput::WriteExit</a>(<span class="stringliteral">&quot;File \&quot;&quot;</span> + InputFileName + <span class="stringliteral">&quot;\&quot; could not be opened&quot;</span>, <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, <span class="stringliteral">&quot;ReadInput()&quot;</span>);</div>
<div class="line"><span class="lineno">   87</span>            <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a4d6fed4ab71c6edf2a0bd5dabecc6ec6">OP_Exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno">   88</span>        };</div>
<div class="line"><span class="lineno">   89</span> </div>
<div class="line"><span class="lineno">   90</span>        std::stringstream data;</div>
<div class="line"><span class="lineno">   91</span>        data &lt;&lt; inp.rdbuf();</div>
<div class="line"><span class="lineno">   92</span>        <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a1a6511943316b1eebb1e5e345fc81588">ReadInput</a>(data);</div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span>        inp.close();</div>
<div class="line"><span class="lineno">   95</span>    }</div>
<div class="line"><span class="lineno">   96</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   97</span>    <span class="keywordflow">if</span> (filetype == <span class="stringliteral">&quot;json&quot;</span>)</div>
<div class="line"><span class="lineno">   98</span>    {</div>
<div class="line"><span class="lineno">   99</span>        <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a91e492bc34c35a88697432b6bda3bc95">ReadJSON</a>(InputFileName);</div>
<div class="line"><span class="lineno">  100</span>    }</div>
<div class="line"><span class="lineno">  101</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  102</span>    {</div>
<div class="line"><span class="lineno">  103</span>        std::cerr &lt;&lt; <span class="stringliteral">&quot;Filetype &quot;</span> &lt;&lt; filetype &lt;&lt; <span class="stringliteral">&quot; not recognized. Filetype must be opi or json.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  104</span>        <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a4d6fed4ab71c6edf2a0bd5dabecc6ec6">OP_Exit</a>(1);</div>
<div class="line"><span class="lineno">  105</span>    }</div>
<div class="line"><span class="lineno">  106</span>}</div>
<div class="ttc" id="aclassopenphase_1_1ConsoleOutput_html_a421faa2fe5d86991328b2b06041a326d"><div class="ttname"><a href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a421faa2fe5d86991328b2b06041a326d">openphase::ConsoleOutput::WriteExit</a></div><div class="ttdeci">static void WriteExit(const std::string Message, const std::string Instance=&quot;&quot;, const std::string Method=&quot;&quot;)</div><div class="ttdef"><b>Definition</b> <a href="../../da/da0/ConsoleOutput_8cpp_source.html#l00196">ConsoleOutput.cpp:196</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FileInterface_html_a09fe0f4b7796b141b23b39a06c854faa"><div class="ttname"><a href="../../d2/d61/classopenphase_1_1FileInterface.html#a09fe0f4b7796b141b23b39a06c854faa">openphase::FileInterface::getFileExtension</a></div><div class="ttdeci">static std::string getFileExtension(const std::string &amp;filename)</div><div class="ttdoc">Returns FileExtension or an empty string.</div><div class="ttdef"><b>Definition</b> <a href="../../df/de6/FileInterface_8cpp_source.html#l00099">FileInterface.cpp:99</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a91e492bc34c35a88697432b6bda3bc95"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a91e492bc34c35a88697432b6bda3bc95">openphase::PhaseField::ReadJSON</a></div><div class="ttdeci">void ReadJSON(const std::string InputFileName)</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l00180">PhaseField.cpp:180</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af41d0a9687ce39388b1551b66a2ffe84" name="af41d0a9687ce39388b1551b66a2ffe84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af41d0a9687ce39388b1551b66a2ffe84">&#9670;&#160;</a></span>ReadInput() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::ReadInput </td>
          <td>(</td>
          <td class="paramtype">std::stringstream &amp;&#160;</td>
          <td class="paramname"><em>inp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reads input from the stringstream. </p>

<p>Reimplemented from <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9a7696bf13bb3e6b88a6965937aafdbb">openphase::OPObject</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l00108">108</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  109</span>{</div>
<div class="line"><span class="lineno">  110</span>    <span class="keywordtype">int</span> moduleLocation = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#afbaeccd98923fc3babc30e1e7b3eed62">FileInterface::FindModuleLocation</a>(inp, <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>);</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aae9497091c72d48f9c660f24a4b4749b">ConsiderNucleusVolume</a> = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a1b38acae500f606496f04a55e714731c">FileInterface::ReadParameterB</a>(inp, moduleLocation, <span class="keywordtype">string</span>(<span class="stringliteral">&quot;ConsiderNucleusVolume&quot;</span>), <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  113</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a2f76b712f5418522f474928d17f453ef">NucleusVolumeFactor</a>   = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a8077611f56a17832ac4d22d604df6dcd">FileInterface::ReadParameterD</a>(inp, moduleLocation, <span class="keywordtype">string</span>(<span class="stringliteral">&quot;NucleusVolumeFactor&quot;</span>), <span class="keyword">false</span>, 1.0);</div>
<div class="line"><span class="lineno">  114</span> </div>
<div class="line"><span class="lineno">  115</span>    <span class="comment">// Reading combine phase fields conditions for all phases</span></div>
<div class="line"><span class="lineno">  116</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> pIndex = 0; pIndex &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a>; pIndex++)</div>
<div class="line"><span class="lineno">  117</span>    {</div>
<div class="line"><span class="lineno">  118</span>        stringstream converter;</div>
<div class="line"><span class="lineno">  119</span>        converter &lt;&lt; <span class="stringliteral">&quot;CombinePhaseFields_&quot;</span> &lt;&lt; pIndex;</div>
<div class="line"><span class="lineno">  120</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa63bc774f077e754f035dc1602e80574">Combine</a>[pIndex] = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a1b38acae500f606496f04a55e714731c">FileInterface::ReadParameterB</a>(inp, moduleLocation, converter.str(),<span class="keyword">false</span>,<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  121</span>    }</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span>    <span class="keywordtype">string</span> tmp1 = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a41941afc8143c9cf6a8eddb4f1c94810">FileInterface::ReadParameterK</a>(inp, moduleLocation, <span class="keywordtype">string</span>(<span class="stringliteral">&quot;InterfaceNormalModel&quot;</span>), <span class="keyword">false</span>, <span class="keywordtype">string</span>(<span class="stringliteral">&quot;AVERAGEGRADIENT&quot;</span>));</div>
<div class="line"><span class="lineno">  124</span>    <span class="keywordflow">if</span>(tmp1 == <span class="stringliteral">&quot;AVERAGEGRADIENT&quot;</span>)</div>
<div class="line"><span class="lineno">  125</span>    {</div>
<div class="line"><span class="lineno">  126</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#acff69bbd27278034e9ecce362211ff29">InterfaceNormalModel</a> = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a5148c5d7019baf33d0a115bcb065772ca9babac0e9016d89ccebadf43556eb513">InterfaceNormalModels::AverageGradient</a>;</div>
<div class="line"><span class="lineno">  127</span>    }</div>
<div class="line"><span class="lineno">  128</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(tmp1 == <span class="stringliteral">&quot;WEIGHTEDGRADIENT&quot;</span>)</div>
<div class="line"><span class="lineno">  129</span>    {</div>
<div class="line"><span class="lineno">  130</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#acff69bbd27278034e9ecce362211ff29">InterfaceNormalModel</a> = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a5148c5d7019baf33d0a115bcb065772ca2eef6557154574f8d93facc1f3002cb1">InterfaceNormalModels::WeightedGradient</a>;</div>
<div class="line"><span class="lineno">  131</span>    }</div>
<div class="line"><span class="lineno">  132</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  133</span>    {</div>
<div class="line"><span class="lineno">  134</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">ConsoleOutput::WriteWarning</a>(<span class="stringliteral">&quot;No or wrong interface normal model specified!\nThe default \&quot;AVERAGEGRADIENT\&quot; model is used!&quot;</span>, <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, <span class="stringliteral">&quot;ReadInput()&quot;</span>);</div>
<div class="line"><span class="lineno">  135</span>    }</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>    <span class="keywordtype">string</span> tmp2 = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a41941afc8143c9cf6a8eddb4f1c94810">FileInterface::ReadParameterK</a>(inp, moduleLocation, <span class="keywordtype">string</span>(<span class="stringliteral">&quot;PhaseFieldLaplacianStencil&quot;</span>), <span class="keyword">false</span>, <span class="keywordtype">string</span>(<span class="stringliteral">&quot;ISOTROPIC&quot;</span>));</div>
<div class="line"><span class="lineno">  138</span>    <span class="keywordflow">if</span>(tmp2 == <span class="stringliteral">&quot;SIMPLE&quot;</span>)</div>
<div class="line"><span class="lineno">  139</span>    {</div>
<div class="line"><span class="lineno">  140</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a65cf354fce580b8677302a60babdc3b2">PhaseFieldLaplacianStencil</a> = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#aa3d45caada142bcd6850f4ba4aebc678a1fbb1e3943c2c6c560247ac8f9289780">LaplacianStencils::Simple</a>;</div>
<div class="line"><span class="lineno">  141</span>    }</div>
<div class="line"><span class="lineno">  142</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(tmp2 == <span class="stringliteral">&quot;ISOTROPIC&quot;</span>)</div>
<div class="line"><span class="lineno">  143</span>    {</div>
<div class="line"><span class="lineno">  144</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a65cf354fce580b8677302a60babdc3b2">PhaseFieldLaplacianStencil</a> = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#aa3d45caada142bcd6850f4ba4aebc678a14b5edf8fb82e568afeb4413c67fa479">LaplacianStencils::Isotropic</a>;</div>
<div class="line"><span class="lineno">  145</span>    }</div>
<div class="line"><span class="lineno">  146</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(tmp2 == <span class="stringliteral">&quot;LB&quot;</span>)</div>
<div class="line"><span class="lineno">  147</span>    {</div>
<div class="line"><span class="lineno">  148</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a65cf354fce580b8677302a60babdc3b2">PhaseFieldLaplacianStencil</a> = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#aa3d45caada142bcd6850f4ba4aebc678ac951270e425b15fc20c64da4341c1d89">LaplacianStencils::LB</a>;</div>
<div class="line"><span class="lineno">  149</span>    }</div>
<div class="line"><span class="lineno">  150</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  151</span>    {</div>
<div class="line"><span class="lineno">  152</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">ConsoleOutput::WriteWarning</a>(<span class="stringliteral">&quot;No or wrong Laplaciant stencil specified!\nThe default \&quot;ISOTROPIC\&quot; model is used!&quot;</span>, <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, <span class="stringliteral">&quot;ReadInput()&quot;</span>);</div>
<div class="line"><span class="lineno">  153</span>    }</div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span>    <span class="keywordtype">string</span> tmp3 = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a41941afc8143c9cf6a8eddb4f1c94810">FileInterface::ReadParameterK</a>(inp, moduleLocation, <span class="keywordtype">string</span>(<span class="stringliteral">&quot;PhaseFieldGradientStencil&quot;</span>), <span class="keyword">false</span>, <span class="keywordtype">string</span>(<span class="stringliteral">&quot;ISOTROPIC&quot;</span>));</div>
<div class="line"><span class="lineno">  156</span>    <span class="keywordflow">if</span>(tmp3 == <span class="stringliteral">&quot;SIMPLE&quot;</span>)</div>
<div class="line"><span class="lineno">  157</span>    {</div>
<div class="line"><span class="lineno">  158</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a6d205eece17c945a4b51869b49184e1a">PhaseFieldGradientStencil</a> = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a210cb929dad1ae2aed26a10365a10b3da1fbb1e3943c2c6c560247ac8f9289780">GradientStencils::Simple</a>;</div>
<div class="line"><span class="lineno">  159</span>    }</div>
<div class="line"><span class="lineno">  160</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(tmp3 == <span class="stringliteral">&quot;ISOTROPIC&quot;</span>)</div>
<div class="line"><span class="lineno">  161</span>    {</div>
<div class="line"><span class="lineno">  162</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a6d205eece17c945a4b51869b49184e1a">PhaseFieldGradientStencil</a> = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a210cb929dad1ae2aed26a10365a10b3da14b5edf8fb82e568afeb4413c67fa479">GradientStencils::Isotropic</a>;</div>
<div class="line"><span class="lineno">  163</span>    }</div>
<div class="line"><span class="lineno">  164</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(tmp3 == <span class="stringliteral">&quot;LB&quot;</span>)</div>
<div class="line"><span class="lineno">  165</span>    {</div>
<div class="line"><span class="lineno">  166</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a6d205eece17c945a4b51869b49184e1a">PhaseFieldGradientStencil</a> = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a210cb929dad1ae2aed26a10365a10b3dac951270e425b15fc20c64da4341c1d89">GradientStencils::LB</a>;</div>
<div class="line"><span class="lineno">  167</span>    }</div>
<div class="line"><span class="lineno">  168</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  169</span>    {</div>
<div class="line"><span class="lineno">  170</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">ConsoleOutput::WriteWarning</a>(<span class="stringliteral">&quot;No or wrong gradient stencil specified!\nThe default \&quot;ISOTROPIC\&quot; model is used!&quot;</span>, <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, <span class="stringliteral">&quot;ReadInput()&quot;</span>);</div>
<div class="line"><span class="lineno">  171</span>    }</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a5000dec22fe09492067409dacda3ca59">SetStencils</a>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>);</div>
<div class="line"><span class="lineno">  174</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa160891e608d26b6333bea5b1087b0bf">AllocateStorages</a>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>);</div>
<div class="line"><span class="lineno">  175</span> </div>
<div class="line"><span class="lineno">  176</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ad86f674a75177eed4dd6cd8c06fcba47">ConsoleOutput::WriteLine</a>();</div>
<div class="line"><span class="lineno">  177</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#acf973fcf791b7ed17177550d8a7175e9">ConsoleOutput::WriteBlankLine</a>();</div>
<div class="line"><span class="lineno">  178</span>}</div>
<div class="ttc" id="aclassopenphase_1_1FileInterface_html_a1b38acae500f606496f04a55e714731c"><div class="ttname"><a href="../../d2/d61/classopenphase_1_1FileInterface.html#a1b38acae500f606496f04a55e714731c">openphase::FileInterface::ReadParameterB</a></div><div class="ttdeci">static bool ReadParameterB(const std::stringstream &amp;Inp, int currentLocation, std::string Key, const bool mandatory=true, const bool defaultval=false)</div><div class="ttdef"><b>Definition</b> <a href="../../df/de6/FileInterface_8cpp_source.html#l01316">FileInterface.cpp:1316</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FileInterface_html_a41941afc8143c9cf6a8eddb4f1c94810"><div class="ttname"><a href="../../d2/d61/classopenphase_1_1FileInterface.html#a41941afc8143c9cf6a8eddb4f1c94810">openphase::FileInterface::ReadParameterK</a></div><div class="ttdeci">static std::string ReadParameterK(const std::stringstream &amp;Inp, int currentLocation, const std::string Key, const bool mandatory=true, const std::string defaultval=&quot;NN&quot;)</div><div class="ttdef"><b>Definition</b> <a href="../../df/de6/FileInterface_8cpp_source.html#l01184">FileInterface.cpp:1184</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FileInterface_html_a8077611f56a17832ac4d22d604df6dcd"><div class="ttname"><a href="../../d2/d61/classopenphase_1_1FileInterface.html#a8077611f56a17832ac4d22d604df6dcd">openphase::FileInterface::ReadParameterD</a></div><div class="ttdeci">static double ReadParameterD(const std::stringstream &amp;Inp, int currentLocation, const std::string Key, const bool mandatory=true, const double defaultval=0.0)</div><div class="ttdef"><b>Definition</b> <a href="../../df/de6/FileInterface_8cpp_source.html#l00257">FileInterface.cpp:257</a></div></div>
<div class="ttc" id="aclassopenphase_1_1FileInterface_html_afbaeccd98923fc3babc30e1e7b3eed62"><div class="ttname"><a href="../../d2/d61/classopenphase_1_1FileInterface.html#afbaeccd98923fc3babc30e1e7b3eed62">openphase::FileInterface::FindModuleLocation</a></div><div class="ttdeci">static int FindModuleLocation(const std::stringstream &amp;Inp, const std::string module)</div><div class="ttdef"><b>Definition</b> <a href="../../df/de6/FileInterface_8cpp_source.html#l00129">FileInterface.cpp:129</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a5000dec22fe09492067409dacda3ca59"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a5000dec22fe09492067409dacda3ca59">openphase::PhaseField::SetStencils</a></div><div class="ttdeci">void SetStencils(GridParameters &amp;Grid)</div><div class="ttdoc">Sets gradient and Laplacian stencils.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l00246">PhaseField.cpp:246</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_aa160891e608d26b6333bea5b1087b0bf"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#aa160891e608d26b6333bea5b1087b0bf">openphase::PhaseField::AllocateStorages</a></div><div class="ttdeci">void AllocateStorages(GridParameters &amp;Grid)</div><div class="ttdoc">Allocates internal storages.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l00341">PhaseField.cpp:341</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_a210cb929dad1ae2aed26a10365a10b3da1fbb1e3943c2c6c560247ac8f9289780"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a210cb929dad1ae2aed26a10365a10b3da1fbb1e3943c2c6c560247ac8f9289780">openphase::GradientStencils::Simple</a></div><div class="ttdeci">@ Simple</div></div>
<div class="ttc" id="anamespaceopenphase_html_a210cb929dad1ae2aed26a10365a10b3dac951270e425b15fc20c64da4341c1d89"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a210cb929dad1ae2aed26a10365a10b3dac951270e425b15fc20c64da4341c1d89">openphase::GradientStencils::LB</a></div><div class="ttdeci">@ LB</div><div class="ttdoc">Isotropic stencils based on lattice Boltzmann stencils.</div></div>
<div class="ttc" id="anamespaceopenphase_html_aa3d45caada142bcd6850f4ba4aebc678a1fbb1e3943c2c6c560247ac8f9289780"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#aa3d45caada142bcd6850f4ba4aebc678a1fbb1e3943c2c6c560247ac8f9289780">openphase::LaplacianStencils::Simple</a></div><div class="ttdeci">@ Simple</div></div>
<div class="ttc" id="anamespaceopenphase_html_aa3d45caada142bcd6850f4ba4aebc678ac951270e425b15fc20c64da4341c1d89"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#aa3d45caada142bcd6850f4ba4aebc678ac951270e425b15fc20c64da4341c1d89">openphase::LaplacianStencils::LB</a></div><div class="ttdeci">@ LB</div><div class="ttdoc">Isotropic stencils based on lattice Boltzmann stencils.</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a91e492bc34c35a88697432b6bda3bc95" name="a91e492bc34c35a88697432b6bda3bc95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91e492bc34c35a88697432b6bda3bc95">&#9670;&#160;</a></span>ReadJSON()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::ReadJSON </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>InputFileName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l00180">180</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  181</span>{</div>
<div class="line"><span class="lineno">  182</span>    std::ifstream f(InputFileName);</div>
<div class="line"><span class="lineno">  183</span>    <a class="code hl_typedef" href="../../d0/d6c/namespaceopenphase.html#a4aedb30971859356857f74882a628759">json</a> data = json::parse(f);</div>
<div class="line"><span class="lineno">  184</span>    <span class="keywordflow">if</span> (data.contains(<a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>))</div>
<div class="line"><span class="lineno">  185</span>    {</div>
<div class="line"><span class="lineno">  186</span>        <a class="code hl_typedef" href="../../d0/d6c/namespaceopenphase.html#a4aedb30971859356857f74882a628759">json</a> phasefield = data[<a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>];</div>
<div class="line"><span class="lineno">  187</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aae9497091c72d48f9c660f24a4b4749b">ConsiderNucleusVolume</a> = FileInterface::ReadParameter&lt;bool&gt;(phasefield, {<span class="stringliteral">&quot;ConsiderNucleusVolume&quot;</span>}, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  188</span>        <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a2f76b712f5418522f474928d17f453ef">NucleusVolumeFactor</a>   = FileInterface::ReadParameter&lt;double&gt;(phasefield, {<span class="stringliteral">&quot;NucleusVolumeFactor&quot;</span>}, 1.0);</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>        <span class="keywordtype">string</span> tmp1 = FileInterface::ReadParameter&lt;std::string&gt;(phasefield, {<span class="stringliteral">&quot;InterfaceNormalModel&quot;</span>}, <span class="stringliteral">&quot;AVERAGEGRADIENT&quot;</span>);</div>
<div class="line"><span class="lineno">  191</span>        <span class="keywordflow">if</span>(tmp1 == <span class="stringliteral">&quot;AVERAGEGRADIENT&quot;</span>)</div>
<div class="line"><span class="lineno">  192</span>        {</div>
<div class="line"><span class="lineno">  193</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#acff69bbd27278034e9ecce362211ff29">InterfaceNormalModel</a> = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a5148c5d7019baf33d0a115bcb065772ca9babac0e9016d89ccebadf43556eb513">InterfaceNormalModels::AverageGradient</a>;</div>
<div class="line"><span class="lineno">  194</span>        }</div>
<div class="line"><span class="lineno">  195</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(tmp1 == <span class="stringliteral">&quot;WEIGHTEDGRADIENT&quot;</span>)</div>
<div class="line"><span class="lineno">  196</span>        {</div>
<div class="line"><span class="lineno">  197</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#acff69bbd27278034e9ecce362211ff29">InterfaceNormalModel</a> = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a5148c5d7019baf33d0a115bcb065772ca2eef6557154574f8d93facc1f3002cb1">InterfaceNormalModels::WeightedGradient</a>;</div>
<div class="line"><span class="lineno">  198</span>        }</div>
<div class="line"><span class="lineno">  199</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  200</span>        {</div>
<div class="line"><span class="lineno">  201</span>            <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">ConsoleOutput::WriteWarning</a>(<span class="stringliteral">&quot;No or wrong interface normal model specified!\nThe default \&quot;AVERAGEGRADIENT\&quot; model is used!&quot;</span>, <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, <span class="stringliteral">&quot;ReadJSON()&quot;</span>);</div>
<div class="line"><span class="lineno">  202</span>        }</div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>        <span class="keywordtype">string</span> tmp2 = FileInterface::ReadParameter&lt;std::string&gt;(phasefield, {<span class="stringliteral">&quot;PhaseFieldLaplacianStencil&quot;</span>}, <span class="stringliteral">&quot;ISOTROPIC&quot;</span>);</div>
<div class="line"><span class="lineno">  205</span>        <span class="keywordflow">if</span>(tmp2 == <span class="stringliteral">&quot;SIMPLE&quot;</span>)</div>
<div class="line"><span class="lineno">  206</span>        {</div>
<div class="line"><span class="lineno">  207</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a65cf354fce580b8677302a60babdc3b2">PhaseFieldLaplacianStencil</a> = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#aa3d45caada142bcd6850f4ba4aebc678a1fbb1e3943c2c6c560247ac8f9289780">LaplacianStencils::Simple</a>;</div>
<div class="line"><span class="lineno">  208</span>        }</div>
<div class="line"><span class="lineno">  209</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(tmp2 == <span class="stringliteral">&quot;ISOTROPIC&quot;</span>)</div>
<div class="line"><span class="lineno">  210</span>        {</div>
<div class="line"><span class="lineno">  211</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a65cf354fce580b8677302a60babdc3b2">PhaseFieldLaplacianStencil</a> = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#aa3d45caada142bcd6850f4ba4aebc678a14b5edf8fb82e568afeb4413c67fa479">LaplacianStencils::Isotropic</a>;</div>
<div class="line"><span class="lineno">  212</span>        }</div>
<div class="line"><span class="lineno">  213</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(tmp2 == <span class="stringliteral">&quot;LB&quot;</span>)</div>
<div class="line"><span class="lineno">  214</span>        {</div>
<div class="line"><span class="lineno">  215</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a65cf354fce580b8677302a60babdc3b2">PhaseFieldLaplacianStencil</a> = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#aa3d45caada142bcd6850f4ba4aebc678ac951270e425b15fc20c64da4341c1d89">LaplacianStencils::LB</a>;</div>
<div class="line"><span class="lineno">  216</span>        }</div>
<div class="line"><span class="lineno">  217</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  218</span>        {</div>
<div class="line"><span class="lineno">  219</span>            <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">ConsoleOutput::WriteWarning</a>(<span class="stringliteral">&quot;No or wrong Laplaciant stencil specified!\nThe default \&quot;ISOTROPIC\&quot; model is used!&quot;</span>, <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, <span class="stringliteral">&quot;ReadJSON()&quot;</span>);</div>
<div class="line"><span class="lineno">  220</span>        }</div>
<div class="line"><span class="lineno">  221</span> </div>
<div class="line"><span class="lineno">  222</span>        <span class="keywordtype">string</span> tmp3 = FileInterface::ReadParameter&lt;std::string&gt;(phasefield, {<span class="stringliteral">&quot;PhaseFieldGradientStencil&quot;</span>}, <span class="stringliteral">&quot;ISOTROPIC&quot;</span>);</div>
<div class="line"><span class="lineno">  223</span>        <span class="keywordflow">if</span>(tmp3 == <span class="stringliteral">&quot;SIMPLE&quot;</span>)</div>
<div class="line"><span class="lineno">  224</span>        {</div>
<div class="line"><span class="lineno">  225</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a6d205eece17c945a4b51869b49184e1a">PhaseFieldGradientStencil</a> = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a210cb929dad1ae2aed26a10365a10b3da1fbb1e3943c2c6c560247ac8f9289780">GradientStencils::Simple</a>;</div>
<div class="line"><span class="lineno">  226</span>        }</div>
<div class="line"><span class="lineno">  227</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(tmp3 == <span class="stringliteral">&quot;ISOTROPIC&quot;</span>)</div>
<div class="line"><span class="lineno">  228</span>        {</div>
<div class="line"><span class="lineno">  229</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a6d205eece17c945a4b51869b49184e1a">PhaseFieldGradientStencil</a> = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a210cb929dad1ae2aed26a10365a10b3da14b5edf8fb82e568afeb4413c67fa479">GradientStencils::Isotropic</a>;</div>
<div class="line"><span class="lineno">  230</span>        }</div>
<div class="line"><span class="lineno">  231</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(tmp3 == <span class="stringliteral">&quot;LB&quot;</span>)</div>
<div class="line"><span class="lineno">  232</span>        {</div>
<div class="line"><span class="lineno">  233</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a6d205eece17c945a4b51869b49184e1a">PhaseFieldGradientStencil</a> = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a210cb929dad1ae2aed26a10365a10b3dac951270e425b15fc20c64da4341c1d89">GradientStencils::LB</a>;</div>
<div class="line"><span class="lineno">  234</span>        }</div>
<div class="line"><span class="lineno">  235</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  236</span>        {</div>
<div class="line"><span class="lineno">  237</span>            <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">ConsoleOutput::WriteWarning</a>(<span class="stringliteral">&quot;No or wrong gradient stencil specified!\nThe default \&quot;ISOTROPIC\&quot; model is used!&quot;</span>, <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, <span class="stringliteral">&quot;ReadInput()&quot;</span>);</div>
<div class="line"><span class="lineno">  238</span>        }</div>
<div class="line"><span class="lineno">  239</span>    }</div>
<div class="line"><span class="lineno">  240</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a5000dec22fe09492067409dacda3ca59">SetStencils</a>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>);</div>
<div class="line"><span class="lineno">  241</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa160891e608d26b6333bea5b1087b0bf">AllocateStorages</a>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>);</div>
<div class="line"><span class="lineno">  242</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ad86f674a75177eed4dd6cd8c06fcba47">ConsoleOutput::WriteLine</a>();</div>
<div class="line"><span class="lineno">  243</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#acf973fcf791b7ed17177550d8a7175e9">ConsoleOutput::WriteBlankLine</a>();</div>
<div class="line"><span class="lineno">  244</span>}</div>
<div class="ttc" id="anamespaceopenphase_html_a4aedb30971859356857f74882a628759"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a4aedb30971859356857f74882a628759">openphase::json</a></div><div class="ttdeci">nlohmann::json json</div><div class="ttdef"><b>Definition</b> <a href="../../df/de6/FileInterface_8cpp_source.html#l00034">FileInterface.cpp:34</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a631209c7492c13b5575850ae2a809d5c" name="a631209c7492c13b5575850ae2a809d5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a631209c7492c13b5575850ae2a809d5c">&#9670;&#160;</a></span>Refine()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::Refine </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates double resolution phase-fields from the single resolution ones. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l01145">1145</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1146</span>{</div>
<div class="line"><span class="lineno"> 1147</span>    <span class="keywordtype">long</span> <span class="keywordtype">int</span> fx = 1 + <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>;</div>
<div class="line"><span class="lineno"> 1148</span>    <span class="keywordtype">long</span> <span class="keywordtype">int</span> fy = 1 + <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>;</div>
<div class="line"><span class="lineno"> 1149</span>    <span class="keywordtype">long</span> <span class="keywordtype">int</span> fz = 1 + <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>;</div>
<div class="line"><span class="lineno"> 1150</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>,0,)</div>
<div class="line"><span class="lineno"> 1151</span>    {</div>
<div class="line"><span class="lineno"> 1152</span>        <span class="comment">//if(Fields(i,j,k).flag)</span></div>
<div class="line"><span class="lineno"> 1153</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> di = -<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; di &lt;= <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; di+=2)</div>
<div class="line"><span class="lineno"> 1154</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> dj = -<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; dj &lt;= <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; dj+=2)</div>
<div class="line"><span class="lineno"> 1155</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> dk = -<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; dk &lt;= <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; dk+=2)</div>
<div class="line"><span class="lineno"> 1156</span>        {</div>
<div class="line"><span class="lineno"> 1157</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(fx*i+(di+1)/2,fy*j+(dj+1)/2,fz*k+(dk+1)/2) = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>.at(i+di*0.25,j+dj*0.25,k+dk*0.25);</div>
<div class="line"><span class="lineno"> 1158</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(fx*i+(di+1)/2,fy*j+(dj+1)/2,fz*k+(dk+1)/2).finalize();</div>
<div class="line"><span class="lineno"> 1159</span>        }</div>
<div class="line"><span class="lineno"> 1160</span>    }</div>
<div class="line"><span class="lineno"> 1161</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1162</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0f305e969f2b5970684ccf9f8752a669" name="a0f305e969f2b5970684ccf9f8752a669"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f305e969f2b5970684ccf9f8752a669">&#9670;&#160;</a></span>Remesh()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::Remesh </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>newNx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>newNy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>newNz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Changes the mesh size while keeping the data. </p>

<p>Reimplemented from <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#af421c7d819be4718f586fb3f97c34583">openphase::OPObject</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02886">2886</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2888</span>{</div>
<div class="line"><span class="lineno"> 2889</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_function" href="../../dc/d18/classopenphase_1_1GridParameters.html#a9b5bec6fce00e1d8169690ad16c7563d">SetDimensions</a>(newNx, newNy, newNz);</div>
<div class="line"><span class="lineno"> 2890</span> </div>
<div class="line"><span class="lineno"> 2891</span>    <span class="keywordflow">switch</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#af0b28822d6a3aba3df4db780b51db71a">Resolution</a>)</div>
<div class="line"><span class="lineno"> 2892</span>    {</div>
<div class="line"><span class="lineno"> 2893</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e">Resolutions::Single</a>:</div>
<div class="line"><span class="lineno"> 2894</span>        {</div>
<div class="line"><span class="lineno"> 2895</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>.Remesh(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>);</div>
<div class="line"><span class="lineno"> 2896</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>.Reallocate(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>);</div>
<div class="line"><span class="lineno"> 2897</span> </div>
<div class="line"><span class="lineno"> 2898</span>            <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>,0,)</div>
<div class="line"><span class="lineno"> 2899</span>            {</div>
<div class="line"><span class="lineno"> 2900</span>                <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).flag = 2*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).size() &gt; 1);</div>
<div class="line"><span class="lineno"> 2901</span>            }</div>
<div class="line"><span class="lineno"> 2902</span>            <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 2903</span> </div>
<div class="line"><span class="lineno"> 2904</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a784a4bea9a5379192bdf4f12ab12cf10">Fractions</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#a0d8d0ac8475f544e2e72929d4b9bae12">Reallocate</a>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>);</div>
<div class="line"><span class="lineno"> 2905</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2906</span>        }</div>
<div class="line"><span class="lineno"> 2907</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>:</div>
<div class="line"><span class="lineno"> 2908</span>        {</div>
<div class="line"><span class="lineno"> 2909</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>.Reallocate(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>);</div>
<div class="line"><span class="lineno"> 2910</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>.Reallocate(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>);</div>
<div class="line"><span class="lineno"> 2911</span> </div>
<div class="line"><span class="lineno"> 2912</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.Remesh(2*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, 2*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, 2*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>);</div>
<div class="line"><span class="lineno"> 2913</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>.Reallocate(2*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, 2*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, 2*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>);</div>
<div class="line"><span class="lineno"> 2914</span> </div>
<div class="line"><span class="lineno"> 2915</span>            <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>,0,)</div>
<div class="line"><span class="lineno"> 2916</span>            {</div>
<div class="line"><span class="lineno"> 2917</span>                <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).flag = 2*(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).size() &gt; 1);</div>
<div class="line"><span class="lineno"> 2918</span>            }</div>
<div class="line"><span class="lineno"> 2919</span>            <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 2920</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a784a4bea9a5379192bdf4f12ab12cf10">Fractions</a>.<a class="code hl_function" href="../../da/d19/classopenphase_1_1Storage3D.html#a0d8d0ac8475f544e2e72929d4b9bae12">Reallocate</a>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>);</div>
<div class="line"><span class="lineno"> 2921</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2922</span>        }</div>
<div class="line"><span class="lineno"> 2923</span>    }</div>
<div class="line"><span class="lineno"> 2924</span> </div>
<div class="line"><span class="lineno"> 2925</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#af8c994d103fffdf2f55db24ab6553cf1">Finalize</a>(BC);</div>
<div class="line"><span class="lineno"> 2926</span> </div>
<div class="line"><span class="lineno"> 2927</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, <span class="stringliteral">&quot;Remeshed&quot;</span>);</div>
<div class="line"><span class="lineno"> 2928</span>}</div>
<div class="ttc" id="aclassopenphase_1_1GridParameters_html_a9b5bec6fce00e1d8169690ad16c7563d"><div class="ttname"><a href="../../dc/d18/classopenphase_1_1GridParameters.html#a9b5bec6fce00e1d8169690ad16c7563d">openphase::GridParameters::SetDimensions</a></div><div class="ttdeci">void SetDimensions(int total_nx, int total_ny, int total_nz)</div><div class="ttdoc">Sets grid parameters.</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d43/GridParameters_8cpp_source.html#l00645">GridParameters.cpp:645</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ace9fa222a53d1b1328d682e947267d4e" name="ace9fa222a53d1b1328d682e947267d4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace9fa222a53d1b1328d682e947267d4e">&#9670;&#160;</a></span>SelectiveCombinePhaseFields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::SelectiveCombinePhaseFields </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>TargetPFIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>SourcePFIndex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">BC</td><td>Merge phase fields of sourceIndex to phase field with index targetPhaseIndex </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03186">3186</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3189</span>{</div>
<div class="line"><span class="lineno"> 3190</span>    <span class="keywordflow">switch</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#af0b28822d6a3aba3df4db780b51db71a">Resolution</a>)</div>
<div class="line"><span class="lineno"> 3191</span>    {</div>
<div class="line"><span class="lineno"> 3192</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e">Resolutions::Single</a>:</div>
<div class="line"><span class="lineno"> 3193</span>        {</div>
<div class="line"><span class="lineno"> 3194</span>            <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a5eda15b7ebd1a3025c27cceb9c896c17">SelectiveCombinePhaseFieldsSR</a>(BC,TargetPFIndex,SourcePFIndex);</div>
<div class="line"><span class="lineno"> 3195</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3196</span>        }</div>
<div class="line"><span class="lineno"> 3197</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>:</div>
<div class="line"><span class="lineno"> 3198</span>        {</div>
<div class="line"><span class="lineno"> 3199</span>            <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#aac868ffd9ecfe979e5b0bac89cd85339">SelectiveCombinePhaseFieldsDR</a>(BC,TargetPFIndex,SourcePFIndex);</div>
<div class="line"><span class="lineno"> 3200</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3201</span>        }</div>
<div class="line"><span class="lineno"> 3202</span>    }</div>
<div class="line"><span class="lineno"> 3203</span>}</div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a5eda15b7ebd1a3025c27cceb9c896c17"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a5eda15b7ebd1a3025c27cceb9c896c17">openphase::PhaseField::SelectiveCombinePhaseFieldsSR</a></div><div class="ttdeci">void SelectiveCombinePhaseFieldsSR(const BoundaryConditions &amp;BC, const size_t TargetPFIndex, const size_t SourcePFIndex)</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l03205">PhaseField.cpp:3205</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_aac868ffd9ecfe979e5b0bac89cd85339"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#aac868ffd9ecfe979e5b0bac89cd85339">openphase::PhaseField::SelectiveCombinePhaseFieldsDR</a></div><div class="ttdeci">void SelectiveCombinePhaseFieldsDR(const BoundaryConditions &amp;BC, const size_t TargetPFIndex, const size_t SourcePFIndex)</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l03233">PhaseField.cpp:3233</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aac868ffd9ecfe979e5b0bac89cd85339" name="aac868ffd9ecfe979e5b0bac89cd85339"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac868ffd9ecfe979e5b0bac89cd85339">&#9670;&#160;</a></span>SelectiveCombinePhaseFieldsDR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::SelectiveCombinePhaseFieldsDR </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>TargetPFIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>SourcePFIndex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">BC</td><td>Merge phase fields of sourceIndex to phase field with index targetPhaseIndex </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03233">3233</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3236</span>{</div>
<div class="line"><span class="lineno"> 3237</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.Bcells(),)</div>
<div class="line"><span class="lineno"> 3238</span>    {</div>
<div class="line"><span class="lineno"> 3239</span>        <span class="keywordtype">double</span> loc_value = 0.0;</div>
<div class="line"><span class="lineno"> 3240</span>        <span class="keywordtype">bool</span> ChangedPF = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3241</span> </div>
<div class="line"><span class="lineno"> 3242</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> it  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).begin();</div>
<div class="line"><span class="lineno"> 3243</span>                  it != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).end(); ++it)</div>
<div class="line"><span class="lineno"> 3244</span>        {</div>
<div class="line"><span class="lineno"> 3245</span>            <span class="keywordflow">if</span>(it-&gt;index == SourcePFIndex)</div>
<div class="line"><span class="lineno"> 3246</span>            {</div>
<div class="line"><span class="lineno"> 3247</span>                loc_value += it-&gt;value;</div>
<div class="line"><span class="lineno"> 3248</span>                it-&gt;value = 0.0;</div>
<div class="line"><span class="lineno"> 3249</span>                ChangedPF = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 3250</span>            }</div>
<div class="line"><span class="lineno"> 3251</span>        }</div>
<div class="line"><span class="lineno"> 3252</span>        <span class="keywordflow">if</span>(ChangedPF == <span class="keyword">true</span>)</div>
<div class="line"><span class="lineno"> 3253</span>        {</div>
<div class="line"><span class="lineno"> 3254</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).add_value(TargetPFIndex, loc_value);</div>
<div class="line"><span class="lineno"> 3255</span>        }</div>
<div class="line"><span class="lineno"> 3256</span>    }</div>
<div class="line"><span class="lineno"> 3257</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 3258</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#af8c994d103fffdf2f55db24ab6553cf1">Finalize</a>(BC);</div>
<div class="line"><span class="lineno"> 3259</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5eda15b7ebd1a3025c27cceb9c896c17" name="a5eda15b7ebd1a3025c27cceb9c896c17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5eda15b7ebd1a3025c27cceb9c896c17">&#9670;&#160;</a></span>SelectiveCombinePhaseFieldsSR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::SelectiveCombinePhaseFieldsSR </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>TargetPFIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>SourcePFIndex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">BC</td><td>Merge phase fields of sourceIndex to phase field with index targetPhaseIndex </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03205">3205</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3208</span>{</div>
<div class="line"><span class="lineno"> 3209</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>.Bcells(),)</div>
<div class="line"><span class="lineno"> 3210</span>    {</div>
<div class="line"><span class="lineno"> 3211</span>        <span class="keywordtype">double</span> loc_value = 0.0;</div>
<div class="line"><span class="lineno"> 3212</span>        <span class="keywordtype">bool</span> ChangedPF = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3213</span> </div>
<div class="line"><span class="lineno"> 3214</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> it  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).begin();</div>
<div class="line"><span class="lineno"> 3215</span>                  it != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).end(); ++it)</div>
<div class="line"><span class="lineno"> 3216</span>        {</div>
<div class="line"><span class="lineno"> 3217</span>            <span class="keywordflow">if</span>(it-&gt;index == SourcePFIndex)</div>
<div class="line"><span class="lineno"> 3218</span>            {</div>
<div class="line"><span class="lineno"> 3219</span>                loc_value += it-&gt;value;</div>
<div class="line"><span class="lineno"> 3220</span>                it-&gt;value = 0.0;</div>
<div class="line"><span class="lineno"> 3221</span>                ChangedPF = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 3222</span>            }</div>
<div class="line"><span class="lineno"> 3223</span>        }</div>
<div class="line"><span class="lineno"> 3224</span>        <span class="keywordflow">if</span>(ChangedPF == <span class="keyword">true</span>)</div>
<div class="line"><span class="lineno"> 3225</span>        {</div>
<div class="line"><span class="lineno"> 3226</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).add_value(TargetPFIndex, loc_value);</div>
<div class="line"><span class="lineno"> 3227</span>        }</div>
<div class="line"><span class="lineno"> 3228</span>    }</div>
<div class="line"><span class="lineno"> 3229</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 3230</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#af8c994d103fffdf2f55db24ab6553cf1">Finalize</a>(BC);</div>
<div class="line"><span class="lineno"> 3231</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a825ae7162676d2a690c3e072d0a49581" name="a825ae7162676d2a690c3e072d0a49581"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a825ae7162676d2a690c3e072d0a49581">&#9670;&#160;</a></span>SetBoundaryConditions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::SetBoundaryConditions </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set boundary conditions. </p>

<p>Reimplemented from <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#a098bf706cf87cf06361ec9bca1c7d32c">openphase::OPObject</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02074">2074</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2075</span>{</div>
<div class="line"><span class="lineno"> 2076</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#af0b28822d6a3aba3df4db780b51db71a">Resolution</a> == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>)</div>
<div class="line"><span class="lineno"> 2077</span>    {</div>
<div class="line"><span class="lineno"> 2078</span>        <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a42e3e7cdc1c94edd6e7a4cc8ca90c93a">SetBoundaryConditionsDR</a>(BC);</div>
<div class="line"><span class="lineno"> 2079</span>    }</div>
<div class="line"><span class="lineno"> 2080</span>    <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a506595d6236a96859a36b19bc7fbd165">SetBoundaryConditionsSR</a>(BC);</div>
<div class="line"><span class="lineno"> 2081</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a42e3e7cdc1c94edd6e7a4cc8ca90c93a" name="a42e3e7cdc1c94edd6e7a4cc8ca90c93a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42e3e7cdc1c94edd6e7a4cc8ca90c93a">&#9670;&#160;</a></span>SetBoundaryConditionsDR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::SetBoundaryConditionsDR </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set boundary conditions in double resolution case. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02090">2090</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2091</span>{</div>
<div class="line"><span class="lineno"> 2092</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>) BC.SetX(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>);</div>
<div class="line"><span class="lineno"> 2093</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>) BC.SetY(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>);</div>
<div class="line"><span class="lineno"> 2094</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>) BC.SetZ(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>);</div>
<div class="line"><span class="lineno"> 2095</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a506595d6236a96859a36b19bc7fbd165" name="a506595d6236a96859a36b19bc7fbd165"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a506595d6236a96859a36b19bc7fbd165">&#9670;&#160;</a></span>SetBoundaryConditionsSR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::SetBoundaryConditionsSR </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set boundary conditions in single resolution case. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02083">2083</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2084</span>{</div>
<div class="line"><span class="lineno"> 2085</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>) BC.SetX(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>);</div>
<div class="line"><span class="lineno"> 2086</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>) BC.SetY(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>);</div>
<div class="line"><span class="lineno"> 2087</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>) BC.SetZ(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>);</div>
<div class="line"><span class="lineno"> 2088</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6351df75321c5be52c45de4df6b0d9b9" name="a6351df75321c5be52c45de4df6b0d9b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6351df75321c5be52c45de4df6b0d9b9">&#9670;&#160;</a></span>SetFlagsDR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::SetFlagsDR </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets the flags which mark interfaces in double resolution case. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l00971">971</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  972</span>{</div>
<div class="line"><span class="lineno">  973</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i, j, k, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.Bcells()-1,)</div>
<div class="line"><span class="lineno">  974</span>    {</div>
<div class="line"><span class="lineno">  975</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).flag == 2)</div>
<div class="line"><span class="lineno">  976</span>        {</div>
<div class="line"><span class="lineno">  977</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ii = -<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii &lt;= +<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ++ii)</div>
<div class="line"><span class="lineno">  978</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= +<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; ++jj)</div>
<div class="line"><span class="lineno">  979</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= +<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; ++kk)</div>
<div class="line"><span class="lineno">  980</span>            <span class="keywordflow">if</span>(!(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i+ii, j+jj, k+kk).flag))</div>
<div class="line"><span class="lineno">  981</span>            {</div>
<div class="line"><span class="lineno">  982</span>                <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i+ii, j+jj, k+kk).flag = 1;</div>
<div class="line"><span class="lineno">  983</span>            }</div>
<div class="line"><span class="lineno">  984</span>        }</div>
<div class="line"><span class="lineno">  985</span>    }</div>
<div class="line"><span class="lineno">  986</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  987</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af5cc5b72dd043ea82b19b8fd59956e07" name="af5cc5b72dd043ea82b19b8fd59956e07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5cc5b72dd043ea82b19b8fd59956e07">&#9670;&#160;</a></span>SetFlagsSR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::SetFlagsSR </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets the flags which mark interfaces. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l00953">953</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  954</span>{</div>
<div class="line"><span class="lineno">  955</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i, j, k, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>.Bcells()-1,)</div>
<div class="line"><span class="lineno">  956</span>    {</div>
<div class="line"><span class="lineno">  957</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).flag == 2)</div>
<div class="line"><span class="lineno">  958</span>        {</div>
<div class="line"><span class="lineno">  959</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ii = -<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii &lt;= +<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ++ii)</div>
<div class="line"><span class="lineno">  960</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= +<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; ++jj)</div>
<div class="line"><span class="lineno">  961</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= +<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; ++kk)</div>
<div class="line"><span class="lineno">  962</span>            <span class="keywordflow">if</span>(!(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i+ii, j+jj, k+kk).flag))</div>
<div class="line"><span class="lineno">  963</span>            {</div>
<div class="line"><span class="lineno">  964</span>                <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i+ii, j+jj, k+kk).flag = 1;</div>
<div class="line"><span class="lineno">  965</span>            }</div>
<div class="line"><span class="lineno">  966</span>        }</div>
<div class="line"><span class="lineno">  967</span>    }</div>
<div class="line"><span class="lineno">  968</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  969</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab672f946e05f95f825cba15304bbbdf5" name="ab672f946e05f95f825cba15304bbbdf5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab672f946e05f95f825cba15304bbbdf5">&#9670;&#160;</a></span>SetIncrementsBoundaryConditionsDR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::SetIncrementsBoundaryConditionsDR </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set boundary conditions for phase field increments in double resolution case. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02104">2104</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2105</span>{</div>
<div class="line"><span class="lineno"> 2106</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>) BC.SetX(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>);</div>
<div class="line"><span class="lineno"> 2107</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>) BC.SetY(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>);</div>
<div class="line"><span class="lineno"> 2108</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>) BC.SetZ(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a751e2803a23026fbb7e4b0b2c7673391">FieldsDotDR</a>);</div>
<div class="line"><span class="lineno"> 2109</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ade001d95d4f0e391ffd5874a821f0966" name="ade001d95d4f0e391ffd5874a821f0966"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade001d95d4f0e391ffd5874a821f0966">&#9670;&#160;</a></span>SetIncrementsBoundaryConditionsSR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::SetIncrementsBoundaryConditionsSR </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set boundary conditions for phase field increments. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02097">2097</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2098</span>{</div>
<div class="line"><span class="lineno"> 2099</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>) BC.SetX(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>);</div>
<div class="line"><span class="lineno"> 2100</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>) BC.SetY(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>);</div>
<div class="line"><span class="lineno"> 2101</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>) BC.SetZ(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a3562565ae829ac5ed575324eb92ce1e8">FieldsDot</a>);</div>
<div class="line"><span class="lineno"> 2102</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5000dec22fe09492067409dacda3ca59" name="a5000dec22fe09492067409dacda3ca59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5000dec22fe09492067409dacda3ca59">&#9670;&#160;</a></span>SetStencils()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::SetStencils </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/d18/classopenphase_1_1GridParameters.html">GridParameters</a> &amp;&#160;</td>
          <td class="paramname"><em>Grid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets gradient and Laplacian stencils. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l00246">246</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  247</span>{</div>
<div class="line"><span class="lineno">  248</span>    <span class="keywordflow">switch</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_function" href="../../dc/d18/classopenphase_1_1GridParameters.html#a70ddf5c25482d7cdefe67b0d25dcd258">Active</a>())</div>
<div class="line"><span class="lineno">  249</span>    {</div>
<div class="line"><span class="lineno">  250</span>        <span class="keywordflow">case</span> 1:</div>
<div class="line"><span class="lineno">  251</span>        {</div>
<div class="line"><span class="lineno">  252</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a4099b0db42d5fcbf908eafe2a338032e">LStencil</a>.<a class="code hl_function" href="../../d8/d86/classopenphase_1_1LaplacianStencil.html#ae5572e5f44eea0fed126bdb8d989fca5">Set</a>(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#aff0dfd649e34e327e58a579508e460ab">LaplacianStencil1D_3</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>);</div>
<div class="line"><span class="lineno">  253</span>            <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a1f560b94dd8685e5f84363d403c5d495">GStencil</a>.<a class="code hl_function" href="../../d0/da4/classopenphase_1_1GradientStencil.html#a598ed8dfc1ea37ded90f3369a12ebed6">Set</a>(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a233bf0b59ed70dabae55d22f2f3000d3">GradientStencil1D</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>);</div>
<div class="line"><span class="lineno">  254</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  255</span>        }</div>
<div class="line"><span class="lineno">  256</span>        <span class="keywordflow">case</span> 2:</div>
<div class="line"><span class="lineno">  257</span>        {</div>
<div class="line"><span class="lineno">  258</span>            <span class="keywordflow">switch</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a65cf354fce580b8677302a60babdc3b2">PhaseFieldLaplacianStencil</a>)</div>
<div class="line"><span class="lineno">  259</span>            {</div>
<div class="line"><span class="lineno">  260</span>                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#aa3d45caada142bcd6850f4ba4aebc678a1fbb1e3943c2c6c560247ac8f9289780">LaplacianStencils::Simple</a>:</div>
<div class="line"><span class="lineno">  261</span>                {</div>
<div class="line"><span class="lineno">  262</span>                    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a4099b0db42d5fcbf908eafe2a338032e">LStencil</a>.<a class="code hl_function" href="../../d8/d86/classopenphase_1_1LaplacianStencil.html#ae5572e5f44eea0fed126bdb8d989fca5">Set</a>(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#af3af6ff69cf9c246ebc2675c476c2e79">LaplacianStencil2D_5</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>);</div>
<div class="line"><span class="lineno">  263</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  264</span>                }</div>
<div class="line"><span class="lineno">  265</span>                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#aa3d45caada142bcd6850f4ba4aebc678a14b5edf8fb82e568afeb4413c67fa479">LaplacianStencils::Isotropic</a>:</div>
<div class="line"><span class="lineno">  266</span>                {</div>
<div class="line"><span class="lineno">  267</span>                    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a4099b0db42d5fcbf908eafe2a338032e">LStencil</a>.<a class="code hl_function" href="../../d8/d86/classopenphase_1_1LaplacianStencil.html#ae5572e5f44eea0fed126bdb8d989fca5">Set</a>(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a5e84fe2bf9a1db8d3c3097eaeb96ac93">LaplacianStencil2D_9</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>);</div>
<div class="line"><span class="lineno">  268</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  269</span>                }</div>
<div class="line"><span class="lineno">  270</span>                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#aa3d45caada142bcd6850f4ba4aebc678ac951270e425b15fc20c64da4341c1d89">LaplacianStencils::LB</a>:</div>
<div class="line"><span class="lineno">  271</span>                {</div>
<div class="line"><span class="lineno">  272</span>                    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a4099b0db42d5fcbf908eafe2a338032e">LStencil</a>.<a class="code hl_function" href="../../d8/d86/classopenphase_1_1LaplacianStencil.html#ae5572e5f44eea0fed126bdb8d989fca5">Set</a>(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a217c129057157117a80210335f65cd40">LaplacianStencil2D_LB</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>);</div>
<div class="line"><span class="lineno">  273</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  274</span>                }</div>
<div class="line"><span class="lineno">  275</span>            }</div>
<div class="line"><span class="lineno">  276</span> </div>
<div class="line"><span class="lineno">  277</span>            <span class="keywordflow">switch</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a6d205eece17c945a4b51869b49184e1a">PhaseFieldGradientStencil</a>)</div>
<div class="line"><span class="lineno">  278</span>            {</div>
<div class="line"><span class="lineno">  279</span>                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a210cb929dad1ae2aed26a10365a10b3da1fbb1e3943c2c6c560247ac8f9289780">GradientStencils::Simple</a>:</div>
<div class="line"><span class="lineno">  280</span>                {</div>
<div class="line"><span class="lineno">  281</span>                    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a1f560b94dd8685e5f84363d403c5d495">GStencil</a>.<a class="code hl_function" href="../../d0/da4/classopenphase_1_1GradientStencil.html#a598ed8dfc1ea37ded90f3369a12ebed6">Set</a>(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a233bf0b59ed70dabae55d22f2f3000d3">GradientStencil1D</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>);</div>
<div class="line"><span class="lineno">  282</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  283</span>                }</div>
<div class="line"><span class="lineno">  284</span>                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a210cb929dad1ae2aed26a10365a10b3da14b5edf8fb82e568afeb4413c67fa479">GradientStencils::Isotropic</a>:</div>
<div class="line"><span class="lineno">  285</span>                {</div>
<div class="line"><span class="lineno">  286</span>                    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a1f560b94dd8685e5f84363d403c5d495">GStencil</a>.<a class="code hl_function" href="../../d0/da4/classopenphase_1_1GradientStencil.html#a598ed8dfc1ea37ded90f3369a12ebed6">Set</a>(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#afc05c891699c92f45267517c97ee2f67">GradientStencil2D</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>);</div>
<div class="line"><span class="lineno">  287</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  288</span>                }</div>
<div class="line"><span class="lineno">  289</span>                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a210cb929dad1ae2aed26a10365a10b3dac951270e425b15fc20c64da4341c1d89">GradientStencils::LB</a>:</div>
<div class="line"><span class="lineno">  290</span>                {</div>
<div class="line"><span class="lineno">  291</span>                    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a1f560b94dd8685e5f84363d403c5d495">GStencil</a>.<a class="code hl_function" href="../../d0/da4/classopenphase_1_1GradientStencil.html#a598ed8dfc1ea37ded90f3369a12ebed6">Set</a>(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a4f42772687633856a388e88728151104">GradientStencil2D_LB</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>);</div>
<div class="line"><span class="lineno">  292</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  293</span>                }</div>
<div class="line"><span class="lineno">  294</span>            }</div>
<div class="line"><span class="lineno">  295</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  296</span>        }</div>
<div class="line"><span class="lineno">  297</span>        <span class="keywordflow">case</span> 3:</div>
<div class="line"><span class="lineno">  298</span>        {</div>
<div class="line"><span class="lineno">  299</span>            <span class="keywordflow">switch</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a65cf354fce580b8677302a60babdc3b2">PhaseFieldLaplacianStencil</a>)</div>
<div class="line"><span class="lineno">  300</span>            {</div>
<div class="line"><span class="lineno">  301</span>                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#aa3d45caada142bcd6850f4ba4aebc678a1fbb1e3943c2c6c560247ac8f9289780">LaplacianStencils::Simple</a>:</div>
<div class="line"><span class="lineno">  302</span>                {</div>
<div class="line"><span class="lineno">  303</span>                    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a4099b0db42d5fcbf908eafe2a338032e">LStencil</a>.<a class="code hl_function" href="../../d8/d86/classopenphase_1_1LaplacianStencil.html#ae5572e5f44eea0fed126bdb8d989fca5">Set</a>(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#aa416f6e5b160652c2f48a0e39b4ab18f">LaplacianStencil3D_7</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>);</div>
<div class="line"><span class="lineno">  304</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  305</span>                }</div>
<div class="line"><span class="lineno">  306</span>                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#aa3d45caada142bcd6850f4ba4aebc678a14b5edf8fb82e568afeb4413c67fa479">LaplacianStencils::Isotropic</a>:</div>
<div class="line"><span class="lineno">  307</span>                {</div>
<div class="line"><span class="lineno">  308</span>                    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a4099b0db42d5fcbf908eafe2a338032e">LStencil</a>.<a class="code hl_function" href="../../d8/d86/classopenphase_1_1LaplacianStencil.html#ae5572e5f44eea0fed126bdb8d989fca5">Set</a>(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a308506fb01f248e342986c5b57ad1f88">LaplacianStencil3D_27a</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>);</div>
<div class="line"><span class="lineno">  309</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  310</span>                }</div>
<div class="line"><span class="lineno">  311</span>                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#aa3d45caada142bcd6850f4ba4aebc678ac951270e425b15fc20c64da4341c1d89">LaplacianStencils::LB</a>:</div>
<div class="line"><span class="lineno">  312</span>                {</div>
<div class="line"><span class="lineno">  313</span>                    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a4099b0db42d5fcbf908eafe2a338032e">LStencil</a>.<a class="code hl_function" href="../../d8/d86/classopenphase_1_1LaplacianStencil.html#ae5572e5f44eea0fed126bdb8d989fca5">Set</a>(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a77849d05295872430a055a1d1731370f">LaplacianStencil3D_LB</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>);</div>
<div class="line"><span class="lineno">  314</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  315</span>                }</div>
<div class="line"><span class="lineno">  316</span>            }</div>
<div class="line"><span class="lineno">  317</span> </div>
<div class="line"><span class="lineno">  318</span>            <span class="keywordflow">switch</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a6d205eece17c945a4b51869b49184e1a">PhaseFieldGradientStencil</a>)</div>
<div class="line"><span class="lineno">  319</span>            {</div>
<div class="line"><span class="lineno">  320</span>                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a210cb929dad1ae2aed26a10365a10b3da1fbb1e3943c2c6c560247ac8f9289780">GradientStencils::Simple</a>:</div>
<div class="line"><span class="lineno">  321</span>                {</div>
<div class="line"><span class="lineno">  322</span>                    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a1f560b94dd8685e5f84363d403c5d495">GStencil</a>.<a class="code hl_function" href="../../d0/da4/classopenphase_1_1GradientStencil.html#a598ed8dfc1ea37ded90f3369a12ebed6">Set</a>(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a233bf0b59ed70dabae55d22f2f3000d3">GradientStencil1D</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>);</div>
<div class="line"><span class="lineno">  323</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  324</span>                }</div>
<div class="line"><span class="lineno">  325</span>                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a210cb929dad1ae2aed26a10365a10b3da14b5edf8fb82e568afeb4413c67fa479">GradientStencils::Isotropic</a>:</div>
<div class="line"><span class="lineno">  326</span>                {</div>
<div class="line"><span class="lineno">  327</span>                    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a1f560b94dd8685e5f84363d403c5d495">GStencil</a>.<a class="code hl_function" href="../../d0/da4/classopenphase_1_1GradientStencil.html#a598ed8dfc1ea37ded90f3369a12ebed6">Set</a>(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a97f05eb021959e8a5f9242f07f646b78">GradientStencil3D</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>);</div>
<div class="line"><span class="lineno">  328</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  329</span>                }</div>
<div class="line"><span class="lineno">  330</span>                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a210cb929dad1ae2aed26a10365a10b3dac951270e425b15fc20c64da4341c1d89">GradientStencils::LB</a>:</div>
<div class="line"><span class="lineno">  331</span>                {</div>
<div class="line"><span class="lineno">  332</span>                    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a1f560b94dd8685e5f84363d403c5d495">GStencil</a>.<a class="code hl_function" href="../../d0/da4/classopenphase_1_1GradientStencil.html#a598ed8dfc1ea37ded90f3369a12ebed6">Set</a>(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#aa3a7ef9cfde2a6446109e34bea555795">GradientStencil3D_LB</a>, <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>);</div>
<div class="line"><span class="lineno">  333</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  334</span>                }</div>
<div class="line"><span class="lineno">  335</span>            }</div>
<div class="line"><span class="lineno">  336</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  337</span>        }</div>
<div class="line"><span class="lineno">  338</span>    }</div>
<div class="line"><span class="lineno">  339</span>}</div>
<div class="ttc" id="aclassopenphase_1_1GradientStencil_html_a598ed8dfc1ea37ded90f3369a12ebed6"><div class="ttname"><a href="../../d0/da4/classopenphase_1_1GradientStencil.html#a598ed8dfc1ea37ded90f3369a12ebed6">openphase::GradientStencil::Set</a></div><div class="ttdeci">void Set(const double UserStencil[3][3][3], double dx, int dNx=1, int dNy=1, int dNz=1)</div><div class="ttdef"><b>Definition</b> <a href="../../df/d3e/GradientStencil_8h_source.html#l00132">GradientStencil.h:132</a></div></div>
<div class="ttc" id="aclassopenphase_1_1LaplacianStencil_html_ae5572e5f44eea0fed126bdb8d989fca5"><div class="ttname"><a href="../../d8/d86/classopenphase_1_1LaplacianStencil.html#ae5572e5f44eea0fed126bdb8d989fca5">openphase::LaplacianStencil::Set</a></div><div class="ttdeci">void Set(const double UserStencil[3][3][3], double dx, int dNx=1, int dNy=1, int dNz=1)</div><div class="ttdef"><b>Definition</b> <a href="../../df/da2/LaplacianStencil_8h_source.html#l00197">LaplacianStencil.h:197</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_a217c129057157117a80210335f65cd40"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a217c129057157117a80210335f65cd40">openphase::LaplacianStencil2D_LB</a></div><div class="ttdeci">const double LaplacianStencil2D_LB[3][3][3]</div><div class="ttdoc">Laplacian stencils based on lattice Boltzmann stencils.</div><div class="ttdef"><b>Definition</b> <a href="../../df/da2/LaplacianStencil_8h_source.html#l00134">LaplacianStencil.h:134</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_a233bf0b59ed70dabae55d22f2f3000d3"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a233bf0b59ed70dabae55d22f2f3000d3">openphase::GradientStencil1D</a></div><div class="ttdeci">const double GradientStencil1D[3][3][3]</div><div class="ttdoc">2 point simple 1D/2D/3D Gradient stencil (standard finite differences)</div><div class="ttdef"><b>Definition</b> <a href="../../df/d3e/GradientStencil_8h_source.html#l00046">GradientStencil.h:46</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_a308506fb01f248e342986c5b57ad1f88"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a308506fb01f248e342986c5b57ad1f88">openphase::LaplacianStencil3D_27a</a></div><div class="ttdeci">const double LaplacianStencil3D_27a[3][3][3]</div><div class="ttdoc">27 point 3D Laplacian stencil by Spotz and Carey (1995)</div><div class="ttdef"><b>Definition</b> <a href="../../df/da2/LaplacianStencil_8h_source.html#l00109">LaplacianStencil.h:109</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_a4f42772687633856a388e88728151104"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a4f42772687633856a388e88728151104">openphase::GradientStencil2D_LB</a></div><div class="ttdeci">const double GradientStencil2D_LB[3][3][3]</div><div class="ttdoc">Gradient stencils based on lattice Boltzmann stencils.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d3e/GradientStencil_8h_source.html#l00096">GradientStencil.h:96</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_a5e84fe2bf9a1db8d3c3097eaeb96ac93"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a5e84fe2bf9a1db8d3c3097eaeb96ac93">openphase::LaplacianStencil2D_9</a></div><div class="ttdeci">const double LaplacianStencil2D_9[3][3][3]</div><div class="ttdoc">Isotropic Laplacian stencils.</div><div class="ttdef"><b>Definition</b> <a href="../../df/da2/LaplacianStencil_8h_source.html#l00085">LaplacianStencil.h:85</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_a77849d05295872430a055a1d1731370f"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a77849d05295872430a055a1d1731370f">openphase::LaplacianStencil3D_LB</a></div><div class="ttdeci">const double LaplacianStencil3D_LB[3][3][3]</div><div class="ttdoc">Laplacian stencil based on D3Q27 lattice Boltzmann stencil.</div><div class="ttdef"><b>Definition</b> <a href="../../df/da2/LaplacianStencil_8h_source.html#l00146">LaplacianStencil.h:146</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_a97f05eb021959e8a5f9242f07f646b78"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a97f05eb021959e8a5f9242f07f646b78">openphase::GradientStencil3D</a></div><div class="ttdeci">const double GradientStencil3D[3][3][3]</div><div class="ttdoc">27 point 3D Gradient stencil from &quot;M.Alfaraj, Y. Wang and Y. Luo, Geophysical prospecting 62 (2014) 5...</div><div class="ttdef"><b>Definition</b> <a href="../../df/d3e/GradientStencil_8h_source.html#l00082">GradientStencil.h:82</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_aa3a7ef9cfde2a6446109e34bea555795"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#aa3a7ef9cfde2a6446109e34bea555795">openphase::GradientStencil3D_LB</a></div><div class="ttdeci">const double GradientStencil3D_LB[3][3][3]</div><div class="ttdoc">Isotropic gradient stencil based on D3Q27 lattice Boltzmann stencil. It is very close to the 27 point...</div><div class="ttdef"><b>Definition</b> <a href="../../df/d3e/GradientStencil_8h_source.html#l00108">GradientStencil.h:108</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_aa416f6e5b160652c2f48a0e39b4ab18f"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#aa416f6e5b160652c2f48a0e39b4ab18f">openphase::LaplacianStencil3D_7</a></div><div class="ttdeci">const double LaplacianStencil3D_7[3][3][3]</div><div class="ttdoc">7 point simple 3D Laplacian stencil</div><div class="ttdef"><b>Definition</b> <a href="../../df/da2/LaplacianStencil_8h_source.html#l00072">LaplacianStencil.h:72</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_af3af6ff69cf9c246ebc2675c476c2e79"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#af3af6ff69cf9c246ebc2675c476c2e79">openphase::LaplacianStencil2D_5</a></div><div class="ttdeci">const double LaplacianStencil2D_5[3][3][3]</div><div class="ttdoc">5 point simple 2D Laplacian stencil</div><div class="ttdef"><b>Definition</b> <a href="../../df/da2/LaplacianStencil_8h_source.html#l00060">LaplacianStencil.h:60</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_afc05c891699c92f45267517c97ee2f67"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#afc05c891699c92f45267517c97ee2f67">openphase::GradientStencil2D</a></div><div class="ttdeci">const double GradientStencil2D[3][3][3]</div><div class="ttdoc">8 point 2D Gradient stencil from &quot;M.Alfaraj, Y. Wang and Y. Luo, Geophysical prospecting 62 (2014) 50...</div><div class="ttdef"><b>Definition</b> <a href="../../df/d3e/GradientStencil_8h_source.html#l00058">GradientStencil.h:58</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_aff0dfd649e34e327e58a579508e460ab"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#aff0dfd649e34e327e58a579508e460ab">openphase::LaplacianStencil1D_3</a></div><div class="ttdeci">const double LaplacianStencil1D_3[3][3][3]</div><div class="ttdoc">Standard Laplacian stencils.</div><div class="ttdef"><b>Definition</b> <a href="../../df/da2/LaplacianStencil_8h_source.html#l00048">LaplacianStencil.h:48</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a007421c86ce87f496fa4658e62d1f777" name="a007421c86ce87f496fa4658e62d1f777"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a007421c86ce87f496fa4658e62d1f777">&#9670;&#160;</a></span>SolidMassDensity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::PhaseField::SolidMassDensity </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns local solid mass density. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03870">3870</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3871</span>{</div>
<div class="line"><span class="lineno"> 3872</span>    <span class="keywordtype">double</span> <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a007421c86ce87f496fa4658e62d1f777">SolidMassDensity</a> = 0.0;</div>
<div class="line"><span class="lineno"> 3873</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> alpha = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cbegin(); alpha != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cend(); alpha++)</div>
<div class="line"><span class="lineno"> 3874</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[alpha-&gt;index].is_solid())</div>
<div class="line"><span class="lineno"> 3875</span>    {</div>
<div class="line"><span class="lineno"> 3876</span>        <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a007421c86ce87f496fa4658e62d1f777">SolidMassDensity</a> += alpha-&gt;value*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[alpha-&gt;value].Density;</div>
<div class="line"><span class="lineno"> 3877</span>    }</div>
<div class="line"><span class="lineno"> 3878</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a007421c86ce87f496fa4658e62d1f777">SolidMassDensity</a>;</div>
<div class="line"><span class="lineno"> 3879</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a318deca1c64d3fd7dc3106f71c734ef7" name="a318deca1c64d3fd7dc3106f71c734ef7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a318deca1c64d3fd7dc3106f71c734ef7">&#9670;&#160;</a></span>SolidPhaseFraction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::PhaseField::SolidPhaseFraction </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns local solid phase fraction. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03857">3857</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3858</span>{</div>
<div class="line"><span class="lineno"> 3859</span>    <span class="keywordtype">double</span> <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a318deca1c64d3fd7dc3106f71c734ef7">SolidPhaseFraction</a> = 0.0;</div>
<div class="line"><span class="lineno"> 3860</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> alpha = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cbegin(); alpha != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cend(); alpha++)</div>
<div class="line"><span class="lineno"> 3861</span>    {</div>
<div class="line"><span class="lineno"> 3862</span>       <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[alpha-&gt;index].is_solid())</div>
<div class="line"><span class="lineno"> 3863</span>       {</div>
<div class="line"><span class="lineno"> 3864</span>           <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a318deca1c64d3fd7dc3106f71c734ef7">SolidPhaseFraction</a> += alpha-&gt;value;</div>
<div class="line"><span class="lineno"> 3865</span>       }</div>
<div class="line"><span class="lineno"> 3866</span>    }</div>
<div class="line"><span class="lineno"> 3867</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a318deca1c64d3fd7dc3106f71c734ef7">SolidPhaseFraction</a>;</div>
<div class="line"><span class="lineno"> 3868</span>}</div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a318deca1c64d3fd7dc3106f71c734ef7"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a318deca1c64d3fd7dc3106f71c734ef7">openphase::PhaseField::SolidPhaseFraction</a></div><div class="ttdeci">double SolidPhaseFraction(const int i, const int j, const int k) const</div><div class="ttdoc">Returns local solid phase fraction.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l03857">PhaseField.cpp:3857</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab6aade89dfd19d9728488fbac901e12f" name="ab6aade89dfd19d9728488fbac901e12f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6aade89dfd19d9728488fbac901e12f">&#9670;&#160;</a></span>ThermodynamicPhasePairPresent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::PhaseField::ThermodynamicPhasePairPresent </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03495">3495</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3496</span>{</div>
<div class="line"><span class="lineno"> 3497</span>    <span class="keywordtype">bool</span> result = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3498</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(x,y,z,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>,0,reduction(or:result))</div>
<div class="line"><span class="lineno"> 3499</span>    if (<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(x,y,z).interface())</div>
<div class="line"><span class="lineno"> 3500</span>    {</div>
<div class="line"><span class="lineno"> 3501</span>        <span class="keywordtype">bool</span> alphapresent = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3502</span>        <span class="keywordtype">bool</span> betapresent  = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3503</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> it  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(x,y,z).cbegin();</div>
<div class="line"><span class="lineno"> 3504</span>                  it != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(x,y,z).cend(); ++it)</div>
<div class="line"><span class="lineno"> 3505</span>        {</div>
<div class="line"><span class="lineno"> 3506</span>            <span class="keywordflow">if</span>(it-&gt;index == alpha)</div>
<div class="line"><span class="lineno"> 3507</span>            {</div>
<div class="line"><span class="lineno"> 3508</span>                alphapresent = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 3509</span>            }</div>
<div class="line"><span class="lineno"> 3510</span> </div>
<div class="line"><span class="lineno"> 3511</span>            <span class="keywordflow">if</span>(it-&gt;index == beta)</div>
<div class="line"><span class="lineno"> 3512</span>            {</div>
<div class="line"><span class="lineno"> 3513</span>                betapresent = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 3514</span>            }</div>
<div class="line"><span class="lineno"> 3515</span>        }</div>
<div class="line"><span class="lineno"> 3516</span>        <span class="keywordflow">if</span>((alphapresent) and (betapresent)) result = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 3517</span>    }</div>
<div class="line"><span class="lineno"> 3518</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 3519</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno"> 3520</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="abbd72fa57b91e462b8f4c84cbb84a860" name="abbd72fa57b91e462b8f4c84cbb84a860"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbd72fa57b91e462b8f4c84cbb84a860">&#9670;&#160;</a></span>ThermodynamicPhasePresent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::PhaseField::ThermodynamicPhasePresent </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>alpha</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03483">3483</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3484</span>{</div>
<div class="line"><span class="lineno"> 3485</span>    <span class="keywordtype">bool</span> result = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3486</span> </div>
<div class="line"><span class="lineno"> 3487</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> beta = 0; beta &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>.<a class="code hl_function" href="../../d6/d90/classopenphase_1_1GrainsProperties.html#abb458316f62ad7fda8d902015e081e9c">size</a>(); beta++)</div>
<div class="line"><span class="lineno"> 3488</span>    {</div>
<div class="line"><span class="lineno"> 3489</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[beta].<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a> == alpha) result = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 3490</span>    }</div>
<div class="line"><span class="lineno"> 3491</span> </div>
<div class="line"><span class="lineno"> 3492</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno"> 3493</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aab1a7fa2e3620073ed7d35d341e53090" name="aab1a7fa2e3620073ed7d35d341e53090"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab1a7fa2e3620073ed7d35d341e53090">&#9670;&#160;</a></span>Variants()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::PhaseField::Variants </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Variants for <a class="el" href="../../d3/d89/structopenphase_1_1VTK.html" title="&lt; static class to write VTK data in xml format">VTK</a> output. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03793">3793</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3794</span>{</div>
<div class="line"><span class="lineno"> 3795</span>    <span class="keywordtype">int</span> locVariant = 0;</div>
<div class="line"><span class="lineno"> 3796</span>    <span class="keywordtype">double</span> locValue = 0.0;</div>
<div class="line"><span class="lineno"> 3797</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> alpha  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 3798</span>              alpha != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).cend(); ++alpha)</div>
<div class="line"><span class="lineno"> 3799</span>    {</div>
<div class="line"><span class="lineno"> 3800</span>        <span class="keywordflow">if</span>(alpha-&gt;value &gt; locValue)</div>
<div class="line"><span class="lineno"> 3801</span>        {</div>
<div class="line"><span class="lineno"> 3802</span>            locValue = alpha-&gt;value;</div>
<div class="line"><span class="lineno"> 3803</span>            locVariant = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[alpha-&gt;index].Variant;</div>
<div class="line"><span class="lineno"> 3804</span>        }</div>
<div class="line"><span class="lineno"> 3805</span>    }</div>
<div class="line"><span class="lineno"> 3806</span>    <span class="keywordflow">return</span> locVariant;</div>
<div class="line"><span class="lineno"> 3807</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a55d4d59b9f62750671aa6ba743e0afde" name="a55d4d59b9f62750671aa6ba743e0afde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55d4d59b9f62750671aa6ba743e0afde">&#9670;&#160;</a></span>VariantsDR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::PhaseField::VariantsDR </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Variants for <a class="el" href="../../d3/d89/structopenphase_1_1VTK.html" title="&lt; static class to write VTK data in xml format">VTK</a> output in double resolution. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03809">3809</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3810</span>{</div>
<div class="line"><span class="lineno"> 3811</span>    <span class="keywordtype">int</span> locVariant = 0;</div>
<div class="line"><span class="lineno"> 3812</span>    <span class="keywordtype">double</span> locValue = 0.0;</div>
<div class="line"><span class="lineno"> 3813</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> alpha  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 3814</span>              alpha != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).cend(); ++alpha)</div>
<div class="line"><span class="lineno"> 3815</span>    {</div>
<div class="line"><span class="lineno"> 3816</span>        <span class="keywordflow">if</span>(alpha-&gt;value &gt; locValue)</div>
<div class="line"><span class="lineno"> 3817</span>        {</div>
<div class="line"><span class="lineno"> 3818</span>            locValue = alpha-&gt;value;</div>
<div class="line"><span class="lineno"> 3819</span>            locVariant = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[alpha-&gt;index].Variant;</div>
<div class="line"><span class="lineno"> 3820</span>        }</div>
<div class="line"><span class="lineno"> 3821</span>    }</div>
<div class="line"><span class="lineno"> 3822</span>    <span class="keywordflow">return</span> locVariant;</div>
<div class="line"><span class="lineno"> 3823</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a639df9f867a4d9dcfe67cb2d64818412" name="a639df9f867a4d9dcfe67cb2d64818412"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a639df9f867a4d9dcfe67cb2d64818412">&#9670;&#160;</a></span>VicinityPhaseFields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; int &gt; openphase::PhaseField::VicinityPhaseFields </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns list of phase fields at point (i,j,k) and neighboring nodes. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l03073">3073</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3075</span>{</div>
<div class="line"><span class="lineno"> 3076</span>    <span class="comment">// Analyze vicinity</span></div>
<div class="line"><span class="lineno"> 3077</span>    std::vector&lt;int&gt; tempPFindex;</div>
<div class="line"><span class="lineno"> 3078</span>    tempPFindex.push_back (<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).front().index);</div>
<div class="line"><span class="lineno"> 3079</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ii = -<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii &lt;= <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#ab1b588e300d68e6b4ae6307136a11b18">dNx</a>; ii++)</div>
<div class="line"><span class="lineno"> 3080</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> jj = -<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj &lt;= <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#afa4d2acbf1237f1a1e3ca3511aed10fc">dNy</a>; jj++)</div>
<div class="line"><span class="lineno"> 3081</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> kk = -<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk &lt;= <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a439e45fff271a1abab42efa02e9e3f1e">dNz</a>; kk++)</div>
<div class="line"><span class="lineno"> 3082</span>    {</div>
<div class="line"><span class="lineno"> 3083</span>        <span class="keywordflow">for</span>(<span class="keyword">auto</span> alpha  = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i+ii,j+jj,k+kk).cbegin();</div>
<div class="line"><span class="lineno"> 3084</span>                 alpha != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i+ii,j+jj,k+kk).cend(); ++alpha)</div>
<div class="line"><span class="lineno"> 3085</span>        {</div>
<div class="line"><span class="lineno"> 3086</span>            <span class="keywordflow">if</span>(alpha-&gt;index != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).front().index)</div>
<div class="line"><span class="lineno"> 3087</span>            {</div>
<div class="line"><span class="lineno"> 3088</span>                tempPFindex.push_back (alpha-&gt;index);</div>
<div class="line"><span class="lineno"> 3089</span>            }</div>
<div class="line"><span class="lineno"> 3090</span>        }</div>
<div class="line"><span class="lineno"> 3091</span>    }</div>
<div class="line"><span class="lineno"> 3092</span> </div>
<div class="line"><span class="lineno"> 3093</span>    <span class="comment">// Erase double entries</span></div>
<div class="line"><span class="lineno"> 3094</span>    std::sort(tempPFindex.begin(), tempPFindex.end() );</div>
<div class="line"><span class="lineno"> 3095</span>    tempPFindex.erase( std::unique( tempPFindex.begin(),</div>
<div class="line"><span class="lineno"> 3096</span>                tempPFindex.end() ), tempPFindex.end() );</div>
<div class="line"><span class="lineno"> 3097</span> </div>
<div class="line"><span class="lineno"> 3098</span>    <span class="keywordflow">return</span> tempPFindex;</div>
<div class="line"><span class="lineno"> 3099</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a939d4b51c2e44fc256f73da1f592d60d" name="a939d4b51c2e44fc256f73da1f592d60d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a939d4b51c2e44fc256f73da1f592d60d">&#9670;&#160;</a></span>Write() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::PhaseField::Write </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;&#160;</td>
          <td class="paramname"><em>locSettings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>tStep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write raw (binary) phase fields to the file PhaseField_tStep.dat. </p>

<p>Reimplemented from <a class="el" href="../../d6/dcd/classopenphase_1_1OPObject.html#a2b2d60f99c90b6fc30f52b516ee0df2b">openphase::OPObject</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02390">2390</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2391</span>{</div>
<div class="line"><span class="lineno"> 2392</span><span class="preprocessor">    #ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 2393</span>    <span class="keywordtype">string</span> FileName =</div>
<div class="line"><span class="lineno"> 2394</span>        <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a19ed8803c3eb456f4708ccc6c6edd995">FileInterface::MakeFileName</a>(locSettings.InputRawDataDir,<a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>+<span class="stringliteral">&quot;_&quot;</span>+ std::to_string(MPI_RANK) + <span class="stringliteral">&quot;_&quot;</span>, tStep, <span class="stringliteral">&quot;.dat&quot;</span>);</div>
<div class="line"><span class="lineno"> 2395</span><span class="preprocessor">    #else</span></div>
<div class="line"><span class="lineno"> 2396</span>    <span class="keywordtype">string</span> FileName =</div>
<div class="line"><span class="lineno"> 2397</span>        <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a19ed8803c3eb456f4708ccc6c6edd995">FileInterface::MakeFileName</a>(locSettings.InputRawDataDir,<a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>+<span class="stringliteral">&quot;_&quot;</span>, tStep, <span class="stringliteral">&quot;.dat&quot;</span>);</div>
<div class="line"><span class="lineno"> 2398</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno"> 2399</span>    <span class="keywordtype">bool</span> write_success = <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a801c176e912c98819700f99ab35de04f">Write</a>(FileName);</div>
<div class="line"><span class="lineno"> 2400</span>    write_success = write_success &amp;&amp; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>.<a class="code hl_function" href="../../d6/d90/classopenphase_1_1GrainsProperties.html#a3a4dbd269ed6d3ad9a25d060da0de938">Write</a>(locSettings, tStep);</div>
<div class="line"><span class="lineno"> 2401</span>    <span class="keywordflow">return</span> write_success;</div>
<div class="line"><span class="lineno"> 2402</span>}</div>
<div class="ttc" id="aclassopenphase_1_1GrainsProperties_html_a3a4dbd269ed6d3ad9a25d060da0de938"><div class="ttname"><a href="../../d6/d90/classopenphase_1_1GrainsProperties.html#a3a4dbd269ed6d3ad9a25d060da0de938">openphase::GrainsProperties::Write</a></div><div class="ttdeci">bool Write(const std::string FileName) const</div><div class="ttdef"><b>Definition</b> <a href="../../da/dab/GrainsProperties_8h_source.html#l00768">GrainsProperties.h:768</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a801c176e912c98819700f99ab35de04f"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a801c176e912c98819700f99ab35de04f">openphase::PhaseField::Write</a></div><div class="ttdeci">bool Write(const std::string &amp;FileName) const</div><div class="ttdoc">Write raw (binary) phase fields to the file FileName.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l02340">PhaseField.cpp:2340</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a801c176e912c98819700f99ab35de04f" name="a801c176e912c98819700f99ab35de04f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a801c176e912c98819700f99ab35de04f">&#9670;&#160;</a></span>Write() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::PhaseField::Write </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>FileName</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write raw (binary) phase fields to the file FileName. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02340">2340</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2341</span>{</div>
<div class="line"><span class="lineno"> 2342</span>    fstream out(FileName.c_str(), ios::out | ios::binary);</div>
<div class="line"><span class="lineno"> 2343</span> </div>
<div class="line"><span class="lineno"> 2344</span>    <span class="keywordflow">if</span> (!out)</div>
<div class="line"><span class="lineno"> 2345</span>    {</div>
<div class="line"><span class="lineno"> 2346</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">ConsoleOutput::WriteWarning</a>(<span class="stringliteral">&quot;File \&quot;&quot;</span> + FileName + <span class="stringliteral">&quot;\&quot; could not be opened&quot;</span>,</div>
<div class="line"><span class="lineno"> 2347</span>                <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, <span class="stringliteral">&quot;Write()&quot;</span>);</div>
<div class="line"><span class="lineno"> 2348</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2349</span>    };</div>
<div class="line"><span class="lineno"> 2350</span> </div>
<div class="line"><span class="lineno"> 2351</span>    <span class="keywordtype">int</span> Nx = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>;</div>
<div class="line"><span class="lineno"> 2352</span>    <span class="keywordtype">int</span> Ny = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>;</div>
<div class="line"><span class="lineno"> 2353</span>    <span class="keywordtype">int</span> Nz = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>;</div>
<div class="line"><span class="lineno"> 2354</span> </div>
<div class="line"><span class="lineno"> 2355</span>    out.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;Nx), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><span class="lineno"> 2356</span>    out.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;Ny), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><span class="lineno"> 2357</span>    out.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;Nz), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><span class="lineno"> 2358</span>       </div>
<div class="line"><span class="lineno"> 2359</span>    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#af0b28822d6a3aba3df4db780b51db71a">Resolution</a>)</div>
<div class="line"><span class="lineno"> 2360</span>    {</div>
<div class="line"><span class="lineno"> 2361</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e">Resolutions::Single</a>:</div>
<div class="line"><span class="lineno"> 2362</span>        {</div>
<div class="line"><span class="lineno"> 2363</span>            <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a71aed4b94e116454c7b11985a91e49ec">STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>,0)</div>
<div class="line"><span class="lineno"> 2364</span>            {</div>
<div class="line"><span class="lineno"> 2365</span>                <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).write(out);</div>
<div class="line"><span class="lineno"> 2366</span>            }</div>
<div class="line"><span class="lineno"> 2367</span>            <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a6ad2c83345f230517a1770304d7b39ad">STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 2368</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2369</span>        }</div>
<div class="line"><span class="lineno"> 2370</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>:</div>
<div class="line"><span class="lineno"> 2371</span>        {</div>
<div class="line"><span class="lineno"> 2372</span>            <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a71aed4b94e116454c7b11985a91e49ec">STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>,0)</div>
<div class="line"><span class="lineno"> 2373</span>            {</div>
<div class="line"><span class="lineno"> 2374</span>                <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).write(out);</div>
<div class="line"><span class="lineno"> 2375</span>            }</div>
<div class="line"><span class="lineno"> 2376</span>            <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a6ad2c83345f230517a1770304d7b39ad">STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 2377</span> </div>
<div class="line"><span class="lineno"> 2378</span>            <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a71aed4b94e116454c7b11985a91e49ec">STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>,0)</div>
<div class="line"><span class="lineno"> 2379</span>            {</div>
<div class="line"><span class="lineno"> 2380</span>                <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).write(out);</div>
<div class="line"><span class="lineno"> 2381</span>            }</div>
<div class="line"><span class="lineno"> 2382</span>            <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a6ad2c83345f230517a1770304d7b39ad">STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 2383</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2384</span>        }</div>
<div class="line"><span class="lineno"> 2385</span>    }</div>
<div class="line"><span class="lineno"> 2386</span>    out.close();</div>
<div class="line"><span class="lineno"> 2387</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2388</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0e850926eb486edcdd55f67a93a418c7" name="a0e850926eb486edcdd55f67a93a418c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e850926eb486edcdd55f67a93a418c7">&#9670;&#160;</a></span>WriteAverageVolume()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::WriteAverageVolume </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>tStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>PhaseIndex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes to the file the average volume of a given phase. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02556">2556</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2557</span>{</div>
<div class="line"><span class="lineno"> 2558</span>    stringstream converter;</div>
<div class="line"><span class="lineno"> 2559</span>    converter &lt;&lt; PhaseIndex;</div>
<div class="line"><span class="lineno"> 2560</span> </div>
<div class="line"><span class="lineno"> 2561</span>    <span class="keywordtype">string</span> FileName = string(<span class="stringliteral">&quot;AverageVolumeOfPhase_&quot;</span>)</div>
<div class="line"><span class="lineno"> 2562</span>        + converter.str() + string(<span class="stringliteral">&quot;.txt&quot;</span>);</div>
<div class="line"><span class="lineno"> 2563</span> </div>
<div class="line"><span class="lineno"> 2564</span>    <span class="keywordflow">if</span>(!tStep)</div>
<div class="line"><span class="lineno"> 2565</span>    {</div>
<div class="line"><span class="lineno"> 2566</span>        fstream tout(FileName.c_str(), ios::out);</div>
<div class="line"><span class="lineno"> 2567</span>        tout &lt;&lt; <span class="stringliteral">&quot;Time\tAvgVolume&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 2568</span>        tout.close();</div>
<div class="line"><span class="lineno"> 2569</span>    }</div>
<div class="line"><span class="lineno"> 2570</span> </div>
<div class="line"><span class="lineno"> 2571</span>    <span class="keywordtype">double</span> avgVol = 0;</div>
<div class="line"><span class="lineno"> 2572</span>    <span class="keywordtype">size_t</span> count = 0;</div>
<div class="line"><span class="lineno"> 2573</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>.<a class="code hl_function" href="../../d6/d90/classopenphase_1_1GrainsProperties.html#abb458316f62ad7fda8d902015e081e9c">size</a>(); n++)</div>
<div class="line"><span class="lineno"> 2574</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[n].Exist and <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[n].<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a> == PhaseIndex)</div>
<div class="line"><span class="lineno"> 2575</span>    {</div>
<div class="line"><span class="lineno"> 2576</span>        avgVol += <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[n].Volume;</div>
<div class="line"><span class="lineno"> 2577</span>        count += 1.0;</div>
<div class="line"><span class="lineno"> 2578</span>    }</div>
<div class="line"><span class="lineno"> 2579</span> </div>
<div class="line"><span class="lineno"> 2580</span>    fstream out(FileName.c_str(), ios::out | ios::app);</div>
<div class="line"><span class="lineno"> 2581</span>    <span class="keywordflow">if</span>(count)</div>
<div class="line"><span class="lineno"> 2582</span>    {</div>
<div class="line"><span class="lineno"> 2583</span>        out &lt;&lt; tStep &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; avgVol/count &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 2584</span>    }</div>
<div class="line"><span class="lineno"> 2585</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2586</span>    {</div>
<div class="line"><span class="lineno"> 2587</span>        out &lt;&lt; tStep &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; 0.0 &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 2588</span>    }</div>
<div class="line"><span class="lineno"> 2589</span>    out.close();</div>
<div class="line"><span class="lineno"> 2590</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a398163fb479fea1925abdcc543f2edaa" name="a398163fb479fea1925abdcc543f2edaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a398163fb479fea1925abdcc543f2edaa">&#9670;&#160;</a></span>WriteDistortedVTK()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::WriteDistortedVTK </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;&#160;</td>
          <td class="paramname"><em>locSettings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d2/de8/classopenphase_1_1ElasticProperties.html">ElasticProperties</a> &amp;&#160;</td>
          <td class="paramname"><em>EP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>tStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>CurvatureOutput</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>precision</em> = <code>16</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes phase fields on distorted grid to the file in <a class="el" href="../../d3/d89/structopenphase_1_1VTK.html" title="&lt; static class to write VTK data in xml format">VTK</a> format in MPI environment. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02197">2197</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2203</span>{</div>
<div class="line"><span class="lineno"> 2204</span>    std::string Filename = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a19ed8803c3eb456f4708ccc6c6edd995">FileInterface::MakeFileName</a>(locSettings.VTKDir, <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>+<span class="stringliteral">&quot;Distorted_&quot;</span>, tStep, <span class="stringliteral">&quot;.vts&quot;</span>);</div>
<div class="line"><span class="lineno"> 2205</span>    std::vector&lt;VTK::Field_t&gt; ListOfFields;</div>
<div class="line"><span class="lineno"> 2206</span>    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#af0b28822d6a3aba3df4db780b51db71a">Resolution</a>)</div>
<div class="line"><span class="lineno"> 2207</span>    {</div>
<div class="line"><span class="lineno"> 2208</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e">Resolutions::Single</a>:</div>
<div class="line"><span class="lineno"> 2209</span>        {</div>
<div class="line"><span class="lineno"> 2210</span>            ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;Interfaces&quot;</span>,  [<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#afbbba5d2bc047ff98cf6c92b0a7af83ca756640f0aea5f5bea1cbe250a9d08989">Interfaces</a>(i,j,k);}});</div>
<div class="line"><span class="lineno"> 2211</span>            ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;Flags&quot;</span>,       [<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).flag;}});</div>
<div class="line"><span class="lineno"> 2212</span>            ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;PhaseFields&quot;</span>, [<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).majority_index();}});</div>
<div class="line"><span class="lineno"> 2213</span>            <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a>; n++)</div>
<div class="line"><span class="lineno"> 2214</span>            {</div>
<div class="line"><span class="lineno"> 2215</span>                ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;PhaseFraction_&quot;</span> + std::to_string(n), [n,<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a784a4bea9a5379192bdf4f12ab12cf10">Fractions</a>(i,j,k,{n});}});</div>
<div class="line"><span class="lineno"> 2216</span>            }</div>
<div class="line"><span class="lineno"> 2217</span>            ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;Junctions&quot;</span>,   [<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).size();}});</div>
<div class="line"><span class="lineno"> 2218</span>            ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;Variants&quot;</span>,    [<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#aab1a7fa2e3620073ed7d35d341e53090">Variants</a>(i,j,k);}});</div>
<div class="line"><span class="lineno"> 2219</span>            ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;ParentGrain&quot;</span>, [<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#aef4cc644c0c70be7ff72707535cd0d52">ParentGrain</a>(i,j,k);}});</div>
<div class="line"><span class="lineno"> 2220</span>            <span class="keywordflow">if</span>(CurvatureOutput)</div>
<div class="line"><span class="lineno"> 2221</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a>; n++)</div>
<div class="line"><span class="lineno"> 2222</span>            {</div>
<div class="line"><span class="lineno"> 2223</span>                ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;Curvature_&quot;</span> + std::to_string(n),            [n,<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#ac7aaf1025baa44ad0a3308376d719da9">CurvaturePhase</a>(i,j,k,n);}});</div>
<div class="line"><span class="lineno"> 2224</span>                ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;PrincipalCurvature_1_&quot;</span> + std::to_string(n), [n,<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a41426a7a8ececf8e6ecb7724e13bd793">PrincipalCurvatures</a>(i,j,k,n)[0];}});</div>
<div class="line"><span class="lineno"> 2225</span>                ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;PrincipalCurvature_2_&quot;</span> + std::to_string(n), [n,<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a41426a7a8ececf8e6ecb7724e13bd793">PrincipalCurvatures</a>(i,j,k,n)[1];}});</div>
<div class="line"><span class="lineno"> 2226</span>            }</div>
<div class="line"><span class="lineno"> 2227</span>            <a class="code hl_function" href="../../d3/d89/structopenphase_1_1VTK.html#a5ba0603b984a6dc0fcfddf4e5ecdd536">VTK::WriteDistorted</a>(Filename, locSettings, EP, ListOfFields, precision);</div>
<div class="line"><span class="lineno"> 2228</span><span class="preprocessor">            #ifndef WIN32       </span></div>
<div class="line"><span class="lineno"> 2229</span>            locSettings.Meta.AddPart(Filename, <span class="stringliteral">&quot;File&quot;</span>, <span class="stringliteral">&quot;VTK file with distorted phase field data&quot;</span>, <span class="stringliteral">&quot;application/xml&quot;</span>);</div>
<div class="line"><span class="lineno"> 2230</span><span class="preprocessor">            #endif</span></div>
<div class="line"><span class="lineno"> 2231</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2232</span>        }</div>
<div class="line"><span class="lineno"> 2233</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>:</div>
<div class="line"><span class="lineno"> 2234</span>        {</div>
<div class="line"><span class="lineno"> 2235</span>            ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;Interfaces&quot;</span>,  [<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a486fdf527759c74e5a2cad6d183f3dff">InterfacesDR</a>(i,j,k);}});</div>
<div class="line"><span class="lineno"> 2236</span>            ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;Flags&quot;</span>,       [<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).flag;}});</div>
<div class="line"><span class="lineno"> 2237</span>            ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;PhaseFields&quot;</span>, [<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).majority_index();}});</div>
<div class="line"><span class="lineno"> 2238</span>            <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a>; n++)</div>
<div class="line"><span class="lineno"> 2239</span>            {</div>
<div class="line"><span class="lineno"> 2240</span>                ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;PhaseFraction_&quot;</span> + std::to_string(n), [n,<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){</div>
<div class="line"><span class="lineno"> 2241</span>                <span class="keywordtype">double</span> FractionsValue = 0.0;</div>
<div class="line"><span class="lineno"> 2242</span>                <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 2243</span>                          it != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).cend(); ++it)</div>
<div class="line"><span class="lineno"> 2244</span>                {</div>
<div class="line"><span class="lineno"> 2245</span>                    <span class="keywordtype">size_t</span> pIndex = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[it-&gt;index].Phase;</div>
<div class="line"><span class="lineno"> 2246</span>                    <span class="keywordflow">if</span>(pIndex == n)</div>
<div class="line"><span class="lineno"> 2247</span>                    {</div>
<div class="line"><span class="lineno"> 2248</span>                        FractionsValue += it-&gt;value;</div>
<div class="line"><span class="lineno"> 2249</span>                    }</div>
<div class="line"><span class="lineno"> 2250</span>                }</div>
<div class="line"><span class="lineno"> 2251</span>                <span class="keywordflow">return</span> FractionsValue;}});</div>
<div class="line"><span class="lineno"> 2252</span>            }</div>
<div class="line"><span class="lineno"> 2253</span>            ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;Junctions&quot;</span>,   [<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).size();}});</div>
<div class="line"><span class="lineno"> 2254</span>            ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;Variants&quot;</span>,    [<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a55d4d59b9f62750671aa6ba743e0afde">VariantsDR</a>(i,j,k);}});</div>
<div class="line"><span class="lineno"> 2255</span>            ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;ParentGrain&quot;</span>, [<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a0d16abfb203f146a81ff92a2d3a68cfb">ParentGrainDR</a>(i,j,k);}});</div>
<div class="line"><span class="lineno"> 2256</span> </div>
<div class="line"><span class="lineno"> 2257</span>            <a class="code hl_function" href="../../d3/d89/structopenphase_1_1VTK.html#a5ba0603b984a6dc0fcfddf4e5ecdd536">VTK::WriteDistorted</a>(Filename, locSettings, EP, ListOfFields, precision, 2);</div>
<div class="line"><span class="lineno"> 2258</span><span class="preprocessor">            #ifndef WIN32       </span></div>
<div class="line"><span class="lineno"> 2259</span>            locSettings.Meta.AddPart(Filename, <span class="stringliteral">&quot;File&quot;</span>, <span class="stringliteral">&quot;VTK file with distorted phase field data&quot;</span>, <span class="stringliteral">&quot;application/xml&quot;</span>);</div>
<div class="line"><span class="lineno"> 2260</span><span class="preprocessor">            #endif</span></div>
<div class="line"><span class="lineno"> 2261</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2262</span>        }</div>
<div class="line"><span class="lineno"> 2263</span>    }</div>
<div class="line"><span class="lineno"> 2264</span>}</div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a0d16abfb203f146a81ff92a2d3a68cfb"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a0d16abfb203f146a81ff92a2d3a68cfb">openphase::PhaseField::ParentGrainDR</a></div><div class="ttdeci">double ParentGrainDR(const int i, const int j, const int k) const</div><div class="ttdoc">Parent grain index for VTK output in double resolution.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l03841">PhaseField.cpp:3841</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a486fdf527759c74e5a2cad6d183f3dff"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a486fdf527759c74e5a2cad6d183f3dff">openphase::PhaseField::InterfacesDR</a></div><div class="ttdeci">double InterfacesDR(const int i, const int j, const int k) const</div><div class="ttdoc">Indicates interfaces for VTK output in double resolution.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l03779">PhaseField.cpp:3779</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_a55d4d59b9f62750671aa6ba743e0afde"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#a55d4d59b9f62750671aa6ba743e0afde">openphase::PhaseField::VariantsDR</a></div><div class="ttdeci">double VariantsDR(const int i, const int j, const int k) const</div><div class="ttdoc">Variants for VTK output in double resolution.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l03809">PhaseField.cpp:3809</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_aab1a7fa2e3620073ed7d35d341e53090"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#aab1a7fa2e3620073ed7d35d341e53090">openphase::PhaseField::Variants</a></div><div class="ttdeci">double Variants(const int i, const int j, const int k) const</div><div class="ttdoc">Variants for VTK output.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l03793">PhaseField.cpp:3793</a></div></div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_ac7aaf1025baa44ad0a3308376d719da9"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#ac7aaf1025baa44ad0a3308376d719da9">openphase::PhaseField::CurvaturePhase</a></div><div class="ttdeci">double CurvaturePhase(const int i, const int j, const int k, const size_t Index) const</div><div class="ttdoc">Curvature for each thermodynamic phase VTK output.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l03423">PhaseField.cpp:3423</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_afbbba5d2bc047ff98cf6c92b0a7af83ca756640f0aea5f5bea1cbe250a9d08989"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#afbbba5d2bc047ff98cf6c92b0a7af83ca756640f0aea5f5bea1cbe250a9d08989">openphase::NucleiLocationModes::Interfaces</a></div><div class="ttdeci">@ Interfaces</div><div class="ttdoc">In all interfaces, e.g. grain and phase boundaries involving matrix phase.</div></div>
<div class="ttc" id="astructopenphase_1_1VTK_html_a5ba0603b984a6dc0fcfddf4e5ecdd536"><div class="ttname"><a href="../../d3/d89/structopenphase_1_1VTK.html#a5ba0603b984a6dc0fcfddf4e5ecdd536">openphase::VTK::WriteDistorted</a></div><div class="ttdeci">static void WriteDistorted(const std::string Filename, const Settings &amp;locSettings, const ElasticProperties &amp;EP, std::vector&lt; Field_t &gt; ListOfFields, const int precision=16, const int resolution=1)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/de8/VTK_8cpp_source.html#l00186">VTK.cpp:186</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="add08e9ecc28c84cbaa472a8945674881" name="add08e9ecc28c84cbaa472a8945674881"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add08e9ecc28c84cbaa472a8945674881">&#9670;&#160;</a></span>WriteGrainsVolume()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::WriteGrainsVolume </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>time_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes grains' volume in grid cells over time into a file. </p>
<p>This function will write a list of all grain volumes in a file, each time this function is called in a new row. The first column is the time, the second row beginning with a "#" marks the thermodynamic index for each grain.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02848">2848</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2849</span>{</div>
<div class="line"><span class="lineno"> 2855</span><span class="keywordtype">string</span> separator = <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><span class="lineno"> 2856</span> </div>
<div class="line"><span class="lineno"> 2857</span>    <span class="keywordflow">if</span> (!std::filesystem::exists(filename))</div>
<div class="line"><span class="lineno"> 2858</span>    {</div>
<div class="line"><span class="lineno"> 2859</span>        ofstream file(filename, ios::out);                                      <span class="comment">//Create file and write header (or overwrite)</span></div>
<div class="line"><span class="lineno"> 2860</span>        file &lt;&lt; <span class="stringliteral">&quot;# Volume of each grain in the order of their field-index! &quot;</span></div>
<div class="line"><span class="lineno"> 2861</span>             &lt;&lt; <span class="stringliteral">&quot;First row contains the simulation time. &quot;</span></div>
<div class="line"><span class="lineno"> 2862</span>             &lt;&lt; <span class="stringliteral">&quot;The next line contains the thermodynamic phase field index &quot;</span></div>
<div class="line"><span class="lineno"> 2863</span>             &lt;&lt; <span class="stringliteral">&quot;of each grain for identification\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 2864</span> </div>
<div class="line"><span class="lineno"> 2865</span>        file &lt;&lt; <span class="stringliteral">&quot;TimeStep &quot;</span> &lt;&lt; separator &lt;&lt; <span class="stringliteral">&quot;Time&quot;</span>;</div>
<div class="line"><span class="lineno"> 2866</span>        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>.<a class="code hl_function" href="../../d6/d90/classopenphase_1_1GrainsProperties.html#abb458316f62ad7fda8d902015e081e9c">size</a>(); n++)</div>
<div class="line"><span class="lineno"> 2867</span>        {</div>
<div class="line"><span class="lineno"> 2868</span>            file &lt;&lt; separator &lt;&lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[n].Phase;</div>
<div class="line"><span class="lineno"> 2869</span>        }</div>
<div class="line"><span class="lineno"> 2870</span>        file &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 2871</span>        file.close();</div>
<div class="line"><span class="lineno"> 2872</span>    }</div>
<div class="line"><span class="lineno"> 2873</span> </div>
<div class="line"><span class="lineno"> 2874</span>    ofstream file(filename, ios::app);</div>
<div class="line"><span class="lineno"> 2875</span>    file.precision(10);</div>
<div class="line"><span class="lineno"> 2876</span>    file &lt;&lt; time_step &lt;&lt; separator &lt;&lt; time &lt;&lt; separator;</div>
<div class="line"><span class="lineno"> 2877</span> </div>
<div class="line"><span class="lineno"> 2878</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>.<a class="code hl_function" href="../../d6/d90/classopenphase_1_1GrainsProperties.html#abb458316f62ad7fda8d902015e081e9c">size</a>(); i++)</div>
<div class="line"><span class="lineno"> 2879</span>    {</div>
<div class="line"><span class="lineno"> 2880</span>        file &lt;&lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[i].Volume &lt;&lt; separator;</div>
<div class="line"><span class="lineno"> 2881</span>    }</div>
<div class="line"><span class="lineno"> 2882</span>    file &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 2883</span>    file.close();</div>
<div class="line"><span class="lineno"> 2884</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a05832d56292f980e7a9c7e60205d49e9" name="a05832d56292f980e7a9c7e60205d49e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05832d56292f980e7a9c7e60205d49e9">&#9670;&#160;</a></span>WriteH5()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::WriteH5 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/d89/classopenphase_1_1H5Interface.html">H5Interface</a> &amp;&#160;</td>
          <td class="paramname"><em>H5</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>tStep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes output in HDF5 format. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02404">2404</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2405</span>{</div>
<div class="line"><span class="lineno"> 2406</span><span class="preprocessor">    #ifdef H5OP</span></div>
<div class="line"><span class="lineno"> 2407</span>    std::vector&lt;double&gt; dbuffer;</div>
<div class="line"><span class="lineno"> 2408</span>    dbuffer.push_back(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a5c1aae2c50ac8d4553575e73bea08105">Nx</a>);</div>
<div class="line"><span class="lineno"> 2409</span>    dbuffer.push_back(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a6dc623672d1966056e21a45e859178b7">Ny</a>);</div>
<div class="line"><span class="lineno"> 2410</span>    dbuffer.push_back(<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#a0f169f4652c06b6e4328e31778885e9b">Nz</a>);</div>
<div class="line"><span class="lineno"> 2411</span>    H5.WriteCheckPoint(tStep, <span class="stringliteral">&quot;PFDomain&quot;</span>, dbuffer);</div>
<div class="line"><span class="lineno"> 2412</span>    dbuffer.clear();</div>
<div class="line"><span class="lineno"> 2413</span>    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#af0b28822d6a3aba3df4db780b51db71a">Resolution</a>)</div>
<div class="line"><span class="lineno"> 2414</span>    {</div>
<div class="line"><span class="lineno"> 2415</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e">Resolutions::Single</a>:</div>
<div class="line"><span class="lineno"> 2416</span>        {</div>
<div class="line"><span class="lineno"> 2417</span>            dbuffer = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>.pack();</div>
<div class="line"><span class="lineno"> 2418</span>            H5.WriteCheckPoint(tStep, <span class="stringliteral">&quot;Fields&quot;</span>, dbuffer);</div>
<div class="line"><span class="lineno"> 2419</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2420</span>        }</div>
<div class="line"><span class="lineno"> 2421</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>:</div>
<div class="line"><span class="lineno"> 2422</span>        {</div>
<div class="line"><span class="lineno"> 2423</span>            dbuffer = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>.pack();</div>
<div class="line"><span class="lineno"> 2424</span>            H5.WriteCheckPoint(tStep, <span class="stringliteral">&quot;FieldsDR&quot;</span>, dbuffer);</div>
<div class="line"><span class="lineno"> 2425</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2426</span>        }</div>
<div class="line"><span class="lineno"> 2427</span>    }</div>
<div class="line"><span class="lineno"> 2428</span>    <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>.<a class="code hl_function" href="../../d6/d90/classopenphase_1_1GrainsProperties.html#ae0b48883e5ac8b41f30ee86579fa9152">WriteH5</a>(tStep,H5);</div>
<div class="line"><span class="lineno"> 2429</span><span class="preprocessor">    #else</span></div>
<div class="line"><span class="lineno"> 2430</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">ConsoleOutput::WriteWarning</a>(<span class="stringliteral">&quot;OpenPhase is not compiled with HDF5 support, use: make Settings=\&quot;H5\&quot;&quot;</span>, <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>, <span class="stringliteral">&quot;WriteH5()&quot;</span>);</div>
<div class="line"><span class="lineno"> 2431</span>    <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a4d6fed4ab71c6edf2a0bd5dabecc6ec6">OP_Exit</a>(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#ab73d51f3247521914daf0d578fc97a05">EXIT_H5_ERROR</a>);</div>
<div class="line"><span class="lineno"> 2432</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno"> 2433</span>}</div>
<div class="ttc" id="aclassopenphase_1_1GrainsProperties_html_ae0b48883e5ac8b41f30ee86579fa9152"><div class="ttname"><a href="../../d6/d90/classopenphase_1_1GrainsProperties.html#ae0b48883e5ac8b41f30ee86579fa9152">openphase::GrainsProperties::WriteH5</a></div><div class="ttdeci">void WriteH5(const long int tStep, H5Interface &amp;H5)</div><div class="ttdef"><b>Definition</b> <a href="../../da/dab/GrainsProperties_8h_source.html#l00919">GrainsProperties.h:919</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c0985f8597ce55d39eb1565a6f5ee21" name="a7c0985f8597ce55d39eb1565a6f5ee21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c0985f8597ce55d39eb1565a6f5ee21">&#9670;&#160;</a></span>WriteIndividualPhaseFieldValuesVTK()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::WriteIndividualPhaseFieldValuesVTK </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;&#160;</td>
          <td class="paramname"><em>locSettings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>tStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::initializer_list&lt; size_t &gt;&#160;</td>
          <td class="paramname"><em>FieldIndices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>precision</em> = <code>16</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes values of individual phase fields to file in <a class="el" href="../../d3/d89/structopenphase_1_1VTK.html" title="&lt; static class to write VTK data in xml format">VTK</a> format. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02296">2296</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2300</span>{</div>
<div class="line"><span class="lineno"> 2301</span>    std::vector&lt;VTK::Field_t&gt; ListOfFields;</div>
<div class="line"><span class="lineno"> 2302</span>    std::string Filename = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a19ed8803c3eb456f4708ccc6c6edd995">FileInterface::MakeFileName</a>(locSettings.VTKDir, <span class="stringliteral">&quot;PhaseFieldValues_&quot;</span>, tStep, <span class="stringliteral">&quot;.vts&quot;</span>);</div>
<div class="line"><span class="lineno"> 2303</span>    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#af0b28822d6a3aba3df4db780b51db71a">Resolution</a>)</div>
<div class="line"><span class="lineno"> 2304</span>    {</div>
<div class="line"><span class="lineno"> 2305</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e">Resolutions::Single</a>:</div>
<div class="line"><span class="lineno"> 2306</span>        {</div>
<div class="line"><span class="lineno"> 2307</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> IteratorIndex = FieldIndices.begin();</div>
<div class="line"><span class="lineno"> 2308</span>                      IteratorIndex != FieldIndices.end(); IteratorIndex++)</div>
<div class="line"><span class="lineno"> 2309</span>            {</div>
<div class="line"><span class="lineno"> 2310</span>                ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;FieldValue_&quot;</span> + std::to_string(*IteratorIndex), [IteratorIndex,<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).get_value(*IteratorIndex);}});</div>
<div class="line"><span class="lineno"> 2311</span>            }</div>
<div class="line"><span class="lineno"> 2312</span>            <a class="code hl_function" href="../../d3/d89/structopenphase_1_1VTK.html#a7617ede48a3aded40ba2eb72d60447f1">VTK::Write</a>(Filename, locSettings, ListOfFields, precision);</div>
<div class="line"><span class="lineno"> 2313</span><span class="preprocessor">            #ifndef WIN32       </span></div>
<div class="line"><span class="lineno"> 2314</span>            locSettings.Meta.AddPart(Filename, <span class="stringliteral">&quot;File&quot;</span>, <span class="stringliteral">&quot;VTK file with individual phase field data&quot;</span>, <span class="stringliteral">&quot;application/xml&quot;</span>);</div>
<div class="line"><span class="lineno"> 2315</span><span class="preprocessor">            #endif</span></div>
<div class="line"><span class="lineno"> 2316</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2317</span>        }</div>
<div class="line"><span class="lineno"> 2318</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>:</div>
<div class="line"><span class="lineno"> 2319</span>        {</div>
<div class="line"><span class="lineno"> 2320</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> IteratorIndex = FieldIndices.begin();</div>
<div class="line"><span class="lineno"> 2321</span>                      IteratorIndex != FieldIndices.end(); IteratorIndex++)</div>
<div class="line"><span class="lineno"> 2322</span>            {</div>
<div class="line"><span class="lineno"> 2323</span>                ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;FieldValue_&quot;</span> + std::to_string(*IteratorIndex), [IteratorIndex,<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).get_value(*IteratorIndex);}});</div>
<div class="line"><span class="lineno"> 2324</span>            }</div>
<div class="line"><span class="lineno"> 2325</span>            <a class="code hl_function" href="../../d3/d89/structopenphase_1_1VTK.html#a7617ede48a3aded40ba2eb72d60447f1">VTK::Write</a>(Filename, locSettings, ListOfFields, precision, 2);</div>
<div class="line"><span class="lineno"> 2326</span><span class="preprocessor">            #ifndef WIN32       </span></div>
<div class="line"><span class="lineno"> 2327</span>            locSettings.Meta.AddPart(Filename, <span class="stringliteral">&quot;File&quot;</span>, <span class="stringliteral">&quot;VTK file with individual phase field data&quot;</span>, <span class="stringliteral">&quot;application/xml&quot;</span>);</div>
<div class="line"><span class="lineno"> 2328</span><span class="preprocessor">            #endif</span></div>
<div class="line"><span class="lineno"> 2329</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2330</span>        }</div>
<div class="line"><span class="lineno"> 2331</span>    }</div>
<div class="line"><span class="lineno"> 2332</span>}</div>
<div class="ttc" id="astructopenphase_1_1VTK_html_a7617ede48a3aded40ba2eb72d60447f1"><div class="ttname"><a href="../../d3/d89/structopenphase_1_1VTK.html#a7617ede48a3aded40ba2eb72d60447f1">openphase::VTK::Write</a></div><div class="ttdeci">static void Write(const std::string Filename, const Settings &amp;locSettings, std::vector&lt; Field_t &gt; ListOfFields, const int precision=16, const int resolution=1)</div><div class="ttdoc">Writes a list of fields which returns a double into a VTK file.</div><div class="ttdef"><b>Definition</b> <a href="../../d2/de8/VTK_8cpp_source.html#l00075">VTK.cpp:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9685e85c1d1e6c1e54fde08a4b53a865" name="a9685e85c1d1e6c1e54fde08a4b53a865"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9685e85c1d1e6c1e54fde08a4b53a865">&#9670;&#160;</a></span>WriteLaplacianVTK()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::WriteLaplacianVTK </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;&#160;</td>
          <td class="paramname"><em>locSettings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>tStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>PhiIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>precision</em> = <code>16</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes Laplacian of a given phase field to the file in <a class="el" href="../../d3/d89/structopenphase_1_1VTK.html" title="&lt; static class to write VTK data in xml format">VTK</a> format. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02266">2266</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2270</span>{</div>
<div class="line"><span class="lineno"> 2271</span>    std::vector&lt;VTK::Field_t&gt; ListOfFields;</div>
<div class="line"><span class="lineno"> 2272</span>    std::string Filename = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a19ed8803c3eb456f4708ccc6c6edd995">FileInterface::MakeFileName</a>(locSettings.VTKDir, <span class="stringliteral">&quot;Laplacian_&quot;</span> + to_string(PhiIndex) + <span class="stringliteral">&quot;_&quot;</span>, tStep, <span class="stringliteral">&quot;.vts&quot;</span>);</div>
<div class="line"><span class="lineno"> 2273</span>    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#af0b28822d6a3aba3df4db780b51db71a">Resolution</a>)</div>
<div class="line"><span class="lineno"> 2274</span>    {</div>
<div class="line"><span class="lineno"> 2275</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e">Resolutions::Single</a>:</div>
<div class="line"><span class="lineno"> 2276</span>        {</div>
<div class="line"><span class="lineno"> 2277</span>            ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;Laplacian_&quot;</span> + std::to_string(PhiIndex), [PhiIndex,<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).get_laplacian(PhiIndex);}});</div>
<div class="line"><span class="lineno"> 2278</span>            <a class="code hl_function" href="../../d3/d89/structopenphase_1_1VTK.html#a7617ede48a3aded40ba2eb72d60447f1">VTK::Write</a>(Filename, locSettings, ListOfFields, precision);</div>
<div class="line"><span class="lineno"> 2279</span><span class="preprocessor">            #ifndef WIN32       </span></div>
<div class="line"><span class="lineno"> 2280</span>            locSettings.Meta.AddPart(Filename, <span class="stringliteral">&quot;File&quot;</span>, <span class="stringliteral">&quot;VTK file with phase field laplacian data&quot;</span>, <span class="stringliteral">&quot;application/xml&quot;</span>);</div>
<div class="line"><span class="lineno"> 2281</span><span class="preprocessor">            #endif</span></div>
<div class="line"><span class="lineno"> 2282</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2283</span>        }</div>
<div class="line"><span class="lineno"> 2284</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>:</div>
<div class="line"><span class="lineno"> 2285</span>        {</div>
<div class="line"><span class="lineno"> 2286</span>            ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;Laplacian_&quot;</span> + std::to_string(PhiIndex), [PhiIndex,<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).get_laplacian(PhiIndex);}});</div>
<div class="line"><span class="lineno"> 2287</span>            <a class="code hl_function" href="../../d3/d89/structopenphase_1_1VTK.html#a7617ede48a3aded40ba2eb72d60447f1">VTK::Write</a>(Filename, locSettings, ListOfFields, precision, 2);</div>
<div class="line"><span class="lineno"> 2288</span><span class="preprocessor">            #ifndef WIN32       </span></div>
<div class="line"><span class="lineno"> 2289</span>            locSettings.Meta.AddPart(Filename, <span class="stringliteral">&quot;File&quot;</span>, <span class="stringliteral">&quot;VTK file with phase field laplacian data&quot;</span>, <span class="stringliteral">&quot;application/xml&quot;</span>);</div>
<div class="line"><span class="lineno"> 2290</span><span class="preprocessor">            #endif</span></div>
<div class="line"><span class="lineno"> 2291</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2292</span>        }</div>
<div class="line"><span class="lineno"> 2293</span>    }</div>
<div class="line"><span class="lineno"> 2294</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afd0125f9c7d2afc5e47b2769ae5edab6" name="afd0125f9c7d2afc5e47b2769ae5edab6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd0125f9c7d2afc5e47b2769ae5edab6">&#9670;&#160;</a></span>WriteMPI()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::PhaseField::WriteMPI </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>Path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02334">2334</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2335</span>{</div>
<div class="line"><span class="lineno"> 2336</span>       <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>.WriteToFile(FileName+<span class="stringliteral">&quot;/Fields.data&quot;</span>);</div>
<div class="line"><span class="lineno"> 2337</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2338</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad31260709ab209458255a5f4d8541c3d" name="ad31260709ab209458255a5f4d8541c3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad31260709ab209458255a5f4d8541c3d">&#9670;&#160;</a></span>WriteVolumePercentages()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::WriteVolumePercentages </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>separator</em> = <code>','</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes volume fraction of all thermodynamic phases to the file FileName. </p>
<p>This function will create tabulated data on the volume percent of each thermodynamic phase. Each time this function is called, a new row will be written in the specified file name for the current time step. If the file is not present it will be created, if the phase already exists, the new data will be appended!</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02809">2809</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2810</span>{</div>
<div class="line"><span class="lineno"> 2817</span>    <span class="comment">// NOTE USED BY OPSTUDIO GUI !!!!!!</span></div>
<div class="line"><span class="lineno"> 2818</span> </div>
<div class="line"><span class="lineno"> 2819</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 2820</span>    <span class="keywordflow">if</span> (MPI_RANK == 0)</div>
<div class="line"><span class="lineno"> 2821</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2822</span>    {</div>
<div class="line"><span class="lineno"> 2823</span>        <span class="keywordflow">if</span> (!std::filesystem::exists(filename))</div>
<div class="line"><span class="lineno"> 2824</span>        {</div>
<div class="line"><span class="lineno"> 2825</span>            <span class="comment">// Write data header</span></div>
<div class="line"><span class="lineno"> 2826</span>            std::ofstream file(filename, ios::out);</div>
<div class="line"><span class="lineno"> 2827</span>            file &lt;&lt; <span class="stringliteral">&quot;time&quot;</span>;</div>
<div class="line"><span class="lineno"> 2828</span>            <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> idx = 0; idx &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a>; idx++)</div>
<div class="line"><span class="lineno"> 2829</span>            {</div>
<div class="line"><span class="lineno"> 2830</span>                file &lt;&lt; separator &lt;&lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a00842a7df5798d0d7e5c677949ec5600">PhaseNames</a>[idx];</div>
<div class="line"><span class="lineno"> 2831</span>            }</div>
<div class="line"><span class="lineno"> 2832</span>            file &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 2833</span>            file.close();</div>
<div class="line"><span class="lineno"> 2834</span>        }</div>
<div class="line"><span class="lineno"> 2835</span> </div>
<div class="line"><span class="lineno"> 2836</span>        <span class="comment">// Write data</span></div>
<div class="line"><span class="lineno"> 2837</span>        std::ofstream file(filename, ios::app);</div>
<div class="line"><span class="lineno"> 2838</span>        file &lt;&lt; std::scientific &lt;&lt; time;</div>
<div class="line"><span class="lineno"> 2839</span>        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> idx = 0; idx &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a>; idx++)</div>
<div class="line"><span class="lineno"> 2840</span>        {</div>
<div class="line"><span class="lineno"> 2841</span>            file &lt;&lt; std::scientific &lt;&lt; separator &lt;&lt; 100.0*<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7f11e6f1f190ef9bb7e6c6013ec03101">FractionsTotal</a>[idx];</div>
<div class="line"><span class="lineno"> 2842</span>        }</div>
<div class="line"><span class="lineno"> 2843</span>        file &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 2844</span>        file.close();</div>
<div class="line"><span class="lineno"> 2845</span>    }</div>
<div class="line"><span class="lineno"> 2846</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad1eea42255f8d7efcafe303a0198ab09" name="ad1eea42255f8d7efcafe303a0198ab09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1eea42255f8d7efcafe303a0198ab09">&#9670;&#160;</a></span>WriteVTK()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::PhaseField::WriteVTK </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;&#160;</td>
          <td class="paramname"><em>locSettings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>tStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>CurvatureOutput</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>precision</em> = <code>16</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes phase fields to the file in <a class="el" href="../../d3/d89/structopenphase_1_1VTK.html" title="&lt; static class to write VTK data in xml format">VTK</a> format. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html#l02128">2128</a> of file <a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2129</span>{</div>
<div class="line"><span class="lineno"> 2130</span>    std::vector&lt;VTK::Field_t&gt; ListOfFields;</div>
<div class="line"><span class="lineno"> 2131</span>    std::string Filename = <a class="code hl_function" href="../../d2/d61/classopenphase_1_1FileInterface.html#a19ed8803c3eb456f4708ccc6c6edd995">FileInterface::MakeFileName</a>(locSettings.VTKDir, <a class="code hl_variable" href="../../d6/dcd/classopenphase_1_1OPObject.html#a9006e8f49762d851b52708b363ba14f2">thisclassname</a>+<span class="stringliteral">&quot;_&quot;</span>, tStep, <span class="stringliteral">&quot;.vts&quot;</span>);</div>
<div class="line"><span class="lineno"> 2132</span>    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a7514a5f0d25deb090526b0a71ca95132">Grid</a>.<a class="code hl_variable" href="../../dc/d18/classopenphase_1_1GridParameters.html#af0b28822d6a3aba3df4db780b51db71a">Resolution</a>)</div>
<div class="line"><span class="lineno"> 2133</span>    {</div>
<div class="line"><span class="lineno"> 2134</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e">Resolutions::Single</a>:</div>
<div class="line"><span class="lineno"> 2135</span>        {</div>
<div class="line"><span class="lineno"> 2136</span>            ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;Interfaces&quot;</span>,  [<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#afbbba5d2bc047ff98cf6c92b0a7af83ca756640f0aea5f5bea1cbe250a9d08989">Interfaces</a>(i,j,k);}});</div>
<div class="line"><span class="lineno"> 2137</span>            ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;Flags&quot;</span>,       [<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).flag;}});</div>
<div class="line"><span class="lineno"> 2138</span>            ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;PhaseFields&quot;</span>, [<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).majority_index();}});</div>
<div class="line"><span class="lineno"> 2139</span>            <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a>; n++)</div>
<div class="line"><span class="lineno"> 2140</span>            {</div>
<div class="line"><span class="lineno"> 2141</span>                ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;PhaseFraction_&quot;</span> + std::to_string(n), [n,<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a784a4bea9a5379192bdf4f12ab12cf10">Fractions</a>(i,j,k,{n});}});</div>
<div class="line"><span class="lineno"> 2142</span>            }</div>
<div class="line"><span class="lineno"> 2143</span>            ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;Junctions&quot;</span>,   [<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aebd94a373c8ff15a6ca2296c8db48e18">Fields</a>(i,j,k).size();}});</div>
<div class="line"><span class="lineno"> 2144</span>            ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;Variants&quot;</span>,    [<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#aab1a7fa2e3620073ed7d35d341e53090">Variants</a>(i,j,k);}});</div>
<div class="line"><span class="lineno"> 2145</span>            ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;ParentGrain&quot;</span>, [<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#aef4cc644c0c70be7ff72707535cd0d52">ParentGrain</a>(i,j,k);}});</div>
<div class="line"><span class="lineno"> 2146</span> </div>
<div class="line"><span class="lineno"> 2147</span>            <span class="keywordflow">if</span>(CurvatureOutput)</div>
<div class="line"><span class="lineno"> 2148</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a>; n++)</div>
<div class="line"><span class="lineno"> 2149</span>            {</div>
<div class="line"><span class="lineno"> 2150</span>                ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;Curvature_&quot;</span> + std::to_string(n),            [n,<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#ac7aaf1025baa44ad0a3308376d719da9">CurvaturePhase</a>(i,j,k,n);}});</div>
<div class="line"><span class="lineno"> 2151</span>                ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;PrincipalCurvature_1_&quot;</span> + std::to_string(n), [n,<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a41426a7a8ececf8e6ecb7724e13bd793">PrincipalCurvatures</a>(i,j,k,n)[0];}});</div>
<div class="line"><span class="lineno"> 2152</span>                ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;PrincipalCurvature_2_&quot;</span> + std::to_string(n), [n,<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a41426a7a8ececf8e6ecb7724e13bd793">PrincipalCurvatures</a>(i,j,k,n)[1];}});</div>
<div class="line"><span class="lineno"> 2153</span>            }</div>
<div class="line"><span class="lineno"> 2154</span>            <a class="code hl_function" href="../../d3/d89/structopenphase_1_1VTK.html#a7617ede48a3aded40ba2eb72d60447f1">VTK::Write</a>(Filename, locSettings, ListOfFields, precision);</div>
<div class="line"><span class="lineno"> 2155</span><span class="preprocessor">#ifndef WIN32       </span></div>
<div class="line"><span class="lineno"> 2156</span>            locSettings.Meta.AddPart(Filename, <span class="stringliteral">&quot;File&quot;</span>, <span class="stringliteral">&quot;VTK file with phase field data&quot;</span>, <span class="stringliteral">&quot;application/xml&quot;</span>);</div>
<div class="line"><span class="lineno"> 2157</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2158</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2159</span>        }</div>
<div class="line"><span class="lineno"> 2160</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>:</div>
<div class="line"><span class="lineno"> 2161</span>        {</div>
<div class="line"><span class="lineno"> 2162</span>            ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;Interfaces&quot;</span>,  [<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a486fdf527759c74e5a2cad6d183f3dff">InterfacesDR</a>(i,j,k);}});</div>
<div class="line"><span class="lineno"> 2163</span>            ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;Flags&quot;</span>,       [<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).flag;}});</div>
<div class="line"><span class="lineno"> 2164</span>            ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;PhaseFields&quot;</span>, [<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).majority_index();}});</div>
<div class="line"><span class="lineno"> 2165</span>            <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a>; n++)</div>
<div class="line"><span class="lineno"> 2166</span>            {</div>
<div class="line"><span class="lineno"> 2167</span>                ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;PhaseFraction_&quot;</span> + std::to_string(n), [n,<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){</div>
<div class="line"><span class="lineno"> 2168</span>                <span class="keywordtype">double</span> FractionsValue = 0.0;</div>
<div class="line"><span class="lineno"> 2169</span>                <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).cbegin();</div>
<div class="line"><span class="lineno"> 2170</span>                          it != <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).cend(); ++it)</div>
<div class="line"><span class="lineno"> 2171</span>                {</div>
<div class="line"><span class="lineno"> 2172</span>                    <span class="keywordtype">size_t</span> pIndex = <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aa2c57b6e85a5364094952fd5257be9c5">FieldsProperties</a>[it-&gt;index].Phase;</div>
<div class="line"><span class="lineno"> 2173</span>                    <span class="keywordflow">if</span>(pIndex == n)</div>
<div class="line"><span class="lineno"> 2174</span>                    {</div>
<div class="line"><span class="lineno"> 2175</span>                        FractionsValue += it-&gt;value;</div>
<div class="line"><span class="lineno"> 2176</span>                    }</div>
<div class="line"><span class="lineno"> 2177</span>                }</div>
<div class="line"><span class="lineno"> 2178</span>                <span class="keywordflow">return</span> FractionsValue;}});</div>
<div class="line"><span class="lineno"> 2179</span>            }</div>
<div class="line"><span class="lineno"> 2180</span>            ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;Junctions&quot;</span>,   [<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#a81113f3bf9c388a9ac8e31861902c40b">FieldsDR</a>(i,j,k).size();}});</div>
<div class="line"><span class="lineno"> 2181</span>            ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;Variants&quot;</span>,    [<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a55d4d59b9f62750671aa6ba743e0afde">VariantsDR</a>(i,j,k);}});</div>
<div class="line"><span class="lineno"> 2182</span>            ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;ParentGrain&quot;</span>, [<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#a0d16abfb203f146a81ff92a2d3a68cfb">ParentGrainDR</a>(i,j,k);}});</div>
<div class="line"><span class="lineno"> 2183</span>            <span class="keywordflow">if</span>(CurvatureOutput)</div>
<div class="line"><span class="lineno"> 2184</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_variable" href="../../d5/d16/classopenphase_1_1PhaseField.html#aaeea2220078792baa302dc4300807029">Nphases</a>; n++)</div>
<div class="line"><span class="lineno"> 2185</span>            {</div>
<div class="line"><span class="lineno"> 2186</span>                ListOfFields.push_back((VTK::Field_t) {<span class="stringliteral">&quot;Curvature_&quot;</span> + std::to_string(n),[n,<span class="keyword">this</span>](<span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k){<span class="keywordflow">return</span> <a class="code hl_function" href="../../d5/d16/classopenphase_1_1PhaseField.html#afe08f3c4509a459e08932ed2c17cf21c">CurvaturePhaseDR</a>(i,j,k,n);}});</div>
<div class="line"><span class="lineno"> 2187</span>            }</div>
<div class="line"><span class="lineno"> 2188</span>            <a class="code hl_function" href="../../d3/d89/structopenphase_1_1VTK.html#a7617ede48a3aded40ba2eb72d60447f1">VTK::Write</a>(Filename, locSettings, ListOfFields, precision, 2);</div>
<div class="line"><span class="lineno"> 2189</span><span class="preprocessor">#ifndef WIN32</span></div>
<div class="line"><span class="lineno"> 2190</span>            locSettings.Meta.AddPart(Filename, <span class="stringliteral">&quot;File&quot;</span>, <span class="stringliteral">&quot;VTK file with phase field data&quot;</span>, <span class="stringliteral">&quot;application/xml&quot;</span>);</div>
<div class="line"><span class="lineno"> 2191</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2192</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2193</span>        }</div>
<div class="line"><span class="lineno"> 2194</span>    }</div>
<div class="line"><span class="lineno"> 2195</span>}</div>
<div class="ttc" id="aclassopenphase_1_1PhaseField_html_afe08f3c4509a459e08932ed2c17cf21c"><div class="ttname"><a href="../../d5/d16/classopenphase_1_1PhaseField.html#afe08f3c4509a459e08932ed2c17cf21c">openphase::PhaseField::CurvaturePhaseDR</a></div><div class="ttdeci">double CurvaturePhaseDR(const int i, const int j, const int k, const size_t Index) const</div><div class="ttdoc">Curvature for each thermodynamic phase VTK output.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d26/PhaseField_8cpp_source.html#l03444">PhaseField.cpp:3444</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a7f54d22dc59afcace6359f599fabcaac" name="a7f54d22dc59afcace6359f599fabcaac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f54d22dc59afcace6359f599fabcaac">&#9670;&#160;</a></span>advectable</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::OPObject::advectable = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>True if the object has non-empty <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a14459aef7e8f81944069f7aa68793864" title="Advects phase-field when no LB solver is used.">Advect()</a> method. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d1c/OPObject_8h_source.html#l00060">60</a> of file <a class="el" href="../../d5/d1c/OPObject_8h_source.html">OPObject.h</a>.</p>

</div>
</div>
<a id="a49a9d1e352e5dafc93f493012d527ee1" name="a49a9d1e352e5dafc93f493012d527ee1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49a9d1e352e5dafc93f493012d527ee1">&#9670;&#160;</a></span>boundary_conditions</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::OPObject::boundary_conditions = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>True if the object has non-empty <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a825ae7162676d2a690c3e072d0a49581" title="Set boundary conditions.">SetBoundaryConditions()</a> </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d1c/OPObject_8h_source.html#l00062">62</a> of file <a class="el" href="../../d5/d1c/OPObject_8h_source.html">OPObject.h</a>.</p>

</div>
</div>
<a id="aa63bc774f077e754f035dc1602e80574" name="aa63bc774f077e754f035dc1602e80574"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa63bc774f077e754f035dc1602e80574">&#9670;&#160;</a></span>Combine</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;bool&gt; openphase::PhaseField::Combine</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Indicates which phase's phase fields should be combined. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/dc5/PhaseField_8h_source.html#l00333">333</a> of file <a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a>.</p>

</div>
</div>
<a id="aae9497091c72d48f9c660f24a4b4749b" name="aae9497091c72d48f9c660f24a4b4749b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae9497091c72d48f9c660f24a4b4749b">&#9670;&#160;</a></span>ConsiderNucleusVolume</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::PhaseField::ConsiderNucleusVolume</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/dc5/PhaseField_8h_source.html#l00244">244</a> of file <a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a>.</p>

</div>
</div>
<a id="aebd94a373c8ff15a6ca2296c8db48e18" name="aebd94a373c8ff15a6ca2296c8db48e18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebd94a373c8ff15a6ca2296c8db48e18">&#9670;&#160;</a></span>Fields</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; <a class="el" href="../../da/ddf/classopenphase_1_1NodePF.html">NodePF</a>, 0 &gt; openphase::PhaseField::Fields</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Phase-field storage. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/dc5/PhaseField_8h_source.html#l00253">253</a> of file <a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a>.</p>

</div>
</div>
<a id="ae462950f95d4fc9a10834b300a721627" name="ae462950f95d4fc9a10834b300a721627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae462950f95d4fc9a10834b300a721627">&#9670;&#160;</a></span>FieldsAdvectionBackup</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; <a class="el" href="../../da/ddf/classopenphase_1_1NodePF.html">NodePF</a>, 0 &gt; openphase::PhaseField::FieldsAdvectionBackup</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Phase-field backup storage for advection. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/dc5/PhaseField_8h_source.html#l00257">257</a> of file <a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a>.</p>

</div>
</div>
<a id="abd10af2caa601ce82e2150bdc4d395b9" name="abd10af2caa601ce82e2150bdc4d395b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd10af2caa601ce82e2150bdc4d395b9">&#9670;&#160;</a></span>FieldsAdvectionDot</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; <a class="el" href="../../d8/d8b/classopenphase_1_1NodeA.html">NodeA</a>&lt;double&gt;, 0 &gt; openphase::PhaseField::FieldsAdvectionDot</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Phase-field storage for advection increments. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/dc5/PhaseField_8h_source.html#l00256">256</a> of file <a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a>.</p>

</div>
</div>
<a id="a3562565ae829ac5ed575324eb92ce1e8" name="a3562565ae829ac5ed575324eb92ce1e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3562565ae829ac5ed575324eb92ce1e8">&#9670;&#160;</a></span>FieldsDot</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; <a class="el" href="../../d3/dc0/classopenphase_1_1NodeAB.html">NodeAB</a>&lt;double,double&gt;, 0 &gt; openphase::PhaseField::FieldsDot</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Phase-field increments storage. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/dc5/PhaseField_8h_source.html#l00254">254</a> of file <a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a>.</p>

</div>
</div>
<a id="a751e2803a23026fbb7e4b0b2c7673391" name="a751e2803a23026fbb7e4b0b2c7673391"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a751e2803a23026fbb7e4b0b2c7673391">&#9670;&#160;</a></span>FieldsDotDR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; <a class="el" href="../../d3/dc0/classopenphase_1_1NodeAB.html">NodeAB</a>&lt;double,double&gt;, 0 &gt; openphase::PhaseField::FieldsDotDR</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Phase-field increments storage for double resolution mode. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/dc5/PhaseField_8h_source.html#l00260">260</a> of file <a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a>.</p>

</div>
</div>
<a id="a81113f3bf9c388a9ac8e31861902c40b" name="a81113f3bf9c388a9ac8e31861902c40b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81113f3bf9c388a9ac8e31861902c40b">&#9670;&#160;</a></span>FieldsDR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; <a class="el" href="../../da/ddf/classopenphase_1_1NodePF.html">NodePF</a>, 0 &gt; openphase::PhaseField::FieldsDR</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Phase-field storage for double resolution mode. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/dc5/PhaseField_8h_source.html#l00259">259</a> of file <a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a>.</p>

</div>
</div>
<a id="aa2c57b6e85a5364094952fd5257be9c5" name="aa2c57b6e85a5364094952fd5257be9c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2c57b6e85a5364094952fd5257be9c5">&#9670;&#160;</a></span>FieldsProperties</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/d90/classopenphase_1_1GrainsProperties.html">GrainsProperties</a> openphase::PhaseField::FieldsProperties</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Phase fields properties. Contains information about location, velocity, orientation, volume, aggregate state etc. of each phase field. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/dc5/PhaseField_8h_source.html#l00249">249</a> of file <a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a>.</p>

</div>
</div>
<a id="a784a4bea9a5379192bdf4f12ab12cf10" name="a784a4bea9a5379192bdf4f12ab12cf10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a784a4bea9a5379192bdf4f12ab12cf10">&#9670;&#160;</a></span>Fractions</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; double, 1 &gt; openphase::PhaseField::Fractions</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Phase fractions storage. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/dc5/PhaseField_8h_source.html#l00251">251</a> of file <a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a>.</p>

</div>
</div>
<a id="a7f11e6f1f190ef9bb7e6c6013ec03101" name="a7f11e6f1f190ef9bb7e6c6013ec03101"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f11e6f1f190ef9bb7e6c6013ec03101">&#9670;&#160;</a></span>FractionsTotal</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; openphase::PhaseField::FractionsTotal</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Total phase fractions in the entire simulation domain. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/dc5/PhaseField_8h_source.html#l00241">241</a> of file <a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a>.</p>

</div>
</div>
<a id="a7514a5f0d25deb090526b0a71ca95132" name="a7514a5f0d25deb090526b0a71ca95132"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7514a5f0d25deb090526b0a71ca95132">&#9670;&#160;</a></span>Grid</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d18/classopenphase_1_1GridParameters.html">GridParameters</a> openphase::PhaseField::Grid</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simulation grid parameters. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/dc5/PhaseField_8h_source.html#l00226">226</a> of file <a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a>.</p>

</div>
</div>
<a id="a1f560b94dd8685e5f84363d403c5d495" name="a1f560b94dd8685e5f84363d403c5d495"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f560b94dd8685e5f84363d403c5d495">&#9670;&#160;</a></span>GStencil</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/da4/classopenphase_1_1GradientStencil.html">GradientStencil</a> openphase::PhaseField::GStencil</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gradient stencil. Uses user specified stencil as the basis. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/dc5/PhaseField_8h_source.html#l00247">247</a> of file <a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a>.</p>

</div>
</div>
<a id="aa112048d179026f359161b1f20e5e98e" name="aa112048d179026f359161b1f20e5e98e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa112048d179026f359161b1f20e5e98e">&#9670;&#160;</a></span>initialized</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::OPObject::initialized = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>True if obect's Initialize has been executed. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d1c/OPObject_8h_source.html#l00057">57</a> of file <a class="el" href="../../d5/d1c/OPObject_8h_source.html">OPObject.h</a>.</p>

</div>
</div>
<a id="a65ef7d7ae73be8f9a7fa626762c4937d" name="a65ef7d7ae73be8f9a7fa626762c4937d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65ef7d7ae73be8f9a7fa626762c4937d">&#9670;&#160;</a></span>input_read</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::OPObject::input_read = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>True if obect's <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a1a6511943316b1eebb1e5e345fc81588" title="Reads input from the file.">ReadInput()</a> has been executed. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d1c/OPObject_8h_source.html#l00058">58</a> of file <a class="el" href="../../d5/d1c/OPObject_8h_source.html">OPObject.h</a>.</p>

</div>
</div>
<a id="acff69bbd27278034e9ecce362211ff29" name="acff69bbd27278034e9ecce362211ff29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acff69bbd27278034e9ecce362211ff29">&#9670;&#160;</a></span>InterfaceNormalModel</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d6c/namespaceopenphase.html#a5148c5d7019baf33d0a115bcb065772c">InterfaceNormalModels</a> openphase::PhaseField::InterfaceNormalModel</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Model selector for the interface normal calculation. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/dc5/PhaseField_8h_source.html#l00232">232</a> of file <a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a>.</p>

</div>
</div>
<a id="a4099b0db42d5fcbf908eafe2a338032e" name="a4099b0db42d5fcbf908eafe2a338032e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4099b0db42d5fcbf908eafe2a338032e">&#9670;&#160;</a></span>LStencil</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d8/d86/classopenphase_1_1LaplacianStencil.html">LaplacianStencil</a> openphase::PhaseField::LStencil</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Laplacian stencil. Uses user specified stencil as the basis. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/dc5/PhaseField_8h_source.html#l00246">246</a> of file <a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a>.</p>

</div>
</div>
<a id="aaeea2220078792baa302dc4300807029" name="aaeea2220078792baa302dc4300807029"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaeea2220078792baa302dc4300807029">&#9670;&#160;</a></span>Nphases</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t openphase::PhaseField::Nphases</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of thermodynamic phases. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/dc5/PhaseField_8h_source.html#l00228">228</a> of file <a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a>.</p>

</div>
</div>
<a id="a80736ea4892c99f7a189d1138252be4b" name="a80736ea4892c99f7a189d1138252be4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80736ea4892c99f7a189d1138252be4b">&#9670;&#160;</a></span>NucleationPresent</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::PhaseField::NucleationPresent</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>True if there are nuclei of any phase, false otherwise. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/dc5/PhaseField_8h_source.html#l00243">243</a> of file <a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a>.</p>

</div>
</div>
<a id="a2f76b712f5418522f474928d17f453ef" name="a2f76b712f5418522f474928d17f453ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f76b712f5418522f474928d17f453ef">&#9670;&#160;</a></span>NucleusVolumeFactor</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::PhaseField::NucleusVolumeFactor</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Scales the critical nucleus volume. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/dc5/PhaseField_8h_source.html#l00230">230</a> of file <a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a>.</p>

</div>
</div>
<a id="a3390ad72b1d99545de2cb145cdc35118" name="a3390ad72b1d99545de2cb145cdc35118"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3390ad72b1d99545de2cb145cdc35118">&#9670;&#160;</a></span>PairwiseGrowthFactors</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d3/dc0/classopenphase_1_1NodeAB.html">NodeAB</a>&lt;double,double&gt; openphase::PhaseField::PairwiseGrowthFactors</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pairwise growth reduction factors to deal with stoichiometric and other constraints. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/dc5/PhaseField_8h_source.html#l00236">236</a> of file <a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a>.</p>

</div>
</div>
<a id="a18545778a21115cf2146d08dc86e2de4" name="a18545778a21115cf2146d08dc86e2de4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18545778a21115cf2146d08dc86e2de4">&#9670;&#160;</a></span>PhaseAggregateStates</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a545a7e1c8dca42c00f8f139a1913c61c">AggregateStates</a>&gt; openphase::PhaseField::PhaseAggregateStates</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Aggregate states of all phases. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/dc5/PhaseField_8h_source.html#l00239">239</a> of file <a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a>.</p>

</div>
</div>
<a id="a0c76a1996bda299c8471a126fb4f1f38" name="a0c76a1996bda299c8471a126fb4f1f38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c76a1996bda299c8471a126fb4f1f38">&#9670;&#160;</a></span>PhaseEquilibriumDensities</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; openphase::PhaseField::PhaseEquilibriumDensities</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Equilibrium densities for all phases. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/dc5/PhaseField_8h_source.html#l00240">240</a> of file <a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a>.</p>

</div>
</div>
<a id="a6d205eece17c945a4b51869b49184e1a" name="a6d205eece17c945a4b51869b49184e1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d205eece17c945a4b51869b49184e1a">&#9670;&#160;</a></span>PhaseFieldGradientStencil</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d6c/namespaceopenphase.html#a210cb929dad1ae2aed26a10365a10b3d">GradientStencils</a> openphase::PhaseField::PhaseFieldGradientStencil</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Phase-field gradient stencil selector. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/dc5/PhaseField_8h_source.html#l00234">234</a> of file <a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a>.</p>

</div>
</div>
<a id="a65cf354fce580b8677302a60babdc3b2" name="a65cf354fce580b8677302a60babdc3b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65cf354fce580b8677302a60babdc3b2">&#9670;&#160;</a></span>PhaseFieldLaplacianStencil</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d6c/namespaceopenphase.html#aa3d45caada142bcd6850f4ba4aebc678">LaplacianStencils</a> openphase::PhaseField::PhaseFieldLaplacianStencil</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Phase-field Laplacian stencil selector. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/dc5/PhaseField_8h_source.html#l00233">233</a> of file <a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a>.</p>

</div>
</div>
<a id="a00842a7df5798d0d7e5c677949ec5600" name="a00842a7df5798d0d7e5c677949ec5600"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00842a7df5798d0d7e5c677949ec5600">&#9670;&#160;</a></span>PhaseNames</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; openphase::PhaseField::PhaseNames</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Names of phases for subset selection. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/dc5/PhaseField_8h_source.html#l00238">238</a> of file <a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a>.</p>

</div>
</div>
<a id="aa5b7ff7b56e2d266c2fd59b620a1603b" name="aa5b7ff7b56e2d266c2fd59b620a1603b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5b7ff7b56e2d266c2fd59b620a1603b">&#9670;&#160;</a></span>readable</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::OPObject::readable = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>True if the object has non-empty <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a9e62b1271b2e4238f55d5aaaae201fcf" title="Read raw (binary) phase fields from the file named FileName.">Read()</a> method. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d1c/OPObject_8h_source.html#l00061">61</a> of file <a class="el" href="../../d5/d1c/OPObject_8h_source.html">OPObject.h</a>.</p>

</div>
</div>
<a id="a44d40bc5a3ef87d7c461b457e01091dd" name="a44d40bc5a3ef87d7c461b457e01091dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44d40bc5a3ef87d7c461b457e01091dd">&#9670;&#160;</a></span>remeshable</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool openphase::OPObject::remeshable = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>True if the object has non-empty <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html#a0f305e969f2b5970684ccf9f8752a669" title="Changes the mesh size while keeping the data.">Remesh()</a> method. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d1c/OPObject_8h_source.html#l00059">59</a> of file <a class="el" href="../../d5/d1c/OPObject_8h_source.html">OPObject.h</a>.</p>

</div>
</div>
<a id="a9006e8f49762d851b52708b363ba14f2" name="a9006e8f49762d851b52708b363ba14f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9006e8f49762d851b52708b363ba14f2">&#9670;&#160;</a></span>thisclassname</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string openphase::OPObject::thisclassname</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Object's implementation class name. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d1c/OPObject_8h_source.html#l00054">54</a> of file <a class="el" href="../../d5/d1c/OPObject_8h_source.html">OPObject.h</a>.</p>

</div>
</div>
<a id="ac8c040bdc306f76b58d5a79201e5df66" name="ac8c040bdc306f76b58d5a79201e5df66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8c040bdc306f76b58d5a79201e5df66">&#9670;&#160;</a></span>thisobjectname</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string openphase::OPObject::thisobjectname</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Object's name. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d1c/OPObject_8h_source.html#l00055">55</a> of file <a class="el" href="../../d5/d1c/OPObject_8h_source.html">OPObject.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../d9/dc5/PhaseField_8h_source.html">PhaseField.h</a></li>
<li><a class="el" href="../../d9/d26/PhaseField_8cpp_source.html">PhaseField.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Dec 17 2025 09:11:01 for OpenPhase by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
