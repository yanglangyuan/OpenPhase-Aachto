<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenPhase: openphase::Initializations Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">OpenPhase
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d0/d6c/namespaceopenphase.html">openphase</a></li><li class="navelem"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html">Initializations</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="../../d2/da1/classopenphase_1_1Initializations-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">openphase::Initializations Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &quot;<a class="el" href="../../df/db1/Initializations_8h_source.html">Initializations.h</a>&quot;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a6193d2120c279795f6bc2fe927eddfe3" id="r_a6193d2120c279795f6bc2fe927eddfe3"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#a6193d2120c279795f6bc2fe927eddfe3">Single</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, size_t PhaseIndex, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="memdesc:a6193d2120c279795f6bc2fe927eddfe3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a single space filling phase-field.  <br /></td></tr>
<tr class="separator:a6193d2120c279795f6bc2fe927eddfe3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adaa3e88b16f1ca0c9c299cb8f75212cd" id="r_adaa3e88b16f1ca0c9c299cb8f75212cd"><td class="memItemLeft" align="right" valign="top">static std::vector&lt; <a class="el" href="../../da/d9c/classopenphase_1_1iVector3.html">iVector3</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#adaa3e88b16f1ca0c9c299cb8f75212cd">QuasiRandomNuclei</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, size_t phaseIndex, <a class="el" href="../../da/d9c/classopenphase_1_1iVector3.html">iVector3</a> offset, <a class="el" href="../../da/d9c/classopenphase_1_1iVector3.html">iVector3</a> spacing, <a class="el" href="../../da/d9c/classopenphase_1_1iVector3.html">iVector3</a> deviation, double threshold=0.05, int seed=1)</td></tr>
<tr class="memdesc:adaa3e88b16f1ca0c9c299cb8f75212cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Plants grain nuclei on a regular grid with the given "offset" from the origin, "spacing" and local random "deviation" from the ideal grid position for each seed.  <br /></td></tr>
<tr class="separator:adaa3e88b16f1ca0c9c299cb8f75212cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef15494f9db14242504e99225aaf6b9f" id="r_aef15494f9db14242504e99225aaf6b9f"><td class="memItemLeft" align="right" valign="top">static std::vector&lt; <a class="el" href="../../da/d9c/classopenphase_1_1iVector3.html">iVector3</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#aef15494f9db14242504e99225aaf6b9f">QuasiRandomSpheres</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, int phaseIndex1, int phaseIndex2, int dist, double radius1, double radius2, double probabilityPhase1, int offset=0, int seed=1)</td></tr>
<tr class="memdesc:aef15494f9db14242504e99225aaf6b9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Populates spherical grains of two different phases on a regular grid with grid spacing "distance" and local random "offset" of each sphere.  <br /></td></tr>
<tr class="separator:aef15494f9db14242504e99225aaf6b9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1021dd2238e2f3cf8e7566b7f5ebecf0" id="r_a1021dd2238e2f3cf8e7566b7f5ebecf0"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#a1021dd2238e2f3cf8e7566b7f5ebecf0">RandomNuclei</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, const <a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;locSettings, size_t phaseIndex, size_t Nparticles, bool randomOrientation=true, bool randomVariants=false, std::string onPlane=&quot;No&quot;, int seed=1)</td></tr>
<tr class="separator:a1021dd2238e2f3cf8e7566b7f5ebecf0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf8aa9ab25944107f87dbe54acba7207" id="r_abf8aa9ab25944107f87dbe54acba7207"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#abf8aa9ab25944107f87dbe54acba7207">Ellipsoid</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, size_t PhaseIndex, double RadiusX, double RadiusY, double RadiusZ, double x0, double y0, double z0, <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="memdesc:abf8aa9ab25944107f87dbe54acba7207"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a spherical grain.  <br /></td></tr>
<tr class="separator:abf8aa9ab25944107f87dbe54acba7207"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6734bf513d2a343979b02dad880605d0" id="r_a6734bf513d2a343979b02dad880605d0"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#a6734bf513d2a343979b02dad880605d0">SectionalPlane</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, const size_t PhaseIndex, const <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> Point, const <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> Orientation, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, const bool NewGrain=true, const size_t FieldIndex=0)</td></tr>
<tr class="memdesc:a6734bf513d2a343979b02dad880605d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a new phase on the negative side of a sectional plane.  <br /></td></tr>
<tr class="separator:a6734bf513d2a343979b02dad880605d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05603e6b4a9f4831c913e083fd62e000" id="r_a05603e6b4a9f4831c913e083fd62e000"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#a05603e6b4a9f4831c913e083fd62e000">Layer</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, size_t PhaseIndex, const <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> position, const <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> orientation, double thickness, <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="memdesc:a05603e6b4a9f4831c913e083fd62e000"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a layer with thickness of PhaseIndex with orientation at position.  <br /></td></tr>
<tr class="separator:a05603e6b4a9f4831c913e083fd62e000"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8127e68e3549a12584b2f55f580e494c" id="r_a8127e68e3549a12584b2f55f580e494c"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#a8127e68e3549a12584b2f55f580e494c">Sphere</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, const size_t PhaseIndex, const double Radius, double x0, double y0, double z0, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, const bool Finalize=true)</td></tr>
<tr class="memdesc:a8127e68e3549a12584b2f55f580e494c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a spherical grain.  <br /></td></tr>
<tr class="separator:a8127e68e3549a12584b2f55f580e494c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59d1c821a077d34464a5572661922e0c" id="r_a59d1c821a077d34464a5572661922e0c"><td class="memItemLeft" align="right" valign="top">static std::vector&lt; size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#a59d1c821a077d34464a5572661922e0c">Fractional</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, size_t MajorityPhaseIndex, size_t MinorityPhaseIndex, double MinorityPhaseLayerThickness, <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="memdesc:a59d1c821a077d34464a5572661922e0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">?? TODO  <br /></td></tr>
<tr class="separator:a59d1c821a077d34464a5572661922e0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab795c3359d3a9fbd77959400101b7580" id="r_ab795c3359d3a9fbd77959400101b7580"><td class="memItemLeft" align="right" valign="top">static std::vector&lt; size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#ab795c3359d3a9fbd77959400101b7580">ThreeFractionals</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, size_t MajorityPhaseIndex, double MajorityPhaseLayerThickness, size_t MinorityPhaseIndex1, double MinorityPhaseLayerThickness1, size_t MinorityPhaseIndex2, <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="memdesc:ab795c3359d3a9fbd77959400101b7580"><td class="mdescLeft">&#160;</td><td class="mdescRight">?? TODO  <br /></td></tr>
<tr class="separator:ab795c3359d3a9fbd77959400101b7580"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a821f2862de799edd30203e226bda0a77" id="r_a821f2862de799edd30203e226bda0a77"><td class="memItemLeft" align="right" valign="top">static std::vector&lt; size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#a821f2862de799edd30203e226bda0a77">TwoDifferentWalls</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, size_t ChannelPhaseIndex, size_t WallsPhaseIndex, double WallsThickness, <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="separator:a821f2862de799edd30203e226bda0a77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a0a30cc938c92f1085dfc35a623e5fb" id="r_a9a0a30cc938c92f1085dfc35a623e5fb"><td class="memItemLeft" align="right" valign="top">static std::vector&lt; size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#a9a0a30cc938c92f1085dfc35a623e5fb">TwoWalls</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, size_t ChannelPhaseIndex, size_t WallsPhaseIndex, double WallsThickness, <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="separator:a9a0a30cc938c92f1085dfc35a623e5fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a299918f9104019121b5316cfe616d7b4" id="r_a299918f9104019121b5316cfe616d7b4"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#a299918f9104019121b5316cfe616d7b4">Rectangular</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, const size_t PhaseIndex, const double Lx, const double Ly, const double Lz, const double x0, const double y0, const double z0, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, const bool Finalize=true)</td></tr>
<tr class="memdesc:a299918f9104019121b5316cfe616d7b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a rectangular grain.  <br /></td></tr>
<tr class="separator:a299918f9104019121b5316cfe616d7b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6c3ad55457d9664ae9798150c0f0d77" id="r_ab6c3ad55457d9664ae9798150c0f0d77"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#ab6c3ad55457d9664ae9798150c0f0d77">Cylinder</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, const size_t PhaseIndex, const double Radius, const double length, const int Axis, const double x0, const double y0, const double z0, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="memdesc:ab6c3ad55457d9664ae9798150c0f0d77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a cylindrical grain.  <br /></td></tr>
<tr class="separator:ab6c3ad55457d9664ae9798150c0f0d77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a319d7506beac5a71b6011d2e6d110488" id="r_a319d7506beac5a71b6011d2e6d110488"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#a319d7506beac5a71b6011d2e6d110488">FillGrainWithSpheres</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, size_t ParrentPhaseFieldIndex, size_t SpheresPhaseIndex, double MinR, double MaxR, <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, size_t Nspheres=0, double MinDistance=-1)</td></tr>
<tr class="memdesc:a319d7506beac5a71b6011d2e6d110488"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fills grain "loosely" with spheres spaced MinDistance apart Fills rectangular domain densely with spherical grains of normal distributed size.  <br /></td></tr>
<tr class="separator:a319d7506beac5a71b6011d2e6d110488"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0003060825e12ee11bca3375fe32dedf" id="r_a0003060825e12ee11bca3375fe32dedf"><td class="memItemLeft" align="right" valign="top">static std::vector&lt; size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#a0003060825e12ee11bca3375fe32dedf">FillRectangularWithSpheres</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, const <a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;locSettings, std::function&lt; size_t(long int, long int, long int)&gt; PhaseIndex, double MeanRadius, double StdRadius, long int x_min, long int x_max, long int y_min, long int y_max, long int z_min, long int z_max, double MinDistance, size_t RandomSeedInput, bool Verbose=true)</td></tr>
<tr class="memdesc:a0003060825e12ee11bca3375fe32dedf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fills rectangular domain densely with spherical grains of normal distributed size. Fills rectangular domain densely with spherical grains of normal distributed size with specified relative density.  <br /></td></tr>
<tr class="separator:a0003060825e12ee11bca3375fe32dedf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e8b15a36d12c6e2e5c42dafb2e601ad" id="r_a0e8b15a36d12c6e2e5c42dafb2e601ad"><td class="memItemLeft" align="right" valign="top">static std::vector&lt; size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#a0e8b15a36d12c6e2e5c42dafb2e601ad">RectangularGreenBody</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, const <a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;locSettings, std::function&lt; size_t(long, long, long)&gt; SolidPhaseIndex, size_t FluidPhaseIndex, long SizeX, long SizeY, long SizeZ, double MeanRadius, double StdRadius, size_t RandomSeed, double RelativeDensity, double accuracy=0.001, size_t MaxItrations=100)</td></tr>
<tr class="separator:a0e8b15a36d12c6e2e5c42dafb2e601ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04e0312614d4d0f6354bbc18baf9bfff" id="r_a04e0312614d4d0f6354bbc18baf9bfff"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#a04e0312614d4d0f6354bbc18baf9bfff">SphereInGrain</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, const size_t ParrentPhaseFieldIndex, const size_t PhaseIndex, const double Radius, const double x0, const double y0, const double z0, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, const bool Finalize=true)</td></tr>
<tr class="separator:a04e0312614d4d0f6354bbc18baf9bfff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2fc49e92ceeae81766954b71ca744ac" id="r_af2fc49e92ceeae81766954b71ca744ac"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#af2fc49e92ceeae81766954b71ca744ac">TwoDimEBSD</a> (std::string filename, std::vector&lt; int &gt; columns, <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="memdesc:af2fc49e92ceeae81766954b71ca744ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads microstructure from EBSD result files.  <br /></td></tr>
<tr class="separator:af2fc49e92ceeae81766954b71ca744ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99d0f6d1ac078e97382e3835d1eb0ea0" id="r_a99d0f6d1ac078e97382e3835d1eb0ea0"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#a99d0f6d1ac078e97382e3835d1eb0ea0">TwoDimEBSDWithOrientations</a> (std::string filename, std::vector&lt; int &gt; columns, std::string anglerepresentation, <a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, <a class="el" href="../../d2/de8/classopenphase_1_1ElasticProperties.html">ElasticProperties</a> &amp;EP, <a class="el" href="../../d0/df3/classopenphase_1_1Orientations.html">Orientations</a> &amp;OR, <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="memdesc:a99d0f6d1ac078e97382e3835d1eb0ea0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads microstructure from EBSD result files.  <br /></td></tr>
<tr class="separator:a99d0f6d1ac078e97382e3835d1eb0ea0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1a0cbb18fe4523334870d2d631e1e69" id="r_aa1a0cbb18fe4523334870d2d631e1e69"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#aa1a0cbb18fe4523334870d2d631e1e69">VoronoiTessellation</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, const size_t seedpoints, const size_t matrixphase)</td></tr>
<tr class="memdesc:aa1a0cbb18fe4523334870d2d631e1e69"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates Voronoi grain structures using the algorithm based on coordination shells.  <br /></td></tr>
<tr class="separator:aa1a0cbb18fe4523334870d2d631e1e69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8351b0e360482ac0dca89e41b2863b68" id="r_a8351b0e360482ac0dca89e41b2863b68"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#a8351b0e360482ac0dca89e41b2863b68">TripleJunction</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, size_t PhaseIndex, <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="separator:a8351b0e360482ac0dca89e41b2863b68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a128f6f13a01a0358bf4903026d50cae7" id="r_a128f6f13a01a0358bf4903026d50cae7"><td class="memItemLeft" align="right" valign="top">static std::vector&lt; size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#a128f6f13a01a0358bf4903026d50cae7">Young3</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, size_t alpha, size_t beta, size_t gamma, size_t delta, <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="separator:a128f6f13a01a0358bf4903026d50cae7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d99cbf6ca074c5de9bcedcaaa9fe9f9" id="r_a7d99cbf6ca074c5de9bcedcaaa9fe9f9"><td class="memItemLeft" align="right" valign="top">static std::vector&lt; size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#a7d99cbf6ca074c5de9bcedcaaa9fe9f9">Young4</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, size_t alpha, size_t beta, size_t gamma, size_t delta, <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="separator:a7d99cbf6ca074c5de9bcedcaaa9fe9f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf0a337a75548672e4ca7f73fbf0e2e7" id="r_aaf0a337a75548672e4ca7f73fbf0e2e7"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#aaf0a337a75548672e4ca7f73fbf0e2e7">Young4Periodic</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, size_t PhaseIndex, <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="separator:aaf0a337a75548672e4ca7f73fbf0e2e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a044e8d01b134de2a1a41d897967e099d" id="r_a044e8d01b134de2a1a41d897967e099d"><td class="memItemLeft" align="right" valign="top">static std::vector&lt; size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#a044e8d01b134de2a1a41d897967e099d">ThermalGrooving</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, size_t PhaseIndex1, size_t PhaseIndex2, <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="separator:a044e8d01b134de2a1a41d897967e099d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6eefb969b6510a77019b14a44450a0c7" id="r_a6eefb969b6510a77019b14a44450a0c7"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#a6eefb969b6510a77019b14a44450a0c7">Read</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, std::string FileInputName, <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="separator:a6eefb969b6510a77019b14a44450a0c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f58993d5f0946a99c22f082add441c7" id="r_a2f58993d5f0946a99c22f082add441c7"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#a2f58993d5f0946a99c22f082add441c7">ReadCSV</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, std::filesystem::path FilePath, char Separator=',')</td></tr>
<tr class="separator:a2f58993d5f0946a99c22f082add441c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24ce5290a304d40488c8271ec62d086d" id="r_a24ce5290a304d40488c8271ec62d086d"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:a24ce5290a304d40488c8271ec62d086d"><td class="memTemplItemLeft" align="right" valign="top">static void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#a24ce5290a304d40488c8271ec62d086d">ApplyPeriodicBoundaryConditionsOnCoordinates</a> (T &amp;i, T &amp;j, T &amp;k, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC, const <a class="el" href="../../dc/d18/classopenphase_1_1GridParameters.html">GridParameters</a> &amp;Dimensions)</td></tr>
<tr class="memdesc:a24ce5290a304d40488c8271ec62d086d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates global coordinates from local mpi coordinates.  <br /></td></tr>
<tr class="separator:a24ce5290a304d40488c8271ec62d086d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0941daec2114981ee0cc049c2263b29b" id="r_a0941daec2114981ee0cc049c2263b29b"><td class="memTemplParams" colspan="2">template&lt;typename T , typename field_t &gt; </td></tr>
<tr class="memitem:a0941daec2114981ee0cc049c2263b29b"><td class="memTemplItemLeft" align="right" valign="top">static bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#a0941daec2114981ee0cc049c2263b29b">CoordinatesInBoundaries</a> (T &amp;i, T &amp;j, T &amp;k, const field_t &amp;field, const <a class="el" href="../../dc/d18/classopenphase_1_1GridParameters.html">GridParameters</a> &amp;Dimensions)</td></tr>
<tr class="memdesc:a0941daec2114981ee0cc049c2263b29b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if (i,j,k) is the.  <br /></td></tr>
<tr class="separator:a0941daec2114981ee0cc049c2263b29b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad00a0106bc9c6f3d9d62bf4677d10ac4" id="r_ad00a0106bc9c6f3d9d62bf4677d10ac4"><td class="memTemplParams" colspan="2">template&lt;class T , size_t Rank&gt; </td></tr>
<tr class="memitem:ad00a0106bc9c6f3d9d62bf4677d10ac4"><td class="memTemplItemLeft" align="right" valign="top">static void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#ad00a0106bc9c6f3d9d62bf4677d10ac4">loop_sphere</a> (<a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; T, Rank &gt; &amp;field, const std::function&lt; bool(long int, long int, long int, double)&gt; &amp;func, const double x0, const double y0, const double z0, const double radius, <a class="el" href="../../dc/d18/classopenphase_1_1GridParameters.html">GridParameters</a> &amp;Dimensions, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="memdesc:ad00a0106bc9c6f3d9d62bf4677d10ac4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Loops over all points (i,j,k) of a sphere with radius at (x0,y0,z0) and executes func(i,j,k,radius)  <br /></td></tr>
<tr class="separator:ad00a0106bc9c6f3d9d62bf4677d10ac4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39027ba28c799d4d34f9c3e60306faaa" id="r_a39027ba28c799d4d34f9c3e60306faaa"><td class="memTemplParams" colspan="2">template&lt;class T , size_t Rank&gt; </td></tr>
<tr class="memitem:a39027ba28c799d4d34f9c3e60306faaa"><td class="memTemplItemLeft" align="right" valign="top">static bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#a39027ba28c799d4d34f9c3e60306faaa">loop_sphere_with_exit</a> (<a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; T, Rank &gt; &amp;field, const std::function&lt; bool(long int, long int, long int, double)&gt; &amp;func, const double x0, const double y0, const double z0, const double radius, const <a class="el" href="../../dc/d18/classopenphase_1_1GridParameters.html">GridParameters</a> &amp;Dimensions, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="memdesc:a39027ba28c799d4d34f9c3e60306faaa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Loops over all points (i,j,k) of a sphere with radius at (x0,y0,z0) and executes func(i,j,k,radius) Exits loop when func(i,j,k,radius) return true.  <br /></td></tr>
<tr class="separator:a39027ba28c799d4d34f9c3e60306faaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-attribs" name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a430c428a01443e146ef506a3305998a2" id="r_a430c428a01443e146ef506a3305998a2"><td class="memItemLeft" align="right" valign="top">static constexpr auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#a430c428a01443e146ef506a3305998a2">thisclassname</a> = &quot;Initializations&quot;</td></tr>
<tr class="separator:a430c428a01443e146ef506a3305998a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-static-methods" name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:aeb2d29324b962a37875a9269b8e69fe8" id="r_aeb2d29324b962a37875a9269b8e69fe8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dee/classopenphase_1_1Initializations.html#aeb2d29324b962a37875a9269b8e69fe8">SphereFixedIdx</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, size_t PhaseIndex, double Radius, double x0, double y0, double z0, <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="separator:aeb2d29324b962a37875a9269b8e69fe8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="../../df/db1/Initializations_8h_source.html#l00044">44</a> of file <a class="el" href="../../df/db1/Initializations_8h_source.html">Initializations.h</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a24ce5290a304d40488c8271ec62d086d" name="a24ce5290a304d40488c8271ec62d086d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24ce5290a304d40488c8271ec62d086d">&#9670;&#160;</a></span>ApplyPeriodicBoundaryConditionsOnCoordinates()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void openphase::Initializations::ApplyPeriodicBoundaryConditionsOnCoordinates </td>
          <td>(</td>
          <td class="paramtype">T &amp;&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T &amp;&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T &amp;&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../dc/d18/classopenphase_1_1GridParameters.html">GridParameters</a> &amp;&#160;</td>
          <td class="paramname"><em>Dimensions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates global coordinates from local mpi coordinates. </p>

<p class="definition">Definition at line <a class="el" href="../../df/db1/Initializations_8h_source.html#l00165">165</a> of file <a class="el" href="../../df/db1/Initializations_8h_source.html">Initializations.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  167</span>    {</div>
<div class="line"><span class="lineno">  168</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno">  169</span>        <span class="keywordflow">if</span> (BC.MPIperiodicX or BC.BCNX == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>) <span class="keywordflow">while</span> (i &gt;= Dimensions.TotalNx) i -= Dimensions.TotalNx;</div>
<div class="line"><span class="lineno">  170</span>        <span class="keywordflow">if</span> (BC.MPIperiodicY or BC.BCNY == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>) <span class="keywordflow">while</span> (j &gt;= Dimensions.TotalNy) j -= Dimensions.TotalNy;</div>
<div class="line"><span class="lineno">  171</span>        <span class="keywordflow">if</span> (BC.MPIperiodicZ or BC.BCNZ == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>) <span class="keywordflow">while</span> (k &gt;= Dimensions.TotalNz) k -= Dimensions.TotalNz;</div>
<div class="line"><span class="lineno">  172</span>        <span class="keywordflow">if</span> (BC.MPIperiodicX or BC.BC0X == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>) <span class="keywordflow">while</span> (i &lt;  0) i += Dimensions.TotalNx;</div>
<div class="line"><span class="lineno">  173</span>        <span class="keywordflow">if</span> (BC.MPIperiodicY or BC.BC0Y == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>) <span class="keywordflow">while</span> (j &lt;  0) j += Dimensions.TotalNy;</div>
<div class="line"><span class="lineno">  174</span>        <span class="keywordflow">if</span> (BC.MPIperiodicZ or BC.BC0Z == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>) <span class="keywordflow">while</span> (k &lt;  0) k += Dimensions.TotalNz;</div>
<div class="line"><span class="lineno">  175</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  176</span>        <span class="keywordflow">if</span> (BC.BCNX == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>) <span class="keywordflow">while</span> (i &gt;= Dimensions.Nx) i -= Dimensions.Nx;</div>
<div class="line"><span class="lineno">  177</span>        <span class="keywordflow">if</span> (BC.BCNY == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>) <span class="keywordflow">while</span> (j &gt;= Dimensions.Ny) j -= Dimensions.Ny;</div>
<div class="line"><span class="lineno">  178</span>        <span class="keywordflow">if</span> (BC.BCNZ == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>) <span class="keywordflow">while</span> (k &gt;= Dimensions.Nz) k -= Dimensions.Nz;</div>
<div class="line"><span class="lineno">  179</span>        <span class="keywordflow">if</span> (BC.BC0X == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>) <span class="keywordflow">while</span> (i &lt;  0) i += Dimensions.Nx;</div>
<div class="line"><span class="lineno">  180</span>        <span class="keywordflow">if</span> (BC.BC0Y == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>) <span class="keywordflow">while</span> (j &lt;  0) j += Dimensions.Ny;</div>
<div class="line"><span class="lineno">  181</span>        <span class="keywordflow">if</span> (BC.BC0Z == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>) <span class="keywordflow">while</span> (k &lt;  0) k += Dimensions.Nz;</div>
<div class="line"><span class="lineno">  182</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  183</span>    };</div>
<div class="ttc" id="anamespaceopenphase_html_a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">openphase::BoundaryConditionTypes::Periodic</a></div><div class="ttdeci">@ Periodic</div><div class="ttdoc">Periodic boundary condition.</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0941daec2114981ee0cc049c2263b29b" name="a0941daec2114981ee0cc049c2263b29b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0941daec2114981ee0cc049c2263b29b">&#9670;&#160;</a></span>CoordinatesInBoundaries()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename field_t &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool openphase::Initializations::CoordinatesInBoundaries </td>
          <td>(</td>
          <td class="paramtype">T &amp;&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T &amp;&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T &amp;&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const field_t &amp;&#160;</td>
          <td class="paramname"><em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../dc/d18/classopenphase_1_1GridParameters.html">GridParameters</a> &amp;&#160;</td>
          <td class="paramname"><em>Dimensions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks if (i,j,k) is the. </p>

<p class="definition">Definition at line <a class="el" href="../../df/db1/Initializations_8h_source.html#l00187">187</a> of file <a class="el" href="../../df/db1/Initializations_8h_source.html">Initializations.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  188</span>    {</div>
<div class="line"><span class="lineno">  189</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno">  190</span>        <span class="keywordflow">if</span> ((i &lt; Dimensions.OffsetX) or (i &gt;= Dimensions.OffsetX + field.sizeX())) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  191</span>        <span class="keywordflow">if</span> ((j &lt; Dimensions.OffsetY) or (j &gt;= Dimensions.OffsetY + field.sizeY())) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  192</span>        <span class="keywordflow">if</span> ((k &lt; Dimensions.OffsetZ) or (k &gt;= Dimensions.OffsetZ + field.sizeZ())) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  193</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  194</span>        <span class="keywordflow">if</span> ((i &lt; 0) or (i &gt;= field.sizeX())) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  195</span>        <span class="keywordflow">if</span> ((j &lt; 0) or (j &gt;= field.sizeY())) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  196</span>        <span class="keywordflow">if</span> ((k &lt; 0) or (k &gt;= field.sizeZ())) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  197</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  198</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  199</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab6c3ad55457d9664ae9798150c0f0d77" name="ab6c3ad55457d9664ae9798150c0f0d77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6c3ad55457d9664ae9798150c0f0d77">&#9670;&#160;</a></span>Cylinder()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t openphase::Initializations::Cylinder </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>PhaseIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>Radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Axis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>y0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>z0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initializes a cylindrical grain. </p>

<p class="definition">Definition at line <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html#l00961">961</a> of file <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html">Initializations.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  970</span>{</div>
<div class="line"><span class="lineno">  971</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> iWidth = (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Resolution == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>) ? 0.5*<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth : <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth;</div>
<div class="line"><span class="lineno">  972</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> locIndex = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.AddGrainInfo(PhaseIndex);</div>
<div class="line"><span class="lineno">  973</span> </div>
<div class="line"><span class="lineno">  974</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a71aed4b94e116454c7b11985a91e49ec">STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields.Bcells())</div>
<div class="line"><span class="lineno">  975</span>    {</div>
<div class="line"><span class="lineno">  976</span>        dVector3 pos__plane ({double(i+<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.OffsetX),double(j),double(k)});</div>
<div class="line"><span class="lineno">  977</span>        dVector3 pos0_plane ({double(x0),double(y0),double(z0)});</div>
<div class="line"><span class="lineno">  978</span>        dVector3 pos__axis  ({0,0,0});</div>
<div class="line"><span class="lineno">  979</span>        dVector3 pos0_axis  ({0,0,0});</div>
<div class="line"><span class="lineno">  980</span>        pos__axis [Axis] = pos__plane[Axis];</div>
<div class="line"><span class="lineno">  981</span>        pos0_axis [Axis] = pos0_plane[Axis];</div>
<div class="line"><span class="lineno">  982</span>        pos__plane[Axis] = 0;</div>
<div class="line"><span class="lineno">  983</span>        pos0_plane[Axis] = 0;</div>
<div class="line"><span class="lineno">  984</span> </div>
<div class="line"><span class="lineno">  985</span>        dVector3 dist_plane = Tools::Distance&lt;dVector3&gt;(pos__plane, pos0_plane, <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNx, <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNy, <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNz, BC);</div>
<div class="line"><span class="lineno">  986</span>        dVector3 dist_axis  = Tools::Distance&lt;dVector3&gt;(pos__axis,  pos0_axis , <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNx, <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNy, <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNz, BC);</div>
<div class="line"><span class="lineno">  987</span> </div>
<div class="line"><span class="lineno">  988</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> rad = dist_plane.abs();</div>
<div class="line"><span class="lineno">  989</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> z   = dist_axis.abs();</div>
<div class="line"><span class="lineno">  990</span> </div>
<div class="line"><span class="lineno">  991</span>        <span class="keywordflow">if</span> ((rad &lt; Radius - iWidth*0.5) and (z &lt; length/2 - iWidth*0.5))</div>
<div class="line"><span class="lineno">  992</span>        {</div>
<div class="line"><span class="lineno">  993</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).clear();</div>
<div class="line"><span class="lineno">  994</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).set_value(locIndex, 1.0);</div>
<div class="line"><span class="lineno">  995</span>        }</div>
<div class="line"><span class="lineno">  996</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((rad &lt;= Radius + iWidth*0.5) and (z &lt;= length/2 + iWidth*0.5))</div>
<div class="line"><span class="lineno">  997</span>        {</div>
<div class="line"><span class="lineno">  998</span>            <span class="keywordtype">double</span> IntProf = 0.0;</div>
<div class="line"><span class="lineno">  999</span>            <span class="keywordflow">if</span> (z &gt;= length/2 - iWidth*0.5 and ((rad - Radius) &lt;= (z - length/2)))</div>
<div class="line"><span class="lineno"> 1000</span>            {</div>
<div class="line"><span class="lineno"> 1001</span>                IntProf = 0.5 - 0.5*std::sin(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>*(z - length/2)/iWidth);</div>
<div class="line"><span class="lineno"> 1002</span>            }</div>
<div class="line"><span class="lineno"> 1003</span>            <span class="keywordflow">if</span> (rad &gt;= Radius - iWidth*0.5 and ((rad - Radius) &gt; (z - length/2)))</div>
<div class="line"><span class="lineno"> 1004</span>            {</div>
<div class="line"><span class="lineno"> 1005</span>                IntProf = 0.5 - 0.5*std::sin(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>*(rad - Radius)/iWidth);</div>
<div class="line"><span class="lineno"> 1006</span>            }</div>
<div class="line"><span class="lineno"> 1007</span> </div>
<div class="line"><span class="lineno"> 1008</span>            <span class="keywordflow">for</span>(<span class="keyword">auto</span> alpha = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).begin();</div>
<div class="line"><span class="lineno"> 1009</span>                     alpha &lt; <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).end(); alpha++)</div>
<div class="line"><span class="lineno"> 1010</span>            {</div>
<div class="line"><span class="lineno"> 1011</span>                alpha-&gt;value *= 1.0 - IntProf;</div>
<div class="line"><span class="lineno"> 1012</span>            }</div>
<div class="line"><span class="lineno"> 1013</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).set_value(locIndex, IntProf);</div>
<div class="line"><span class="lineno"> 1014</span>        }</div>
<div class="line"><span class="lineno"> 1015</span>    }</div>
<div class="line"><span class="lineno"> 1016</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a6ad2c83345f230517a1770304d7b39ad">STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 1017</span> </div>
<div class="line"><span class="lineno"> 1018</span>    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FinalizeInitialization(BC);</div>
<div class="line"><span class="lineno"> 1019</span>    <span class="keywordflow">return</span> locIndex;</div>
<div class="line"><span class="lineno"> 1020</span>}</div>
<div class="ttc" id="aMacros_8h_html_a6ad2c83345f230517a1770304d7b39ad"><div class="ttname"><a href="../../df/d0a/Macros_8h.html#a6ad2c83345f230517a1770304d7b39ad">STORAGE_LOOP_END</a></div><div class="ttdeci">#define STORAGE_LOOP_END</div><div class="ttdef"><b>Definition</b> <a href="../../df/d0a/Macros_8h_source.html#l00074">Macros.h:74</a></div></div>
<div class="ttc" id="aMacros_8h_html_a71aed4b94e116454c7b11985a91e49ec"><div class="ttname"><a href="../../df/d0a/Macros_8h.html#a71aed4b94e116454c7b11985a91e49ec">STORAGE_LOOP_BEGIN</a></div><div class="ttdeci">#define STORAGE_LOOP_BEGIN(i, j, k, T__, op_loop_bcells__)</div><div class="ttdef"><b>Definition</b> <a href="../../df/d0a/Macros_8h_source.html#l00053">Macros.h:53</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">openphase::Resolutions::Dual</a></div><div class="ttdeci">@ Dual</div><div class="ttdoc">Double resolution for phase fields.</div></div>
<div class="ttc" id="anamespaceopenphase_html_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">openphase::HeatSourceTypes::Phase</a></div><div class="ttdeci">@ Phase</div><div class="ttdoc">Selected phase will act as a heat source.</div></div>
<div class="ttc" id="anamespaceopenphase_html_a2c26ef9422df111d9487d3d34cf3d613"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">openphase::Pi</a></div><div class="ttdeci">static constexpr double Pi</div><div class="ttdoc">Pi constant value.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/df1/Globals_8h_source.html#l00124">Globals.h:124</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abf8aa9ab25944107f87dbe54acba7207" name="abf8aa9ab25944107f87dbe54acba7207"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf8aa9ab25944107f87dbe54acba7207">&#9670;&#160;</a></span>Ellipsoid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t openphase::Initializations::Ellipsoid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>PhaseIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RadiusX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RadiusY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RadiusZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initializes a spherical grain. </p>
<p>&lt; Inner ellipsoid</p>
<p>&lt; Outer ellipsoid</p>
<p>&lt; Point in the pure phase</p>
<p>&lt; remove all phase fields that may already be present</p>
<p>&lt; Point in the interface</p>

<p class="definition">Definition at line <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html#l00779">779</a> of file <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html">Initializations.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  784</span>{</div>
<div class="line"><span class="lineno">  785</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> iWidth = (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Resolution == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>) ? 0.5*<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth : <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth;</div>
<div class="line"><span class="lineno">  786</span>    <span class="keywordtype">size_t</span> index = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.AddGrainInfo(PhaseIndex);</div>
<div class="line"><span class="lineno">  787</span> </div>
<div class="line"><span class="lineno">  789</span>    <span class="keywordtype">double</span> Rxi = RadiusX - iWidth*0.5;</div>
<div class="line"><span class="lineno">  790</span>    <span class="keywordtype">double</span> Ryi = RadiusY - iWidth*0.5;</div>
<div class="line"><span class="lineno">  791</span>    <span class="keywordtype">double</span> Rzi = RadiusZ - iWidth*0.5;</div>
<div class="line"><span class="lineno">  793</span>    <span class="keywordtype">double</span> Rxo = RadiusX + iWidth*0.5;</div>
<div class="line"><span class="lineno">  794</span>    <span class="keywordtype">double</span> Ryo = RadiusY + iWidth*0.5;</div>
<div class="line"><span class="lineno">  795</span>    <span class="keywordtype">double</span> Rzo = RadiusZ + iWidth*0.5;</div>
<div class="line"><span class="lineno">  796</span> </div>
<div class="line"><span class="lineno">  797</span>    <span class="keywordtype">double</span> Rxi2 = Rxi*Rxi;</div>
<div class="line"><span class="lineno">  798</span>    <span class="keywordtype">double</span> Ryi2 = Ryi*Ryi;</div>
<div class="line"><span class="lineno">  799</span>    <span class="keywordtype">double</span> Rzi2 = Rzi*Rzi;</div>
<div class="line"><span class="lineno">  800</span> </div>
<div class="line"><span class="lineno">  801</span>    <span class="keywordtype">double</span> Rxo2 = Rxo*Rxo;</div>
<div class="line"><span class="lineno">  802</span>    <span class="keywordtype">double</span> Ryo2 = Ryo*Ryo;</div>
<div class="line"><span class="lineno">  803</span>    <span class="keywordtype">double</span> Rzo2 = Rzo*Rzo;</div>
<div class="line"><span class="lineno">  804</span> </div>
<div class="line"><span class="lineno">  805</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a71aed4b94e116454c7b11985a91e49ec">STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields.Bcells())</div>
<div class="line"><span class="lineno">  806</span>    {</div>
<div class="line"><span class="lineno">  807</span>        <span class="keywordtype">double</span> radX = (i+<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.OffsetX-x0);</div>
<div class="line"><span class="lineno">  808</span>        <span class="keywordtype">double</span> radY = (j+<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.OffsetY-y0);</div>
<div class="line"><span class="lineno">  809</span>        <span class="keywordtype">double</span> radZ = (k+<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.OffsetZ-z0);</div>
<div class="line"><span class="lineno">  810</span> </div>
<div class="line"><span class="lineno">  811</span>        <span class="keywordflow">if</span> ((radX*radX/Rxi2 + radY*radY/Ryi2 + radZ*radZ/Rzi2) &lt;= 1.0)  </div>
<div class="line"><span class="lineno">  812</span>        {</div>
<div class="line"><span class="lineno">  813</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).clear();     </div>
<div class="line"><span class="lineno">  814</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(index, 1.0);</div>
<div class="line"><span class="lineno">  815</span>        }</div>
<div class="line"><span class="lineno">  816</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((radX*radX/Rxo2 + radY*radY/Ryo2 + radZ*radZ/Rzo2) &lt;= 1.0)  </div>
<div class="line"><span class="lineno">  817</span>        {</div>
<div class="line"><span class="lineno">  818</span>            <span class="comment">// Find coordinates inside the interface</span></div>
<div class="line"><span class="lineno">  819</span>            <span class="keywordtype">double</span> r1 = -iWidth*0.5;</div>
<div class="line"><span class="lineno">  820</span>            <span class="keywordtype">double</span> r2 =  iWidth*0.5;</div>
<div class="line"><span class="lineno">  821</span>            <span class="keywordtype">double</span> rr = (r1 + r2)*0.5;</div>
<div class="line"><span class="lineno">  822</span>            <span class="keywordtype">double</span> tolerance = 1e-6;</div>
<div class="line"><span class="lineno">  823</span>            <span class="keywordflow">while</span> (fabs(r2 - r1) &gt; tolerance)</div>
<div class="line"><span class="lineno">  824</span>            {</div>
<div class="line"><span class="lineno">  825</span>                <span class="keywordflow">if</span>(<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a73a1d922b833a6751d42d498a7664028">PinE</a>(radX, radY, radZ, RadiusX+r1, RadiusY+r1, RadiusZ+r1) &gt; 0.0)</div>
<div class="line"><span class="lineno">  826</span>                   r1 += 0.25*(r2 - r1);</div>
<div class="line"><span class="lineno">  827</span>                <span class="keywordflow">else</span> r1 -= 0.25*(r2 - r1);</div>
<div class="line"><span class="lineno">  828</span>                <span class="keywordflow">if</span>(<a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a73a1d922b833a6751d42d498a7664028">PinE</a>(radX, radY, radZ, RadiusX+r2, RadiusY+r2, RadiusZ+r2) &lt; 0.0)</div>
<div class="line"><span class="lineno">  829</span>                    r2 -= 0.25*(r2 - r1);</div>
<div class="line"><span class="lineno">  830</span>                <span class="keywordflow">else</span> r2 += 0.25*(r2 - r1);</div>
<div class="line"><span class="lineno">  831</span> </div>
<div class="line"><span class="lineno">  832</span>                rr = (r1 + r2)*0.5;</div>
<div class="line"><span class="lineno">  833</span>            }</div>
<div class="line"><span class="lineno">  834</span> </div>
<div class="line"><span class="lineno">  835</span>            <span class="keywordtype">double</span> IntProf = 0.5 - 0.5*sin(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>*rr/iWidth);</div>
<div class="line"><span class="lineno">  836</span> </div>
<div class="line"><span class="lineno">  837</span>            <span class="keywordflow">for</span>(<span class="keyword">auto</span> alpha = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).begin();</div>
<div class="line"><span class="lineno">  838</span>                     alpha &lt; <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).end(); ++alpha)</div>
<div class="line"><span class="lineno">  839</span>            {</div>
<div class="line"><span class="lineno">  840</span>                alpha-&gt;value *= 1.0 - IntProf;</div>
<div class="line"><span class="lineno">  841</span>            }</div>
<div class="line"><span class="lineno">  842</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(index, IntProf);</div>
<div class="line"><span class="lineno">  843</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).flag = 2;</div>
<div class="line"><span class="lineno">  844</span>        }</div>
<div class="line"><span class="lineno">  845</span>    }</div>
<div class="line"><span class="lineno">  846</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a6ad2c83345f230517a1770304d7b39ad">STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  847</span> </div>
<div class="line"><span class="lineno">  848</span>    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FinalizeInitialization(BC);</div>
<div class="line"><span class="lineno">  849</span>    <span class="keywordflow">return</span> index;</div>
<div class="line"><span class="lineno">  850</span>}</div>
<div class="ttc" id="anamespaceopenphase_html_a73a1d922b833a6751d42d498a7664028"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a73a1d922b833a6751d42d498a7664028">openphase::PinE</a></div><div class="ttdeci">double PinE(const double x, const double y, const double z, const double a, const double b, const double c)</div><div class="ttdoc">Auxiliary function, check whether a point (x,y,z) lies within ellipsoid with axes a,...</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d3a/Initializations_8cpp_source.html#l00773">Initializations.cpp:773</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a319d7506beac5a71b6011d2e6d110488" name="a319d7506beac5a71b6011d2e6d110488"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a319d7506beac5a71b6011d2e6d110488">&#9670;&#160;</a></span>FillGrainWithSpheres()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t openphase::Initializations::FillGrainWithSpheres </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>ParrentPhaseFieldIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>SpheresPhaseIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>MinR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>MaxR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>Nspheres</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>MinDistance</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fills grain "loosely" with spheres spaced MinDistance apart Fills rectangular domain densely with spherical grains of normal distributed size. </p>

<p class="definition">Definition at line <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html#l01611">1611</a> of file <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html">Initializations.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1618</span>{</div>
<div class="line"><span class="lineno"> 1619</span>    <span class="keywordflow">if</span> (MinDistance &lt; 0.0) MinDistance = MinR;</div>
<div class="line"><span class="lineno"> 1620</span> </div>
<div class="line"><span class="lineno"> 1621</span>    vector&lt;iVector3&gt; spheres;</div>
<div class="line"><span class="lineno"> 1622</span>    vector&lt;double&gt; Radii;</div>
<div class="line"><span class="lineno"> 1623</span> </div>
<div class="line"><span class="lineno"> 1624</span>    <span class="keywordtype">int</span> counter = 0;</div>
<div class="line"><span class="lineno"> 1625</span>    <span class="keywordtype">int</span> globalCounter = 0;</div>
<div class="line"><span class="lineno"> 1626</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> MaxNumberOfTries = 10.0*(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNumberOfCells());</div>
<div class="line"><span class="lineno"> 1627</span> </div>
<div class="line"><span class="lineno"> 1628</span>    <span class="comment">//default_random_engine generator;</span></div>
<div class="line"><span class="lineno"> 1629</span>    std::random_device generator;</div>
<div class="line"><span class="lineno"> 1630</span>    <span class="comment">//std::mt19937_64 generator(rd());</span></div>
<div class="line"><span class="lineno"> 1631</span>    uniform_int_distribution&lt;int&gt; distributionX(0, (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNx-1));</div>
<div class="line"><span class="lineno"> 1632</span>    uniform_int_distribution&lt;int&gt; distributionY(0, (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNy-1));</div>
<div class="line"><span class="lineno"> 1633</span>    uniform_int_distribution&lt;int&gt; distributionZ(0, (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNz-1));</div>
<div class="line"><span class="lineno"> 1634</span>    uniform_real_distribution&lt;double&gt; distributionR(MinR, MaxR);</div>
<div class="line"><span class="lineno"> 1635</span> </div>
<div class="line"><span class="lineno"> 1636</span>    <span class="keywordflow">while</span>(counter &lt; MaxNumberOfTries)</div>
<div class="line"><span class="lineno"> 1637</span>    {</div>
<div class="line"><span class="lineno"> 1638</span>        <span class="keywordtype">int</span> i = distributionX(generator);</div>
<div class="line"><span class="lineno"> 1639</span>        <span class="keywordtype">int</span> j = distributionY(generator);</div>
<div class="line"><span class="lineno"> 1640</span>        <span class="keywordtype">int</span> k = distributionZ(generator);</div>
<div class="line"><span class="lineno"> 1641</span>        <span class="keywordtype">double</span> Radius  = distributionR(generator);</div>
<div class="line"><span class="lineno"> 1642</span><span class="preprocessor">        #ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 1643</span>        OP_MPI_Bcast(&amp;(i), 1, OP_MPI_INT, 0, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 1644</span>        OP_MPI_Bcast(&amp;(j), 1, OP_MPI_INT, 0, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 1645</span>        OP_MPI_Bcast(&amp;(k), 1, OP_MPI_INT, 0, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 1646</span>        OP_MPI_Bcast(&amp;(Radius), 1, OP_MPI_DOUBLE, 0, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 1647</span><span class="preprocessor">        #endif</span></div>
<div class="line"><span class="lineno"> 1648</span> </div>
<div class="line"><span class="lineno"> 1649</span>        <span class="keywordtype">bool</span> overlapping = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1650</span>        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> n = 0; n &lt; spheres.size(); n++)</div>
<div class="line"><span class="lineno"> 1651</span>        {</div>
<div class="line"><span class="lineno"> 1652</span>            <span class="keywordtype">double</span> distance = Tools::Distance&lt;iVector3&gt;({i,j,k}, spheres[n], <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNx, <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNy, <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNz, BC).abs();</div>
<div class="line"><span class="lineno"> 1653</span>            <span class="keywordflow">if</span>(distance &lt; Radius + Radii[n] + MinDistance) overlapping = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1654</span>        }</div>
<div class="line"><span class="lineno"> 1655</span> </div>
<div class="line"><span class="lineno"> 1656</span><span class="preprocessor">        #ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 1657</span>        <span class="keywordtype">double</span> locParentPhaseFraction = 0;</div>
<div class="line"><span class="lineno"> 1658</span>        <span class="keywordtype">double</span> ParentPhaseFraction = 0;</div>
<div class="line"><span class="lineno"> 1659</span>        <span class="keywordflow">if</span> (i &gt; <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.OffsetX and i &lt; <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.OffsetX + <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Nx)</div>
<div class="line"><span class="lineno"> 1660</span>        {</div>
<div class="line"><span class="lineno"> 1661</span>            locParentPhaseFraction = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i - <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.OffsetX, j, k).get_value(ParrentPhaseFieldIndex);</div>
<div class="line"><span class="lineno"> 1662</span>        }</div>
<div class="line"><span class="lineno"> 1663</span>        OP_MPI_Allreduce(&amp;(locParentPhaseFraction), &amp;(ParentPhaseFraction), 1, OP_MPI_DOUBLE, OP_MPI_SUM, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 1664</span><span class="preprocessor">        #else</span></div>
<div class="line"><span class="lineno"> 1665</span>            <span class="keywordtype">double</span> ParentPhaseFraction = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).get_value(ParrentPhaseFieldIndex);</div>
<div class="line"><span class="lineno"> 1666</span><span class="preprocessor">        #endif</span></div>
<div class="line"><span class="lineno"> 1667</span> </div>
<div class="line"><span class="lineno"> 1668</span>        <span class="keywordflow">if</span>(overlapping or ParentPhaseFraction &lt; 1.0)</div>
<div class="line"><span class="lineno"> 1669</span>        {</div>
<div class="line"><span class="lineno"> 1670</span>            counter++;</div>
<div class="line"><span class="lineno"> 1671</span>        }</div>
<div class="line"><span class="lineno"> 1672</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1673</span>        {</div>
<div class="line"><span class="lineno"> 1674</span>            <span class="keywordtype">size_t</span> sphereIndex =</div>
<div class="line"><span class="lineno"> 1675</span>            <a class="code hl_function" href="../../de/dee/classopenphase_1_1Initializations.html#a04e0312614d4d0f6354bbc18baf9bfff">SphereInGrain</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, ParrentPhaseFieldIndex, SpheresPhaseIndex,</div>
<div class="line"><span class="lineno"> 1676</span>                          Radius, i, j, k, BC, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1677</span>            spheres.push_back({i,j,k});</div>
<div class="line"><span class="lineno"> 1678</span>            Radii.push_back(Radius);</div>
<div class="line"><span class="lineno"> 1679</span>            stringstream message;</div>
<div class="line"><span class="lineno"> 1680</span>            message &lt;&lt; <span class="stringliteral">&quot;*********************************************************\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1681</span>            message &lt;&lt; <span class="stringliteral">&quot;after &quot;</span> &lt;&lt; counter &lt;&lt; <span class="stringliteral">&quot; tries sphere nr: &quot;</span></div>
<div class="line"><span class="lineno"> 1682</span>                    &lt;&lt; spheres.size() &lt;&lt; <span class="stringliteral">&quot; at (&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; k &lt;&lt;<span class="stringliteral">&quot;)&quot;</span></div>
<div class="line"><span class="lineno"> 1683</span>                    &lt;&lt; <span class="stringliteral">&quot; with R = &quot;</span> &lt;&lt; Radius&lt;&lt; <span class="stringliteral">&quot; and phase field index = &quot;</span></div>
<div class="line"><span class="lineno"> 1684</span>                    &lt;&lt; sphereIndex &lt;&lt; <span class="stringliteral">&quot; set.&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1685</span>            <span class="comment">//Phase.PrintPointStatistics(i,j,k); //NOTE: not mpi-parallel</span></div>
<div class="line"><span class="lineno"> 1686</span>            message &lt;&lt; <span class="stringliteral">&quot;*********************************************************\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1687</span>            <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a607154bed184a8633e4a43e37e98a4d9">ConsoleOutput::WriteSimple</a>(message.str());</div>
<div class="line"><span class="lineno"> 1688</span>            globalCounter += counter;</div>
<div class="line"><span class="lineno"> 1689</span>            counter = 0;</div>
<div class="line"><span class="lineno"> 1690</span> </div>
<div class="line"><span class="lineno"> 1691</span>            <span class="keywordflow">if</span>(Nspheres != 0 and spheres.size() == Nspheres)</div>
<div class="line"><span class="lineno"> 1692</span>            {</div>
<div class="line"><span class="lineno"> 1693</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1694</span>            }</div>
<div class="line"><span class="lineno"> 1695</span>        }</div>
<div class="line"><span class="lineno"> 1696</span>    }</div>
<div class="line"><span class="lineno"> 1697</span>    cout &lt;&lt; <span class="stringliteral">&quot;after &quot;</span> &lt;&lt; globalCounter &lt;&lt; <span class="stringliteral">&quot; tries &quot;</span> &lt;&lt; spheres.size()</div>
<div class="line"><span class="lineno"> 1698</span>         &lt;&lt; <span class="stringliteral">&quot; spheres could be initialized!\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1699</span> </div>
<div class="line"><span class="lineno"> 1700</span>    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FinalizeInitialization(BC);</div>
<div class="line"><span class="lineno"> 1701</span> </div>
<div class="line"><span class="lineno"> 1702</span>    <span class="keywordflow">return</span> spheres.size();</div>
<div class="line"><span class="lineno"> 1703</span>}</div>
<div class="ttc" id="aclassopenphase_1_1ConsoleOutput_html_a607154bed184a8633e4a43e37e98a4d9"><div class="ttname"><a href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a607154bed184a8633e4a43e37e98a4d9">openphase::ConsoleOutput::WriteSimple</a></div><div class="ttdeci">static void WriteSimple(const std::string Message)</div><div class="ttdef"><b>Definition</b> <a href="../../da/da0/ConsoleOutput_8cpp_source.html#l00140">ConsoleOutput.cpp:140</a></div></div>
<div class="ttc" id="aclassopenphase_1_1Initializations_html_a04e0312614d4d0f6354bbc18baf9bfff"><div class="ttname"><a href="../../de/dee/classopenphase_1_1Initializations.html#a04e0312614d4d0f6354bbc18baf9bfff">openphase::Initializations::SphereInGrain</a></div><div class="ttdeci">static size_t SphereInGrain(PhaseField &amp;Phase, const size_t ParrentPhaseFieldIndex, const size_t PhaseIndex, const double Radius, const double x0, const double y0, const double z0, const BoundaryConditions &amp;BC, const bool Finalize=true)</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d3a/Initializations_8cpp_source.html#l01576">Initializations.cpp:1576</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0003060825e12ee11bca3375fe32dedf" name="a0003060825e12ee11bca3375fe32dedf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0003060825e12ee11bca3375fe32dedf">&#9670;&#160;</a></span>FillRectangularWithSpheres()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; size_t &gt; openphase::Initializations::FillRectangularWithSpheres </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;&#160;</td>
          <td class="paramname"><em>locSettings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; size_t(long int, long int, long int)&gt;&#160;</td>
          <td class="paramname"><em>PhaseIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>MeanRadius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>StdRadius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>x_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>x_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>y_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>y_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>z_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>z_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>MinDistance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>RandomSeedInput</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>Verbose</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fills rectangular domain densely with spherical grains of normal distributed size. Fills rectangular domain densely with spherical grains of normal distributed size with specified relative density. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PhaseIndex</td><td>function that determines the phases of the grain which may depend on the position (i,j,k).  </td></tr>
    <tr><td class="paramname">MeanRadius</td><td>Mean radius of grains  </td></tr>
    <tr><td class="paramname">StdRadius</td><td>Standard deviation grain radius  </td></tr>
    <tr><td class="paramname">x_min</td><td>First x-index of rectangular  </td></tr>
    <tr><td class="paramname">x_max</td><td>Last x-index of rectangular  </td></tr>
    <tr><td class="paramname">y_min</td><td>First y-index of rectangular  </td></tr>
    <tr><td class="paramname">y_max</td><td>Last y-index of rectangular  </td></tr>
    <tr><td class="paramname">z_min</td><td>First a-index of rectangular  </td></tr>
    <tr><td class="paramname">z_max</td><td>Last z-index of rectangular  </td></tr>
    <tr><td class="paramname">MinDistance</td><td>Minimal distance of grains which can be negative for even denser microstructure!  </td></tr>
    <tr><td class="paramname">RandomSeedInput</td><td>Random number seed for initialization </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html#l01705">1705</a> of file <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html">Initializations.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1717</span>{</div>
<div class="line"><span class="lineno"> 1718</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> Nx = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNx;</div>
<div class="line"><span class="lineno"> 1719</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> Ny = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNy;</div>
<div class="line"><span class="lineno"> 1720</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> Nz = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNz;</div>
<div class="line"><span class="lineno"> 1721</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> MinRadius = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth/2;</div>
<div class="line"><span class="lineno"> 1722</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> MaxRadius = std::max(Nx/2, std::max(Ny/2, Nz/2));</div>
<div class="line"><span class="lineno"> 1723</span> </div>
<div class="line"><span class="lineno"> 1724</span>    <span class="keywordflow">if</span> (StdRadius &lt; 0.0)</div>
<div class="line"><span class="lineno"> 1725</span>    {</div>
<div class="line"><span class="lineno"> 1726</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a421faa2fe5d86991328b2b06041a326d">ConsoleOutput::WriteExit</a>(<span class="stringliteral">&quot;Standard deviation needs to be positive!&quot;</span>, <a class="code hl_variable" href="../../de/dee/classopenphase_1_1Initializations.html#a430c428a01443e146ef506a3305998a2">thisclassname</a>, <span class="stringliteral">&quot;FillWithSpheres&quot;</span>);</div>
<div class="line"><span class="lineno"> 1727</span>        <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a4d6fed4ab71c6edf2a0bd5dabecc6ec6">OP_Exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 1728</span>    }</div>
<div class="line"><span class="lineno"> 1729</span>    <span class="keywordflow">if</span> (MeanRadius &lt; MinRadius)</div>
<div class="line"><span class="lineno"> 1730</span>    {</div>
<div class="line"><span class="lineno"> 1731</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a421faa2fe5d86991328b2b06041a326d">ConsoleOutput::WriteExit</a>(<span class="stringliteral">&quot;The mean radius needs to be at least half the interface width!&quot;</span>, <a class="code hl_variable" href="../../de/dee/classopenphase_1_1Initializations.html#a430c428a01443e146ef506a3305998a2">thisclassname</a>, <span class="stringliteral">&quot;FillWithSpheres&quot;</span>);</div>
<div class="line"><span class="lineno"> 1732</span>        <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a4d6fed4ab71c6edf2a0bd5dabecc6ec6">OP_Exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 1733</span>    }</div>
<div class="line"><span class="lineno"> 1734</span>    <span class="keywordflow">if</span> (MeanRadius &gt; MaxRadius)</div>
<div class="line"><span class="lineno"> 1735</span>    {</div>
<div class="line"><span class="lineno"> 1736</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a421faa2fe5d86991328b2b06041a326d">ConsoleOutput::WriteExit</a>(<span class="stringliteral">&quot;The mean radius needs to be smaller than the simulation box!&quot;</span>, <a class="code hl_variable" href="../../de/dee/classopenphase_1_1Initializations.html#a430c428a01443e146ef506a3305998a2">thisclassname</a>, <span class="stringliteral">&quot;FillWithSpheres&quot;</span>);</div>
<div class="line"><span class="lineno"> 1737</span>        <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a4d6fed4ab71c6edf2a0bd5dabecc6ec6">OP_Exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 1738</span>    }</div>
<div class="line"><span class="lineno"> 1739</span> </div>
<div class="line"><span class="lineno"> 1740</span>    std::vector&lt;size_t&gt; SpheresIdx;</div>
<div class="line"><span class="lineno"> 1741</span>    std::mt19937_64 generator(RandomSeed);</div>
<div class="line"><span class="lineno"> 1742</span>    std::normal_distribution&lt;double&gt; radius_gen(MeanRadius,StdRadius);</div>
<div class="line"><span class="lineno"> 1743</span>    std::uniform_real_distribution&lt;double&gt; dist_01(0.0,1.0);</div>
<div class="line"><span class="lineno"> 1744</span>    std::uniform_real_distribution&lt;double&gt; phi_gen(0,2.0*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>);</div>
<div class="line"><span class="lineno"> 1745</span>    std::uniform_real_distribution&lt;double&gt; theta_gen(0,<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>);</div>
<div class="line"><span class="lineno"> 1746</span> </div>
<div class="line"><span class="lineno"> 1747</span>    <span class="keyword">auto</span> rand01 = std::bind(dist_01,generator);</div>
<div class="line"><span class="lineno"> 1748</span> </div>
<div class="line"><span class="lineno"> 1749</span>    Storage3D&lt;int,0&gt; Shielded(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid, 0);</div>
<div class="line"><span class="lineno"> 1750</span>    <span class="keyword">struct </span>Planted_t {<span class="keywordtype">int</span> x; <span class="keywordtype">int</span> y; <span class="keywordtype">int</span> z; <span class="keywordtype">double</span> radius;};</div>
<div class="line"><span class="lineno"> 1751</span>    std::vector&lt;Planted_t&gt; Planted;</div>
<div class="line"><span class="lineno"> 1752</span>    {</div>
<div class="line"><span class="lineno"> 1753</span>        <span class="comment">// Die solid radius</span></div>
<div class="line"><span class="lineno"> 1754</span>        <span class="keywordtype">double</span> radius = radius_gen(generator);</div>
<div class="line"><span class="lineno"> 1755</span><span class="preprocessor">        #ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 1756</span>        OP_MPI_Bcast(&amp;(radius), 1, OP_MPI_DOUBLE, 0, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 1757</span><span class="preprocessor">        #endif</span></div>
<div class="line"><span class="lineno"> 1758</span> </div>
<div class="line"><span class="lineno"> 1759</span>        <span class="keywordflow">while</span>(radius &lt; MinRadius or radius &gt; MaxRadius) radius = radius_gen(generator);</div>
<div class="line"><span class="lineno"> 1760</span> </div>
<div class="line"><span class="lineno"> 1761</span>        <span class="keywordflow">if</span> (Verbose) <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a41683f616ffa4631340cb0de41cad70f">ConsoleOutput::Write</a>(<span class="stringliteral">&quot;Plant initial Grain&quot;</span>);</div>
<div class="line"><span class="lineno"> 1762</span>        assert(radius &lt; MaxRadius);</div>
<div class="line"><span class="lineno"> 1763</span> </div>
<div class="line"><span class="lineno"> 1764</span>        <span class="comment">// Select random position inside boundaries</span></div>
<div class="line"><span class="lineno"> 1765</span>        Planted_t PInit;</div>
<div class="line"><span class="lineno"> 1766</span>        PInit.x = (Nx &gt; 1 ) ? x_min + rand01()*(x_max-x_min) : 0;</div>
<div class="line"><span class="lineno"> 1767</span>        PInit.y = (Ny &gt; 1 ) ? y_min + rand01()*(y_max-y_min) : 0;</div>
<div class="line"><span class="lineno"> 1768</span>        PInit.z = (Nz &gt; 1 ) ? z_min + rand01()*(z_max-z_min) : 0;</div>
<div class="line"><span class="lineno"> 1769</span>        PInit.radius = radius;</div>
<div class="line"><span class="lineno"> 1770</span> </div>
<div class="line"><span class="lineno"> 1771</span>        <span class="comment">// Check if simulation box is 2D</span></div>
<div class="line"><span class="lineno"> 1772</span>        <span class="keywordflow">while</span> (PInit.x &gt;= Nx) PInit.x -= Nx;</div>
<div class="line"><span class="lineno"> 1773</span>        <span class="keywordflow">while</span> (PInit.y &gt;= Ny) PInit.y -= Ny;</div>
<div class="line"><span class="lineno"> 1774</span>        <span class="keywordflow">while</span> (PInit.z &gt;= Nz) PInit.z -= Nz;</div>
<div class="line"><span class="lineno"> 1775</span>        <span class="keywordflow">while</span> (PInit.x &lt;   0) PInit.x += Nx;</div>
<div class="line"><span class="lineno"> 1776</span>        <span class="keywordflow">while</span> (PInit.y &lt;   0) PInit.y += Ny;</div>
<div class="line"><span class="lineno"> 1777</span>        <span class="keywordflow">while</span> (PInit.z &lt;   0) PInit.z += Nz;</div>
<div class="line"><span class="lineno"> 1778</span> </div>
<div class="line"><span class="lineno"> 1779</span>        <span class="comment">// Initialize phase-field</span></div>
<div class="line"><span class="lineno"> 1780</span><span class="preprocessor">        #ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 1781</span>        OP_MPI_Bcast(&amp;(PInit.x), 1, OP_MPI_DOUBLE, 0, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 1782</span>        OP_MPI_Bcast(&amp;(PInit.y), 1, OP_MPI_DOUBLE, 0, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 1783</span>        OP_MPI_Bcast(&amp;(PInit.z), 1, OP_MPI_DOUBLE, 0, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 1784</span><span class="preprocessor">        #endif</span></div>
<div class="line"><span class="lineno"> 1785</span>        Planted.push_back(PInit);</div>
<div class="line"><span class="lineno"> 1786</span> </div>
<div class="line"><span class="lineno"> 1787</span>        <span class="keyword">const</span> <span class="keywordtype">size_t</span> phaseIdx =  PhaseIndex(PInit.x, PInit.y, PInit.z);</div>
<div class="line"><span class="lineno"> 1788</span>        <span class="keyword">const</span> <span class="keywordtype">size_t</span> idx = <a class="code hl_function" href="../../de/dee/classopenphase_1_1Initializations.html#a8127e68e3549a12584b2f55f580e494c">Initializations::Sphere</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, phaseIdx, radius, PInit.x, PInit.y, PInit.z, BC, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1789</span>        SpheresIdx.push_back(idx);</div>
<div class="line"><span class="lineno"> 1790</span> </div>
<div class="line"><span class="lineno"> 1791</span>        <span class="comment">// Shield surrounding against places of other solid particles</span></div>
<div class="line"><span class="lineno"> 1792</span>        <span class="keyword">auto</span> set_shield = [&amp;Shielded](<span class="keywordtype">long</span> <span class="keywordtype">int</span> i,<span class="keywordtype">long</span> <span class="keywordtype">int</span> j,<span class="keywordtype">long</span> <span class="keywordtype">int</span> k, <span class="keywordtype">double</span> rad){Shielded(i,j,k) = <span class="keyword">true</span>; <span class="keywordflow">return</span> <span class="keyword">false</span>;};</div>
<div class="line"><span class="lineno"> 1793</span>        <a class="code hl_function" href="../../de/dee/classopenphase_1_1Initializations.html#ad00a0106bc9c6f3d9d62bf4677d10ac4">Initializations::loop_sphere</a>(Shielded, set_shield, PInit.x, PInit.y, PInit.z, radius + MinDistance/2.0, <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid, BC);</div>
<div class="line"><span class="lineno"> 1794</span> </div>
<div class="line"><span class="lineno"> 1795</span>        <span class="keywordflow">if</span> (Verbose) <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a41683f616ffa4631340cb0de41cad70f">ConsoleOutput::Write</a>(<span class="stringliteral">&quot;Planted number &quot;</span>, Planted.size());</div>
<div class="line"><span class="lineno"> 1796</span> </div>
<div class="line"><span class="lineno"> 1797</span>        <span class="keywordtype">size_t</span> i = 0;</div>
<div class="line"><span class="lineno"> 1798</span>        <span class="keywordflow">while</span>(i &lt; Planted.size())</div>
<div class="line"><span class="lineno"> 1799</span>        {</div>
<div class="line"><span class="lineno"> 1800</span>            <span class="keywordtype">size_t</span> N = 1000;<span class="comment">//4.0/3.0*M_PI*(std::pow(2*radius,3) - std::pow(radius,3));</span></div>
<div class="line"><span class="lineno"> 1801</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; N; j++)</div>
<div class="line"><span class="lineno"> 1802</span>            {</div>
<div class="line"><span class="lineno"> 1803</span>                radius = radius_gen(generator);</div>
<div class="line"><span class="lineno"> 1804</span><span class="preprocessor">                #ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 1805</span>                <span class="comment">//MPI_Bcast(&amp;(i),      1, MPI_INT, 0, MPI_COMM_WORLD);</span></div>
<div class="line"><span class="lineno"> 1806</span>                <span class="comment">//MPI_Bcast(&amp;(j),      1, MPI_INT, 0, MPI_COMM_WORLD);</span></div>
<div class="line"><span class="lineno"> 1807</span>                OP_MPI_Bcast(&amp;(radius), 1, OP_MPI_DOUBLE, 0, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 1808</span><span class="preprocessor">                #endif</span></div>
<div class="line"><span class="lineno"> 1809</span>                <span class="keywordflow">if</span> (radius &lt; MinRadius) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1810</span> </div>
<div class="line"><span class="lineno"> 1811</span>                <span class="comment">// Place new solid next to the old one</span></div>
<div class="line"><span class="lineno"> 1812</span>                <span class="keywordtype">double</span> phi   = phi_gen(generator);</div>
<div class="line"><span class="lineno"> 1813</span>                <span class="keywordtype">double</span> theta = theta_gen(generator);</div>
<div class="line"><span class="lineno"> 1814</span><span class="preprocessor">                #ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 1815</span>                OP_MPI_Bcast(&amp;(phi),   1, OP_MPI_DOUBLE, 0, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 1816</span>                OP_MPI_Bcast(&amp;(theta), 1, OP_MPI_DOUBLE, 0, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 1817</span><span class="preprocessor">                #endif</span></div>
<div class="line"><span class="lineno"> 1818</span> </div>
<div class="line"><span class="lineno"> 1819</span>                Planted_t PNew;</div>
<div class="line"><span class="lineno"> 1820</span>                PNew.x = (Nx &gt; 1) ? Planted[i].x + (Planted[i].radius+MinDistance+radius+3)*cos(phi)   : 0;<span class="comment">//*sin(theta);</span></div>
<div class="line"><span class="lineno"> 1821</span>                PNew.y = (Ny &gt; 1) ? Planted[i].y + (Planted[i].radius+MinDistance+radius+3)*sin(phi)   : 0;<span class="comment">//*sin(theta);</span></div>
<div class="line"><span class="lineno"> 1822</span>                PNew.z = (Nz &gt; 1) ? Planted[i].z + (Planted[i].radius+MinDistance+radius+3)*cos(theta) : 0;<span class="comment">//TODO z is too large</span></div>
<div class="line"><span class="lineno"> 1823</span>                PNew.radius = radius;</div>
<div class="line"><span class="lineno"> 1824</span>                <span class="comment">// Check if new solid is in simulation box</span></div>
<div class="line"><span class="lineno"> 1825</span>                <span class="keywordflow">if</span> (PNew.x &gt;= Nx) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1826</span>                <span class="keywordflow">if</span> (PNew.y &gt;= Ny) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1827</span>                <span class="keywordflow">if</span> (PNew.z &gt;= Nz) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1828</span>                <span class="keywordflow">if</span> (PNew.x &lt;   0) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1829</span>                <span class="keywordflow">if</span> (PNew.y &lt;   0) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1830</span>                <span class="keywordflow">if</span> (PNew.z &lt;   0) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1831</span> </div>
<div class="line"><span class="lineno"> 1832</span>                <span class="comment">// Check if floor and ceiling are not touched</span></div>
<div class="line"><span class="lineno"> 1833</span>                <span class="keywordflow">if</span> (x_min != 0  and PNew.x-PNew.radius &lt; x_min) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1834</span>                <span class="keywordflow">if</span> (x_max != Nx and PNew.x+PNew.radius &gt; x_max) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1835</span>                <span class="keywordflow">if</span> (y_min != 0  and PNew.y-PNew.radius &lt; y_min) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1836</span>                <span class="keywordflow">if</span> (y_max != Ny and PNew.y+PNew.radius &gt; y_max) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1837</span>                <span class="keywordflow">if</span> (z_min != 0  and PNew.z-PNew.radius &lt; z_min) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1838</span>                <span class="keywordflow">if</span> (z_max != Nz and PNew.z+PNew.radius &gt; z_max) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1839</span> </div>
<div class="line"><span class="lineno"> 1840</span>                <span class="comment">// Check if surrounding shielded against planting</span></div>
<div class="line"><span class="lineno"> 1841</span>                <span class="keyword">auto</span> check_shield = [&amp;Shielded](<span class="keywordtype">long</span> <span class="keywordtype">int</span> ii,<span class="keywordtype">long</span> <span class="keywordtype">int</span> jj,<span class="keywordtype">long</span> <span class="keywordtype">int</span> kk, <span class="keywordtype">double</span> rad){<span class="keywordflow">return</span> (Shielded(ii,jj,kk) == <span class="keyword">true</span>) ? <span class="keyword">true</span> : false;};</div>
<div class="line"><span class="lineno"> 1842</span>                <span class="keywordtype">int</span>  IsShielded = <a class="code hl_function" href="../../de/dee/classopenphase_1_1Initializations.html#a39027ba28c799d4d34f9c3e60306faaa">Initializations::loop_sphere_with_exit</a>(Shielded, check_shield, PNew.x, PNew.y, PNew.z, radius + MinDistance/2.0, <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid, BC);</div>
<div class="line"><span class="lineno"> 1843</span><span class="preprocessor">                #ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 1844</span>                <span class="keywordtype">int</span> tmpIsShielded = IsShielded;</div>
<div class="line"><span class="lineno"> 1845</span>                OP_MPI_Allreduce(&amp;tmpIsShielded, &amp;(IsShielded), 1, OP_MPI_INT, OP_MPI_SUM, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 1846</span><span class="preprocessor">                #endif</span></div>
<div class="line"><span class="lineno"> 1847</span>                <span class="keywordflow">if</span> (IsShielded) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1848</span> </div>
<div class="line"><span class="lineno"> 1849</span>                <span class="comment">// Shield surrounding against places of other solid particles</span></div>
<div class="line"><span class="lineno"> 1850</span>                <a class="code hl_function" href="../../de/dee/classopenphase_1_1Initializations.html#ad00a0106bc9c6f3d9d62bf4677d10ac4">Initializations::loop_sphere</a>(Shielded, set_shield, PNew.x, PNew.y, PNew.z, radius + MinDistance/2.0, <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid, BC);</div>
<div class="line"><span class="lineno"> 1851</span> </div>
<div class="line"><span class="lineno"> 1852</span>                <span class="comment">// Initialize spherical phase field</span></div>
<div class="line"><span class="lineno"> 1853</span>                Planted.push_back(PNew);</div>
<div class="line"><span class="lineno"> 1854</span>                <span class="keywordtype">int</span> phaseIdx2 = PhaseIndex(PNew.x, PNew.y, PNew.z);</div>
<div class="line"><span class="lineno"> 1855</span><span class="preprocessor">                #ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 1856</span>                OP_MPI_Bcast(&amp;(phaseIdx2), 1, OP_MPI_INT, 0, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 1857</span><span class="preprocessor">                #endif</span></div>
<div class="line"><span class="lineno"> 1858</span>                <span class="keyword">const</span> <span class="keywordtype">size_t</span> idx = <a class="code hl_function" href="../../de/dee/classopenphase_1_1Initializations.html#a8127e68e3549a12584b2f55f580e494c">Initializations::Sphere</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, phaseIdx2, radius, PNew.x, PNew.y, PNew.z, BC, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1859</span>                SpheresIdx.push_back(idx);</div>
<div class="line"><span class="lineno"> 1860</span> </div>
<div class="line"><span class="lineno"> 1861</span>                <span class="keywordflow">if</span> (Verbose) <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a41683f616ffa4631340cb0de41cad70f">ConsoleOutput::Write</a>(<span class="stringliteral">&quot;Planted number &quot;</span>, Planted.size());</div>
<div class="line"><span class="lineno"> 1862</span>            }</div>
<div class="line"><span class="lineno"> 1863</span>            ++i;</div>
<div class="line"><span class="lineno"> 1864</span>        }</div>
<div class="line"><span class="lineno"> 1865</span>    }</div>
<div class="line"><span class="lineno"> 1866</span> </div>
<div class="line"><span class="lineno"> 1867</span>    uniform_int_distribution &lt;int&gt; Q1Distribution(0, 360);</div>
<div class="line"><span class="lineno"> 1868</span>    uniform_int_distribution &lt;int&gt; Q2Distribution(0, 180);</div>
<div class="line"><span class="lineno"> 1869</span>    uniform_int_distribution &lt;int&gt; Q3Distribution(0, 360);</div>
<div class="line"><span class="lineno"> 1870</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties.size(); n++)</div>
<div class="line"><span class="lineno"> 1871</span>    {</div>
<div class="line"><span class="lineno"> 1872</span>        <span class="keywordtype">double</span> Q1 = Q1Distribution(generator) * <a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>/180.0;</div>
<div class="line"><span class="lineno"> 1873</span>        <span class="keywordtype">double</span> Q2 = Q2Distribution(generator) * <a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>/180.0;</div>
<div class="line"><span class="lineno"> 1874</span>        <span class="keywordtype">double</span> Q3 = Q3Distribution(generator) * <a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>/180.0;</div>
<div class="line"><span class="lineno"> 1875</span>        EulerAngles locAngles({Q1, Q2, Q3}, <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a631078f50f3da2bf1138bc0182054010ab71eaef9d6f6d31e69a4401fc00b737c">XYZ</a>);</div>
<div class="line"><span class="lineno"> 1876</span>        <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[n].Orientation = locAngles.getQuaternion();</div>
<div class="line"><span class="lineno"> 1877</span>    }</div>
<div class="line"><span class="lineno"> 1878</span> </div>
<div class="line"><span class="lineno"> 1879</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 1880</span>    <span class="keywordflow">if</span> (MPI_RANK == 0)</div>
<div class="line"><span class="lineno"> 1881</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1882</span>    {</div>
<div class="line"><span class="lineno"> 1883</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> sep = <span class="charliteral">&#39;,&#39;</span>;</div>
<div class="line"><span class="lineno"> 1884</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a41683f616ffa4631340cb0de41cad70f">ConsoleOutput::Write</a>(<span class="stringliteral">&quot;Spheres planted&quot;</span>, Planted.size());</div>
<div class="line"><span class="lineno"> 1885</span>        std::ofstream file(locSettings.TextDir + <span class="stringliteral">&quot;InitialParticlePositions.csv&quot;</span>);</div>
<div class="line"><span class="lineno"> 1886</span>        file &lt;&lt; <span class="stringliteral">&quot;x&quot;</span> &lt;&lt; sep &lt;&lt; <span class="stringliteral">&quot;y&quot;</span> &lt;&lt; sep &lt;&lt; <span class="stringliteral">&quot;z&quot;</span> &lt;&lt; sep &lt;&lt; <span class="stringliteral">&quot;radius\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1887</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> sphere = Planted.cbegin(); sphere != Planted.end(); sphere++)</div>
<div class="line"><span class="lineno"> 1888</span>        {</div>
<div class="line"><span class="lineno"> 1889</span>            file &lt;&lt; sphere-&gt;x &lt;&lt; sep;</div>
<div class="line"><span class="lineno"> 1890</span>            file &lt;&lt; sphere-&gt;y &lt;&lt; sep;</div>
<div class="line"><span class="lineno"> 1891</span>            file &lt;&lt; sphere-&gt;z &lt;&lt; sep;</div>
<div class="line"><span class="lineno"> 1892</span>            file &lt;&lt; sphere-&gt;radius &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1893</span>        }</div>
<div class="line"><span class="lineno"> 1894</span>    }</div>
<div class="line"><span class="lineno"> 1895</span> </div>
<div class="line"><span class="lineno"> 1896</span>    <span class="comment">// Finalise initialization</span></div>
<div class="line"><span class="lineno"> 1897</span>    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FinalizeInitialization(BC);</div>
<div class="line"><span class="lineno"> 1898</span>    <span class="keywordflow">return</span> SpheresIdx;</div>
<div class="line"><span class="lineno"> 1899</span>}</div>
<div class="ttc" id="aclassopenphase_1_1ConsoleOutput_html_a41683f616ffa4631340cb0de41cad70f"><div class="ttname"><a href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a41683f616ffa4631340cb0de41cad70f">openphase::ConsoleOutput::Write</a></div><div class="ttdeci">static void Write(const std::string message)</div><div class="ttdoc">Writes a Message, Blank Line, or Line of char to screen.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/dfe/ConsoleOutput_8h_source.html#l00079">ConsoleOutput.h:79</a></div></div>
<div class="ttc" id="aclassopenphase_1_1ConsoleOutput_html_a421faa2fe5d86991328b2b06041a326d"><div class="ttname"><a href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a421faa2fe5d86991328b2b06041a326d">openphase::ConsoleOutput::WriteExit</a></div><div class="ttdeci">static void WriteExit(const std::string Message, const std::string Instance=&quot;&quot;, const std::string Method=&quot;&quot;)</div><div class="ttdef"><b>Definition</b> <a href="../../da/da0/ConsoleOutput_8cpp_source.html#l00196">ConsoleOutput.cpp:196</a></div></div>
<div class="ttc" id="aclassopenphase_1_1Initializations_html_a39027ba28c799d4d34f9c3e60306faaa"><div class="ttname"><a href="../../de/dee/classopenphase_1_1Initializations.html#a39027ba28c799d4d34f9c3e60306faaa">openphase::Initializations::loop_sphere_with_exit</a></div><div class="ttdeci">static bool loop_sphere_with_exit(Storage3D&lt; T, Rank &gt; &amp;field, const std::function&lt; bool(long int, long int, long int, double)&gt; &amp;func, const double x0, const double y0, const double z0, const double radius, const GridParameters &amp;Dimensions, const BoundaryConditions &amp;BC)</div><div class="ttdoc">Loops over all points (i,j,k) of a sphere with radius at (x0,y0,z0) and executes func(i,...</div><div class="ttdef"><b>Definition</b> <a href="../../df/db1/Initializations_8h_source.html#l00261">Initializations.h:261</a></div></div>
<div class="ttc" id="aclassopenphase_1_1Initializations_html_a430c428a01443e146ef506a3305998a2"><div class="ttname"><a href="../../de/dee/classopenphase_1_1Initializations.html#a430c428a01443e146ef506a3305998a2">openphase::Initializations::thisclassname</a></div><div class="ttdeci">static constexpr auto thisclassname</div><div class="ttdef"><b>Definition</b> <a href="../../df/db1/Initializations_8h_source.html#l00322">Initializations.h:322</a></div></div>
<div class="ttc" id="aclassopenphase_1_1Initializations_html_a8127e68e3549a12584b2f55f580e494c"><div class="ttname"><a href="../../de/dee/classopenphase_1_1Initializations.html#a8127e68e3549a12584b2f55f580e494c">openphase::Initializations::Sphere</a></div><div class="ttdeci">static size_t Sphere(PhaseField &amp;Phase, const size_t PhaseIndex, const double Radius, double x0, double y0, double z0, const BoundaryConditions &amp;BC, const bool Finalize=true)</div><div class="ttdoc">Initializes a spherical grain.</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d3a/Initializations_8cpp_source.html#l00341">Initializations.cpp:341</a></div></div>
<div class="ttc" id="aclassopenphase_1_1Initializations_html_ad00a0106bc9c6f3d9d62bf4677d10ac4"><div class="ttname"><a href="../../de/dee/classopenphase_1_1Initializations.html#ad00a0106bc9c6f3d9d62bf4677d10ac4">openphase::Initializations::loop_sphere</a></div><div class="ttdeci">static void loop_sphere(Storage3D&lt; T, Rank &gt; &amp;field, const std::function&lt; bool(long int, long int, long int, double)&gt; &amp;func, const double x0, const double y0, const double z0, const double radius, GridParameters &amp;Dimensions, const BoundaryConditions &amp;BC)</div><div class="ttdoc">Loops over all points (i,j,k) of a sphere with radius at (x0,y0,z0) and executes func(i,...</div><div class="ttdef"><b>Definition</b> <a href="../../df/db1/Initializations_8h_source.html#l00203">Initializations.h:203</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_a4d6fed4ab71c6edf2a0bd5dabecc6ec6"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a4d6fed4ab71c6edf2a0bd5dabecc6ec6">openphase::OP_Exit</a></div><div class="ttdeci">void OP_Exit(int exit_code)</div><div class="ttdef"><b>Definition</b> <a href="../../d9/df1/Globals_8h_source.html#l00098">Globals.h:98</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_a631078f50f3da2bf1138bc0182054010ab71eaef9d6f6d31e69a4401fc00b737c"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a631078f50f3da2bf1138bc0182054010ab71eaef9d6f6d31e69a4401fc00b737c">openphase::XYZ</a></div><div class="ttdeci">@ XYZ</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d29/EulerAngles_8h_source.html#l00037">EulerAngles.h:37</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a59d1c821a077d34464a5572661922e0c" name="a59d1c821a077d34464a5572661922e0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59d1c821a077d34464a5572661922e0c">&#9670;&#160;</a></span>Fractional()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; size_t &gt; openphase::Initializations::Fractional </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>MajorityPhaseIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>MinorityPhaseIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>MinorityPhaseLayerThickness</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>?? TODO </p>

<p class="definition">Definition at line <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html#l00559">559</a> of file <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html">Initializations.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  564</span>{</div>
<div class="line"><span class="lineno">  565</span>    <span class="keywordflow">if</span>( BC.BC0Z != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5baa5af8c34dc3d5f295a4ce78e0930690d">BoundaryConditionTypes::NoFlux</a> || BC.BCNZ != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5baa5af8c34dc3d5f295a4ce78e0930690d">BoundaryConditionTypes::NoFlux</a> )</div>
<div class="line"><span class="lineno">  566</span>    {</div>
<div class="line"><span class="lineno">  567</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">ConsoleOutput::WriteWarning</a>(</div>
<div class="line"><span class="lineno">  568</span>                <span class="stringliteral">&quot;Consider NoFlux Boundary condition at least along \n&quot;</span></div>
<div class="line"><span class="lineno">  569</span>                <span class="stringliteral">&quot;Z-direction for Fractional initialization&quot;</span>, <a class="code hl_variable" href="../../de/dee/classopenphase_1_1Initializations.html#a430c428a01443e146ef506a3305998a2">thisclassname</a>, <span class="stringliteral">&quot;Fractional&quot;</span>);</div>
<div class="line"><span class="lineno">  570</span>    }</div>
<div class="line"><span class="lineno">  571</span> </div>
<div class="line"><span class="lineno">  572</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> iWidth = (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Resolution == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>) ? 0.5*<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth : <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth;</div>
<div class="line"><span class="lineno">  573</span> </div>
<div class="line"><span class="lineno">  574</span>    <span class="keywordtype">size_t</span> index1 = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.AddGrainInfo(MajorityPhaseIndex);</div>
<div class="line"><span class="lineno">  575</span>    <span class="keywordtype">size_t</span> index2 = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.AddGrainInfo(MinorityPhaseIndex);</div>
<div class="line"><span class="lineno">  576</span> </div>
<div class="line"><span class="lineno">  577</span>    <span class="keywordtype">int</span> offset = MinorityPhaseLayerThickness;</div>
<div class="line"><span class="lineno">  578</span> </div>
<div class="line"><span class="lineno">  579</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a71aed4b94e116454c7b11985a91e49ec">STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields.Bcells())</div>
<div class="line"><span class="lineno">  580</span>    {</div>
<div class="line"><span class="lineno">  581</span>        <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).clear();</div>
<div class="line"><span class="lineno">  582</span> </div>
<div class="line"><span class="lineno">  583</span>        <span class="keywordflow">if</span> (k &gt; offset + iWidth/2)</div>
<div class="line"><span class="lineno">  584</span>        {</div>
<div class="line"><span class="lineno">  585</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(index1, 1);</div>
<div class="line"><span class="lineno">  586</span>        }</div>
<div class="line"><span class="lineno">  587</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k &lt; offset - iWidth/2)</div>
<div class="line"><span class="lineno">  588</span>        {</div>
<div class="line"><span class="lineno">  589</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(index2, 1);</div>
<div class="line"><span class="lineno">  590</span>        }</div>
<div class="line"><span class="lineno">  591</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  592</span>        {</div>
<div class="line"><span class="lineno">  593</span>            <span class="keywordtype">double</span> IntProf = 0.5 - 0.5*sin(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>*(k - offset)/iWidth);</div>
<div class="line"><span class="lineno">  594</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(index1, 1.0 - IntProf);</div>
<div class="line"><span class="lineno">  595</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(index2, IntProf);</div>
<div class="line"><span class="lineno">  596</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).flag = 2;</div>
<div class="line"><span class="lineno">  597</span>        }</div>
<div class="line"><span class="lineno">  598</span>    }</div>
<div class="line"><span class="lineno">  599</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a6ad2c83345f230517a1770304d7b39ad">STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  600</span> </div>
<div class="line"><span class="lineno">  601</span>    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FinalizeInitialization(BC);</div>
<div class="line"><span class="lineno">  602</span> </div>
<div class="line"><span class="lineno">  603</span>    <span class="keywordflow">return</span> vector&lt;size_t&gt;({index1,index2});</div>
<div class="line"><span class="lineno">  604</span>}</div>
<div class="ttc" id="aclassopenphase_1_1ConsoleOutput_html_a3d39f6f01e37b75d360090aa734bc1bd"><div class="ttname"><a href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">openphase::ConsoleOutput::WriteWarning</a></div><div class="ttdeci">static void WriteWarning(const std::string Message, const std::string Instance=&quot;&quot;, const std::string Method=&quot;&quot;)</div><div class="ttdef"><b>Definition</b> <a href="../../da/da0/ConsoleOutput_8cpp_source.html#l00176">ConsoleOutput.cpp:176</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_a69910bb765933ee28721d9784d7b6a5baa5af8c34dc3d5f295a4ce78e0930690d"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5baa5af8c34dc3d5f295a4ce78e0930690d">openphase::BoundaryConditionTypes::NoFlux</a></div><div class="ttdeci">@ NoFlux</div><div class="ttdoc">Adiabatic boundary condition, results in zero first order derivative at the boundary.</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a05603e6b4a9f4831c913e083fd62e000" name="a05603e6b4a9f4831c913e083fd62e000"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05603e6b4a9f4831c913e083fd62e000">&#9670;&#160;</a></span>Layer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t openphase::Initializations::Layer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>PhaseIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a>&#160;</td>
          <td class="paramname"><em>position</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a>&#160;</td>
          <td class="paramname"><em>orientation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>thickness</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initializes a layer with thickness of PhaseIndex with orientation at position. </p>

<p class="definition">Definition at line <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html#l00519">519</a> of file <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html">Initializations.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  525</span>{</div>
<div class="line"><span class="lineno">  526</span>    <span class="keyword">const</span> dVector3 n = orientation.normalized();</div>
<div class="line"><span class="lineno">  527</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> iWidth = (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Resolution == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>) ? 0.5*<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth : <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth;</div>
<div class="line"><span class="lineno">  528</span> </div>
<div class="line"><span class="lineno">  529</span>    <span class="keywordtype">size_t</span> idx = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.AddGrainInfo(PhaseIndex);</div>
<div class="line"><span class="lineno">  530</span> </div>
<div class="line"><span class="lineno">  531</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a71aed4b94e116454c7b11985a91e49ec">STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields.Bcells())</div>
<div class="line"><span class="lineno">  532</span>    {</div>
<div class="line"><span class="lineno">  533</span>        <span class="keyword">const</span> dVector3 x = {double(i),double(j),double(k)};</div>
<div class="line"><span class="lineno">  534</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> distance = std::abs((x-position)*n);</div>
<div class="line"><span class="lineno">  535</span> </div>
<div class="line"><span class="lineno">  536</span>        <span class="keywordflow">if</span> (distance &lt; 0.5*thickness - 0.5*iWidth)</div>
<div class="line"><span class="lineno">  537</span>        {</div>
<div class="line"><span class="lineno">  538</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).clear();</div>
<div class="line"><span class="lineno">  539</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(idx, 1.0);</div>
<div class="line"><span class="lineno">  540</span>        }</div>
<div class="line"><span class="lineno">  541</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (distance &lt; 0.5*thickness + 0.5*iWidth)</div>
<div class="line"><span class="lineno">  542</span>        {</div>
<div class="line"><span class="lineno">  543</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> IntProf = 0.5 - 0.5*std::sin(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>*(distance - 0.5*thickness)/iWidth);</div>
<div class="line"><span class="lineno">  544</span>            <span class="keywordflow">for</span>(<span class="keyword">auto</span> alpha = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).begin();</div>
<div class="line"><span class="lineno">  545</span>                     alpha &lt; <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).end(); alpha++)</div>
<div class="line"><span class="lineno">  546</span>            {</div>
<div class="line"><span class="lineno">  547</span>                alpha-&gt;value *= 1.0 - IntProf;</div>
<div class="line"><span class="lineno">  548</span>            }</div>
<div class="line"><span class="lineno">  549</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(idx, IntProf);</div>
<div class="line"><span class="lineno">  550</span>        }</div>
<div class="line"><span class="lineno">  551</span>    }</div>
<div class="line"><span class="lineno">  552</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a6ad2c83345f230517a1770304d7b39ad">STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  553</span> </div>
<div class="line"><span class="lineno">  554</span>    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FinalizeInitialization(BC);</div>
<div class="line"><span class="lineno">  555</span> </div>
<div class="line"><span class="lineno">  556</span>    <span class="keywordflow">return</span> idx;</div>
<div class="line"><span class="lineno">  557</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad00a0106bc9c6f3d9d62bf4677d10ac4" name="ad00a0106bc9c6f3d9d62bf4677d10ac4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad00a0106bc9c6f3d9d62bf4677d10ac4">&#9670;&#160;</a></span>loop_sphere()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class T , size_t Rank&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void openphase::Initializations::loop_sphere </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; T, Rank &gt; &amp;&#160;</td>
          <td class="paramname"><em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::function&lt; bool(long int, long int, long int, double)&gt; &amp;&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>y0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>z0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dc/d18/classopenphase_1_1GridParameters.html">GridParameters</a> &amp;&#160;</td>
          <td class="paramname"><em>Dimensions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Loops over all points (i,j,k) of a sphere with radius at (x0,y0,z0) and executes func(i,j,k,radius) </p>

<p class="definition">Definition at line <a class="el" href="../../df/db1/Initializations_8h_source.html#l00203">203</a> of file <a class="el" href="../../df/db1/Initializations_8h_source.html">Initializations.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  207</span>    {</div>
<div class="line"><span class="lineno">  208</span>        <span class="comment">// &lt;&lt;&lt; It is safe to put sphere with its center coordinates outside</span></div>
<div class="line"><span class="lineno">  209</span>        <span class="comment">// &lt;&lt;&lt; of the simulation domain and its radius bigger than system</span></div>
<div class="line"><span class="lineno">  210</span>        <span class="comment">// &lt;&lt;&lt; dimensions thus not need for assertion.</span></div>
<div class="line"><span class="lineno">  211</span>        <span class="comment">//assert(x0 &gt;= 0);</span></div>
<div class="line"><span class="lineno">  212</span>        <span class="comment">//assert(y0 &gt;= 0);</span></div>
<div class="line"><span class="lineno">  213</span>        <span class="comment">//assert(z0 &gt;= 0);</span></div>
<div class="line"><span class="lineno">  214</span>        <span class="comment">//assert(x0 &lt; locSettings.TotalNx);</span></div>
<div class="line"><span class="lineno">  215</span>        <span class="comment">//assert(y0 &lt; locSettings.TotalNy);</span></div>
<div class="line"><span class="lineno">  216</span>        <span class="comment">//assert(z0 &lt; locSettings.TotalNz);</span></div>
<div class="line"><span class="lineno">  217</span>        <span class="comment">//assert(radius &lt; std::max(locSettings.TotalNx,std::max(locSettings.TotalNy,locSettings.TotalNz)));</span></div>
<div class="line"><span class="lineno">  218</span> </div>
<div class="line"><span class="lineno">  219</span>        dVector3 pos0 ({double(x0),double(y0),double(z0)});</div>
<div class="line"><span class="lineno">  220</span>        <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> iRadius = std::ceil(radius);</div>
<div class="line"><span class="lineno">  221</span>        <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> ii_min = (field.dNx() != 0 and field.sizeX() &gt; 1) ? -std::min(iRadius,field.sizeX()) : 0;</div>
<div class="line"><span class="lineno">  222</span>        <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> ii_max = (field.dNx() != 0 and field.sizeX() &gt; 1) ?  std::min(iRadius,field.sizeX()) : 0;</div>
<div class="line"><span class="lineno">  223</span>        <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> jj_min = (field.dNy() != 0 and field.sizeY() &gt; 1) ? -std::min(iRadius,field.sizeY()) : 0;</div>
<div class="line"><span class="lineno">  224</span>        <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> jj_max = (field.dNy() != 0 and field.sizeY() &gt; 1) ?  std::min(iRadius,field.sizeY()) : 0;</div>
<div class="line"><span class="lineno">  225</span>        <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> kk_min = (field.dNz() != 0 and field.sizeZ() &gt; 1) ? -std::min(iRadius,field.sizeZ()) : 0;</div>
<div class="line"><span class="lineno">  226</span>        <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> kk_max = (field.dNz() != 0 and field.sizeZ() &gt; 1) ?  std::min(iRadius,field.sizeZ()) : 0;</div>
<div class="line"><span class="lineno">  227</span> </div>
<div class="line"><span class="lineno">  228</span>        std::vector&lt;std::array&lt;long int,3&gt;&gt; list;</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span><span class="preprocessor">        #pragma omp parallel for collapse(3) </span><span class="comment">//NOTE has crashes MPI calculation in older version of loop!</span></div>
<div class="line"><span class="lineno">  231</span>        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">int</span> ii = ii_min; ii &lt;= ii_max; ++ii)</div>
<div class="line"><span class="lineno">  232</span>        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">int</span> jj = jj_min; jj &lt;= jj_max; ++jj)</div>
<div class="line"><span class="lineno">  233</span>        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">int</span> kk = kk_min; kk &lt;= kk_max; ++kk)</div>
<div class="line"><span class="lineno">  234</span>        {</div>
<div class="line"><span class="lineno">  235</span>            <span class="comment">// Calculate global coordinates (i,j,k)</span></div>
<div class="line"><span class="lineno">  236</span>            <span class="keywordtype">long</span> <span class="keywordtype">int</span> i = std::round(x0 + ii);</div>
<div class="line"><span class="lineno">  237</span>            <span class="keywordtype">long</span> <span class="keywordtype">int</span> j = std::round(y0 + jj);</div>
<div class="line"><span class="lineno">  238</span>            <span class="keywordtype">long</span> <span class="keywordtype">int</span> k = std::round(z0 + kk);</div>
<div class="line"><span class="lineno">  239</span> </div>
<div class="line"><span class="lineno">  240</span>            <a class="code hl_function" href="../../de/dee/classopenphase_1_1Initializations.html#a24ce5290a304d40488c8271ec62d086d">ApplyPeriodicBoundaryConditionsOnCoordinates</a>(i,j,k,BC,Dimensions);</div>
<div class="line"><span class="lineno">  241</span>            <span class="keywordflow">if</span>(not <a class="code hl_function" href="../../de/dee/classopenphase_1_1Initializations.html#a0941daec2114981ee0cc049c2263b29b">CoordinatesInBoundaries</a>(i,j,k,field,Dimensions)) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  242</span> </div>
<div class="line"><span class="lineno">  243</span>            <span class="comment">// Calculate distance between (i,j,k) and (x0,y0,z0)</span></div>
<div class="line"><span class="lineno">  244</span>            dVector3 pos ({double(i),double(j),double(k)});</div>
<div class="line"><span class="lineno">  245</span>            <span class="keywordtype">double</span> rad = Tools::Distance&lt;dVector3&gt;(pos, pos0, Dimensions.TotalNx, Dimensions.TotalNy, Dimensions.TotalNz, BC).abs();</div>
<div class="line"><span class="lineno">  246</span>            <span class="keywordflow">if</span> (rad &gt; radius) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span>            <span class="comment">// Convert global coordinates to local block coordinates</span></div>
<div class="line"><span class="lineno">  249</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno">  250</span>            i -= Dimensions.OffsetX;</div>
<div class="line"><span class="lineno">  251</span>            j -= Dimensions.OffsetY;</div>
<div class="line"><span class="lineno">  252</span>            k -= Dimensions.OffsetZ;</div>
<div class="line"><span class="lineno">  253</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  254</span>            func(i,j,k,rad);</div>
<div class="line"><span class="lineno">  255</span>        }</div>
<div class="line"><span class="lineno">  256</span>    }</div>
<div class="ttc" id="aclassopenphase_1_1Initializations_html_a0941daec2114981ee0cc049c2263b29b"><div class="ttname"><a href="../../de/dee/classopenphase_1_1Initializations.html#a0941daec2114981ee0cc049c2263b29b">openphase::Initializations::CoordinatesInBoundaries</a></div><div class="ttdeci">static bool CoordinatesInBoundaries(T &amp;i, T &amp;j, T &amp;k, const field_t &amp;field, const GridParameters &amp;Dimensions)</div><div class="ttdoc">Checks if (i,j,k) is the.</div><div class="ttdef"><b>Definition</b> <a href="../../df/db1/Initializations_8h_source.html#l00187">Initializations.h:187</a></div></div>
<div class="ttc" id="aclassopenphase_1_1Initializations_html_a24ce5290a304d40488c8271ec62d086d"><div class="ttname"><a href="../../de/dee/classopenphase_1_1Initializations.html#a24ce5290a304d40488c8271ec62d086d">openphase::Initializations::ApplyPeriodicBoundaryConditionsOnCoordinates</a></div><div class="ttdeci">static void ApplyPeriodicBoundaryConditionsOnCoordinates(T &amp;i, T &amp;j, T &amp;k, const BoundaryConditions &amp;BC, const GridParameters &amp;Dimensions)</div><div class="ttdoc">Calculates global coordinates from local mpi coordinates.</div><div class="ttdef"><b>Definition</b> <a href="../../df/db1/Initializations_8h_source.html#l00165">Initializations.h:166</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a39027ba28c799d4d34f9c3e60306faaa" name="a39027ba28c799d4d34f9c3e60306faaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39027ba28c799d4d34f9c3e60306faaa">&#9670;&#160;</a></span>loop_sphere_with_exit()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class T , size_t Rank&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool openphase::Initializations::loop_sphere_with_exit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; T, Rank &gt; &amp;&#160;</td>
          <td class="paramname"><em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::function&lt; bool(long int, long int, long int, double)&gt; &amp;&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>y0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>z0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../dc/d18/classopenphase_1_1GridParameters.html">GridParameters</a> &amp;&#160;</td>
          <td class="paramname"><em>Dimensions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Loops over all points (i,j,k) of a sphere with radius at (x0,y0,z0) and executes func(i,j,k,radius) Exits loop when func(i,j,k,radius) return true. </p>

<p class="definition">Definition at line <a class="el" href="../../df/db1/Initializations_8h_source.html#l00261">261</a> of file <a class="el" href="../../df/db1/Initializations_8h_source.html">Initializations.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  265</span>    {</div>
<div class="line"><span class="lineno">  266</span>        assert(x0 &gt;= 0);</div>
<div class="line"><span class="lineno">  267</span>        assert(y0 &gt;= 0);</div>
<div class="line"><span class="lineno">  268</span>        assert(z0 &gt;= 0);</div>
<div class="line"><span class="lineno">  269</span>        assert(x0 &lt; Dimensions.TotalNx);</div>
<div class="line"><span class="lineno">  270</span>        assert(y0 &lt; Dimensions.TotalNy);</div>
<div class="line"><span class="lineno">  271</span>        assert(z0 &lt; Dimensions.TotalNz);</div>
<div class="line"><span class="lineno">  272</span>        assert(radius &lt; std::max(Dimensions.TotalNx,std::max(Dimensions.TotalNy,Dimensions.TotalNz)));</div>
<div class="line"><span class="lineno">  273</span> </div>
<div class="line"><span class="lineno">  274</span>        dVector3 pos0 ({double(x0),double(y0),double(z0)});</div>
<div class="line"><span class="lineno">  275</span>        <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> iRadius = std::ceil(radius);</div>
<div class="line"><span class="lineno">  276</span>        <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> ii_min = (field.dNx() != 0) ? -iRadius : 0;</div>
<div class="line"><span class="lineno">  277</span>        <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> ii_max = (field.dNx() != 0) ?  iRadius : 0;</div>
<div class="line"><span class="lineno">  278</span>        <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> jj_min = (field.dNy() != 0) ? -iRadius : 0;</div>
<div class="line"><span class="lineno">  279</span>        <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> jj_max = (field.dNy() != 0) ?  iRadius : 0;</div>
<div class="line"><span class="lineno">  280</span>        <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> kk_min = (field.dNz() != 0) ? -iRadius : 0;</div>
<div class="line"><span class="lineno">  281</span>        <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> kk_max = (field.dNz() != 0) ?  iRadius : 0;</div>
<div class="line"><span class="lineno">  282</span> </div>
<div class="line"><span class="lineno">  283</span>        <span class="keywordtype">int</span> loc_exit_loop = 0; <span class="comment">// is used to exit loop if a certain condition is met e.g. the presence of an existing phase</span></div>
<div class="line"><span class="lineno">  284</span><span class="preprocessor">        #pragma omp parallel for shared(loc_exit_loop) collapse(3) </span><span class="comment">//NOTE has crashes MPI calculation in older version of loop!</span></div>
<div class="line"><span class="lineno">  285</span>        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">int</span> ii = ii_min; ii &lt;= ii_max; ++ii)</div>
<div class="line"><span class="lineno">  286</span>        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">int</span> jj = jj_min; jj &lt;= jj_max; ++jj)</div>
<div class="line"><span class="lineno">  287</span>        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">int</span> kk = kk_min; kk &lt;= kk_max; ++kk)</div>
<div class="line"><span class="lineno">  288</span>        {</div>
<div class="line"><span class="lineno">  289</span>            <span class="keywordflow">if</span> (loc_exit_loop) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  290</span>            <span class="comment">// Calculate global coordinates (i,j,k)</span></div>
<div class="line"><span class="lineno">  291</span>            <span class="keywordtype">long</span> <span class="keywordtype">int</span> i = std::round(x0 + ii);</div>
<div class="line"><span class="lineno">  292</span>            <span class="keywordtype">long</span> <span class="keywordtype">int</span> j = std::round(y0 + jj);</div>
<div class="line"><span class="lineno">  293</span>            <span class="keywordtype">long</span> <span class="keywordtype">int</span> k = std::round(z0 + kk);</div>
<div class="line"><span class="lineno">  294</span> </div>
<div class="line"><span class="lineno">  295</span>            <a class="code hl_function" href="../../de/dee/classopenphase_1_1Initializations.html#a24ce5290a304d40488c8271ec62d086d">ApplyPeriodicBoundaryConditionsOnCoordinates</a>(i,j,k,BC,Dimensions);</div>
<div class="line"><span class="lineno">  296</span>            <span class="keywordflow">if</span>(not <a class="code hl_function" href="../../de/dee/classopenphase_1_1Initializations.html#a0941daec2114981ee0cc049c2263b29b">CoordinatesInBoundaries</a>(i,j,k,field,Dimensions)) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  297</span> </div>
<div class="line"><span class="lineno">  298</span>            <span class="comment">// Calculate distance between (i,j,k) and (x0,y0,z0)</span></div>
<div class="line"><span class="lineno">  299</span>            dVector3 pos ({double(i),double(j),double(k)});</div>
<div class="line"><span class="lineno">  300</span>            <span class="keywordtype">double</span> rad = Tools::Distance&lt;dVector3&gt;(pos, pos0, Dimensions.TotalNx, Dimensions.TotalNy, Dimensions.TotalNz, BC).abs();</div>
<div class="line"><span class="lineno">  301</span>            <span class="keywordflow">if</span> (rad &gt; radius) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  302</span> </div>
<div class="line"><span class="lineno">  303</span>            <span class="comment">// Convert global coordinates to local block coordinates</span></div>
<div class="line"><span class="lineno">  304</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno">  305</span>            i -= Dimensions.OffsetX;</div>
<div class="line"><span class="lineno">  306</span>            j -= Dimensions.OffsetY;</div>
<div class="line"><span class="lineno">  307</span>            k -= Dimensions.OffsetZ;</div>
<div class="line"><span class="lineno">  308</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  309</span>            <span class="keywordflow">if</span> (func(i,j,k,rad)) loc_exit_loop++;</div>
<div class="line"><span class="lineno">  310</span>        }</div>
<div class="line"><span class="lineno">  311</span>        <span class="keywordtype">int</span> exit_loop = 0;</div>
<div class="line"><span class="lineno">  312</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno">  313</span>        OP_MPI_Allreduce(&amp;loc_exit_loop, &amp;exit_loop, 1, OP_MPI_INT, OP_MPI_SUM, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  314</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  315</span>        exit_loop += loc_exit_loop;</div>
<div class="line"><span class="lineno">  316</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  317</span> </div>
<div class="line"><span class="lineno">  318</span>        <span class="keywordflow">if</span> (exit_loop) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  319</span>        <span class="keywordflow">else</span> <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  320</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="adaa3e88b16f1ca0c9c299cb8f75212cd" name="adaa3e88b16f1ca0c9c299cb8f75212cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adaa3e88b16f1ca0c9c299cb8f75212cd">&#9670;&#160;</a></span>QuasiRandomNuclei()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; <a class="el" href="../../da/d9c/classopenphase_1_1iVector3.html">iVector3</a> &gt; openphase::Initializations::QuasiRandomNuclei </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>phaseIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d9c/classopenphase_1_1iVector3.html">iVector3</a>&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d9c/classopenphase_1_1iVector3.html">iVector3</a>&#160;</td>
          <td class="paramname"><em>spacing</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d9c/classopenphase_1_1iVector3.html">iVector3</a>&#160;</td>
          <td class="paramname"><em>deviation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>threshold</em> = <code>0.05</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>seed</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Plants grain nuclei on a regular grid with the given "offset" from the origin, "spacing" and local random "deviation" from the ideal grid position for each seed. </p>

<p class="definition">Definition at line <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html#l00053">53</a> of file <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html">Initializations.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   60</span>{</div>
<div class="line"><span class="lineno">   61</span>    vector&lt;iVector3&gt; result;</div>
<div class="line"><span class="lineno">   62</span> </div>
<div class="line"><span class="lineno">   63</span>    <span class="keywordflow">if</span> (seed == -1)</div>
<div class="line"><span class="lineno">   64</span>    {</div>
<div class="line"><span class="lineno">   65</span>        srand(time(NULL));</div>
<div class="line"><span class="lineno">   66</span>    }</div>
<div class="line"><span class="lineno">   67</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   68</span>    {</div>
<div class="line"><span class="lineno">   69</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno">   70</span>        srand(pow(seed + MPI_RANK,(MPI_RANK + 1)));</div>
<div class="line"><span class="lineno">   71</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">   72</span>        srand(seed);</div>
<div class="line"><span class="lineno">   73</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   74</span>    }</div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span>    <span class="keywordtype">int</span> Nx = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNx;</div>
<div class="line"><span class="lineno">   77</span>    <span class="keywordtype">int</span> Ny = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNy;</div>
<div class="line"><span class="lineno">   78</span>    <span class="keywordtype">int</span> Nz = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNz;</div>
<div class="line"><span class="lineno">   79</span> </div>
<div class="line"><span class="lineno">   80</span>    <span class="keywordtype">int</span> distx = (offset[0] &lt; Nx and spacing[0] &lt; Nx) ? offset[0] : 0;</div>
<div class="line"><span class="lineno">   81</span>    <span class="keywordtype">int</span> disty = (offset[1] &lt; Ny and spacing[1] &lt; Ny) ? offset[1] : 0;</div>
<div class="line"><span class="lineno">   82</span>    <span class="keywordtype">int</span> distz = (offset[2] &lt; Nz and spacing[2] &lt; Nz) ? offset[2] : 0;</div>
<div class="line"><span class="lineno">   83</span> </div>
<div class="line"><span class="lineno">   84</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = distx; i &lt; Nx; i += spacing[0])</div>
<div class="line"><span class="lineno">   85</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = disty; j &lt; Ny; j += spacing[1])</div>
<div class="line"><span class="lineno">   86</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = distz; k &lt; Nz; k += spacing[2])</div>
<div class="line"><span class="lineno">   87</span>    {</div>
<div class="line"><span class="lineno">   88</span>        <span class="keywordtype">double</span> chance = double(rand()) / double(RAND_MAX);</div>
<div class="line"><span class="lineno">   89</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno">   90</span>        OP_MPI_Bcast(&amp;(chance), 1, OP_MPI_DOUBLE, 0, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">   91</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   92</span>        <span class="keywordflow">if</span> (chance &gt; threshold)</div>
<div class="line"><span class="lineno">   93</span>        {</div>
<div class="line"><span class="lineno">   94</span>            <span class="keywordtype">int</span> di = (spacing[0] &gt;= Nx or deviation[0] == 0) ? 0 : (rand() % (2 * deviation[0]) - deviation[0]);</div>
<div class="line"><span class="lineno">   95</span>            <span class="keywordtype">int</span> dj = (spacing[1] &gt;= Ny or deviation[1] == 0) ? 0 : (rand() % (2 * deviation[1]) - deviation[1]);</div>
<div class="line"><span class="lineno">   96</span>            <span class="keywordtype">int</span> dk = (spacing[2] &gt;= Nz or deviation[2] == 0) ? 0 : (rand() % (2 * deviation[2]) - deviation[2]);</div>
<div class="line"><span class="lineno">   97</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno">   98</span>            OP_MPI_Bcast(&amp;(di), 1, OP_MPI_INT, 0, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">   99</span>            OP_MPI_Bcast(&amp;(dj), 1, OP_MPI_INT, 0, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  100</span>            OP_MPI_Bcast(&amp;(dk), 1, OP_MPI_INT, 0, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  101</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  102</span>            <span class="keywordflow">if</span> (i + di &gt;= 0 and i + di &lt; Nx and</div>
<div class="line"><span class="lineno">  103</span>                j + dj &gt;= 0 and j + dj &lt; Ny and</div>
<div class="line"><span class="lineno">  104</span>                k + dk &gt;= 0 and k + dk &lt; Nz)</div>
<div class="line"><span class="lineno">  105</span>            {</div>
<div class="line"><span class="lineno">  106</span>                <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.PlantGrainNucleus(phaseIndex, i + di, j + dj, k + dk);</div>
<div class="line"><span class="lineno">  107</span> </div>
<div class="line"><span class="lineno">  108</span>                iVector3 temp;</div>
<div class="line"><span class="lineno">  109</span>                temp[0] = i + di;</div>
<div class="line"><span class="lineno">  110</span>                temp[1] = j + dj;</div>
<div class="line"><span class="lineno">  111</span>                temp[2] = k + dk;</div>
<div class="line"><span class="lineno">  112</span>                result.push_back(temp);</div>
<div class="line"><span class="lineno">  113</span>            }</div>
<div class="line"><span class="lineno">  114</span>        }</div>
<div class="line"><span class="lineno">  115</span>    }</div>
<div class="line"><span class="lineno">  116</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  117</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aef15494f9db14242504e99225aaf6b9f" name="aef15494f9db14242504e99225aaf6b9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef15494f9db14242504e99225aaf6b9f">&#9670;&#160;</a></span>QuasiRandomSpheres()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; <a class="el" href="../../da/d9c/classopenphase_1_1iVector3.html">iVector3</a> &gt; openphase::Initializations::QuasiRandomSpheres </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>phaseIndex1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>phaseIndex2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>probabilityPhase1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>offset</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>seed</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Populates spherical grains of two different phases on a regular grid with grid spacing "distance" and local random "offset" of each sphere. </p>

<p class="definition">Definition at line <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html#l00119">119</a> of file <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html">Initializations.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  129</span>{</div>
<div class="line"><span class="lineno">  130</span>    vector&lt;iVector3&gt; result;</div>
<div class="line"><span class="lineno">  131</span> </div>
<div class="line"><span class="lineno">  132</span>    <span class="keywordflow">if</span> (seed == -1)</div>
<div class="line"><span class="lineno">  133</span>    {</div>
<div class="line"><span class="lineno">  134</span>        srand(time(NULL));</div>
<div class="line"><span class="lineno">  135</span>    }</div>
<div class="line"><span class="lineno">  136</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  137</span>    {</div>
<div class="line"><span class="lineno">  138</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno">  139</span>        srand(pow(seed + MPI_RANK,(MPI_RANK + 1)));</div>
<div class="line"><span class="lineno">  140</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  141</span>        srand(seed);</div>
<div class="line"><span class="lineno">  142</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  143</span>    }</div>
<div class="line"><span class="lineno">  144</span> </div>
<div class="line"><span class="lineno">  145</span>    <span class="keywordtype">int</span> Nx = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNx;</div>
<div class="line"><span class="lineno">  146</span>    <span class="keywordtype">int</span> Ny = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNy;</div>
<div class="line"><span class="lineno">  147</span>    <span class="keywordtype">int</span> Nz = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNz;</div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span>    <span class="keywordtype">int</span> distx = (dist &lt; Nx) ? dist : 0;</div>
<div class="line"><span class="lineno">  150</span>    <span class="keywordtype">int</span> disty = (dist &lt; Ny) ? dist : 0;</div>
<div class="line"><span class="lineno">  151</span>    <span class="keywordtype">int</span> distz = (dist &lt; Nz) ? dist : 0;</div>
<div class="line"><span class="lineno">  152</span>    <span class="keywordtype">double</span> threshold = 0.05;</div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = distx; i &lt; Nx; i += 2 * dist)</div>
<div class="line"><span class="lineno">  155</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = disty; j &lt; Ny; j += 2 * dist)</div>
<div class="line"><span class="lineno">  156</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = distz; k &lt; Nz; k += 2 * dist)</div>
<div class="line"><span class="lineno">  157</span>    {</div>
<div class="line"><span class="lineno">  158</span>        <span class="keywordtype">double</span> chance = double(rand()) / double(RAND_MAX);</div>
<div class="line"><span class="lineno">  159</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno">  160</span>        OP_MPI_Bcast(&amp;(chance), 1, OP_MPI_DOUBLE, 0, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  161</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  162</span>        <span class="keywordflow">if</span> (chance &gt; threshold)</div>
<div class="line"><span class="lineno">  163</span>        {</div>
<div class="line"><span class="lineno">  164</span>            <span class="keywordtype">int</span> di = (distx == 0 or offset == 0) ? 0 : (rand() % (2 * offset) - offset);</div>
<div class="line"><span class="lineno">  165</span>            <span class="keywordtype">int</span> dj = (disty == 0 or offset == 0) ? 0 : (rand() % (2 * offset) - offset);</div>
<div class="line"><span class="lineno">  166</span>            <span class="keywordtype">int</span> dk = (distz == 0 or offset == 0) ? 0 : (rand() % (2 * offset) - offset);</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno">  169</span>            OP_MPI_Bcast(&amp;(di), 1, OP_MPI_INT, 0, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  170</span>            OP_MPI_Bcast(&amp;(dj), 1, OP_MPI_INT, 0, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  171</span>            OP_MPI_Bcast(&amp;(dk), 1, OP_MPI_INT, 0, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  172</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  173</span>            <span class="keywordflow">if</span> (i + di &gt;= 0 and i + di &lt; Nx and</div>
<div class="line"><span class="lineno">  174</span>                j + dj &gt;= 0 and j + dj &lt; Ny and</div>
<div class="line"><span class="lineno">  175</span>                k + dk &gt;= 0 and k + dk &lt; Nz)</div>
<div class="line"><span class="lineno">  176</span>            {</div>
<div class="line"><span class="lineno">  177</span>                <span class="keywordtype">double</span> randPhase = double(rand()) / double(RAND_MAX);</div>
<div class="line"><span class="lineno">  178</span>                <span class="keywordflow">if</span> (randPhase &lt; probabilityPhase1)</div>
<div class="line"><span class="lineno">  179</span>                {</div>
<div class="line"><span class="lineno">  180</span>                    <a class="code hl_function" href="../../de/dee/classopenphase_1_1Initializations.html#a8127e68e3549a12584b2f55f580e494c">Initializations::Sphere</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, phaseIndex1, radius1, i+di, j+dj, k+dk, BC);</div>
<div class="line"><span class="lineno">  181</span>                }</div>
<div class="line"><span class="lineno">  182</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  183</span>                {</div>
<div class="line"><span class="lineno">  184</span>                    <a class="code hl_function" href="../../de/dee/classopenphase_1_1Initializations.html#a8127e68e3549a12584b2f55f580e494c">Initializations::Sphere</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, phaseIndex2, radius2, i+di, j+dj, k+dk, BC);</div>
<div class="line"><span class="lineno">  185</span>                }</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>                iVector3 temp;</div>
<div class="line"><span class="lineno">  188</span>                temp[0] = i + di;</div>
<div class="line"><span class="lineno">  189</span>                temp[1] = j + dj;</div>
<div class="line"><span class="lineno">  190</span>                temp[2] = k + dk;</div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span>                result.push_back(temp);</div>
<div class="line"><span class="lineno">  193</span>            }</div>
<div class="line"><span class="lineno">  194</span>        }</div>
<div class="line"><span class="lineno">  195</span>    }</div>
<div class="line"><span class="lineno">  196</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  197</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1021dd2238e2f3cf8e7566b7f5ebecf0" name="a1021dd2238e2f3cf8e7566b7f5ebecf0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1021dd2238e2f3cf8e7566b7f5ebecf0">&#9670;&#160;</a></span>RandomNuclei()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::Initializations::RandomNuclei </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;&#160;</td>
          <td class="paramname"><em>locSettings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>phaseIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>Nparticles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>randomOrientation</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>randomVariants</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>onPlane</em> = <code>&quot;No&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>seed</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html#l00199">199</a> of file <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html">Initializations.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  207</span>{</div>
<div class="line"><span class="lineno">  208</span>    <span class="keywordflow">if</span> (seed == -1)</div>
<div class="line"><span class="lineno">  209</span>    {</div>
<div class="line"><span class="lineno">  210</span>        srand(time(NULL));</div>
<div class="line"><span class="lineno">  211</span>    }</div>
<div class="line"><span class="lineno">  212</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  213</span>    {</div>
<div class="line"><span class="lineno">  214</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno">  215</span>        srand(pow(seed + MPI_RANK,(MPI_RANK + 1)));</div>
<div class="line"><span class="lineno">  216</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  217</span>        srand(seed);</div>
<div class="line"><span class="lineno">  218</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  219</span>    }</div>
<div class="line"><span class="lineno">  220</span> </div>
<div class="line"><span class="lineno">  221</span>    default_random_engine OrientationsGenerator(2*seed);</div>
<div class="line"><span class="lineno">  222</span>    default_random_engine VariantsGenerator(3*seed);</div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; Nparticles; n++)</div>
<div class="line"><span class="lineno">  225</span>    {</div>
<div class="line"><span class="lineno">  226</span>        <span class="keywordtype">bool</span> planted = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  227</span>        <span class="keywordtype">int</span> iterations = 0;</div>
<div class="line"><span class="lineno">  228</span>        <span class="keywordflow">while</span>(!planted and iterations &lt; 1000)</div>
<div class="line"><span class="lineno">  229</span>        {</div>
<div class="line"><span class="lineno">  230</span>            iterations++;</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>            <span class="keywordtype">int</span> di = 0;</div>
<div class="line"><span class="lineno">  233</span>            <span class="keywordflow">if</span>     (onPlane == <span class="stringliteral">&quot;Xbottom&quot;</span>) {di = 0;}</div>
<div class="line"><span class="lineno">  234</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(onPlane == <span class="stringliteral">&quot;Xtop&quot;</span>)    {di = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Nx - 1;}</div>
<div class="line"><span class="lineno">  235</span>            <span class="keywordflow">else</span>                          {di = rand() % <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Nx;};</div>
<div class="line"><span class="lineno">  236</span> </div>
<div class="line"><span class="lineno">  237</span>            <span class="keywordtype">int</span> dj = 0;</div>
<div class="line"><span class="lineno">  238</span>            <span class="keywordflow">if</span>     (onPlane == <span class="stringliteral">&quot;Ybottom&quot;</span>) {dj = 0;}</div>
<div class="line"><span class="lineno">  239</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(onPlane == <span class="stringliteral">&quot;Ytop&quot;</span>)    {dj = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Ny - 1;}</div>
<div class="line"><span class="lineno">  240</span>            <span class="keywordflow">else</span>                          {dj = rand() % <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Ny;};</div>
<div class="line"><span class="lineno">  241</span> </div>
<div class="line"><span class="lineno">  242</span>            <span class="keywordtype">int</span> dk = 0;</div>
<div class="line"><span class="lineno">  243</span>            <span class="keywordflow">if</span>     (onPlane == <span class="stringliteral">&quot;Zbottom&quot;</span>) {dk = 0;}</div>
<div class="line"><span class="lineno">  244</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(onPlane == <span class="stringliteral">&quot;Ztop&quot;</span>)    {dk = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Nz - 1;}</div>
<div class="line"><span class="lineno">  245</span>            <span class="keywordflow">else</span>                          {dk = rand() % <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Nz;};</div>
<div class="line"><span class="lineno">  246</span> </div>
<div class="line"><span class="lineno">  247</span>            <span class="keywordtype">bool</span> freecell = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  248</span> </div>
<div class="line"><span class="lineno">  249</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = - <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth; ii &lt;= <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth; ii++)</div>
<div class="line"><span class="lineno">  250</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = - <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth; jj &lt;= <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth; jj++)</div>
<div class="line"><span class="lineno">  251</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk = - <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth; kk &lt;= <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth; kk++)</div>
<div class="line"><span class="lineno">  252</span>            <span class="keywordflow">if</span> ((di+ii &gt; -<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields.Bcells() and di+ii &lt; <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Nx + <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields.Bcells() and</div>
<div class="line"><span class="lineno">  253</span>                 dj+jj &gt; -<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields.Bcells() and dj+jj &lt; <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Ny + <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields.Bcells() and</div>
<div class="line"><span class="lineno">  254</span>                 dk+kk &gt; -<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields.Bcells() and dk+kk &lt; <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Nz + <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields.Bcells()) and</div>
<div class="line"><span class="lineno">  255</span>                <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(di+ii,dj+jj,dk+kk).flag)</div>
<div class="line"><span class="lineno">  256</span>            {</div>
<div class="line"><span class="lineno">  257</span>                freecell = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  258</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  259</span>            }</div>
<div class="line"><span class="lineno">  260</span>            <span class="keywordflow">if</span>(freecell)</div>
<div class="line"><span class="lineno">  261</span>            {</div>
<div class="line"><span class="lineno">  262</span>                <span class="keywordtype">int</span> locIndex = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.PlantGrainNucleus(phaseIndex, di, dj, dk);</div>
<div class="line"><span class="lineno">  263</span>                <span class="keywordflow">if</span>(randomOrientation)</div>
<div class="line"><span class="lineno">  264</span>                {</div>
<div class="line"><span class="lineno">  265</span>                    uniform_real_distribution&lt;double&gt; loc_orientation(0, 180);</div>
<div class="line"><span class="lineno">  266</span>                    <span class="keywordtype">int</span> Q1 = loc_orientation(VariantsGenerator);</div>
<div class="line"><span class="lineno">  267</span>                    <span class="keywordtype">int</span> Q2 = loc_orientation(VariantsGenerator);</div>
<div class="line"><span class="lineno">  268</span>                    <span class="keywordtype">int</span> Q3 = loc_orientation(VariantsGenerator);</div>
<div class="line"><span class="lineno">  269</span>                    EulerAngles locAngles({Q1*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>/180, Q2*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>/180, Q3*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>/180}, <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a631078f50f3da2bf1138bc0182054010ab71eaef9d6f6d31e69a4401fc00b737c">XYZ</a>);</div>
<div class="line"><span class="lineno">  270</span> </div>
<div class="line"><span class="lineno">  271</span>                    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[locIndex].Orientation = locAngles.getQuaternion();</div>
<div class="line"><span class="lineno">  272</span>                }</div>
<div class="line"><span class="lineno">  273</span>                <span class="keywordflow">if</span>(randomVariants)</div>
<div class="line"><span class="lineno">  274</span>                {</div>
<div class="line"><span class="lineno">  275</span>                    uniform_int_distribution&lt;int&gt; loc_variant(0, locSettings.Nvariants[phaseIndex]-1);</div>
<div class="line"><span class="lineno">  276</span>                    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[locIndex].Variant = loc_variant(VariantsGenerator);</div>
<div class="line"><span class="lineno">  277</span>                }</div>
<div class="line"><span class="lineno">  278</span>                planted = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  279</span>            }</div>
<div class="line"><span class="lineno">  280</span>        }</div>
<div class="line"><span class="lineno">  281</span>    }</div>
<div class="line"><span class="lineno">  282</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6eefb969b6510a77019b14a44450a0c7" name="a6eefb969b6510a77019b14a44450a0c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6eefb969b6510a77019b14a44450a0c7">&#9670;&#160;</a></span>Read()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::Initializations::Read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>FileInputName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html#l00852">852</a> of file <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html">Initializations.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  854</span>{</div>
<div class="line"><span class="lineno">  855</span>    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Read(FileName);</div>
<div class="line"><span class="lineno">  856</span> </div>
<div class="line"><span class="lineno">  857</span>    <span class="keywordflow">if</span>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Resolution == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e">Resolutions::Single</a>)</div>
<div class="line"><span class="lineno">  858</span>    {</div>
<div class="line"><span class="lineno">  859</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a71aed4b94e116454c7b11985a91e49ec">STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields.Bcells())</div>
<div class="line"><span class="lineno">  860</span>        {</div>
<div class="line"><span class="lineno">  861</span>            <span class="keywordflow">for</span>(<span class="keyword">auto</span> alpha = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).begin();</div>
<div class="line"><span class="lineno">  862</span>                     alpha != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).end(); alpha++)</div>
<div class="line"><span class="lineno">  863</span>            {</div>
<div class="line"><span class="lineno">  864</span>               <span class="keywordflow">if</span>(alpha-&gt;index &gt;= <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties.size())</div>
<div class="line"><span class="lineno">  865</span>               {</div>
<div class="line"><span class="lineno">  866</span>                   <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties.Reallocate(alpha-&gt;index+1);</div>
<div class="line"><span class="lineno">  867</span>               }</div>
<div class="line"><span class="lineno">  868</span>               <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[alpha-&gt;index].Exist = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  869</span>           }</div>
<div class="line"><span class="lineno">  870</span>        }</div>
<div class="line"><span class="lineno">  871</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a6ad2c83345f230517a1770304d7b39ad">STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  872</span>    }</div>
<div class="line"><span class="lineno">  873</span> </div>
<div class="line"><span class="lineno">  874</span>    <span class="keywordflow">if</span>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Resolution == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>)</div>
<div class="line"><span class="lineno">  875</span>    {</div>
<div class="line"><span class="lineno">  876</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a71aed4b94e116454c7b11985a91e49ec">STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsDR,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsDR.Bcells())</div>
<div class="line"><span class="lineno">  877</span>        {</div>
<div class="line"><span class="lineno">  878</span>            <span class="keywordflow">for</span>(<span class="keyword">auto</span> alpha = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsDR(i,j,k).begin();</div>
<div class="line"><span class="lineno">  879</span>                     alpha != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsDR(i,j,k).end(); alpha++)</div>
<div class="line"><span class="lineno">  880</span>            {</div>
<div class="line"><span class="lineno">  881</span>                <span class="keywordflow">if</span>(alpha-&gt;index &gt;= <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties.size())</div>
<div class="line"><span class="lineno">  882</span>                {</div>
<div class="line"><span class="lineno">  883</span>                    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties.Reallocate(alpha-&gt;index+1);</div>
<div class="line"><span class="lineno">  884</span>                }</div>
<div class="line"><span class="lineno">  885</span>                <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[alpha-&gt;index].Exist = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  886</span>            }</div>
<div class="line"><span class="lineno">  887</span>        }</div>
<div class="line"><span class="lineno">  888</span>        <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a6ad2c83345f230517a1770304d7b39ad">STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  889</span>    }</div>
<div class="line"><span class="lineno">  890</span>    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Finalize(BC);</div>
<div class="line"><span class="lineno">  891</span>}</div>
<div class="ttc" id="anamespaceopenphase_html_a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e">openphase::Resolutions::Single</a></div><div class="ttdeci">@ Single</div><div class="ttdoc">Single resolution for all fields.</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2f58993d5f0946a99c22f082add441c7" name="a2f58993d5f0946a99c22f082add441c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f58993d5f0946a99c22f082add441c7">&#9670;&#160;</a></span>ReadCSV()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::Initializations::ReadCSV </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::filesystem::path&#160;</td>
          <td class="paramname"><em>FilePath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>Separator</em> = <code>','</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html#l02196">2196</a> of file <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html">Initializations.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2197</span>{</div>
<div class="line"><span class="lineno"> 2198</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3adb3c1b74bf9ac814922b7a8283707e">ConsoleOutput::WriteLineInsert</a>(<span class="stringliteral">&quot;Reading CSV file&quot;</span>);</div>
<div class="line"><span class="lineno"> 2199</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Filename&quot;</span>, FilePath.string());</div>
<div class="line"><span class="lineno"> 2200</span> </div>
<div class="line"><span class="lineno"> 2201</span>    <span class="comment">// Open file</span></div>
<div class="line"><span class="lineno"> 2202</span>    std::ifstream file(FilePath);</div>
<div class="line"><span class="lineno"> 2203</span>    <span class="keywordflow">if</span> (!file.is_open())</div>
<div class="line"><span class="lineno"> 2204</span>    {</div>
<div class="line"><span class="lineno"> 2205</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a421faa2fe5d86991328b2b06041a326d">ConsoleOutput::WriteExit</a>(<span class="stringliteral">&quot;Could not open file&quot;</span>, FilePath.string(), <span class="stringliteral">&quot;ReadCSV&quot;</span>);</div>
<div class="line"><span class="lineno"> 2206</span>        <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a4d6fed4ab71c6edf2a0bd5dabecc6ec6">OP_Exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 2207</span>    }</div>
<div class="line"><span class="lineno"> 2208</span> </div>
<div class="line"><span class="lineno"> 2209</span>    <span class="comment">// Read data</span></div>
<div class="line"><span class="lineno"> 2210</span>    std::set&lt;size_t&gt; PhaseIndices;</div>
<div class="line"><span class="lineno"> 2211</span>    std::vector&lt;std::vector&lt;long int&gt;&gt; data;</div>
<div class="line"><span class="lineno"> 2212</span>    {</div>
<div class="line"><span class="lineno"> 2213</span>        std::string line;</div>
<div class="line"><span class="lineno"> 2214</span>        <span class="keywordflow">while</span> (std::getline(file, line))</div>
<div class="line"><span class="lineno"> 2215</span>        {</div>
<div class="line"><span class="lineno"> 2216</span>            std::vector&lt;long int&gt; row;</div>
<div class="line"><span class="lineno"> 2217</span>            std::istringstream lineStream(line);</div>
<div class="line"><span class="lineno"> 2218</span>            std::string cell;</div>
<div class="line"><span class="lineno"> 2219</span> </div>
<div class="line"><span class="lineno"> 2220</span>            <span class="keywordflow">while</span> (std::getline(lineStream, cell, Separator))</div>
<div class="line"><span class="lineno"> 2221</span>            {</div>
<div class="line"><span class="lineno"> 2222</span>                <span class="keywordflow">try</span></div>
<div class="line"><span class="lineno"> 2223</span>                {</div>
<div class="line"><span class="lineno"> 2224</span>                    <span class="keywordtype">long</span> <span class="keywordtype">int</span> value = std::stol(cell);</div>
<div class="line"><span class="lineno"> 2225</span>                    row.push_back(value);</div>
<div class="line"><span class="lineno"> 2226</span>                }</div>
<div class="line"><span class="lineno"> 2227</span>                <span class="keywordflow">catch</span> (std::invalid_argument&amp; e)</div>
<div class="line"><span class="lineno"> 2228</span>                {</div>
<div class="line"><span class="lineno"> 2229</span>                    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a421faa2fe5d86991328b2b06041a326d">ConsoleOutput::WriteExit</a>(<span class="stringliteral">&quot;Invalid argument: &quot;</span>+cell, <a class="code hl_variable" href="../../de/dee/classopenphase_1_1Initializations.html#a430c428a01443e146ef506a3305998a2">thisclassname</a>, <span class="stringliteral">&quot;ReadCSV&quot;</span>);</div>
<div class="line"><span class="lineno"> 2230</span>                    <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a4d6fed4ab71c6edf2a0bd5dabecc6ec6">OP_Exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 2231</span>                }</div>
<div class="line"><span class="lineno"> 2232</span>                <span class="keywordflow">catch</span> (std::out_of_range&amp; e)</div>
<div class="line"><span class="lineno"> 2233</span>                {</div>
<div class="line"><span class="lineno"> 2234</span>                    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a421faa2fe5d86991328b2b06041a326d">ConsoleOutput::WriteExit</a>(<span class="stringliteral">&quot;Out of range: &quot;</span>+cell, <a class="code hl_variable" href="../../de/dee/classopenphase_1_1Initializations.html#a430c428a01443e146ef506a3305998a2">thisclassname</a>, <span class="stringliteral">&quot;ReadCSV&quot;</span>);</div>
<div class="line"><span class="lineno"> 2235</span>                    <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a4d6fed4ab71c6edf2a0bd5dabecc6ec6">OP_Exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 2236</span>                }</div>
<div class="line"><span class="lineno"> 2237</span>            }</div>
<div class="line"><span class="lineno"> 2238</span>            <span class="keywordflow">if</span> (row.size() != 5u)</div>
<div class="line"><span class="lineno"> 2239</span>            {</div>
<div class="line"><span class="lineno"> 2240</span>                <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a421faa2fe5d86991328b2b06041a326d">ConsoleOutput::WriteExit</a>(<span class="stringliteral">&quot;Wrong data format. Expected 4 columns i,j,k,phaseIdx,grainIdx&quot;</span>, <a class="code hl_variable" href="../../de/dee/classopenphase_1_1Initializations.html#a430c428a01443e146ef506a3305998a2">thisclassname</a>, <span class="stringliteral">&quot;ReadCSV&quot;</span>);</div>
<div class="line"><span class="lineno"> 2241</span>                <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a4d6fed4ab71c6edf2a0bd5dabecc6ec6">OP_Exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 2242</span>            }</div>
<div class="line"><span class="lineno"> 2243</span>            <span class="keywordtype">long</span> <span class="keywordtype">int</span> phaseIdx = row[3];</div>
<div class="line"><span class="lineno"> 2244</span>            <span class="keywordflow">if</span> (phaseIdx &lt; 0)</div>
<div class="line"><span class="lineno"> 2245</span>            {</div>
<div class="line"><span class="lineno"> 2246</span>                <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a421faa2fe5d86991328b2b06041a326d">ConsoleOutput::WriteExit</a>(<span class="stringliteral">&quot;Phase index must be positive&quot;</span>, <a class="code hl_variable" href="../../de/dee/classopenphase_1_1Initializations.html#a430c428a01443e146ef506a3305998a2">thisclassname</a>, <span class="stringliteral">&quot;ReadCSV&quot;</span>);</div>
<div class="line"><span class="lineno"> 2247</span>                <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a4d6fed4ab71c6edf2a0bd5dabecc6ec6">OP_Exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 2248</span>            }</div>
<div class="line"><span class="lineno"> 2249</span>            <span class="keywordflow">if</span> (row[4] &lt; 0)</div>
<div class="line"><span class="lineno"> 2250</span>            {</div>
<div class="line"><span class="lineno"> 2251</span>                <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a421faa2fe5d86991328b2b06041a326d">ConsoleOutput::WriteExit</a>(<span class="stringliteral">&quot;Grain index must be positive&quot;</span>, <a class="code hl_variable" href="../../de/dee/classopenphase_1_1Initializations.html#a430c428a01443e146ef506a3305998a2">thisclassname</a>, <span class="stringliteral">&quot;ReadCSV&quot;</span>);</div>
<div class="line"><span class="lineno"> 2252</span>                <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a4d6fed4ab71c6edf2a0bd5dabecc6ec6">OP_Exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 2253</span>            }</div>
<div class="line"><span class="lineno"> 2254</span>            PhaseIndices.insert(phaseIdx);</div>
<div class="line"><span class="lineno"> 2255</span>            data.push_back(row);</div>
<div class="line"><span class="lineno"> 2256</span>        }</div>
<div class="line"><span class="lineno"> 2257</span>        file.close();</div>
<div class="line"><span class="lineno"> 2258</span>    }</div>
<div class="line"><span class="lineno"> 2259</span>    <span class="keywordflow">if</span> (data.size() != (<span class="keywordtype">size_t</span>) <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNumberOfCells())</div>
<div class="line"><span class="lineno"> 2260</span>    {</div>
<div class="line"><span class="lineno"> 2261</span>        std::stringstream message;</div>
<div class="line"><span class="lineno"> 2262</span>        message &lt;&lt; <span class="stringliteral">&quot;Wrong number of rows, &quot;</span> &lt;&lt; data.size() &lt;&lt; <span class="stringliteral">&quot;, expected: Nx*Ny*Nz = &quot;</span> &lt;&lt; <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNumberOfCells();</div>
<div class="line"><span class="lineno"> 2263</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a421faa2fe5d86991328b2b06041a326d">ConsoleOutput::WriteExit</a>(message.str(), <a class="code hl_variable" href="../../de/dee/classopenphase_1_1Initializations.html#a430c428a01443e146ef506a3305998a2">thisclassname</a>, <span class="stringliteral">&quot;ReadCSV&quot;</span>);</div>
<div class="line"><span class="lineno"> 2264</span>        <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a4d6fed4ab71c6edf2a0bd5dabecc6ec6">OP_Exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 2265</span>    }</div>
<div class="line"><span class="lineno"> 2266</span> </div>
<div class="line"><span class="lineno"> 2267</span>    <span class="comment">// Set phase-field values</span></div>
<div class="line"><span class="lineno"> 2268</span>    std::map&lt;size_t, size_t&gt; grainIdxMap;</div>
<div class="line"><span class="lineno"> 2269</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; line : data) </div>
<div class="line"><span class="lineno"> 2270</span>    {</div>
<div class="line"><span class="lineno"> 2271</span>        <span class="keywordtype">long</span> <span class="keywordtype">int</span> i = line[0] - <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.OffsetX;</div>
<div class="line"><span class="lineno"> 2272</span>        <span class="keywordtype">long</span> <span class="keywordtype">int</span> j = line[1] - <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.OffsetY;</div>
<div class="line"><span class="lineno"> 2273</span>        <span class="keywordtype">long</span> <span class="keywordtype">int</span> k = line[2] - <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.OffsetZ;</div>
<div class="line"><span class="lineno"> 2274</span>        <span class="keywordflow">if</span> (i &lt; 0 or i &gt;= <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Nx) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2275</span>        <span class="keywordflow">if</span> (j &lt; 0 or j &gt;= <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Ny) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2276</span>        <span class="keywordflow">if</span> (k &lt; 0 or k &gt;= <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Nz) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2277</span>        <span class="keywordtype">size_t</span> phaseIdx = line[3];</div>
<div class="line"><span class="lineno"> 2278</span>        <span class="keywordtype">size_t</span> grainIdxFile = line[4];</div>
<div class="line"><span class="lineno"> 2279</span>        <span class="keywordtype">size_t</span> grainIdx = 0;</div>
<div class="line"><span class="lineno"> 2280</span>        <span class="keywordflow">if</span> (grainIdxMap.find(grainIdxFile) == grainIdxMap.end())</div>
<div class="line"><span class="lineno"> 2281</span>        {</div>
<div class="line"><span class="lineno"> 2282</span>            grainIdxMap[grainIdxFile] = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.AddGrainInfo(phaseIdx);</div>
<div class="line"><span class="lineno"> 2283</span>            grainIdx = grainIdxMap[grainIdxFile];</div>
<div class="line"><span class="lineno"> 2284</span>        }</div>
<div class="line"><span class="lineno"> 2285</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2286</span>        {</div>
<div class="line"><span class="lineno"> 2287</span>            grainIdx = grainIdxMap[grainIdxFile];</div>
<div class="line"><span class="lineno"> 2288</span>        }</div>
<div class="line"><span class="lineno"> 2289</span>        <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).set_value(grainIdx, 1.0);</div>
<div class="line"><span class="lineno"> 2290</span>    }</div>
<div class="line"><span class="lineno"> 2291</span>    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FinalizeInitialization(BC);</div>
<div class="line"><span class="lineno"> 2292</span>    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.SetBoundaryConditions(BC);</div>
<div class="line"><span class="lineno"> 2293</span> </div>
<div class="line"><span class="lineno"> 2294</span>    <span class="comment">// Smooth phase-field</span></div>
<div class="line"><span class="lineno"> 2295</span>    Storage3D&lt;NodePF,0&gt; tmp(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields);</div>
<div class="line"><span class="lineno"> 2296</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a71aed4b94e116454c7b11985a91e49ec">STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields,0)</div>
<div class="line"><span class="lineno"> 2297</span>    {</div>
<div class="line"><span class="lineno"> 2298</span>        <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.dNx)</div>
<div class="line"><span class="lineno"> 2299</span>        {</div>
<div class="line"><span class="lineno"> 2300</span>            <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).front().index != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i+1,j,k).front().index) tmp(i,j,k).add_value(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i+1,j,k).front().index, 1);</div>
<div class="line"><span class="lineno"> 2301</span>            <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).front().index != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i-1,j,k).front().index) tmp(i,j,k).add_value(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i-1,j,k).front().index, 1);</div>
<div class="line"><span class="lineno"> 2302</span>        }</div>
<div class="line"><span class="lineno"> 2303</span>        <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.dNy)</div>
<div class="line"><span class="lineno"> 2304</span>        {</div>
<div class="line"><span class="lineno"> 2305</span>            <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).front().index != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j+1,k).front().index) tmp(i,j,k).add_value(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j+1,k).front().index, 1);</div>
<div class="line"><span class="lineno"> 2306</span>            <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).front().index != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j-1,k).front().index) tmp(i,j,k).add_value(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j-1,k).front().index, 1);</div>
<div class="line"><span class="lineno"> 2307</span>        }</div>
<div class="line"><span class="lineno"> 2308</span>        <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.dNz)</div>
<div class="line"><span class="lineno"> 2309</span>        {</div>
<div class="line"><span class="lineno"> 2310</span>            <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).front().index != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k+1).front().index) tmp(i,j,k).add_value(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k+1).front().index, 1);</div>
<div class="line"><span class="lineno"> 2311</span>            <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).front().index != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k-1).front().index) tmp(i,j,k).add_value(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k-1).front().index, 1);</div>
<div class="line"><span class="lineno"> 2312</span>        }</div>
<div class="line"><span class="lineno"> 2313</span>        <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.dNx &amp;&amp; <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.dNy)</div>
<div class="line"><span class="lineno"> 2314</span>        {</div>
<div class="line"><span class="lineno"> 2315</span>            <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).front().index != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i-1,j+1,k).front().index) tmp(i,j,k).add_value(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i-1,j+1,k).front().index, 1);</div>
<div class="line"><span class="lineno"> 2316</span>            <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).front().index != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i-1,j-1,k).front().index) tmp(i,j,k).add_value(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i-1,j-1,k).front().index, 1);</div>
<div class="line"><span class="lineno"> 2317</span>            <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).front().index != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i+1,j+1,k).front().index) tmp(i,j,k).add_value(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i+1,j+1,k).front().index, 1);</div>
<div class="line"><span class="lineno"> 2318</span>            <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).front().index != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i+1,j-1,k).front().index) tmp(i,j,k).add_value(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i+1,j-1,k).front().index, 1);</div>
<div class="line"><span class="lineno"> 2319</span>        }</div>
<div class="line"><span class="lineno"> 2320</span>        <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.dNx &amp;&amp; <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.dNz)</div>
<div class="line"><span class="lineno"> 2321</span>        {</div>
<div class="line"><span class="lineno"> 2322</span>            <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).front().index != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i-1,j,k+1).front().index) tmp(i,j,k).add_value(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i-1,j,k+1).front().index, 1);</div>
<div class="line"><span class="lineno"> 2323</span>            <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).front().index != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i-1,j,k-1).front().index) tmp(i,j,k).add_value(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i-1,j,k-1).front().index, 1);</div>
<div class="line"><span class="lineno"> 2324</span>            <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).front().index != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i+1,j,k+1).front().index) tmp(i,j,k).add_value(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i+1,j,k+1).front().index, 1);</div>
<div class="line"><span class="lineno"> 2325</span>            <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).front().index != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i+1,j,k-1).front().index) tmp(i,j,k).add_value(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i+1,j,k-1).front().index, 1);</div>
<div class="line"><span class="lineno"> 2326</span>        }</div>
<div class="line"><span class="lineno"> 2327</span>        <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.dNy &amp;&amp; <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.dNz)</div>
<div class="line"><span class="lineno"> 2328</span>        {</div>
<div class="line"><span class="lineno"> 2329</span>            <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).front().index != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j-1,k+1).front().index) tmp(i,j,k).add_value(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j-1,k+1).front().index, 1);</div>
<div class="line"><span class="lineno"> 2330</span>            <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).front().index != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j-1,k-1).front().index) tmp(i,j,k).add_value(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j-1,k-1).front().index, 1);</div>
<div class="line"><span class="lineno"> 2331</span>            <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).front().index != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j+1,k+1).front().index) tmp(i,j,k).add_value(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j+1,k+1).front().index, 1);</div>
<div class="line"><span class="lineno"> 2332</span>            <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).front().index != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j+1,k-1).front().index) tmp(i,j,k).add_value(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j+1,k-1).front().index, 1);</div>
<div class="line"><span class="lineno"> 2333</span>        }</div>
<div class="line"><span class="lineno"> 2334</span>    }</div>
<div class="line"><span class="lineno"> 2335</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a6ad2c83345f230517a1770304d7b39ad">STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 2336</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a71aed4b94e116454c7b11985a91e49ec">STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields,0)</div>
<div class="line"><span class="lineno"> 2337</span>    {</div>
<div class="line"><span class="lineno"> 2338</span>        <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k) = tmp(i,j,k);</div>
<div class="line"><span class="lineno"> 2339</span>    }</div>
<div class="line"><span class="lineno"> 2340</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a6ad2c83345f230517a1770304d7b39ad">STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 2341</span>    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FinalizeInitialization(BC);</div>
<div class="line"><span class="lineno"> 2342</span>    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.SetBoundaryConditions(BC);</div>
<div class="line"><span class="lineno"> 2343</span>}</div>
<div class="ttc" id="aclassopenphase_1_1ConsoleOutput_html_a3adb3c1b74bf9ac814922b7a8283707e"><div class="ttname"><a href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3adb3c1b74bf9ac814922b7a8283707e">openphase::ConsoleOutput::WriteLineInsert</a></div><div class="ttdeci">static void WriteLineInsert(const std::string Insert, const std::string LineType=&quot;-&quot;)</div><div class="ttdef"><b>Definition</b> <a href="../../da/da0/ConsoleOutput_8cpp_source.html#l00117">ConsoleOutput.cpp:117</a></div></div>
<div class="ttc" id="aclassopenphase_1_1ConsoleOutput_html_ae2753bb70e817b1bdd5ae2b99adf6e0f"><div class="ttname"><a href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">openphase::ConsoleOutput::WriteStandard</a></div><div class="ttdeci">static void WriteStandard(const std::string &amp;Left, const T Right, const int precision=StandardPrecision, floatfield notation=StandardNotation, const size_t ColumnWidth=StandardColumnWidth)</div><div class="ttdoc">Writes GetStandard result to std::cout if MPI-Rank 0.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/dfe/ConsoleOutput_8h_source.html#l00291">ConsoleOutput.h:291</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a299918f9104019121b5316cfe616d7b4" name="a299918f9104019121b5316cfe616d7b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a299918f9104019121b5316cfe616d7b4">&#9670;&#160;</a></span>Rectangular()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t openphase::Initializations::Rectangular </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>PhaseIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>Lx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>Ly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>Lz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>y0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>z0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>Finalize</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initializes a rectangular grain. </p>

<p class="definition">Definition at line <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html#l00893">893</a> of file <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html">Initializations.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  898</span>{</div>
<div class="line"><span class="lineno">  899</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> iWidth = (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Resolution == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>) ? 0.5*<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth : <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth;</div>
<div class="line"><span class="lineno">  900</span>    <span class="comment">// Determine the area where the phase-field is one</span></div>
<div class="line"><span class="lineno">  901</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> SizeX = (Lx &lt; iWidth) ? 1: (Lx - iWidth)/2.0;</div>
<div class="line"><span class="lineno">  902</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> SizeY = (Ly &lt; iWidth) ? 1: (Ly - iWidth)/2.0;</div>
<div class="line"><span class="lineno">  903</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> SizeZ = (Lz &lt; iWidth) ? 1: (Lz - iWidth)/2.0;</div>
<div class="line"><span class="lineno">  904</span> </div>
<div class="line"><span class="lineno">  905</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> locIndex = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.AddGrainInfo(PhaseIndex);</div>
<div class="line"><span class="lineno">  906</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a71aed4b94e116454c7b11985a91e49ec">STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields.Bcells())</div>
<div class="line"><span class="lineno">  907</span>    {</div>
<div class="line"><span class="lineno">  908</span>        <span class="comment">// Determine relative coordinates</span></div>
<div class="line"><span class="lineno">  909</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> x = double(i+<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.OffsetX);</div>
<div class="line"><span class="lineno">  910</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> y = double(j+<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.OffsetY);</div>
<div class="line"><span class="lineno">  911</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> z = double(k+<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.OffsetZ);</div>
<div class="line"><span class="lineno">  912</span>        <span class="keyword">const</span> dVector3 pos  ({x , y, z});</div>
<div class="line"><span class="lineno">  913</span>        <span class="keyword">const</span> dVector3 pos0 ({x0,y0,z0});</div>
<div class="line"><span class="lineno">  914</span>        dVector3 dist = Tools::Distance&lt;dVector3&gt;(pos, pos0, <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNx, <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNy, <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNz, BC);</div>
<div class="line"><span class="lineno">  915</span>        dist[0] = std::abs(dist[0]) - SizeX;</div>
<div class="line"><span class="lineno">  916</span>        dist[1] = std::abs(dist[1]) - SizeY;</div>
<div class="line"><span class="lineno">  917</span>        dist[2] = std::abs(dist[2]) - SizeZ;</div>
<div class="line"><span class="lineno">  918</span> </div>
<div class="line"><span class="lineno">  919</span>        <span class="comment">// Set cubic phase field</span></div>
<div class="line"><span class="lineno">  920</span>        <span class="keywordflow">if</span> (dist[0] &lt;= 0 and dist[1] &lt;= 0 and dist[2] &lt;= 0)</div>
<div class="line"><span class="lineno">  921</span>        {</div>
<div class="line"><span class="lineno">  922</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).clear();</div>
<div class="line"><span class="lineno">  923</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(locIndex, 1);</div>
<div class="line"><span class="lineno">  924</span>        }</div>
<div class="line"><span class="lineno">  925</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dist[0] &lt;= iWidth and dist[1] &lt;= iWidth and dist[2] &lt;= iWidth)</div>
<div class="line"><span class="lineno">  926</span>        {</div>
<div class="line"><span class="lineno">  927</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> xx = std::max(dist[0], std::max(dist[1], dist[2]));</div>
<div class="line"><span class="lineno">  928</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> IntProf = 0.5 + 0.5 * std::cos(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a> * xx / iWidth);</div>
<div class="line"><span class="lineno">  929</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).flag = 2;</div>
<div class="line"><span class="lineno">  930</span> </div>
<div class="line"><span class="lineno">  931</span>            <span class="keywordtype">double</span> tmp = IntProf;</div>
<div class="line"><span class="lineno">  932</span>            <span class="keywordflow">for</span>(<span class="keyword">auto</span> alpha = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).begin();</div>
<div class="line"><span class="lineno">  933</span>                     alpha != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).end(); alpha++)</div>
<div class="line"><span class="lineno">  934</span>            <span class="keywordflow">if</span> (alpha-&gt;value &gt; tmp)</div>
<div class="line"><span class="lineno">  935</span>            {</div>
<div class="line"><span class="lineno">  936</span>                alpha-&gt;value -= tmp;</div>
<div class="line"><span class="lineno">  937</span>                tmp = 0;</div>
<div class="line"><span class="lineno">  938</span>            }</div>
<div class="line"><span class="lineno">  939</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  940</span>            {</div>
<div class="line"><span class="lineno">  941</span>                tmp -= alpha-&gt;value;</div>
<div class="line"><span class="lineno">  942</span>                alpha-&gt;value = 0;</div>
<div class="line"><span class="lineno">  943</span>            }</div>
<div class="line"><span class="lineno">  944</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).set_value(locIndex, IntProf);</div>
<div class="line"><span class="lineno">  945</span>        }</div>
<div class="line"><span class="lineno">  946</span>    }</div>
<div class="line"><span class="lineno">  947</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a6ad2c83345f230517a1770304d7b39ad">STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  948</span> </div>
<div class="line"><span class="lineno">  949</span>    <span class="keywordflow">if</span> (Finalize)</div>
<div class="line"><span class="lineno">  950</span>    {</div>
<div class="line"><span class="lineno">  951</span>        <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Finalize(BC);</div>
<div class="line"><span class="lineno">  952</span> </div>
<div class="line"><span class="lineno">  953</span>        <span class="keywordflow">if</span>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Resolution == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>)</div>
<div class="line"><span class="lineno">  954</span>        {</div>
<div class="line"><span class="lineno">  955</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Refine();</div>
<div class="line"><span class="lineno">  956</span>        }</div>
<div class="line"><span class="lineno">  957</span>    }</div>
<div class="line"><span class="lineno">  958</span>    <span class="keywordflow">return</span> locIndex;</div>
<div class="line"><span class="lineno">  959</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0e8b15a36d12c6e2e5c42dafb2e601ad" name="a0e8b15a36d12c6e2e5c42dafb2e601ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e8b15a36d12c6e2e5c42dafb2e601ad">&#9670;&#160;</a></span>RectangularGreenBody()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; size_t &gt; openphase::Initializations::RectangularGreenBody </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d1/d40/classopenphase_1_1Settings.html">Settings</a> &amp;&#160;</td>
          <td class="paramname"><em>locSettings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; size_t(long, long, long)&gt;&#160;</td>
          <td class="paramname"><em>SolidPhaseIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>FluidPhaseIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>SizeX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>SizeY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>SizeZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>MeanRadius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>StdRadius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>RandomSeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RelativeDensity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>accuracy</em> = <code>0.001</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>MaxItrations</em> = <code>100</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">SolidPhaseIndex</td><td>function that determines the phases of the grain which may depend on the position (i,j,k).  </td></tr>
    <tr><td class="paramname">FluidPhaseIndex</td><td>Index of fluid phase  </td></tr>
    <tr><td class="paramname">SizeX</td><td>First x-index of rectangular  </td></tr>
    <tr><td class="paramname">SizeY</td><td>First y-index of rectangular  </td></tr>
    <tr><td class="paramname">SizeZ</td><td>First a-index of rectangular  </td></tr>
    <tr><td class="paramname">MeanRadius</td><td>Mean radius of grains  </td></tr>
    <tr><td class="paramname">StdRadius</td><td>Standard deviation grain radius  </td></tr>
    <tr><td class="paramname">RandomSeed</td><td>Random number seed for initialization  </td></tr>
    <tr><td class="paramname">RelativeDensity</td><td>Relative Density of initialized green body  </td></tr>
    <tr><td class="paramname">accuracy</td><td>Accuracy of relative Density of initialized green body  </td></tr>
    <tr><td class="paramname">MaxItrations</td><td>Maximum number of attempt to initialize green body of specified density </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html#l01901">1901</a> of file <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html">Initializations.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1915</span>{</div>
<div class="line"><span class="lineno"> 1916</span>    <span class="comment">// Clamp input parameters </span></div>
<div class="line"><span class="lineno"> 1917</span>    SizeX = std::clamp(SizeX,0l,<span class="keywordtype">long</span>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNx));</div>
<div class="line"><span class="lineno"> 1918</span>    SizeY = std::clamp(SizeY,0l,<span class="keywordtype">long</span>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNy));</div>
<div class="line"><span class="lineno"> 1919</span>    SizeZ = std::clamp(SizeZ,0l,<span class="keywordtype">long</span>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNz));</div>
<div class="line"><span class="lineno"> 1920</span>    MeanRadius = std::clamp(MeanRadius,0.,std::numeric_limits&lt;double&gt;::max());</div>
<div class="line"><span class="lineno"> 1921</span>    StdRadius = std::clamp(StdRadius,0.,std::numeric_limits&lt;double&gt;::max());</div>
<div class="line"><span class="lineno"> 1922</span>    RelativeDensity = std::clamp(RelativeDensity,0.,1.0);</div>
<div class="line"><span class="lineno"> 1923</span>    accuracy = std::clamp(accuracy,0.,1.0);</div>
<div class="line"><span class="lineno"> 1924</span> </div>
<div class="line"><span class="lineno"> 1925</span>    <span class="comment">// Calculate rectangular coordinates</span></div>
<div class="line"><span class="lineno"> 1926</span>    <span class="keywordtype">long</span> x_min = std::max(<span class="keywordtype">int</span>((<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNx - SizeX)/2), 0);</div>
<div class="line"><span class="lineno"> 1927</span>    <span class="keywordtype">long</span> x_max = std::min(<span class="keywordtype">int</span>((<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNx - SizeX)/2 + SizeX), <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNx);</div>
<div class="line"><span class="lineno"> 1928</span>    <span class="keywordtype">long</span> y_min = std::max(<span class="keywordtype">int</span>((<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNy - SizeY)/2), 0);</div>
<div class="line"><span class="lineno"> 1929</span>    <span class="keywordtype">long</span> y_max = std::min(<span class="keywordtype">int</span>((<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNy - SizeY)/2 + SizeY), <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNx);</div>
<div class="line"><span class="lineno"> 1930</span>    <span class="keywordtype">long</span> z_min = std::max(<span class="keywordtype">int</span>((<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNz - SizeZ)/2), 0);</div>
<div class="line"><span class="lineno"> 1931</span>    <span class="keywordtype">long</span> z_max = std::min(<span class="keywordtype">int</span>((<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNz - SizeZ)/2 + SizeZ), <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNx);</div>
<div class="line"><span class="lineno"> 1932</span> </div>
<div class="line"><span class="lineno"> 1933</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a41683f616ffa4631340cb0de41cad70f">ConsoleOutput::Write</a>(<span class="stringliteral">&quot;Try to initialize micro structure with relative density&quot;</span>, RelativeDensity);</div>
<div class="line"><span class="lineno"> 1934</span>    std::vector&lt;size_t&gt; SpheresIdx;</div>
<div class="line"><span class="lineno"> 1935</span>    <span class="keyword">auto</span> SolidPhaseFraction = [&amp;<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>](<span class="keywordtype">long</span> i, <span class="keywordtype">long</span> j, <span class="keywordtype">long</span> k){<span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.SolidPhaseFraction(i,j,k);};</div>
<div class="line"><span class="lineno"> 1936</span>    <span class="keyword">auto</span> <a class="code hl_function" href="../../d1/d21/namespaceopenphase_1_1SystemOfLinearEquationsSolvers.html#a8be14318d84fda719a06937b2d0e619a">residual</a> = [&amp;] (<span class="keywordtype">double</span>&amp; MinDist)</div>
<div class="line"><span class="lineno"> 1937</span>    {</div>
<div class="line"><span class="lineno"> 1938</span>        <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Clear();</div>
<div class="line"><span class="lineno"> 1939</span>        <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties.Reallocate(0);</div>
<div class="line"><span class="lineno"> 1940</span>        <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e">Single</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>,FluidPhaseIndex,BC);</div>
<div class="line"><span class="lineno"> 1941</span>        SpheresIdx = <a class="code hl_function" href="../../de/dee/classopenphase_1_1Initializations.html#a0003060825e12ee11bca3375fe32dedf">FillRectangularWithSpheres</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, BC,locSettings,</div>
<div class="line"><span class="lineno"> 1942</span>                SolidPhaseIndex, MeanRadius, StdRadius,</div>
<div class="line"><span class="lineno"> 1943</span>                x_min,x_max,y_min,y_max,z_min,z_max, MinDist, RandomSeed, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1944</span>        <span class="keywordtype">double</span> RelRho = <a class="code hl_function" href="../../d7/d6d/structopenphase_1_1AnalysisSintering.html#a25c6865b2b3600e18833756cb5df0365">AnalysisSintering::CalculateDensity_LineIntersection</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>,SolidPhaseFraction);</div>
<div class="line"><span class="lineno"> 1945</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a41683f616ffa4631340cb0de41cad70f">ConsoleOutput::Write</a>(<span class="stringliteral">&quot;Density of micro structure: &quot;</span>+std::to_string(RelRho)+<span class="stringliteral">&quot; MinDist:&quot;</span>+std::to_string(MinDist));</div>
<div class="line"><span class="lineno"> 1946</span>        <span class="keywordflow">return</span> RelRho - RelativeDensity;</div>
<div class="line"><span class="lineno"> 1947</span>    };</div>
<div class="line"><span class="lineno"> 1948</span> </div>
<div class="line"><span class="lineno"> 1949</span>    <span class="keywordtype">double</span> MinDist = 0.0;</div>
<div class="line"><span class="lineno"> 1950</span>    <span class="keywordflow">try</span></div>
<div class="line"><span class="lineno"> 1951</span>    {</div>
<div class="line"><span class="lineno"> 1952</span>        <span class="keywordtype">double</span>&amp; x0 = MinDist;</div>
<div class="line"><span class="lineno"> 1953</span>        <span class="keywordtype">double</span>  x1 = MinDist+0.1;</div>
<div class="line"><span class="lineno"> 1954</span>        <a class="code hl_function" href="../../dd/d04/structopenphase_1_1RootFindingAlgorithms.html#a7ed5dc0fe50eb6e07e08f081ad824ddf">RootFindingAlgorithms::Secant</a>(residual, x0, x1, accuracy, MaxItrations);</div>
<div class="line"><span class="lineno"> 1955</span>    }</div>
<div class="line"><span class="lineno"> 1956</span>    <span class="keywordflow">catch</span> (std::runtime_error&amp; ecep)</div>
<div class="line"><span class="lineno"> 1957</span>    {</div>
<div class="line"><span class="lineno"> 1958</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">ConsoleOutput::WriteWarning</a>(ecep.what(),<span class="stringliteral">&quot;Initializations&quot;</span>,<span class="stringliteral">&quot;FillWithSpheresWithDensity&quot;</span>);</div>
<div class="line"><span class="lineno"> 1959</span>    }</div>
<div class="line"><span class="lineno"> 1960</span> </div>
<div class="line"><span class="lineno"> 1961</span>    <span class="comment">// Finalise initialization</span></div>
<div class="line"><span class="lineno"> 1962</span>    <span class="keywordflow">if</span>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Resolution == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>)</div>
<div class="line"><span class="lineno"> 1963</span>    {</div>
<div class="line"><span class="lineno"> 1964</span>        <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Refine();</div>
<div class="line"><span class="lineno"> 1965</span>    }</div>
<div class="line"><span class="lineno"> 1966</span>    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Finalize(BC);</div>
<div class="line"><span class="lineno"> 1967</span>    <span class="keywordflow">return</span> SpheresIdx;</div>
<div class="line"><span class="lineno"> 1968</span>}</div>
<div class="ttc" id="aclassopenphase_1_1Initializations_html_a0003060825e12ee11bca3375fe32dedf"><div class="ttname"><a href="../../de/dee/classopenphase_1_1Initializations.html#a0003060825e12ee11bca3375fe32dedf">openphase::Initializations::FillRectangularWithSpheres</a></div><div class="ttdeci">static std::vector&lt; size_t &gt; FillRectangularWithSpheres(PhaseField &amp;Phase, const BoundaryConditions &amp;BC, const Settings &amp;locSettings, std::function&lt; size_t(long int, long int, long int)&gt; PhaseIndex, double MeanRadius, double StdRadius, long int x_min, long int x_max, long int y_min, long int y_max, long int z_min, long int z_max, double MinDistance, size_t RandomSeedInput, bool Verbose=true)</div><div class="ttdoc">Fills rectangular domain densely with spherical grains of normal distributed size....</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d3a/Initializations_8cpp_source.html#l01705">Initializations.cpp:1705</a></div></div>
<div class="ttc" id="anamespaceopenphase_1_1SystemOfLinearEquationsSolvers_html_a8be14318d84fda719a06937b2d0e619a"><div class="ttname"><a href="../../d1/d21/namespaceopenphase_1_1SystemOfLinearEquationsSolvers.html#a8be14318d84fda719a06937b2d0e619a">openphase::SystemOfLinearEquationsSolvers::residual</a></div><div class="ttdeci">Vector OP_EXPORTS residual(const Matrix &amp;A, Vector &amp;x, const Vector &amp;b)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d33/SystemOfLinearEquationsSolvers_8h_source.html#l00159">SystemOfLinearEquationsSolvers.h:159</a></div></div>
<div class="ttc" id="astructopenphase_1_1AnalysisSintering_html_a25c6865b2b3600e18833756cb5df0365"><div class="ttname"><a href="../../d7/d6d/structopenphase_1_1AnalysisSintering.html#a25c6865b2b3600e18833756cb5df0365">openphase::AnalysisSintering::CalculateDensity_LineIntersection</a></div><div class="ttdeci">static double CalculateDensity_LineIntersection(const PhaseField &amp;Phase, const Field3D &amp;MassDensity)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dd0/AnalysisSintering_8cpp_source.html#l00376">AnalysisSintering.cpp:376</a></div></div>
<div class="ttc" id="astructopenphase_1_1RootFindingAlgorithms_html_a7ed5dc0fe50eb6e07e08f081ad824ddf"><div class="ttname"><a href="../../dd/d04/structopenphase_1_1RootFindingAlgorithms.html#a7ed5dc0fe50eb6e07e08f081ad824ddf">openphase::RootFindingAlgorithms::Secant</a></div><div class="ttdeci">static void Secant(UNARY func, T &amp;x0, T &amp;x1, T accuracy, unsigned long iterations)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d01/RootFindingAlgorithms_8h_source.html#l00119">RootFindingAlgorithms.h:119</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6734bf513d2a343979b02dad880605d0" name="a6734bf513d2a343979b02dad880605d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6734bf513d2a343979b02dad880605d0">&#9670;&#160;</a></span>SectionalPlane()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t openphase::Initializations::SectionalPlane </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>PhaseIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a>&#160;</td>
          <td class="paramname"><em>Point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a>&#160;</td>
          <td class="paramname"><em>Orientation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>NewGrain</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>FieldIndex</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initializes a new phase on the negative side of a sectional plane. </p>
<p>Initializes a new phase on the negative side of a plane </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Phase</td><td>Phase field </td></tr>
    <tr><td class="paramname">PhaseIndex</td><td>Phase index </td></tr>
    <tr><td class="paramname">Point</td><td>Point on plane </td></tr>
    <tr><td class="paramname">Orientation</td><td>Plane normal </td></tr>
    <tr><td class="paramname">BC</td><td>Boundary conditions </td></tr>
    <tr><td class="paramname">locSettings</td><td>Project settings </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html#l00293">293</a> of file <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html">Initializations.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  300</span>{</div>
<div class="line"><span class="lineno">  301</span>    <span class="keyword">const</span> dVector3 n      = Orientation.normalized();</div>
<div class="line"><span class="lineno">  302</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> iWidth = (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Resolution == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>) ? 0.5*<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth : <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth;</div>
<div class="line"><span class="lineno">  303</span> </div>
<div class="line"><span class="lineno">  304</span>    <span class="keywordtype">int</span> locIndex;</div>
<div class="line"><span class="lineno">  305</span>    <span class="keywordflow">if</span> (NewGrain)</div>
<div class="line"><span class="lineno">  306</span>    {</div>
<div class="line"><span class="lineno">  307</span>         locIndex = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.AddGrainInfo(PhaseIndex);</div>
<div class="line"><span class="lineno">  308</span>    }</div>
<div class="line"><span class="lineno">  309</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  310</span>    {</div>
<div class="line"><span class="lineno">  311</span>         locIndex = FieldIndex;</div>
<div class="line"><span class="lineno">  312</span>    }</div>
<div class="line"><span class="lineno">  313</span> </div>
<div class="line"><span class="lineno">  314</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a71aed4b94e116454c7b11985a91e49ec">STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields.Bcells())</div>
<div class="line"><span class="lineno">  315</span>    {</div>
<div class="line"><span class="lineno">  316</span>        <span class="keyword">const</span> dVector3 x = {double(i),double(j),double(k)}; <span class="comment">// position in space</span></div>
<div class="line"><span class="lineno">  317</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> distance = (x-Point)*n;   <span class="comment">// distance from plane</span></div>
<div class="line"><span class="lineno">  318</span> </div>
<div class="line"><span class="lineno">  319</span>        <span class="keywordflow">if</span> (distance &lt; - 0.5*iWidth)</div>
<div class="line"><span class="lineno">  320</span>        {</div>
<div class="line"><span class="lineno">  321</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).clear();</div>
<div class="line"><span class="lineno">  322</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(locIndex, 1.0);</div>
<div class="line"><span class="lineno">  323</span>        }</div>
<div class="line"><span class="lineno">  324</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (distance &lt;= 0.5*iWidth)</div>
<div class="line"><span class="lineno">  325</span>        {</div>
<div class="line"><span class="lineno">  326</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> IntProf = 0.5 - 0.5*std::sin(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>*(distance)/iWidth);</div>
<div class="line"><span class="lineno">  327</span>            <span class="keywordflow">for</span>(<span class="keyword">auto</span> alpha = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).begin();</div>
<div class="line"><span class="lineno">  328</span>                     alpha &lt; <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).end(); alpha++)</div>
<div class="line"><span class="lineno">  329</span>            {</div>
<div class="line"><span class="lineno">  330</span>                alpha-&gt;value *= 1.0 - IntProf;</div>
<div class="line"><span class="lineno">  331</span>            }</div>
<div class="line"><span class="lineno">  332</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(locIndex, IntProf);</div>
<div class="line"><span class="lineno">  333</span>        }</div>
<div class="line"><span class="lineno">  334</span>    }</div>
<div class="line"><span class="lineno">  335</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a6ad2c83345f230517a1770304d7b39ad">STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  336</span> </div>
<div class="line"><span class="lineno">  337</span>    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FinalizeInitialization(BC);</div>
<div class="line"><span class="lineno">  338</span>    <span class="keywordflow">return</span> locIndex;</div>
<div class="line"><span class="lineno">  339</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6193d2120c279795f6bc2fe927eddfe3" name="a6193d2120c279795f6bc2fe927eddfe3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6193d2120c279795f6bc2fe927eddfe3">&#9670;&#160;</a></span>Single()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t openphase::Initializations::Single </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>PhaseIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initializes a single space filling phase-field. </p>

<p class="definition">Definition at line <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html#l00502">502</a> of file <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html">Initializations.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  505</span>{</div>
<div class="line"><span class="lineno">  506</span>    <span class="keywordtype">size_t</span> locIndex = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.AddGrainInfo(PhaseIndex);</div>
<div class="line"><span class="lineno">  507</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a71aed4b94e116454c7b11985a91e49ec">STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields.Bcells())</div>
<div class="line"><span class="lineno">  508</span>    {</div>
<div class="line"><span class="lineno">  509</span>        <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).clear();</div>
<div class="line"><span class="lineno">  510</span>        <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(locIndex, 1.0);</div>
<div class="line"><span class="lineno">  511</span>    }</div>
<div class="line"><span class="lineno">  512</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a6ad2c83345f230517a1770304d7b39ad">STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  513</span> </div>
<div class="line"><span class="lineno">  514</span>    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FinalizeInitialization(BC);</div>
<div class="line"><span class="lineno">  515</span> </div>
<div class="line"><span class="lineno">  516</span>    <span class="keywordflow">return</span> locIndex;</div>
<div class="line"><span class="lineno">  517</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8127e68e3549a12584b2f55f580e494c" name="a8127e68e3549a12584b2f55f580e494c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8127e68e3549a12584b2f55f580e494c">&#9670;&#160;</a></span>Sphere()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t openphase::Initializations::Sphere </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>PhaseIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>Radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>Finalize</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initializes a spherical grain. </p>

<p class="definition">Definition at line <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html#l00341">341</a> of file <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html">Initializations.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  347</span>{</div>
<div class="line"><span class="lineno">  348</span>    <span class="comment">// &lt;&lt;&lt; It is safe to put sphere with its center coordinates outside</span></div>
<div class="line"><span class="lineno">  349</span>    <span class="comment">// &lt;&lt;&lt; of the simulation domain and its radius bigger than system</span></div>
<div class="line"><span class="lineno">  350</span>    <span class="comment">// &lt;&lt;&lt; dimensions thus not need for assertion.    //assert(x0 &gt;= 0);</span></div>
<div class="line"><span class="lineno">  351</span>    <span class="comment">//assert(y0 &gt;= 0);</span></div>
<div class="line"><span class="lineno">  352</span>    <span class="comment">//assert(z0 &gt;= 0);</span></div>
<div class="line"><span class="lineno">  353</span>    <span class="comment">//assert(x0 &lt; locSettings.TotalNx);</span></div>
<div class="line"><span class="lineno">  354</span>    <span class="comment">//assert(y0 &lt; locSettings.TotalNy);</span></div>
<div class="line"><span class="lineno">  355</span>    <span class="comment">//assert(z0 &lt; locSettings.TotalNz);</span></div>
<div class="line"><span class="lineno">  356</span>    <span class="comment">//assert(Radius &lt; std::max(locSettings.TotalNx,std::max(locSettings.TotalNy,locSettings.TotalNz)));</span></div>
<div class="line"><span class="lineno">  357</span> </div>
<div class="line"><span class="lineno">  358</span>    <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.dNx == 0) x0 = 0.0;</div>
<div class="line"><span class="lineno">  359</span>    <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.dNy == 0) y0 = 0.0;</div>
<div class="line"><span class="lineno">  360</span>    <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.dNz == 0) z0 = 0.0;</div>
<div class="line"><span class="lineno">  361</span> </div>
<div class="line"><span class="lineno">  362</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> iWidth = (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Resolution == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>) ? 0.5*<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth : <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth;</div>
<div class="line"><span class="lineno">  363</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> locIndex = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.AddGrainInfo(PhaseIndex);</div>
<div class="line"><span class="lineno">  364</span>    <span class="comment">//assert(Phase.FieldsProperties[locIndex].is_solid());</span></div>
<div class="line"><span class="lineno">  365</span>    <span class="keyword">auto</span> set_sphere = [&amp;iWidth,&amp;Radius,&amp;locIndex,&amp;<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>](<span class="keywordtype">long</span> <span class="keywordtype">int</span> i,<span class="keywordtype">long</span> <span class="keywordtype">int</span> j,<span class="keywordtype">long</span> <span class="keywordtype">int</span> k, <span class="keywordtype">double</span> rad)</div>
<div class="line"><span class="lineno">  366</span>    {</div>
<div class="line"><span class="lineno">  367</span>        <span class="keywordflow">if</span> (rad &lt; Radius - iWidth*0.5)</div>
<div class="line"><span class="lineno">  368</span>        {</div>
<div class="line"><span class="lineno">  369</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).clear();</div>
<div class="line"><span class="lineno">  370</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).set_value(locIndex, 1.0);</div>
<div class="line"><span class="lineno">  371</span>        }</div>
<div class="line"><span class="lineno">  372</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rad &lt;= Radius + iWidth*0.5)</div>
<div class="line"><span class="lineno">  373</span>        {</div>
<div class="line"><span class="lineno">  374</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> IntProf = 0.5 - 0.5*std::sin(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>*(rad - Radius)/iWidth);</div>
<div class="line"><span class="lineno">  375</span>            <span class="keywordflow">for</span>(<span class="keyword">auto</span> alpha = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).begin();</div>
<div class="line"><span class="lineno">  376</span>                     alpha &lt; <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).end(); alpha++)</div>
<div class="line"><span class="lineno">  377</span>            {</div>
<div class="line"><span class="lineno">  378</span>                alpha-&gt;value *= 1.0 - IntProf;</div>
<div class="line"><span class="lineno">  379</span>            }</div>
<div class="line"><span class="lineno">  380</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).set_value(locIndex, IntProf);</div>
<div class="line"><span class="lineno">  381</span>        }</div>
<div class="line"><span class="lineno">  382</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  383</span>    };</div>
<div class="line"><span class="lineno">  384</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> loop_radius = Radius + 1.1*iWidth;</div>
<div class="line"><span class="lineno">  385</span>    <a class="code hl_function" href="../../de/dee/classopenphase_1_1Initializations.html#ad00a0106bc9c6f3d9d62bf4677d10ac4">loop_sphere</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields, set_sphere, x0, y0, z0, loop_radius, <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid, BC);</div>
<div class="line"><span class="lineno">  386</span> </div>
<div class="line"><span class="lineno">  387</span>    <span class="keywordflow">if</span> (Finalize) <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FinalizeInitialization(BC);</div>
<div class="line"><span class="lineno">  388</span>    <span class="keywordflow">return</span> locIndex;</div>
<div class="line"><span class="lineno">  389</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aeb2d29324b962a37875a9269b8e69fe8" name="aeb2d29324b962a37875a9269b8e69fe8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb2d29324b962a37875a9269b8e69fe8">&#9670;&#160;</a></span>SphereFixedIdx()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::Initializations::SphereFixedIdx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>PhaseIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html#l01022">1022</a> of file <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html">Initializations.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1027</span>{</div>
<div class="line"><span class="lineno"> 1028</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> iWidth = (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Resolution == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>) ? 0.5*<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth : <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth;</div>
<div class="line"><span class="lineno"> 1029</span>    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[PhaseIndex].Exist = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1030</span>    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[PhaseIndex].Stage = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#af71cd9b36fd77e1eb90f17b95c04e52eafa3aff3c185c6dc7754235f397c2099a">GrainStages::Stable</a>;</div>
<div class="line"><span class="lineno"> 1031</span> </div>
<div class="line"><span class="lineno"> 1032</span>    <span class="keyword">auto</span> set_sphere = [&amp;iWidth,&amp;Radius,&amp;PhaseIndex,&amp;<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>,&amp;z0](<span class="keywordtype">long</span> <span class="keywordtype">int</span> i,<span class="keywordtype">long</span> <span class="keywordtype">int</span> j,<span class="keywordtype">long</span> <span class="keywordtype">int</span> k, <span class="keywordtype">double</span> rad)</div>
<div class="line"><span class="lineno"> 1033</span>    {</div>
<div class="line"><span class="lineno"> 1034</span>       <span class="keywordflow">if</span> (rad &lt; Radius - iWidth*0.5)</div>
<div class="line"><span class="lineno"> 1035</span>        {</div>
<div class="line"><span class="lineno"> 1036</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).clear();</div>
<div class="line"><span class="lineno"> 1037</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(PhaseIndex, 1.0);</div>
<div class="line"><span class="lineno"> 1038</span>        }</div>
<div class="line"><span class="lineno"> 1039</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rad &lt; Radius + iWidth*0.5)</div>
<div class="line"><span class="lineno"> 1040</span>        {</div>
<div class="line"><span class="lineno"> 1041</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> IntProf = 0.5 - 0.5*sin(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>*(rad - Radius)/iWidth);</div>
<div class="line"><span class="lineno"> 1042</span>            <span class="keywordflow">if</span>(IntProf &gt; <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, z0).get_value(PhaseIndex))</div>
<div class="line"><span class="lineno"> 1043</span>            {</div>
<div class="line"><span class="lineno"> 1044</span>                <span class="keywordflow">for</span>(<span class="keyword">auto</span> alpha = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).begin();</div>
<div class="line"><span class="lineno"> 1045</span>                         alpha &lt; <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).end(); alpha++)</div>
<div class="line"><span class="lineno"> 1046</span>                {</div>
<div class="line"><span class="lineno"> 1047</span>                    alpha-&gt;value *= 1.0 - IntProf;</div>
<div class="line"><span class="lineno"> 1048</span>                }</div>
<div class="line"><span class="lineno"> 1049</span>                <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(PhaseIndex, IntProf);</div>
<div class="line"><span class="lineno"> 1050</span>                <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).flag = 2;</div>
<div class="line"><span class="lineno"> 1051</span>            }</div>
<div class="line"><span class="lineno"> 1052</span>        }</div>
<div class="line"><span class="lineno"> 1053</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1054</span>    };</div>
<div class="line"><span class="lineno"> 1055</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> loop_radius = Radius + 1.1*iWidth;</div>
<div class="line"><span class="lineno"> 1056</span>    <a class="code hl_function" href="../../de/dee/classopenphase_1_1Initializations.html#ad00a0106bc9c6f3d9d62bf4677d10ac4">loop_sphere</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields, set_sphere, x0, y0, z0, loop_radius, <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid, BC);</div>
<div class="line"><span class="lineno"> 1057</span> </div>
<div class="line"><span class="lineno"> 1058</span>    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FinalizeInitialization(BC);</div>
<div class="line"><span class="lineno"> 1059</span>}</div>
<div class="ttc" id="anamespaceopenphase_html_af71cd9b36fd77e1eb90f17b95c04e52eafa3aff3c185c6dc7754235f397c2099a"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#af71cd9b36fd77e1eb90f17b95c04e52eafa3aff3c185c6dc7754235f397c2099a">openphase::GrainStages::Stable</a></div><div class="ttdeci">@ Stable</div><div class="ttdoc">The state of a stable grain (above critical size)</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a04e0312614d4d0f6354bbc18baf9bfff" name="a04e0312614d4d0f6354bbc18baf9bfff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04e0312614d4d0f6354bbc18baf9bfff">&#9670;&#160;</a></span>SphereInGrain()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t openphase::Initializations::SphereInGrain </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>ParrentPhaseFieldIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>PhaseIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>Radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>y0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>z0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>Finalize</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html#l01576">1576</a> of file <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html">Initializations.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1583</span>{</div>
<div class="line"><span class="lineno"> 1584</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> iWidth = (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Resolution == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>) ? 0.5*<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth : <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth;</div>
<div class="line"><span class="lineno"> 1585</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> locIndex = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.AddGrainInfo(PhaseIndex);</div>
<div class="line"><span class="lineno"> 1586</span>    <span class="keyword">auto</span> set_sphere = [&amp;iWidth,&amp;Radius,&amp;locIndex,&amp;<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>,&amp;ParrentPhaseFieldIndex](<span class="keywordtype">long</span> <span class="keywordtype">int</span> i,<span class="keywordtype">long</span> <span class="keywordtype">int</span> j,<span class="keywordtype">long</span> <span class="keywordtype">int</span> k, <span class="keywordtype">double</span> rad)</div>
<div class="line"><span class="lineno"> 1587</span>    {</div>
<div class="line"><span class="lineno"> 1588</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> ParrentPhaseAmount = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).get_value(ParrentPhaseFieldIndex);</div>
<div class="line"><span class="lineno"> 1589</span>        <span class="keywordflow">if</span> (rad &lt; (Radius - iWidth*0.5))</div>
<div class="line"><span class="lineno"> 1590</span>        {</div>
<div class="line"><span class="lineno"> 1591</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).set_value(ParrentPhaseFieldIndex, 0.0);</div>
<div class="line"><span class="lineno"> 1592</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).set_value(locIndex, ParrentPhaseAmount);</div>
<div class="line"><span class="lineno"> 1593</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).flag = 2;</div>
<div class="line"><span class="lineno"> 1594</span>        }</div>
<div class="line"><span class="lineno"> 1595</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rad &lt; (Radius + iWidth*0.5))</div>
<div class="line"><span class="lineno"> 1596</span>        {</div>
<div class="line"><span class="lineno"> 1597</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> Profile = (0.5 - 0.5*sin(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>*(rad- Radius)/iWidth))*ParrentPhaseAmount;</div>
<div class="line"><span class="lineno"> 1598</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(ParrentPhaseFieldIndex, ParrentPhaseAmount-Profile);</div>
<div class="line"><span class="lineno"> 1599</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(locIndex, Profile);</div>
<div class="line"><span class="lineno"> 1600</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).flag = 2;</div>
<div class="line"><span class="lineno"> 1601</span>        }</div>
<div class="line"><span class="lineno"> 1602</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1603</span>    };</div>
<div class="line"><span class="lineno"> 1604</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> loop_radius = Radius + 1.1*iWidth;</div>
<div class="line"><span class="lineno"> 1605</span>    <a class="code hl_function" href="../../de/dee/classopenphase_1_1Initializations.html#ad00a0106bc9c6f3d9d62bf4677d10ac4">loop_sphere</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields, set_sphere, x0, y0, z0, loop_radius, <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid, BC);</div>
<div class="line"><span class="lineno"> 1606</span> </div>
<div class="line"><span class="lineno"> 1607</span>    <span class="keywordflow">if</span> (Finalize) <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FinalizeInitialization(BC);</div>
<div class="line"><span class="lineno"> 1608</span>    <span class="keywordflow">return</span> locIndex;</div>
<div class="line"><span class="lineno"> 1609</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a044e8d01b134de2a1a41d897967e099d" name="a044e8d01b134de2a1a41d897967e099d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a044e8d01b134de2a1a41d897967e099d">&#9670;&#160;</a></span>ThermalGrooving()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; size_t &gt; openphase::Initializations::ThermalGrooving </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>PhaseIndex1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>PhaseIndex2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html#l01992">1992</a> of file <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html">Initializations.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1995</span>{</div>
<div class="line"><span class="lineno"> 1996</span>    <span class="keywordtype">size_t</span> Nx = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Nx;</div>
<div class="line"><span class="lineno"> 1997</span>    <span class="keywordtype">size_t</span> Nz = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Nz;</div>
<div class="line"><span class="lineno"> 1998</span> </div>
<div class="line"><span class="lineno"> 1999</span>    <span class="keywordtype">int</span> x = Nx/2.0;</div>
<div class="line"><span class="lineno"> 2000</span>    <span class="keywordtype">int</span> y = 0;</div>
<div class="line"><span class="lineno"> 2001</span>    <span class="keywordtype">int</span> z = Nz+1;</div>
<div class="line"><span class="lineno"> 2002</span>    <span class="keywordtype">int</span> dx = 3.0*Nx/4.0+1;</div>
<div class="line"><span class="lineno"> 2003</span>    <span class="keywordtype">int</span> dy = 0;</div>
<div class="line"><span class="lineno"> 2004</span>    <span class="keywordtype">int</span> dz = Nz/2.0;</div>
<div class="line"><span class="lineno"> 2005</span> </div>
<div class="line"><span class="lineno"> 2006</span>    vector&lt;size_t&gt; locIndex = <a class="code hl_function" href="../../de/dee/classopenphase_1_1Initializations.html#a59d1c821a077d34464a5572661922e0c">Fractional</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>,beta,beta,dz,BC);</div>
<div class="line"><span class="lineno"> 2007</span>    locIndex.push_back(<a class="code hl_function" href="../../de/dee/classopenphase_1_1Initializations.html#a299918f9104019121b5316cfe616d7b4">Rectangular</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>,alpha,x,y,z,dx,dy,dz,BC));</div>
<div class="line"><span class="lineno"> 2008</span> </div>
<div class="line"><span class="lineno"> 2009</span>    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.SetBoundaryConditions(BC);</div>
<div class="line"><span class="lineno"> 2010</span> </div>
<div class="line"><span class="lineno"> 2011</span>    <span class="keywordflow">return</span> locIndex;</div>
<div class="line"><span class="lineno"> 2012</span>}</div>
<div class="ttc" id="aclassopenphase_1_1Initializations_html_a299918f9104019121b5316cfe616d7b4"><div class="ttname"><a href="../../de/dee/classopenphase_1_1Initializations.html#a299918f9104019121b5316cfe616d7b4">openphase::Initializations::Rectangular</a></div><div class="ttdeci">static size_t Rectangular(PhaseField &amp;Phase, const size_t PhaseIndex, const double Lx, const double Ly, const double Lz, const double x0, const double y0, const double z0, const BoundaryConditions &amp;BC, const bool Finalize=true)</div><div class="ttdoc">Initializes a rectangular grain.</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d3a/Initializations_8cpp_source.html#l00893">Initializations.cpp:893</a></div></div>
<div class="ttc" id="aclassopenphase_1_1Initializations_html_a59d1c821a077d34464a5572661922e0c"><div class="ttname"><a href="../../de/dee/classopenphase_1_1Initializations.html#a59d1c821a077d34464a5572661922e0c">openphase::Initializations::Fractional</a></div><div class="ttdeci">static std::vector&lt; size_t &gt; Fractional(PhaseField &amp;Phase, size_t MajorityPhaseIndex, size_t MinorityPhaseIndex, double MinorityPhaseLayerThickness, BoundaryConditions &amp;BC)</div><div class="ttdoc">?? TODO</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d3a/Initializations_8cpp_source.html#l00559">Initializations.cpp:559</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab795c3359d3a9fbd77959400101b7580" name="ab795c3359d3a9fbd77959400101b7580"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab795c3359d3a9fbd77959400101b7580">&#9670;&#160;</a></span>ThreeFractionals()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; size_t &gt; openphase::Initializations::ThreeFractionals </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>MajorityPhaseIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>MajorityPhaseLayerThickness</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>MinorityPhaseIndex1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>MinorityPhaseLayerThickness1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>MinorityPhaseIndex2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>?? TODO </p>

<p class="definition">Definition at line <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html#l00606">606</a> of file <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html">Initializations.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  613</span>{</div>
<div class="line"><span class="lineno">  614</span> </div>
<div class="line"><span class="lineno">  615</span>    <span class="keywordflow">if</span>( BC.BC0Z != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5baa5af8c34dc3d5f295a4ce78e0930690d">BoundaryConditionTypes::NoFlux</a> or</div>
<div class="line"><span class="lineno">  616</span>        BC.BCNZ != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5baa5af8c34dc3d5f295a4ce78e0930690d">BoundaryConditionTypes::NoFlux</a> )</div>
<div class="line"><span class="lineno">  617</span>    {</div>
<div class="line"><span class="lineno">  618</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">ConsoleOutput::WriteWarning</a>(</div>
<div class="line"><span class="lineno">  619</span>                <span class="stringliteral">&quot;Consider NoFlux Boundary condition atleast along \n&quot;</span></div>
<div class="line"><span class="lineno">  620</span>                <span class="stringliteral">&quot;Z-direction for Fractional initialization&quot;</span>, <a class="code hl_variable" href="../../de/dee/classopenphase_1_1Initializations.html#a430c428a01443e146ef506a3305998a2">thisclassname</a>, <span class="stringliteral">&quot;Fractional&quot;</span>);</div>
<div class="line"><span class="lineno">  621</span>    }</div>
<div class="line"><span class="lineno">  622</span> </div>
<div class="line"><span class="lineno">  623</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> iWidth = (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Resolution == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>) ? 0.5*<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth : <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth;</div>
<div class="line"><span class="lineno">  624</span> </div>
<div class="line"><span class="lineno">  625</span>    <span class="keywordtype">size_t</span> index1 = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.AddGrainInfo(MajorityPhaseIndex);</div>
<div class="line"><span class="lineno">  626</span>    <span class="keywordtype">size_t</span> index2 = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.AddGrainInfo(MinorityPhaseIndex1);</div>
<div class="line"><span class="lineno">  627</span>    <span class="keywordtype">size_t</span> index3 = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.AddGrainInfo(MinorityPhaseIndex2);</div>
<div class="line"><span class="lineno">  628</span> </div>
<div class="line"><span class="lineno">  629</span>    <span class="keywordtype">int</span> offset1 = MajorityPhaseLayerThickness;</div>
<div class="line"><span class="lineno">  630</span>    <span class="keywordtype">int</span> offset2 = MinorityPhaseLayerThickness1;</div>
<div class="line"><span class="lineno">  631</span> </div>
<div class="line"><span class="lineno">  632</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a71aed4b94e116454c7b11985a91e49ec">STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields.Bcells())</div>
<div class="line"><span class="lineno">  633</span>    {</div>
<div class="line"><span class="lineno">  634</span>        <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).clear();</div>
<div class="line"><span class="lineno">  635</span>        <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).flag = 0;</div>
<div class="line"><span class="lineno">  636</span> </div>
<div class="line"><span class="lineno">  637</span>        <span class="keywordflow">if</span> (k &lt; offset1 - iWidth/2)</div>
<div class="line"><span class="lineno">  638</span>        {</div>
<div class="line"><span class="lineno">  639</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(index1, 1);</div>
<div class="line"><span class="lineno">  640</span>        }</div>
<div class="line"><span class="lineno">  641</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((k &gt; offset1 + iWidth/2) and (k &lt; offset1+offset2 - iWidth/2))</div>
<div class="line"><span class="lineno">  642</span>        {</div>
<div class="line"><span class="lineno">  643</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(index2, 1);</div>
<div class="line"><span class="lineno">  644</span>        }</div>
<div class="line"><span class="lineno">  645</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k &gt; offset1+offset2 + iWidth/2)</div>
<div class="line"><span class="lineno">  646</span>        {</div>
<div class="line"><span class="lineno">  647</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(index3, 1);</div>
<div class="line"><span class="lineno">  648</span>        }</div>
<div class="line"><span class="lineno">  649</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((k &lt;= offset1 + iWidth/2) and (k &gt;= offset1 - iWidth/2))</div>
<div class="line"><span class="lineno">  650</span>        {</div>
<div class="line"><span class="lineno">  651</span>            <span class="keywordtype">double</span> IntProf = 0.5 - 0.5*sin(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>*(k - offset1)/iWidth);</div>
<div class="line"><span class="lineno">  652</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(index2, 1.0 - IntProf);</div>
<div class="line"><span class="lineno">  653</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(index1, IntProf);</div>
<div class="line"><span class="lineno">  654</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).flag = 2;</div>
<div class="line"><span class="lineno">  655</span>        }</div>
<div class="line"><span class="lineno">  656</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((k &lt;= offset1+offset2 + iWidth/2) and</div>
<div class="line"><span class="lineno">  657</span>                 (k &gt;= offset1+offset2 - iWidth/2))</div>
<div class="line"><span class="lineno">  658</span>        {</div>
<div class="line"><span class="lineno">  659</span>            <span class="keywordtype">double</span> IntProf = 0.5 - 0.5*sin(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>*(k - (offset1+offset2))/iWidth);</div>
<div class="line"><span class="lineno">  660</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(index3, 1.0 - IntProf);</div>
<div class="line"><span class="lineno">  661</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(index2, IntProf);</div>
<div class="line"><span class="lineno">  662</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).flag = 2;</div>
<div class="line"><span class="lineno">  663</span>        }</div>
<div class="line"><span class="lineno">  664</span>    }</div>
<div class="line"><span class="lineno">  665</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a6ad2c83345f230517a1770304d7b39ad">STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  666</span> </div>
<div class="line"><span class="lineno">  667</span>    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FinalizeInitialization(BC);</div>
<div class="line"><span class="lineno">  668</span> </div>
<div class="line"><span class="lineno">  669</span>    <span class="keywordflow">return</span> vector&lt;size_t&gt;({index1,index2,index3});</div>
<div class="line"><span class="lineno">  670</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8351b0e360482ac0dca89e41b2863b68" name="a8351b0e360482ac0dca89e41b2863b68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8351b0e360482ac0dca89e41b2863b68">&#9670;&#160;</a></span>TripleJunction()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::Initializations::TripleJunction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>PhaseIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html#l00444">444</a> of file <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html">Initializations.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  447</span>{</div>
<div class="line"><span class="lineno">  448</span>    <span class="keywordtype">int</span> Nx = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Nx;</div>
<div class="line"><span class="lineno">  449</span>    <span class="keywordtype">int</span> Nz = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Nz;</div>
<div class="line"><span class="lineno">  450</span> </div>
<div class="line"><span class="lineno">  451</span>    <a class="code hl_function" href="../../de/dee/classopenphase_1_1Initializations.html#a299918f9104019121b5316cfe616d7b4">Rectangular</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, PhaseIndex  , 2.0*Nx/3.0, 0, Nz/2.0, 1.0*Nx/3.0, 0,     Nz/4.0,  BC, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  452</span>    <a class="code hl_function" href="../../de/dee/classopenphase_1_1Initializations.html#a299918f9104019121b5316cfe616d7b4">Rectangular</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, PhaseIndex+1, 2.0*Nx/3.0, 0, Nz/2.0, 1.0*Nx/3.0, 0, 3.0*Nz/4.0,  BC, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  453</span>    <a class="code hl_function" href="../../de/dee/classopenphase_1_1Initializations.html#a299918f9104019121b5316cfe616d7b4">Rectangular</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, PhaseIndex+2,     Nx/3.0, 0, Nz    , 5.0*Nx/6.0, 0,     Nz/2.0,  BC, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  454</span> </div>
<div class="line"><span class="lineno">  455</span>    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FinalizeInitialization(BC);</div>
<div class="line"><span class="lineno">  456</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a821f2862de799edd30203e226bda0a77" name="a821f2862de799edd30203e226bda0a77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a821f2862de799edd30203e226bda0a77">&#9670;&#160;</a></span>TwoDifferentWalls()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; size_t &gt; openphase::Initializations::TwoDifferentWalls </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>ChannelPhaseIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>WallsPhaseIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>WallsThickness</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html#l00721">721</a> of file <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html">Initializations.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  726</span>{</div>
<div class="line"><span class="lineno">  727</span>    <span class="keywordtype">int</span> Nz = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Nz;</div>
<div class="line"><span class="lineno">  728</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> iWidth = (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Resolution == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>) ? 0.5*<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth : <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth;</div>
<div class="line"><span class="lineno">  729</span> </div>
<div class="line"><span class="lineno">  730</span>    <span class="keywordtype">size_t</span> index1 = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.AddGrainInfo(ChannelPhaseIndex);</div>
<div class="line"><span class="lineno">  731</span>    <span class="keywordtype">size_t</span> index2 = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.AddGrainInfo(WallsPhaseIndex);</div>
<div class="line"><span class="lineno">  732</span>    <span class="keywordtype">size_t</span> index3 = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.AddGrainInfo(WallsPhaseIndex);</div>
<div class="line"><span class="lineno">  733</span> </div>
<div class="line"><span class="lineno">  734</span>    <span class="keywordtype">int</span> offset = WallsThickness;</div>
<div class="line"><span class="lineno">  735</span> </div>
<div class="line"><span class="lineno">  736</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a71aed4b94e116454c7b11985a91e49ec">STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields.Bcells())</div>
<div class="line"><span class="lineno">  737</span>    {</div>
<div class="line"><span class="lineno">  738</span>        <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).clear();</div>
<div class="line"><span class="lineno">  739</span> </div>
<div class="line"><span class="lineno">  740</span>        <span class="keywordflow">if</span> (k &gt; offset + iWidth/2 &amp;&amp; k &lt; (Nz) - offset - iWidth/2 - 1)</div>
<div class="line"><span class="lineno">  741</span>        {</div>
<div class="line"><span class="lineno">  742</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(index1, 1);</div>
<div class="line"><span class="lineno">  743</span>        }</div>
<div class="line"><span class="lineno">  744</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k &lt; offset - iWidth/2)</div>
<div class="line"><span class="lineno">  745</span>        {</div>
<div class="line"><span class="lineno">  746</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(index2, 1);</div>
<div class="line"><span class="lineno">  747</span>        }</div>
<div class="line"><span class="lineno">  748</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k &gt; (Nz) - offset + iWidth/2 - 1)</div>
<div class="line"><span class="lineno">  749</span>        {</div>
<div class="line"><span class="lineno">  750</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(index3, 1);</div>
<div class="line"><span class="lineno">  751</span>        }</div>
<div class="line"><span class="lineno">  752</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k &gt;= offset - iWidth/2 &amp;&amp; k &lt;= offset + iWidth/2)</div>
<div class="line"><span class="lineno">  753</span>        {</div>
<div class="line"><span class="lineno">  754</span>            <span class="keywordtype">double</span> IntProf = 0.5 - 0.5*sin(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>*(k - offset)/iWidth);</div>
<div class="line"><span class="lineno">  755</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(index1, 1.0 - IntProf);</div>
<div class="line"><span class="lineno">  756</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(index2, IntProf);</div>
<div class="line"><span class="lineno">  757</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).flag = 2;</div>
<div class="line"><span class="lineno">  758</span>        }</div>
<div class="line"><span class="lineno">  759</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k &gt;= (Nz) - offset - iWidth/2 - 1 &amp;&amp; k &lt;= (Nz) - offset + iWidth/2 - 1)</div>
<div class="line"><span class="lineno">  760</span>        {</div>
<div class="line"><span class="lineno">  761</span>            <span class="keywordtype">double</span> IntProf = 0.5 + 0.5*sin(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>*((Nz) - k - offset - 1)/iWidth);</div>
<div class="line"><span class="lineno">  762</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(index1, IntProf);</div>
<div class="line"><span class="lineno">  763</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(index3, 1.0 - IntProf);</div>
<div class="line"><span class="lineno">  764</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).flag = 2;</div>
<div class="line"><span class="lineno">  765</span>        }</div>
<div class="line"><span class="lineno">  766</span>    }</div>
<div class="line"><span class="lineno">  767</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a6ad2c83345f230517a1770304d7b39ad">STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  768</span> </div>
<div class="line"><span class="lineno">  769</span>    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FinalizeInitialization(BC);</div>
<div class="line"><span class="lineno">  770</span>    <span class="keywordflow">return</span> vector&lt;size_t&gt;({index1,index2,index3});</div>
<div class="line"><span class="lineno">  771</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af2fc49e92ceeae81766954b71ca744ac" name="af2fc49e92ceeae81766954b71ca744ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2fc49e92ceeae81766954b71ca744ac">&#9670;&#160;</a></span>TwoDimEBSD()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int openphase::Initializations::TwoDimEBSD </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int &gt;&#160;</td>
          <td class="paramname"><em>columns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reads microstructure from EBSD result files. </p>

<p class="definition">Definition at line <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html#l01061">1061</a> of file <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html">Initializations.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1063</span>{</div>
<div class="line"><span class="lineno"> 1064</span>    <span class="comment">// Method to read in 2D EBSD data from input file with the following format:</span></div>
<div class="line"><span class="lineno"> 1065</span>    <span class="comment">//    x-coord     y-coordinate     phase-field index (this line is not required in the file)</span></div>
<div class="line"><span class="lineno"> 1066</span>    <span class="comment">// &quot;    0            0                    1       &quot;</span></div>
<div class="line"><span class="lineno"> 1067</span>    <span class="comment">// &quot;    0.1          0                    2       &quot;</span></div>
<div class="line"><span class="lineno"> 1068</span>    <span class="comment">// &quot;                     etc                      &quot;</span></div>
<div class="line"><span class="lineno"> 1069</span> </div>
<div class="line"><span class="lineno"> 1070</span>    <span class="comment">// The columns are seperated by whitespaces, the exact column numbers can be given</span></div>
<div class="line"><span class="lineno"> 1071</span>    <span class="comment">// via the columns vector using the following correlations:</span></div>
<div class="line"><span class="lineno"> 1072</span>    <span class="comment">// x coordinate -&gt; columns[0]</span></div>
<div class="line"><span class="lineno"> 1073</span>    <span class="comment">// y coordinate -&gt; columns[1]</span></div>
<div class="line"><span class="lineno"> 1074</span>    <span class="comment">// phase field index -&gt; columns[2]</span></div>
<div class="line"><span class="lineno"> 1075</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1076</span>    <span class="comment">// Example call:</span></div>
<div class="line"><span class="lineno"> 1077</span>    <span class="comment">//    Initializations::TwoDimEBSDWithOrientations(&quot;EBSDmap.dat&quot;,</span></div>
<div class="line"><span class="lineno"> 1078</span>    <span class="comment">//                      {4, 5, 6, 1, 2, 3}, Phi, EP, BC, OPSettings);</span></div>
<div class="line"><span class="lineno"> 1079</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1080</span>    <span class="comment">// Note: For hexagonal grids run /scripts/EBSDHexRegParser.m first (Matlab)</span></div>
<div class="line"><span class="lineno"> 1081</span> </div>
<div class="line"><span class="lineno"> 1082</span>    <span class="keywordflow">if</span>(columns.size() != 3)</div>
<div class="line"><span class="lineno"> 1083</span>    {</div>
<div class="line"><span class="lineno"> 1084</span>        columns.clear(); columns = {1, 2, 3};</div>
<div class="line"><span class="lineno"> 1085</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">ConsoleOutput::WriteWarning</a>(<span class="stringliteral">&quot;Column list incomplete. Set to default {1, 2, 3}.&quot;</span>, <a class="code hl_variable" href="../../de/dee/classopenphase_1_1Initializations.html#a430c428a01443e146ef506a3305998a2">thisclassname</a>, <span class="stringliteral">&quot;TwoDimEBSD&quot;</span>);</div>
<div class="line"><span class="lineno"> 1086</span>    }</div>
<div class="line"><span class="lineno"> 1087</span> </div>
<div class="line"><span class="lineno"> 1088</span>    <span class="keywordflow">if</span>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Nz != 1)</div>
<div class="line"><span class="lineno"> 1089</span>    {</div>
<div class="line"><span class="lineno"> 1090</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a421faa2fe5d86991328b2b06041a326d">ConsoleOutput::WriteExit</a>(<span class="stringliteral">&quot;Only 2d supported&quot;</span>, <a class="code hl_variable" href="../../de/dee/classopenphase_1_1Initializations.html#a430c428a01443e146ef506a3305998a2">thisclassname</a>, <span class="stringliteral">&quot;TwoDimEBSD&quot;</span>);</div>
<div class="line"><span class="lineno"> 1091</span>        <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a4d6fed4ab71c6edf2a0bd5dabecc6ec6">OP_Exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 1092</span>    }</div>
<div class="line"><span class="lineno"> 1093</span> </div>
<div class="line"><span class="lineno"> 1094</span>    ifstream inp(filename.c_str(), ios::out);</div>
<div class="line"><span class="lineno"> 1095</span> </div>
<div class="line"><span class="lineno"> 1096</span>    <span class="keywordflow">if</span> (!inp)</div>
<div class="line"><span class="lineno"> 1097</span>    {</div>
<div class="line"><span class="lineno"> 1098</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a421faa2fe5d86991328b2b06041a326d">ConsoleOutput::WriteExit</a>(<span class="stringliteral">&quot;File &quot;</span> + filename + <span class="stringliteral">&quot; could not be opened&quot;</span>,</div>
<div class="line"><span class="lineno"> 1099</span>                <a class="code hl_variable" href="../../de/dee/classopenphase_1_1Initializations.html#a430c428a01443e146ef506a3305998a2">thisclassname</a>, <span class="stringliteral">&quot;TwoDimEBSD()&quot;</span>);</div>
<div class="line"><span class="lineno"> 1100</span>        <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a4d6fed4ab71c6edf2a0bd5dabecc6ec6">OP_Exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 1101</span>    };</div>
<div class="line"><span class="lineno"> 1102</span> </div>
<div class="line"><span class="lineno"> 1103</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#acf973fcf791b7ed17177550d8a7175e9">ConsoleOutput::WriteBlankLine</a>();</div>
<div class="line"><span class="lineno"> 1104</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3adb3c1b74bf9ac814922b7a8283707e">ConsoleOutput::WriteLineInsert</a>(<span class="stringliteral">&quot;EBSD reader&quot;</span>);</div>
<div class="line"><span class="lineno"> 1105</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Source&quot;</span>, filename);</div>
<div class="line"><span class="lineno"> 1106</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Read x coordinates from column&quot;</span>, columns[0]);</div>
<div class="line"><span class="lineno"> 1107</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Read y coordinates from column&quot;</span>, columns[1]);</div>
<div class="line"><span class="lineno"> 1108</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Read phase indices from column&quot;</span>, columns[2]);</div>
<div class="line"><span class="lineno"> 1109</span> </div>
<div class="line"><span class="lineno"> 1110</span>    <span class="comment">// Count number of lines</span></div>
<div class="line"><span class="lineno"> 1111</span>    <span class="keywordtype">int</span> nol = 0;</div>
<div class="line"><span class="lineno"> 1112</span>    std::string line;</div>
<div class="line"><span class="lineno"> 1113</span>    <span class="keywordflow">while</span>(getline (inp,line)) nol++;</div>
<div class="line"><span class="lineno"> 1114</span>    inp.clear(); <span class="comment">// back to begin</span></div>
<div class="line"><span class="lineno"> 1115</span>    inp.seekg(0, ios::beg);</div>
<div class="line"><span class="lineno"> 1116</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Number of lines&quot;</span>, nol);</div>
<div class="line"><span class="lineno"> 1117</span> </div>
<div class="line"><span class="lineno"> 1118</span>    <span class="comment">// Read input file</span></div>
<div class="line"><span class="lineno"> 1119</span> </div>
<div class="line"><span class="lineno"> 1120</span>    vector&lt;size_t&gt; phaseindex;</div>
<div class="line"><span class="lineno"> 1121</span>    vector&lt;size_t&gt; individualphaseindices;</div>
<div class="line"><span class="lineno"> 1122</span>    vector&lt;double&gt; xcoord;</div>
<div class="line"><span class="lineno"> 1123</span>    vector&lt;double&gt; individualxcoord;</div>
<div class="line"><span class="lineno"> 1124</span>    vector&lt;double&gt; ycoord;</div>
<div class="line"><span class="lineno"> 1125</span>    vector&lt;double&gt; individualycoord;</div>
<div class="line"><span class="lineno"> 1126</span> </div>
<div class="line"><span class="lineno"> 1127</span>    <span class="keywordflow">while</span>(<span class="keyword">true</span>)</div>
<div class="line"><span class="lineno"> 1128</span>    {</div>
<div class="line"><span class="lineno"> 1129</span>        std::string line;</div>
<div class="line"><span class="lineno"> 1130</span>        std::getline( inp, line );</div>
<div class="line"><span class="lineno"> 1131</span>        <span class="keywordflow">if</span>( !inp ) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1132</span>        std::istringstream iline( line );</div>
<div class="line"><span class="lineno"> 1133</span><span class="comment">//        if (line.size() &gt; 0) cout &lt;&lt; line &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1134</span> </div>
<div class="line"><span class="lineno"> 1135</span>        <span class="keywordtype">int</span> spos = 1;</div>
<div class="line"><span class="lineno"> 1136</span> </div>
<div class="line"><span class="lineno"> 1137</span>        <span class="keywordflow">while</span>(<span class="keyword">true</span>)</div>
<div class="line"><span class="lineno"> 1138</span>        {</div>
<div class="line"><span class="lineno"> 1139</span>            std::string str;</div>
<div class="line"><span class="lineno"> 1140</span>            std::getline(iline, str, <span class="charliteral">&#39; &#39;</span> );</div>
<div class="line"><span class="lineno"> 1141</span> </div>
<div class="line"><span class="lineno"> 1142</span>            <span class="keywordflow">if</span>(spos == columns[0] and str.size() &gt; 0) <span class="comment">// Read x coordinates</span></div>
<div class="line"><span class="lineno"> 1143</span>            {</div>
<div class="line"><span class="lineno"> 1144</span>                <span class="keywordtype">double</span> xx = std::stod(str);</div>
<div class="line"><span class="lineno"> 1145</span> </div>
<div class="line"><span class="lineno"> 1146</span>                <span class="comment">// Identify individual number of xcoordinates</span></div>
<div class="line"><span class="lineno"> 1147</span>                <span class="keywordflow">if</span>(std::find(individualxcoord.begin(), individualxcoord.end(), xx) == individualxcoord.end())</div>
<div class="line"><span class="lineno"> 1148</span>                {</div>
<div class="line"><span class="lineno"> 1149</span>                    individualxcoord.push_back(xx);</div>
<div class="line"><span class="lineno"> 1150</span>    <span class="comment">//                cout &lt;&lt; xx &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1151</span>                }</div>
<div class="line"><span class="lineno"> 1152</span>                xcoord.push_back(xx);</div>
<div class="line"><span class="lineno"> 1153</span>            }</div>
<div class="line"><span class="lineno"> 1154</span> </div>
<div class="line"><span class="lineno"> 1155</span>            <span class="keywordflow">if</span>(spos == columns[1] and str.size() &gt; 0)  <span class="comment">// Read y coordinates</span></div>
<div class="line"><span class="lineno"> 1156</span>            {</div>
<div class="line"><span class="lineno"> 1157</span>                <span class="keywordtype">double</span> yy = std::stod(str);</div>
<div class="line"><span class="lineno"> 1158</span>                <span class="comment">// Identify individual number of ycoordinates</span></div>
<div class="line"><span class="lineno"> 1159</span>                <span class="keywordflow">if</span>(std::find(individualycoord.begin(), individualycoord.end(), yy) == individualycoord.end())</div>
<div class="line"><span class="lineno"> 1160</span>                {</div>
<div class="line"><span class="lineno"> 1161</span>                    individualycoord.push_back(yy);</div>
<div class="line"><span class="lineno"> 1162</span>                }</div>
<div class="line"><span class="lineno"> 1163</span>                ycoord.push_back(yy);</div>
<div class="line"><span class="lineno"> 1164</span>            }</div>
<div class="line"><span class="lineno"> 1165</span> </div>
<div class="line"><span class="lineno"> 1166</span>            <span class="keywordflow">if</span>(spos == columns[2] and str.size() &gt; 0) <span class="comment">// Read phase field index</span></div>
<div class="line"><span class="lineno"> 1167</span>            {</div>
<div class="line"><span class="lineno"> 1168</span>                <span class="keywordtype">int</span> lindex = std::stoi(str);</div>
<div class="line"><span class="lineno"> 1169</span>                <span class="comment">// Identify individual number of phases</span></div>
<div class="line"><span class="lineno"> 1170</span>                <span class="keywordflow">if</span> (std::find(individualphaseindices.begin(), individualphaseindices.end(), lindex) == individualphaseindices.end())</div>
<div class="line"><span class="lineno"> 1171</span>                {</div>
<div class="line"><span class="lineno"> 1172</span>                    individualphaseindices.push_back(lindex);</div>
<div class="line"><span class="lineno"> 1173</span>                }</div>
<div class="line"><span class="lineno"> 1174</span>                phaseindex.push_back(lindex);</div>
<div class="line"><span class="lineno"> 1175</span>            }</div>
<div class="line"><span class="lineno"> 1176</span>            <span class="keywordflow">if</span> (str.size() &gt; 0) spos++;</div>
<div class="line"><span class="lineno"> 1177</span>            <span class="keywordflow">if</span>( !iline ) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1178</span>        }</div>
<div class="line"><span class="lineno"> 1179</span>    }</div>
<div class="line"><span class="lineno"> 1180</span> </div>
<div class="line"><span class="lineno"> 1181</span>    <span class="keywordtype">size_t</span> individualgrainnum = individualphaseindices.size();</div>
<div class="line"><span class="lineno"> 1182</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Number of individual phases&quot;</span>, individualgrainnum);</div>
<div class="line"><span class="lineno"> 1183</span>    <span class="keywordtype">size_t</span> maxphaseindex = *max_element(individualphaseindices.begin(), individualphaseindices.end());</div>
<div class="line"><span class="lineno"> 1184</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Largest phase-field index&quot;</span>, maxphaseindex);</div>
<div class="line"><span class="lineno"> 1185</span>    <span class="keywordtype">size_t</span> pfsize = phaseindex.size();</div>
<div class="line"><span class="lineno"> 1186</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Phasefield storage size&quot;</span>, pfsize);</div>
<div class="line"><span class="lineno"> 1187</span>    <span class="keywordtype">size_t</span> NxEBSD = individualxcoord.size();</div>
<div class="line"><span class="lineno"> 1188</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Number of (individual) x coordinates&quot;</span>, NxEBSD);</div>
<div class="line"><span class="lineno"> 1189</span>    <span class="keywordtype">double</span> maxX = xcoord.back();</div>
<div class="line"><span class="lineno"> 1190</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Biggest X Coord&quot;</span>, maxX);</div>
<div class="line"><span class="lineno"> 1191</span>    <span class="keywordtype">double</span> distX = maxX/double(NxEBSD);</div>
<div class="line"><span class="lineno"> 1192</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Rastering X&quot;</span>, distX);</div>
<div class="line"><span class="lineno"> 1193</span>    <span class="keywordtype">size_t</span> NyEBSD = individualycoord.size();</div>
<div class="line"><span class="lineno"> 1194</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Number of (individual) y coordinates&quot;</span>, NyEBSD);</div>
<div class="line"><span class="lineno"> 1195</span>    <span class="keywordtype">double</span> maxY = ycoord.back();</div>
<div class="line"><span class="lineno"> 1196</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Biggest Y Coord&quot;</span>, maxY);</div>
<div class="line"><span class="lineno"> 1197</span>    <span class="keywordtype">double</span> distY = maxY/double(NyEBSD);</div>
<div class="line"><span class="lineno"> 1198</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Rastering Y&quot;</span>, distY);</div>
<div class="line"><span class="lineno"> 1199</span> </div>
<div class="line"><span class="lineno"> 1200</span><span class="comment">//    for(size_t i = 0 ; i &lt; phaseindex.size(); ++i) cout &lt;&lt; phaseindex[i] &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><span class="lineno"> 1201</span><span class="comment">//    cout &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1202</span><span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1203</span><span class="comment">//    for(size_t i = 0 ; i &lt; xcoord.size(); ++i) cout &lt;&lt; xcoord[i] &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><span class="lineno"> 1204</span><span class="comment">//    cout &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1205</span><span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1206</span>    stringstream outPhaseIndeces;</div>
<div class="line"><span class="lineno"> 1207</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0 ; i &lt; individualphaseindices.size(); ++i) outPhaseIndeces &lt;&lt; individualphaseindices[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><span class="lineno"> 1208</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a607154bed184a8633e4a43e37e98a4d9">ConsoleOutput::WriteSimple</a>(outPhaseIndeces.str());</div>
<div class="line"><span class="lineno"> 1209</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#acf973fcf791b7ed17177550d8a7175e9">ConsoleOutput::WriteBlankLine</a>();</div>
<div class="line"><span class="lineno"> 1210</span> </div>
<div class="line"><span class="lineno"> 1211</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> Nx = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Nx;</div>
<div class="line"><span class="lineno"> 1212</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> Ny = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Ny;</div>
<div class="line"><span class="lineno"> 1213</span> </div>
<div class="line"><span class="lineno"> 1214</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> idx = 0; idx &lt; maxphaseindex+1; idx++)</div>
<div class="line"><span class="lineno"> 1215</span>    {</div>
<div class="line"><span class="lineno"> 1216</span>        <span class="keywordflow">if</span>(std::find(individualphaseindices.begin(), individualphaseindices.end(), idx) != individualphaseindices.end())</div>
<div class="line"><span class="lineno"> 1217</span>        {</div>
<div class="line"><span class="lineno"> 1218</span>            <span class="keywordtype">size_t</span> locIndex = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.AddGrainInfo(0) + idx%<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Nphases; <span class="comment">// eigene zv</span></div>
<div class="line"><span class="lineno"> 1219</span> </div>
<div class="line"><span class="lineno"> 1220</span>            <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Add grain/phase&quot;</span>, locIndex);</div>
<div class="line"><span class="lineno"> 1221</span> </div>
<div class="line"><span class="lineno"> 1222</span>            <span class="keywordtype">int</span> incx = 1; <span class="comment">// Skip points in x-direction</span></div>
<div class="line"><span class="lineno"> 1223</span>            <span class="keywordtype">int</span> incy = 1; <span class="comment">// Skip points in y-direction</span></div>
<div class="line"><span class="lineno"> 1224</span> </div>
<div class="line"><span class="lineno"> 1225</span>            <span class="comment">//int itery = 1;</span></div>
<div class="line"><span class="lineno"> 1226</span>            <span class="keywordtype">int</span> colstep = 0;</div>
<div class="line"><span class="lineno"> 1227</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; Ny; ++j)</div>
<div class="line"><span class="lineno"> 1228</span>            {</div>
<div class="line"><span class="lineno"> 1229</span>                <span class="keywordtype">int</span> iterx = 1;</div>
<div class="line"><span class="lineno"> 1230</span> </div>
<div class="line"><span class="lineno"> 1231</span>                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; Nx; ++i)</div>
<div class="line"><span class="lineno"> 1232</span>                {</div>
<div class="line"><span class="lineno"> 1233</span>                    <span class="keywordflow">if</span> (idx + 1 == phaseindex[-1 + iterx + colstep])</div>
<div class="line"><span class="lineno"> 1234</span>    <span class="comment">//                if ((locIndex)%locSettings.Nphases + 1 + idx == phaseindex[-1 + iterx + colstep])</span></div>
<div class="line"><span class="lineno"> 1235</span>                    {</div>
<div class="line"><span class="lineno"> 1236</span>    <span class="comment">//                    cout &lt;&lt; i &lt;&lt; &quot; &quot; &lt;&lt; j &lt;&lt; &quot; &quot; &lt;&lt; -1 + iterx + (itery-1)*Nx &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1237</span>                        <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, 0).clear();</div>
<div class="line"><span class="lineno"> 1238</span>                        <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, 0).flag = 2;</div>
<div class="line"><span class="lineno"> 1239</span>                        <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, 0).set_value(locIndex, 1.0);</div>
<div class="line"><span class="lineno"> 1240</span>                    }</div>
<div class="line"><span class="lineno"> 1241</span>                    iterx += incx;</div>
<div class="line"><span class="lineno"> 1242</span>                }</div>
<div class="line"><span class="lineno"> 1243</span>                <span class="keywordflow">if</span>(incx == 1 and incy == 1)</div>
<div class="line"><span class="lineno"> 1244</span>                {</div>
<div class="line"><span class="lineno"> 1245</span>                    colstep += Nx;</div>
<div class="line"><span class="lineno"> 1246</span>                }</div>
<div class="line"><span class="lineno"> 1247</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1248</span>                {</div>
<div class="line"><span class="lineno"> 1249</span>                <span class="comment">// Odd columns</span></div>
<div class="line"><span class="lineno"> 1250</span>                    <span class="keywordflow">if</span>(j%2 == 1) colstep += Nx;</div>
<div class="line"><span class="lineno"> 1251</span>                    <span class="keywordflow">else</span> colstep += (Nx-1);</div>
<div class="line"><span class="lineno"> 1252</span>                }</div>
<div class="line"><span class="lineno"> 1253</span>                <span class="comment">//itery += incy;</span></div>
<div class="line"><span class="lineno"> 1254</span>            }</div>
<div class="line"><span class="lineno"> 1255</span>        }</div>
<div class="line"><span class="lineno"> 1256</span>    }</div>
<div class="line"><span class="lineno"> 1257</span> </div>
<div class="line"><span class="lineno"> 1258</span>    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FinalizeInitialization(BC);</div>
<div class="line"><span class="lineno"> 1259</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;EBSD&quot;</span>, <span class="stringliteral">&quot;done&quot;</span>);</div>
<div class="line"><span class="lineno"> 1260</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ad86f674a75177eed4dd6cd8c06fcba47">ConsoleOutput::WriteLine</a>();</div>
<div class="line"><span class="lineno"> 1261</span> </div>
<div class="line"><span class="lineno"> 1262</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1263</span>}</div>
<div class="ttc" id="aclassopenphase_1_1ConsoleOutput_html_acf973fcf791b7ed17177550d8a7175e9"><div class="ttname"><a href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#acf973fcf791b7ed17177550d8a7175e9">openphase::ConsoleOutput::WriteBlankLine</a></div><div class="ttdeci">static void WriteBlankLine(void)</div><div class="ttdef"><b>Definition</b> <a href="../../da/da0/ConsoleOutput_8cpp_source.html#l00129">ConsoleOutput.cpp:129</a></div></div>
<div class="ttc" id="aclassopenphase_1_1ConsoleOutput_html_ad86f674a75177eed4dd6cd8c06fcba47"><div class="ttname"><a href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ad86f674a75177eed4dd6cd8c06fcba47">openphase::ConsoleOutput::WriteLine</a></div><div class="ttdeci">static void WriteLine(const std::string LineType=&quot;-&quot;)</div><div class="ttdef"><b>Definition</b> <a href="../../da/da0/ConsoleOutput_8cpp_source.html#l00106">ConsoleOutput.cpp:106</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a99d0f6d1ac078e97382e3835d1eb0ea0" name="a99d0f6d1ac078e97382e3835d1eb0ea0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99d0f6d1ac078e97382e3835d1eb0ea0">&#9670;&#160;</a></span>TwoDimEBSDWithOrientations()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int openphase::Initializations::TwoDimEBSDWithOrientations </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int &gt;&#160;</td>
          <td class="paramname"><em>columns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>anglerepresentation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/de8/classopenphase_1_1ElasticProperties.html">ElasticProperties</a> &amp;&#160;</td>
          <td class="paramname"><em>EP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/df3/classopenphase_1_1Orientations.html">Orientations</a> &amp;&#160;</td>
          <td class="paramname"><em>OR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reads microstructure from EBSD result files. </p>

<p class="definition">Definition at line <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html#l01265">1265</a> of file <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html">Initializations.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1267</span>{</div>
<div class="line"><span class="lineno"> 1268</span>    <span class="comment">// Method to read in 2D EBSD data from input file with the following format:</span></div>
<div class="line"><span class="lineno"> 1269</span>    <span class="comment">//    x-coord     y-coordinate     phase-field index (this line is not required in the file)</span></div>
<div class="line"><span class="lineno"> 1270</span>    <span class="comment">// &quot;    0            0                    1       &quot;</span></div>
<div class="line"><span class="lineno"> 1271</span>    <span class="comment">// &quot;    0.1          0                    2       &quot;</span></div>
<div class="line"><span class="lineno"> 1272</span>    <span class="comment">// &quot;                     etc                      &quot;</span></div>
<div class="line"><span class="lineno"> 1273</span> </div>
<div class="line"><span class="lineno"> 1274</span>    <span class="comment">// The columns are seperated by whitespaces, the exact column numbers can be given</span></div>
<div class="line"><span class="lineno"> 1275</span>    <span class="comment">// via the columns vector using the following correlations:</span></div>
<div class="line"><span class="lineno"> 1276</span>    <span class="comment">// x coordinate -&gt; columns[0]</span></div>
<div class="line"><span class="lineno"> 1277</span>    <span class="comment">// y coordinate -&gt; columns[1]</span></div>
<div class="line"><span class="lineno"> 1278</span>    <span class="comment">// phase field index -&gt; columns[2]</span></div>
<div class="line"><span class="lineno"> 1279</span>    <span class="comment">// Euler angle 1 -&gt; columns[3]</span></div>
<div class="line"><span class="lineno"> 1280</span>    <span class="comment">// Euler angle 2 -&gt; columns[4]</span></div>
<div class="line"><span class="lineno"> 1281</span>    <span class="comment">// Euler angle 3 -&gt; columns[5]</span></div>
<div class="line"><span class="lineno"> 1282</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1283</span>    <span class="comment">// Example call:</span></div>
<div class="line"><span class="lineno"> 1284</span>    <span class="comment">//    Initializations::TwoDimEBSDWithOrientations(&quot;EBSDmap.dat&quot;,</span></div>
<div class="line"><span class="lineno"> 1285</span>    <span class="comment">//                      {4, 5, 6, 1, 2, 3}, Phi, EP, BC, OPSettings);</span></div>
<div class="line"><span class="lineno"> 1286</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1287</span>    <span class="comment">// Note: For hexagonal grids run /scripts/EBSDHexRegParser.m first (Matlab)</span></div>
<div class="line"><span class="lineno"> 1288</span> </div>
<div class="line"><span class="lineno"> 1289</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> Nx = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Nx;</div>
<div class="line"><span class="lineno"> 1290</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> Ny = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Ny;</div>
<div class="line"><span class="lineno"> 1291</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> Nz = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Nz;</div>
<div class="line"><span class="lineno"> 1292</span> </div>
<div class="line"><span class="lineno"> 1293</span>    <span class="keywordflow">if</span>(columns.size() != 6)</div>
<div class="line"><span class="lineno"> 1294</span>    {</div>
<div class="line"><span class="lineno"> 1295</span>        columns.clear(); columns = {1, 2, 3, 4, 5, 6};</div>
<div class="line"><span class="lineno"> 1296</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">ConsoleOutput::WriteWarning</a>(<span class="stringliteral">&quot;Column list incomplete. Set to default {1, 2, 3, 4, 5, 6}.&quot;</span>,</div>
<div class="line"><span class="lineno"> 1297</span>                <a class="code hl_variable" href="../../de/dee/classopenphase_1_1Initializations.html#a430c428a01443e146ef506a3305998a2">thisclassname</a>, <span class="stringliteral">&quot;TwoDimEBSD&quot;</span>);</div>
<div class="line"><span class="lineno"> 1298</span>    }</div>
<div class="line"><span class="lineno"> 1299</span> </div>
<div class="line"><span class="lineno"> 1300</span>    <span class="keywordflow">if</span>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Nz != 1)</div>
<div class="line"><span class="lineno"> 1301</span>    {</div>
<div class="line"><span class="lineno"> 1302</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a421faa2fe5d86991328b2b06041a326d">ConsoleOutput::WriteExit</a>(<span class="stringliteral">&quot;Only 2d supported&quot;</span>, <a class="code hl_variable" href="../../de/dee/classopenphase_1_1Initializations.html#a430c428a01443e146ef506a3305998a2">thisclassname</a>, <span class="stringliteral">&quot;TwoDimEBSD&quot;</span>);</div>
<div class="line"><span class="lineno"> 1303</span>        <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a4d6fed4ab71c6edf2a0bd5dabecc6ec6">OP_Exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 1304</span>    }</div>
<div class="line"><span class="lineno"> 1305</span> </div>
<div class="line"><span class="lineno"> 1306</span>    ifstream inp(filename.c_str(), ios::out);</div>
<div class="line"><span class="lineno"> 1307</span> </div>
<div class="line"><span class="lineno"> 1308</span>    <span class="keywordflow">if</span> (!inp)</div>
<div class="line"><span class="lineno"> 1309</span>    {</div>
<div class="line"><span class="lineno"> 1310</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a421faa2fe5d86991328b2b06041a326d">ConsoleOutput::WriteExit</a>(<span class="stringliteral">&quot;File &quot;</span> + filename + <span class="stringliteral">&quot; could not be opened&quot;</span>,</div>
<div class="line"><span class="lineno"> 1311</span>                <a class="code hl_variable" href="../../de/dee/classopenphase_1_1Initializations.html#a430c428a01443e146ef506a3305998a2">thisclassname</a>, <span class="stringliteral">&quot;TwoDimEBSD()&quot;</span>);</div>
<div class="line"><span class="lineno"> 1312</span>        <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a4d6fed4ab71c6edf2a0bd5dabecc6ec6">OP_Exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 1313</span>    };</div>
<div class="line"><span class="lineno"> 1314</span> </div>
<div class="line"><span class="lineno"> 1315</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#acf973fcf791b7ed17177550d8a7175e9">ConsoleOutput::WriteBlankLine</a>();</div>
<div class="line"><span class="lineno"> 1316</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3adb3c1b74bf9ac814922b7a8283707e">ConsoleOutput::WriteLineInsert</a>(<span class="stringliteral">&quot;EBSD reader&quot;</span>);</div>
<div class="line"><span class="lineno"> 1317</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Source&quot;</span>, filename);</div>
<div class="line"><span class="lineno"> 1318</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Read x coordinates from column&quot;</span>, columns[0]);</div>
<div class="line"><span class="lineno"> 1319</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Read y coordinates from column&quot;</span>, columns[1]);</div>
<div class="line"><span class="lineno"> 1320</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Read phase indices from column&quot;</span>, columns[2]);</div>
<div class="line"><span class="lineno"> 1321</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Read Euler angle 1 from column&quot;</span>, columns[3]);</div>
<div class="line"><span class="lineno"> 1322</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Read Euler angle 2 from column&quot;</span>, columns[4]);</div>
<div class="line"><span class="lineno"> 1323</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Read Euler angle 3 from column&quot;</span>, columns[5]);</div>
<div class="line"><span class="lineno"> 1324</span> </div>
<div class="line"><span class="lineno"> 1325</span>    <span class="comment">// Count number of lines</span></div>
<div class="line"><span class="lineno"> 1326</span>    <span class="keywordtype">int</span> nol = 0;</div>
<div class="line"><span class="lineno"> 1327</span>    std::string line;</div>
<div class="line"><span class="lineno"> 1328</span>    <span class="keywordflow">while</span>(getline (inp,line)) nol++;</div>
<div class="line"><span class="lineno"> 1329</span>    inp.clear(); <span class="comment">// back to begin</span></div>
<div class="line"><span class="lineno"> 1330</span>    inp.seekg(0, ios::beg);</div>
<div class="line"><span class="lineno"> 1331</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Number of lines&quot;</span>, nol);</div>
<div class="line"><span class="lineno"> 1332</span> </div>
<div class="line"><span class="lineno"> 1333</span>    <span class="comment">// Read input file</span></div>
<div class="line"><span class="lineno"> 1334</span> </div>
<div class="line"><span class="lineno"> 1335</span>    vector&lt;size_t&gt; phaseindex;</div>
<div class="line"><span class="lineno"> 1336</span>    vector&lt;size_t&gt; individualphaseindices;</div>
<div class="line"><span class="lineno"> 1337</span>    vector&lt;double&gt; xcoord;</div>
<div class="line"><span class="lineno"> 1338</span>    vector&lt;double&gt; individualxcoord;</div>
<div class="line"><span class="lineno"> 1339</span>    vector&lt;double&gt; ycoord;</div>
<div class="line"><span class="lineno"> 1340</span>    vector&lt;double&gt; individualycoord;</div>
<div class="line"><span class="lineno"> 1341</span>    vector&lt;EulerAngles&gt; Eang;</div>
<div class="line"><span class="lineno"> 1342</span> </div>
<div class="line"><span class="lineno"> 1343</span>    <span class="keywordflow">while</span>(<span class="keyword">true</span>)</div>
<div class="line"><span class="lineno"> 1344</span>    {</div>
<div class="line"><span class="lineno"> 1345</span>        std::string line;</div>
<div class="line"><span class="lineno"> 1346</span>        std::getline( inp, line );</div>
<div class="line"><span class="lineno"> 1347</span>        <span class="keywordflow">if</span>( !inp ) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1348</span>        std::istringstream iline( line );</div>
<div class="line"><span class="lineno"> 1349</span><span class="comment">//        if (line.size() &gt; 0) cout &lt;&lt; line &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1350</span> </div>
<div class="line"><span class="lineno"> 1351</span>        EulerAngles tempEang;</div>
<div class="line"><span class="lineno"> 1352</span>        tempEang.set_to_zero();</div>
<div class="line"><span class="lineno"> 1353</span>        <span class="keywordtype">int</span> spos = 1;</div>
<div class="line"><span class="lineno"> 1354</span> </div>
<div class="line"><span class="lineno"> 1355</span>        <span class="keywordflow">while</span>(<span class="keyword">true</span>)</div>
<div class="line"><span class="lineno"> 1356</span>        {</div>
<div class="line"><span class="lineno"> 1357</span>            std::string str;</div>
<div class="line"><span class="lineno"> 1358</span>            std::getline(iline, str, <span class="charliteral">&#39; &#39;</span> );</div>
<div class="line"><span class="lineno"> 1359</span> </div>
<div class="line"><span class="lineno"> 1360</span>            <span class="keywordflow">if</span>(spos == columns[0] and str.size() &gt; 0) <span class="comment">// Read x coordinates</span></div>
<div class="line"><span class="lineno"> 1361</span>            {</div>
<div class="line"><span class="lineno"> 1362</span>                <span class="keywordtype">double</span> xx = std::stod(str);</div>
<div class="line"><span class="lineno"> 1363</span> </div>
<div class="line"><span class="lineno"> 1364</span>                <span class="comment">// Identify individual number of xcoordinates</span></div>
<div class="line"><span class="lineno"> 1365</span>                <span class="keywordflow">if</span>(std::find(individualxcoord.begin(), individualxcoord.end(), xx) == individualxcoord.end())</div>
<div class="line"><span class="lineno"> 1366</span>                {</div>
<div class="line"><span class="lineno"> 1367</span>                    individualxcoord.push_back(xx);</div>
<div class="line"><span class="lineno"> 1368</span>    <span class="comment">//                cout &lt;&lt; xx &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1369</span>                }</div>
<div class="line"><span class="lineno"> 1370</span>                xcoord.push_back(xx);</div>
<div class="line"><span class="lineno"> 1371</span>            }</div>
<div class="line"><span class="lineno"> 1372</span> </div>
<div class="line"><span class="lineno"> 1373</span>            <span class="keywordflow">if</span>(spos == columns[1] and str.size() &gt; 0)  <span class="comment">// Read y coordinates</span></div>
<div class="line"><span class="lineno"> 1374</span>            {</div>
<div class="line"><span class="lineno"> 1375</span>                <span class="keywordtype">double</span> yy = std::stod(str);</div>
<div class="line"><span class="lineno"> 1376</span>                <span class="comment">// Identify individual number of ycoordinates</span></div>
<div class="line"><span class="lineno"> 1377</span>                <span class="keywordflow">if</span>(std::find(individualycoord.begin(), individualycoord.end(), yy) == individualycoord.end())</div>
<div class="line"><span class="lineno"> 1378</span>                {</div>
<div class="line"><span class="lineno"> 1379</span>                    individualycoord.push_back(yy);</div>
<div class="line"><span class="lineno"> 1380</span>                }</div>
<div class="line"><span class="lineno"> 1381</span>                ycoord.push_back(yy);</div>
<div class="line"><span class="lineno"> 1382</span>            }</div>
<div class="line"><span class="lineno"> 1383</span> </div>
<div class="line"><span class="lineno"> 1384</span>            <span class="keywordflow">if</span>(spos == columns[2] and str.size() &gt; 0) <span class="comment">// Read phase field index</span></div>
<div class="line"><span class="lineno"> 1385</span>            {</div>
<div class="line"><span class="lineno"> 1386</span>                <span class="keywordtype">int</span> lindex = std::stoi(str);</div>
<div class="line"><span class="lineno"> 1387</span>                <span class="comment">// Identify individual number of phases</span></div>
<div class="line"><span class="lineno"> 1388</span>                <span class="keywordflow">if</span> (std::find(individualphaseindices.begin(), individualphaseindices.end(), lindex) == individualphaseindices.end())</div>
<div class="line"><span class="lineno"> 1389</span>                {</div>
<div class="line"><span class="lineno"> 1390</span>                    individualphaseindices.push_back(lindex);</div>
<div class="line"><span class="lineno"> 1391</span>                }</div>
<div class="line"><span class="lineno"> 1392</span>                phaseindex.push_back(lindex);</div>
<div class="line"><span class="lineno"> 1393</span>            }</div>
<div class="line"><span class="lineno"> 1394</span> </div>
<div class="line"><span class="lineno"> 1395</span>            <span class="keywordtype">double</span> anglefactor = 180.0/<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>;</div>
<div class="line"><span class="lineno"> 1396</span>            <span class="keywordflow">if</span>(!anglerepresentation.compare(<span class="stringliteral">&quot;degree&quot;</span>) or !anglerepresentation.compare(<span class="stringliteral">&quot;deg&quot;</span>)</div>
<div class="line"><span class="lineno"> 1397</span>                    or !anglerepresentation.compare(<span class="stringliteral">&quot;Degree&quot;</span>) or !anglerepresentation.compare(<span class="stringliteral">&quot;Deg&quot;</span>))</div>
<div class="line"><span class="lineno"> 1398</span>            {</div>
<div class="line"><span class="lineno"> 1399</span>                anglefactor = 1.0;</div>
<div class="line"><span class="lineno"> 1400</span>            }</div>
<div class="line"><span class="lineno"> 1401</span> </div>
<div class="line"><span class="lineno"> 1402</span>            <span class="keywordflow">if</span>(spos == columns[3] and str.size() &gt; 0) <span class="comment">// Read Euler angle 1</span></div>
<div class="line"><span class="lineno"> 1403</span>            {</div>
<div class="line"><span class="lineno"> 1404</span>                tempEang.Q[0] = std::stod(str)*anglefactor;</div>
<div class="line"><span class="lineno"> 1405</span>            }</div>
<div class="line"><span class="lineno"> 1406</span> </div>
<div class="line"><span class="lineno"> 1407</span>            <span class="keywordflow">if</span>(spos == columns[4] and str.size() &gt; 0) <span class="comment">// Read Euler angle 2</span></div>
<div class="line"><span class="lineno"> 1408</span>            {</div>
<div class="line"><span class="lineno"> 1409</span>                tempEang.Q[1] = std::stod(str)*anglefactor;</div>
<div class="line"><span class="lineno"> 1410</span>            }</div>
<div class="line"><span class="lineno"> 1411</span> </div>
<div class="line"><span class="lineno"> 1412</span>            <span class="keywordflow">if</span>(spos == columns[5] and str.size() &gt; 0) <span class="comment">// Read Euler angle 3</span></div>
<div class="line"><span class="lineno"> 1413</span>            {</div>
<div class="line"><span class="lineno"> 1414</span>                tempEang.Q[2] = std::stod(str)*anglefactor;</div>
<div class="line"><span class="lineno"> 1415</span>            }</div>
<div class="line"><span class="lineno"> 1416</span> </div>
<div class="line"><span class="lineno"> 1417</span>            <span class="keywordflow">if</span> (str.size() &gt; 0) spos++;</div>
<div class="line"><span class="lineno"> 1418</span>            <span class="keywordflow">if</span>( !iline ) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1419</span>        }</div>
<div class="line"><span class="lineno"> 1420</span> </div>
<div class="line"><span class="lineno"> 1421</span>        tempEang.set_convention(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a631078f50f3da2bf1138bc0182054010a3f621246b8dd589df33df6fce0956d8c">ZXZ</a>);</div>
<div class="line"><span class="lineno"> 1422</span> </div>
<div class="line"><span class="lineno"> 1423</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3d39f6f01e37b75d360090aa734bc1bd">ConsoleOutput::WriteWarning</a>(<span class="stringliteral">&quot;Using ZXZ angle convention&quot;</span>, <a class="code hl_variable" href="../../de/dee/classopenphase_1_1Initializations.html#a430c428a01443e146ef506a3305998a2">thisclassname</a>, <span class="stringliteral">&quot;TwoDimEBSDWithOrientations()&quot;</span>);</div>
<div class="line"><span class="lineno"> 1424</span> </div>
<div class="line"><span class="lineno"> 1425</span>        tempEang.setTrigonometricFunctions();</div>
<div class="line"><span class="lineno"> 1426</span>        Eang.push_back(tempEang);</div>
<div class="line"><span class="lineno"> 1427</span>    }</div>
<div class="line"><span class="lineno"> 1428</span> </div>
<div class="line"><span class="lineno"> 1429</span>    <span class="keywordtype">size_t</span> individualgrainnum = individualphaseindices.size();</div>
<div class="line"><span class="lineno"> 1430</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Number of individual phases&quot;</span>, individualgrainnum);</div>
<div class="line"><span class="lineno"> 1431</span>    <span class="keywordtype">size_t</span> pfsize = phaseindex.size();</div>
<div class="line"><span class="lineno"> 1432</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Phasefield storage size&quot;</span>, pfsize);</div>
<div class="line"><span class="lineno"> 1433</span>    <span class="keywordtype">size_t</span> NxEBSD = individualxcoord.size();</div>
<div class="line"><span class="lineno"> 1434</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Number of (individual) x coordinates&quot;</span>, NxEBSD);</div>
<div class="line"><span class="lineno"> 1435</span>    <span class="keywordtype">double</span> maxX = 0;</div>
<div class="line"><span class="lineno"> 1436</span>    <span class="keywordflow">if</span>(xcoord.size()) maxX = xcoord.back();</div>
<div class="line"><span class="lineno"> 1437</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Biggest X Coord&quot;</span>, maxX);</div>
<div class="line"><span class="lineno"> 1438</span>    <span class="keywordtype">double</span> distX = maxX/double(NxEBSD);</div>
<div class="line"><span class="lineno"> 1439</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Rastering X&quot;</span>, distX);</div>
<div class="line"><span class="lineno"> 1440</span>    <span class="keywordtype">size_t</span> NyEBSD = individualycoord.size();</div>
<div class="line"><span class="lineno"> 1441</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Number of (individual) y coordinates&quot;</span>, NyEBSD);</div>
<div class="line"><span class="lineno"> 1442</span>    <span class="keywordtype">double</span> maxY = 0;</div>
<div class="line"><span class="lineno"> 1443</span>    <span class="keywordflow">if</span>(ycoord.size()) maxY = ycoord.back();</div>
<div class="line"><span class="lineno"> 1444</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Biggest Y Coord&quot;</span>, maxY);</div>
<div class="line"><span class="lineno"> 1445</span>    <span class="keywordtype">double</span> distY = maxY/double(NyEBSD);</div>
<div class="line"><span class="lineno"> 1446</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Rastering Y&quot;</span>, distY);</div>
<div class="line"><span class="lineno"> 1447</span> </div>
<div class="line"><span class="lineno"> 1448</span>    Storage3D &lt;EulerAngles, 0&gt; StorageEulerAngles;</div>
<div class="line"><span class="lineno"> 1449</span>    StorageEulerAngles.Allocate(Nx, Ny, 1, 1,1,0, 0);</div>
<div class="line"><span class="lineno"> 1450</span> </div>
<div class="line"><span class="lineno"> 1451</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> idx = 0; idx &lt; individualgrainnum; idx++)</div>
<div class="line"><span class="lineno"> 1452</span>    {</div>
<div class="line"><span class="lineno"> 1453</span>        <span class="keywordtype">size_t</span> locIndex = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.AddGrainInfo(0) + idx%<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Nphases;</div>
<div class="line"><span class="lineno"> 1454</span> </div>
<div class="line"><span class="lineno"> 1455</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Add grain/phase&quot;</span>, locIndex);</div>
<div class="line"><span class="lineno"> 1456</span> </div>
<div class="line"><span class="lineno"> 1457</span>        <span class="keywordtype">int</span> incx = 1; <span class="comment">// Skip points in x-direction</span></div>
<div class="line"><span class="lineno"> 1458</span>        <span class="keywordtype">int</span> incy = 1; <span class="comment">// Skip points in y-direction</span></div>
<div class="line"><span class="lineno"> 1459</span> </div>
<div class="line"><span class="lineno"> 1460</span>        <span class="comment">//int itery = 1;</span></div>
<div class="line"><span class="lineno"> 1461</span>        <span class="keywordtype">int</span> colstep = 0;</div>
<div class="line"><span class="lineno"> 1462</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; Ny; ++j)</div>
<div class="line"><span class="lineno"> 1463</span>        {</div>
<div class="line"><span class="lineno"> 1464</span>            <span class="keywordtype">int</span> iterx = 1;</div>
<div class="line"><span class="lineno"> 1465</span> </div>
<div class="line"><span class="lineno"> 1466</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; Nx; ++i)</div>
<div class="line"><span class="lineno"> 1467</span>            {</div>
<div class="line"><span class="lineno"> 1468</span>                <span class="comment">// SetInitialOrientations</span></div>
<div class="line"><span class="lineno"> 1469</span>                EulerAngles EangLocal = Eang[-1 + iterx + colstep];</div>
<div class="line"><span class="lineno"> 1470</span>                OR.Quaternions(i,j,0) = EangLocal.getQuaternion();</div>
<div class="line"><span class="lineno"> 1471</span>                StorageEulerAngles(i,j,0) = EangLocal;</div>
<div class="line"><span class="lineno"> 1472</span> </div>
<div class="line"><span class="lineno"> 1473</span>                <span class="comment">// Set phase fields</span></div>
<div class="line"><span class="lineno"> 1474</span>                <span class="keywordflow">if</span> (idx + 1 == phaseindex[-1 + iterx + colstep])</div>
<div class="line"><span class="lineno"> 1475</span><span class="comment">//                if ((locIndex)%locSettings.Nphases + 1 + idx == phaseindex[-1 + iterx + colstep])</span></div>
<div class="line"><span class="lineno"> 1476</span>                {</div>
<div class="line"><span class="lineno"> 1477</span><span class="comment">//                    cout &lt;&lt; i &lt;&lt; &quot; &quot; &lt;&lt; j &lt;&lt; &quot; &quot; &lt;&lt; -1 + iterx + (itery-1)*Nx &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1478</span>                    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, 0).clear();</div>
<div class="line"><span class="lineno"> 1479</span>                    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, 0).flag = 2;</div>
<div class="line"><span class="lineno"> 1480</span>                    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, 0).set_value(locIndex, 1.0);</div>
<div class="line"><span class="lineno"> 1481</span>                }</div>
<div class="line"><span class="lineno"> 1482</span>                iterx += incx;</div>
<div class="line"><span class="lineno"> 1483</span>            }</div>
<div class="line"><span class="lineno"> 1484</span>            <span class="keywordflow">if</span>(incx == 1 and incy == 1)</div>
<div class="line"><span class="lineno"> 1485</span>            {</div>
<div class="line"><span class="lineno"> 1486</span>                colstep += Nx;</div>
<div class="line"><span class="lineno"> 1487</span>            }</div>
<div class="line"><span class="lineno"> 1488</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1489</span>            {</div>
<div class="line"><span class="lineno"> 1490</span>            <span class="comment">// Odd columns</span></div>
<div class="line"><span class="lineno"> 1491</span>                <span class="keywordflow">if</span>(j%2 == 1) colstep += Nx;</div>
<div class="line"><span class="lineno"> 1492</span>                <span class="keywordflow">else</span> colstep += (Nx-1);</div>
<div class="line"><span class="lineno"> 1493</span>            }</div>
<div class="line"><span class="lineno"> 1494</span>            <span class="comment">//itery += incy;</span></div>
<div class="line"><span class="lineno"> 1495</span>        }</div>
<div class="line"><span class="lineno"> 1496</span>    }</div>
<div class="line"><span class="lineno"> 1497</span> </div>
<div class="line"><span class="lineno"> 1498</span>    <span class="comment">// Create output to VTK</span></div>
<div class="line"><span class="lineno"> 1499</span> </div>
<div class="line"><span class="lineno"> 1500</span>    stringstream outbuffer;</div>
<div class="line"><span class="lineno"> 1501</span> </div>
<div class="line"><span class="lineno"> 1502</span>    outbuffer &lt;&lt; <span class="stringliteral">&quot;# vtk DataFile Version 3.0\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1503</span>    outbuffer &lt;&lt; <span class="stringliteral">&quot;InitialEulerAngles\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1504</span>    outbuffer &lt;&lt; <span class="stringliteral">&quot;ASCII\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1505</span>    outbuffer &lt;&lt; <span class="stringliteral">&quot;DATASET STRUCTURED_GRID\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1506</span>    outbuffer &lt;&lt; <span class="stringliteral">&quot;DIMENSIONS &quot;</span> &lt;&lt; Nx &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; Ny &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; 1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1507</span>    outbuffer &lt;&lt; <span class="stringliteral">&quot;POINTS &quot;</span> &lt;&lt;  Nx*Ny &lt;&lt; <span class="stringliteral">&quot; int\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1508</span> </div>
<div class="line"><span class="lineno"> 1509</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; Nz; ++k)</div>
<div class="line"><span class="lineno"> 1510</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; Ny; ++j)</div>
<div class="line"><span class="lineno"> 1511</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; Nx; ++i)</div>
<div class="line"><span class="lineno"> 1512</span>    {</div>
<div class="line"><span class="lineno"> 1513</span>        outbuffer &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1514</span>    }</div>
<div class="line"><span class="lineno"> 1515</span>    outbuffer &lt;&lt; <span class="stringliteral">&quot; \n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1516</span>    outbuffer &lt;&lt; <span class="stringliteral">&quot;POINT_DATA &quot;</span> &lt;&lt; Nx*Ny &lt;&lt; <span class="stringliteral">&quot; \n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1517</span> </div>
<div class="line"><span class="lineno"> 1518</span>    outbuffer &lt;&lt; <span class="stringliteral">&quot;SCALARS Eang_&quot;</span> &lt;&lt; 1 &lt;&lt; <span class="stringliteral">&quot; double\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1519</span>    outbuffer &lt;&lt; <span class="stringliteral">&quot;LOOKUP_TABLE default\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1520</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; Nz; k++)</div>
<div class="line"><span class="lineno"> 1521</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; Ny; j++)</div>
<div class="line"><span class="lineno"> 1522</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; Nx; i++)</div>
<div class="line"><span class="lineno"> 1523</span>    {</div>
<div class="line"><span class="lineno"> 1524</span>        outbuffer &lt;&lt; StorageEulerAngles(i,j,k).Q[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><span class="lineno"> 1525</span>    }</div>
<div class="line"><span class="lineno"> 1526</span>    outbuffer &lt;&lt; <span class="stringliteral">&quot; \n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1527</span>    outbuffer &lt;&lt; <span class="stringliteral">&quot;SCALARS Eang_&quot;</span> &lt;&lt; 2 &lt;&lt; <span class="stringliteral">&quot; double\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1528</span>    outbuffer &lt;&lt; <span class="stringliteral">&quot;LOOKUP_TABLE default\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1529</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; Nz; k++)</div>
<div class="line"><span class="lineno"> 1530</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; Ny; j++)</div>
<div class="line"><span class="lineno"> 1531</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; Nx; i++)</div>
<div class="line"><span class="lineno"> 1532</span>    {</div>
<div class="line"><span class="lineno"> 1533</span>        outbuffer &lt;&lt; StorageEulerAngles(i,j,k).Q[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><span class="lineno"> 1534</span>    }</div>
<div class="line"><span class="lineno"> 1535</span>    outbuffer &lt;&lt; <span class="stringliteral">&quot; \n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1536</span>    outbuffer &lt;&lt; <span class="stringliteral">&quot;SCALARS Eang_&quot;</span> &lt;&lt; 3 &lt;&lt; <span class="stringliteral">&quot; double\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1537</span>    outbuffer &lt;&lt; <span class="stringliteral">&quot;LOOKUP_TABLE default\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1538</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; Nz; k++)</div>
<div class="line"><span class="lineno"> 1539</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; Ny; j++)</div>
<div class="line"><span class="lineno"> 1540</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; Nx; i++)</div>
<div class="line"><span class="lineno"> 1541</span>    {</div>
<div class="line"><span class="lineno"> 1542</span>        outbuffer &lt;&lt; StorageEulerAngles(i,j,k).Q[2] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><span class="lineno"> 1543</span>    }</div>
<div class="line"><span class="lineno"> 1544</span> </div>
<div class="line"><span class="lineno"> 1545</span>    <span class="keywordtype">string</span> FileName = <a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a36c021aa7764ad2af93a18b4778ae2d3">DefaultVTKDir</a> + <span class="stringliteral">&quot;InitializedEulerAngles.vtk&quot;</span>;</div>
<div class="line"><span class="lineno"> 1546</span> </div>
<div class="line"><span class="lineno"> 1547</span>    ofstream vtk_file(FileName.c_str());</div>
<div class="line"><span class="lineno"> 1548</span>    vtk_file &lt;&lt; outbuffer.rdbuf();</div>
<div class="line"><span class="lineno"> 1549</span>    vtk_file.close();</div>
<div class="line"><span class="lineno"> 1550</span> </div>
<div class="line"><span class="lineno"> 1551</span>    <span class="comment">// Write table of orientations</span></div>
<div class="line"><span class="lineno"> 1552</span> </div>
<div class="line"><span class="lineno"> 1553</span>    outbuffer.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 1554</span> </div>
<div class="line"><span class="lineno"> 1555</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0 ; i &lt; Eang.size(); ++i)</div>
<div class="line"><span class="lineno"> 1556</span>    {</div>
<div class="line"><span class="lineno"> 1557</span>        outbuffer &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; Eang[i].Q[0] &lt;&lt; <span class="stringliteral">&quot;  &quot;</span></div>
<div class="line"><span class="lineno"> 1558</span>                               &lt;&lt; Eang[i].Q[1] &lt;&lt; <span class="stringliteral">&quot;  &quot;</span></div>
<div class="line"><span class="lineno"> 1559</span>                               &lt;&lt; Eang[i].Q[2] &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 1560</span>    }</div>
<div class="line"><span class="lineno"> 1561</span>    FileName = <span class="stringliteral">&quot;EBSDorientations.dat&quot;</span>;</div>
<div class="line"><span class="lineno"> 1562</span> </div>
<div class="line"><span class="lineno"> 1563</span>    ofstream orientations_file(FileName.c_str());</div>
<div class="line"><span class="lineno"> 1564</span>    orientations_file &lt;&lt; outbuffer.rdbuf();</div>
<div class="line"><span class="lineno"> 1565</span>    orientations_file.close();</div>
<div class="line"><span class="lineno"> 1566</span> </div>
<div class="line"><span class="lineno"> 1567</span>    <span class="comment">// End write Euler angles</span></div>
<div class="line"><span class="lineno"> 1568</span> </div>
<div class="line"><span class="lineno"> 1569</span>    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FinalizeInitialization(BC);</div>
<div class="line"><span class="lineno"> 1570</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;EBSD&quot;</span>, <span class="stringliteral">&quot;done&quot;</span>);</div>
<div class="line"><span class="lineno"> 1571</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ad86f674a75177eed4dd6cd8c06fcba47">ConsoleOutput::WriteLine</a>();</div>
<div class="line"><span class="lineno"> 1572</span> </div>
<div class="line"><span class="lineno"> 1573</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1574</span>}</div>
<div class="ttc" id="anamespaceopenphase_html_a36c021aa7764ad2af93a18b4778ae2d3"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a36c021aa7764ad2af93a18b4778ae2d3">openphase::DefaultVTKDir</a></div><div class="ttdeci">const std::string DefaultVTKDir</div><div class="ttdef"><b>Definition</b> <a href="../../d9/df1/Globals_8h_source.html#l00266">Globals.h:266</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_a631078f50f3da2bf1138bc0182054010a3f621246b8dd589df33df6fce0956d8c"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a631078f50f3da2bf1138bc0182054010a3f621246b8dd589df33df6fce0956d8c">openphase::ZXZ</a></div><div class="ttdeci">@ ZXZ</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d29/EulerAngles_8h_source.html#l00036">EulerAngles.h:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9a0a30cc938c92f1085dfc35a623e5fb" name="a9a0a30cc938c92f1085dfc35a623e5fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a0a30cc938c92f1085dfc35a623e5fb">&#9670;&#160;</a></span>TwoWalls()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; size_t &gt; openphase::Initializations::TwoWalls </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>ChannelPhaseIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>WallsPhaseIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>WallsThickness</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html#l00672">672</a> of file <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html">Initializations.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  677</span>{</div>
<div class="line"><span class="lineno">  678</span>    <span class="keywordtype">int</span> Nz = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNz;</div>
<div class="line"><span class="lineno">  679</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> iWidth = (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Resolution == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9acf53591af1208ddd535806600273099a">Resolutions::Dual</a>) ? 0.5*<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth : <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth;</div>
<div class="line"><span class="lineno">  680</span> </div>
<div class="line"><span class="lineno">  681</span>    <span class="keywordtype">size_t</span> index1 = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.AddGrainInfo(ChannelPhaseIndex);</div>
<div class="line"><span class="lineno">  682</span>    <span class="keywordtype">size_t</span> index2 = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.AddGrainInfo(WallsPhaseIndex);</div>
<div class="line"><span class="lineno">  683</span> </div>
<div class="line"><span class="lineno">  684</span>    <span class="keywordtype">int</span> offset = WallsThickness;</div>
<div class="line"><span class="lineno">  685</span> </div>
<div class="line"><span class="lineno">  686</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a71aed4b94e116454c7b11985a91e49ec">STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields.Bcells())</div>
<div class="line"><span class="lineno">  687</span>    {</div>
<div class="line"><span class="lineno">  688</span>        <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).clear();</div>
<div class="line"><span class="lineno">  689</span>        <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).flag = 0;</div>
<div class="line"><span class="lineno">  690</span> </div>
<div class="line"><span class="lineno">  691</span>        <span class="keywordflow">if</span> (k + <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.OffsetZ &gt; offset + iWidth/2 &amp;&amp; k + <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.OffsetZ &lt; Nz - offset - 1 - iWidth/2)</div>
<div class="line"><span class="lineno">  692</span>        {</div>
<div class="line"><span class="lineno">  693</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(index1, 1);</div>
<div class="line"><span class="lineno">  694</span>        }</div>
<div class="line"><span class="lineno">  695</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k+ <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.OffsetZ &lt; offset - iWidth/2 || k+ <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.OffsetZ &gt; Nz - offset - 1 + iWidth/2)</div>
<div class="line"><span class="lineno">  696</span>        {</div>
<div class="line"><span class="lineno">  697</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(index2, 1);</div>
<div class="line"><span class="lineno">  698</span>        }</div>
<div class="line"><span class="lineno">  699</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k+ <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.OffsetZ &gt;= offset - iWidth/2 &amp;&amp; k+ <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.OffsetZ &lt;= offset + iWidth/2)</div>
<div class="line"><span class="lineno">  700</span>        {</div>
<div class="line"><span class="lineno">  701</span>            <span class="keywordtype">double</span> IntProf = 0.5 - 0.5*sin(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>*((k+ <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.OffsetZ) - offset)/iWidth);</div>
<div class="line"><span class="lineno">  702</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(index1, 1.0 - IntProf);</div>
<div class="line"><span class="lineno">  703</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(index2, IntProf);</div>
<div class="line"><span class="lineno">  704</span> </div>
<div class="line"><span class="lineno">  705</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).flag = 2;</div>
<div class="line"><span class="lineno">  706</span>        }</div>
<div class="line"><span class="lineno">  707</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k+ <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.OffsetZ &gt;= Nz - offset - 1 - iWidth/2 &amp;&amp; k+ <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.OffsetZ &lt;= Nz - offset - 1 + iWidth/2)</div>
<div class="line"><span class="lineno">  708</span>        {</div>
<div class="line"><span class="lineno">  709</span>            <span class="keywordtype">double</span> IntProf = 0.5 + 0.5*sin(<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>*(Nz - (k + <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.OffsetZ)- offset - 1)/iWidth);</div>
<div class="line"><span class="lineno">  710</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(index1, IntProf);</div>
<div class="line"><span class="lineno">  711</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(index2, 1.0 - IntProf);</div>
<div class="line"><span class="lineno">  712</span>            <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).flag = 2;</div>
<div class="line"><span class="lineno">  713</span>        }</div>
<div class="line"><span class="lineno">  714</span>    }</div>
<div class="line"><span class="lineno">  715</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a6ad2c83345f230517a1770304d7b39ad">STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  716</span> </div>
<div class="line"><span class="lineno">  717</span>    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FinalizeInitialization(BC);</div>
<div class="line"><span class="lineno">  718</span>    <span class="keywordflow">return</span> vector&lt;size_t&gt;({index1,index2});</div>
<div class="line"><span class="lineno">  719</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa1a0cbb18fe4523334870d2d631e1e69" name="aa1a0cbb18fe4523334870d2d631e1e69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1a0cbb18fe4523334870d2d631e1e69">&#9670;&#160;</a></span>VoronoiTessellation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::Initializations::VoronoiTessellation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>seedpoints</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>matrixphase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates Voronoi grain structures using the algorithm based on coordination shells. </p>

<p class="definition">Definition at line <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html#l02014">2014</a> of file <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html">Initializations.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2018</span>{</div>
<div class="line"><span class="lineno"> 2019</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a3adb3c1b74bf9ac814922b7a8283707e">ConsoleOutput::WriteLineInsert</a>(<span class="stringliteral">&quot;Voronoi creator&quot;</span>);</div>
<div class="line"><span class="lineno"> 2020</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Number of grains&quot;</span>, Ngrains);</div>
<div class="line"><span class="lineno"> 2021</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#ae2753bb70e817b1bdd5ae2b99adf6e0f">ConsoleOutput::WriteStandard</a>(<span class="stringliteral">&quot;Thermodynamic phase&quot;</span>, GrainsPhase);</div>
<div class="line"><span class="lineno"> 2022</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a607154bed184a8633e4a43e37e98a4d9">ConsoleOutput::WriteSimple</a>(<span class="stringliteral">&quot;Generating grain seeds... &quot;</span>);</div>
<div class="line"><span class="lineno"> 2023</span> </div>
<div class="line"><span class="lineno"> 2024</span>    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Clear();</div>
<div class="line"><span class="lineno"> 2025</span> </div>
<div class="line"><span class="lineno"> 2026</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> n = 0; n &lt; Ngrains; n++)</div>
<div class="line"><span class="lineno"> 2027</span>    {</div>
<div class="line"><span class="lineno"> 2028</span>        <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.AddGrainInfo(GrainsPhase);</div>
<div class="line"><span class="lineno"> 2029</span>    }</div>
<div class="line"><span class="lineno"> 2030</span> </div>
<div class="line"><span class="lineno"> 2031</span>    <span class="keywordtype">int</span> TotalNx = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNx;</div>
<div class="line"><span class="lineno"> 2032</span>    <span class="keywordtype">int</span> TotalNy = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNy;</div>
<div class="line"><span class="lineno"> 2033</span>    <span class="keywordtype">int</span> TotalNz = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNz;</div>
<div class="line"><span class="lineno"> 2034</span> </div>
<div class="line"><span class="lineno"> 2035</span>    <span class="keywordtype">int</span> Nx = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Nx;</div>
<div class="line"><span class="lineno"> 2036</span>    <span class="keywordtype">int</span> Ny = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Ny;</div>
<div class="line"><span class="lineno"> 2037</span>    <span class="keywordtype">int</span> Nz = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Nz;</div>
<div class="line"><span class="lineno"> 2038</span> </div>
<div class="line"><span class="lineno"> 2039</span>    <span class="keywordtype">size_t</span> SeedX = 253;</div>
<div class="line"><span class="lineno"> 2040</span>    <span class="keywordtype">size_t</span> SeedY = 4958;</div>
<div class="line"><span class="lineno"> 2041</span>    <span class="keywordtype">size_t</span> SeedZ = 54861;</div>
<div class="line"><span class="lineno"> 2042</span> </div>
<div class="line"><span class="lineno"> 2043</span>    mt19937_64 xPosGenerator(SeedX);</div>
<div class="line"><span class="lineno"> 2044</span>    mt19937_64 yPosGenerator(SeedY);</div>
<div class="line"><span class="lineno"> 2045</span>    mt19937_64 zPosGenerator(SeedZ);</div>
<div class="line"><span class="lineno"> 2046</span> </div>
<div class="line"><span class="lineno"> 2047</span>    uniform_int_distribution &lt;int&gt; xPosDistribution(0, TotalNx - 1);</div>
<div class="line"><span class="lineno"> 2048</span>    uniform_int_distribution &lt;int&gt; yPosDistribution(0, TotalNy - 1);</div>
<div class="line"><span class="lineno"> 2049</span>    uniform_int_distribution &lt;int&gt; zPosDistribution(0, TotalNz - 1);</div>
<div class="line"><span class="lineno"> 2050</span> </div>
<div class="line"><span class="lineno"> 2051</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties.size(); ++n)</div>
<div class="line"><span class="lineno"> 2052</span>    {</div>
<div class="line"><span class="lineno"> 2053</span>        <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[n].Rcm[0] = xPosDistribution(xPosGenerator);</div>
<div class="line"><span class="lineno"> 2054</span>        <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[n].Rcm[1] = yPosDistribution(yPosGenerator);</div>
<div class="line"><span class="lineno"> 2055</span>        <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[n].Rcm[2] = zPosDistribution(zPosGenerator);</div>
<div class="line"><span class="lineno"> 2056</span>    }</div>
<div class="line"><span class="lineno"> 2057</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a607154bed184a8633e4a43e37e98a4d9">ConsoleOutput::WriteSimple</a>(<span class="stringliteral">&quot;Done!&quot;</span>);</div>
<div class="line"><span class="lineno"> 2058</span> </div>
<div class="line"><span class="lineno"> 2059</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a607154bed184a8633e4a43e37e98a4d9">ConsoleOutput::WriteSimple</a>(<span class="stringliteral">&quot;Creating coordination shells...&quot;</span>);</div>
<div class="line"><span class="lineno"> 2060</span> </div>
<div class="line"><span class="lineno"> 2061</span>    <span class="keywordtype">size_t</span> NpointsTotal = TotalNx*TotalNy*TotalNz;</div>
<div class="line"><span class="lineno"> 2062</span>    <span class="keywordtype">size_t</span> NpointsRun = 0;</div>
<div class="line"><span class="lineno"> 2063</span> </div>
<div class="line"><span class="lineno"> 2064</span>    vector&lt;iVector3&gt; CoordinationShells;</div>
<div class="line"><span class="lineno"> 2065</span> </div>
<div class="line"><span class="lineno"> 2066</span>    <span class="keywordtype">int</span> MAXsize = std::max(std::max(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNx, <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNy), <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.TotalNz);</div>
<div class="line"><span class="lineno"> 2067</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> x = 0; x &lt; MAXsize; x++)</div>
<div class="line"><span class="lineno"> 2068</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> y = x; y &lt; MAXsize; y++)</div>
<div class="line"><span class="lineno"> 2069</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> z = y; z &lt; MAXsize; z++)</div>
<div class="line"><span class="lineno"> 2070</span>    {</div>
<div class="line"><span class="lineno"> 2071</span>        CoordinationShells.push_back(iVector3({x,y,z}));</div>
<div class="line"><span class="lineno"> 2072</span>    }</div>
<div class="line"><span class="lineno"> 2073</span>    std::sort(CoordinationShells.begin(),CoordinationShells.end());</div>
<div class="line"><span class="lineno"> 2074</span> </div>
<div class="line"><span class="lineno"> 2075</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a607154bed184a8633e4a43e37e98a4d9">ConsoleOutput::WriteSimple</a>(<span class="stringliteral">&quot;Done!&quot;</span>);</div>
<div class="line"><span class="lineno"> 2076</span> </div>
<div class="line"><span class="lineno"> 2077</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#adc741bd713ef03fa4a2e95055effc2f0">ConsoleOutput::StartProgressIndicator</a>(<span class="stringliteral">&quot;Creating Voronoi grain structure&quot;</span>);</div>
<div class="line"><span class="lineno"> 2078</span>    <span class="keywordtype">int</span> position = 0;</div>
<div class="line"><span class="lineno"> 2079</span> </div>
<div class="line"><span class="lineno"> 2080</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> s = 0; s &lt; CoordinationShells.size(); s++)</div>
<div class="line"><span class="lineno"> 2081</span>    {</div>
<div class="line"><span class="lineno"> 2082</span>        vector &lt;iVector3&gt; locShell = <a class="code hl_function" href="../../df/dfe/classopenphase_1_1Tools.html#a4e705f80c82f77b5ebec80cdbd6d8dcb">Tools::findIndexPermutations</a>(CoordinationShells[s]);</div>
<div class="line"><span class="lineno"> 2083</span> </div>
<div class="line"><span class="lineno"> 2084</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties.size(); ++n)</div>
<div class="line"><span class="lineno"> 2085</span>        {</div>
<div class="line"><span class="lineno"> 2086</span>            <span class="keywordtype">int</span> Rx = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[n].Rcm[0];</div>
<div class="line"><span class="lineno"> 2087</span>            <span class="keywordtype">int</span> Ry = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[n].Rcm[1];</div>
<div class="line"><span class="lineno"> 2088</span>            <span class="keywordtype">int</span> Rz = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[n].Rcm[2];</div>
<div class="line"><span class="lineno"> 2089</span> </div>
<div class="line"><span class="lineno"> 2090</span>            <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> m = 0; m &lt; locShell.size(); m++)</div>
<div class="line"><span class="lineno"> 2091</span>            {</div>
<div class="line"><span class="lineno"> 2092</span>                <span class="keywordtype">int</span> x = Rx + locShell[m][0];</div>
<div class="line"><span class="lineno"> 2093</span>                <span class="keywordtype">int</span> y = Ry + locShell[m][1];</div>
<div class="line"><span class="lineno"> 2094</span>                <span class="keywordtype">int</span> z = Rz + locShell[m][2];</div>
<div class="line"><span class="lineno"> 2095</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 2096</span>                <span class="keywordflow">if</span>(BC.BC0X == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a> or BC.MPIperiodicX) x = (x + TotalNx) % TotalNx;</div>
<div class="line"><span class="lineno"> 2097</span>                <span class="keywordflow">if</span>(BC.BC0Y == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a> or BC.MPIperiodicY) y = (y + TotalNy) % TotalNy;</div>
<div class="line"><span class="lineno"> 2098</span>                <span class="keywordflow">if</span>(BC.BC0Z == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a> or BC.MPIperiodicZ) z = (z + TotalNz) % TotalNz;</div>
<div class="line"><span class="lineno"> 2099</span> </div>
<div class="line"><span class="lineno"> 2100</span>                x -= <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.OffsetX;</div>
<div class="line"><span class="lineno"> 2101</span>                y -= <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.OffsetY;</div>
<div class="line"><span class="lineno"> 2102</span>                z -= <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.OffsetZ;</div>
<div class="line"><span class="lineno"> 2103</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 2104</span>                <span class="keywordflow">if</span>(BC.BC0X == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>) x = (x + Nx) % Nx;</div>
<div class="line"><span class="lineno"> 2105</span>                <span class="keywordflow">if</span>(BC.BC0Y == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>) y = (y + Ny) % Ny;</div>
<div class="line"><span class="lineno"> 2106</span>                <span class="keywordflow">if</span>(BC.BC0Z == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>) z = (z + Nz) % Nz;</div>
<div class="line"><span class="lineno"> 2107</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2108</span>                <span class="keywordflow">if</span>(x &gt;= 0 and x &lt; Nx and</div>
<div class="line"><span class="lineno"> 2109</span>                   y &gt;= 0 and y &lt; Ny and</div>
<div class="line"><span class="lineno"> 2110</span>                   z &gt;= 0 and z &lt; Nz and</div>
<div class="line"><span class="lineno"> 2111</span>                   <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(x,y,z).size() == 0)</div>
<div class="line"><span class="lineno"> 2112</span>                {</div>
<div class="line"><span class="lineno"> 2113</span>                    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(x,y,z).set_value(n, 1.0);</div>
<div class="line"><span class="lineno"> 2114</span>                    NpointsRun ++;</div>
<div class="line"><span class="lineno"> 2115</span>                }</div>
<div class="line"><span class="lineno"> 2116</span>            }</div>
<div class="line"><span class="lineno"> 2117</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno"> 2118</span>            OP_MPI_Allreduce(OP_MPI_IN_PLACE, &amp;NpointsRun, 1, OP_MPI_UNSIGNED_LONG, OP_MPI_SUM, OP_MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 2119</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2120</span>            <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a0d699e41af6f89b4ea022723e8ff6e2e">ConsoleOutput::AdvanceProgressIndicator</a>(0,NpointsTotal,NpointsRun, position);</div>
<div class="line"><span class="lineno"> 2121</span> </div>
<div class="line"><span class="lineno"> 2122</span>            <span class="keywordflow">if</span>(NpointsRun == NpointsTotal) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2123</span>        }</div>
<div class="line"><span class="lineno"> 2124</span>        <span class="keywordflow">if</span>(NpointsRun == NpointsTotal) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2125</span>    }</div>
<div class="line"><span class="lineno"> 2126</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a1e5e83eb43dc21106d6610e655ac4f7f">ConsoleOutput::EndProgressIndicator</a>();</div>
<div class="line"><span class="lineno"> 2127</span> </div>
<div class="line"><span class="lineno"> 2128</span>    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.SetBoundaryConditions(BC);</div>
<div class="line"><span class="lineno"> 2129</span> </div>
<div class="line"><span class="lineno"> 2130</span>    <span class="comment">// Spread interfaces by overlapping the grains near the interface</span></div>
<div class="line"><span class="lineno"> 2131</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a607154bed184a8633e4a43e37e98a4d9">ConsoleOutput::WriteSimple</a>(<span class="stringliteral">&quot;Creating grain boundaries...&quot;</span>);</div>
<div class="line"><span class="lineno"> 2132</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a71aed4b94e116454c7b11985a91e49ec">STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields,0)</div>
<div class="line"><span class="lineno"> 2133</span>    if(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).size() == 1)</div>
<div class="line"><span class="lineno"> 2134</span>    {</div>
<div class="line"><span class="lineno"> 2135</span>        <span class="keywordtype">size_t</span> alpha_index = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).begin()-&gt;index;</div>
<div class="line"><span class="lineno"> 2136</span> </div>
<div class="line"><span class="lineno"> 2137</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> di = -1; di &lt;= 1; di++)</div>
<div class="line"><span class="lineno"> 2138</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> dj = -1; dj &lt;= 1; dj++)</div>
<div class="line"><span class="lineno"> 2139</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> dk = -1; dk &lt;= 1; dk++)</div>
<div class="line"><span class="lineno"> 2140</span>        <span class="keywordflow">if</span>(i+di &gt;= 0 and i+di &lt; Nx and</div>
<div class="line"><span class="lineno"> 2141</span>           j+dj &gt;= 0 and j+dj &lt; Ny and</div>
<div class="line"><span class="lineno"> 2142</span>           k+dk &gt;= 0 and k+dk &lt; Nz and</div>
<div class="line"><span class="lineno"> 2143</span>           (di != 0 or dj != 0 or dk != 0))</div>
<div class="line"><span class="lineno"> 2144</span>        {</div>
<div class="line"><span class="lineno"> 2145</span>            <span class="keywordtype">bool</span> grain_not_present = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2146</span>            <span class="keywordflow">for</span>(<span class="keyword">auto</span> beta  = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i+di,j+dj,k+dk).begin();</div>
<div class="line"><span class="lineno"> 2147</span>                     beta != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i+di,j+dj,k+dk).end(); ++beta)</div>
<div class="line"><span class="lineno"> 2148</span>            <span class="keywordflow">if</span>(beta-&gt;index == alpha_index)</div>
<div class="line"><span class="lineno"> 2149</span>            {</div>
<div class="line"><span class="lineno"> 2150</span>                grain_not_present = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2151</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2152</span>            }</div>
<div class="line"><span class="lineno"> 2153</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2154</span>            {</div>
<div class="line"><span class="lineno"> 2155</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2156</span>            }</div>
<div class="line"><span class="lineno"> 2157</span>            <span class="keywordflow">if</span>(grain_not_present)</div>
<div class="line"><span class="lineno"> 2158</span>            {</div>
<div class="line"><span class="lineno"> 2159</span>                <span class="keywordflow">for</span>(<span class="keyword">auto</span> beta  = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i+di,j+dj,k+dk).begin();</div>
<div class="line"><span class="lineno"> 2160</span>                         beta != <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i+di,j+dj,k+dk).end(); ++beta)</div>
<div class="line"><span class="lineno"> 2161</span>                {</div>
<div class="line"><span class="lineno"> 2162</span>                    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).add_value(beta-&gt;index, 1.0);</div>
<div class="line"><span class="lineno"> 2163</span>                }</div>
<div class="line"><span class="lineno"> 2164</span>                <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i+di,j+dj,k+dk).add_value(alpha_index, 1.0);</div>
<div class="line"><span class="lineno"> 2165</span>            }</div>
<div class="line"><span class="lineno"> 2166</span>        }</div>
<div class="line"><span class="lineno"> 2167</span>    }</div>
<div class="line"><span class="lineno"> 2168</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a6ad2c83345f230517a1770304d7b39ad">STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno"> 2169</span> </div>
<div class="line"><span class="lineno"> 2170</span>    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FinalizeInitialization(BC);</div>
<div class="line"><span class="lineno"> 2171</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a607154bed184a8633e4a43e37e98a4d9">ConsoleOutput::WriteSimple</a>(<span class="stringliteral">&quot;Done!&quot;</span>);</div>
<div class="line"><span class="lineno"> 2172</span> </div>
<div class="line"><span class="lineno"> 2173</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a607154bed184a8633e4a43e37e98a4d9">ConsoleOutput::WriteSimple</a>(<span class="stringliteral">&quot;Generating random orientations...&quot;</span>);</div>
<div class="line"><span class="lineno"> 2174</span> </div>
<div class="line"><span class="lineno"> 2175</span>    mt19937_64 OrientGenerator1(45);</div>
<div class="line"><span class="lineno"> 2176</span>    mt19937_64 OrientGenerator2(697);</div>
<div class="line"><span class="lineno"> 2177</span>    mt19937_64 OrientGenerator3(255);</div>
<div class="line"><span class="lineno"> 2178</span> </div>
<div class="line"><span class="lineno"> 2179</span>    uniform_int_distribution &lt;int&gt; Q1Distribution(0, 360);</div>
<div class="line"><span class="lineno"> 2180</span>    uniform_int_distribution &lt;int&gt; Q2Distribution(0, 180);</div>
<div class="line"><span class="lineno"> 2181</span>    uniform_int_distribution &lt;int&gt; Q3Distribution(0, 360);</div>
<div class="line"><span class="lineno"> 2182</span> </div>
<div class="line"><span class="lineno"> 2183</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> n = 0; n &lt; <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties.size(); n++)</div>
<div class="line"><span class="lineno"> 2184</span>    {</div>
<div class="line"><span class="lineno"> 2185</span>        <span class="keywordtype">double</span> Q1 = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.dNy*<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.dNz*Q1Distribution(OrientGenerator1) * <a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>/180.0;</div>
<div class="line"><span class="lineno"> 2186</span>        <span class="keywordtype">double</span> Q2 = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.dNx*<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.dNz*Q2Distribution(OrientGenerator2) * <a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>/180.0;</div>
<div class="line"><span class="lineno"> 2187</span>        <span class="keywordtype">double</span> Q3 = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.dNx*<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.dNy*Q3Distribution(OrientGenerator3) * <a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>/180.0;</div>
<div class="line"><span class="lineno"> 2188</span> </div>
<div class="line"><span class="lineno"> 2189</span>        EulerAngles locAngles({Q1, Q2, Q3}, <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a631078f50f3da2bf1138bc0182054010ab71eaef9d6f6d31e69a4401fc00b737c">XYZ</a>);</div>
<div class="line"><span class="lineno"> 2190</span>        <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[n].Orientation = locAngles.getQuaternion();</div>
<div class="line"><span class="lineno"> 2191</span>    }</div>
<div class="line"><span class="lineno"> 2192</span> </div>
<div class="line"><span class="lineno"> 2193</span>    <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a607154bed184a8633e4a43e37e98a4d9">ConsoleOutput::WriteSimple</a>(<span class="stringliteral">&quot;Done!&quot;</span>);</div>
<div class="line"><span class="lineno"> 2194</span>}</div>
<div class="ttc" id="aclassopenphase_1_1ConsoleOutput_html_a0d699e41af6f89b4ea022723e8ff6e2e"><div class="ttname"><a href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a0d699e41af6f89b4ea022723e8ff6e2e">openphase::ConsoleOutput::AdvanceProgressIndicator</a></div><div class="ttdeci">static void AdvanceProgressIndicator(double start_value, double end_value, double current_value, int &amp;position)</div><div class="ttdef"><b>Definition</b> <a href="../../da/da0/ConsoleOutput_8cpp_source.html#l00258">ConsoleOutput.cpp:258</a></div></div>
<div class="ttc" id="aclassopenphase_1_1ConsoleOutput_html_a1e5e83eb43dc21106d6610e655ac4f7f"><div class="ttname"><a href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a1e5e83eb43dc21106d6610e655ac4f7f">openphase::ConsoleOutput::EndProgressIndicator</a></div><div class="ttdeci">static void EndProgressIndicator(void)</div><div class="ttdef"><b>Definition</b> <a href="../../da/da0/ConsoleOutput_8cpp_source.html#l00275">ConsoleOutput.cpp:275</a></div></div>
<div class="ttc" id="aclassopenphase_1_1ConsoleOutput_html_adc741bd713ef03fa4a2e95055effc2f0"><div class="ttname"><a href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#adc741bd713ef03fa4a2e95055effc2f0">openphase::ConsoleOutput::StartProgressIndicator</a></div><div class="ttdeci">static void StartProgressIndicator(std::string IndicatorTitle)</div><div class="ttdef"><b>Definition</b> <a href="../../da/da0/ConsoleOutput_8cpp_source.html#l00245">ConsoleOutput.cpp:245</a></div></div>
<div class="ttc" id="aclassopenphase_1_1Tools_html_a4e705f80c82f77b5ebec80cdbd6d8dcb"><div class="ttname"><a href="../../df/dfe/classopenphase_1_1Tools.html#a4e705f80c82f77b5ebec80cdbd6d8dcb">openphase::Tools::findIndexPermutations</a></div><div class="ttdeci">static std::vector&lt; iVector3 &gt; findIndexPermutations(iVector3 &amp;locIndices)</div><div class="ttdoc">Finds all index permutations of locIndices.</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d48/Tools_8cpp_source.html#l00037">Tools.cpp:37</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a128f6f13a01a0358bf4903026d50cae7" name="a128f6f13a01a0358bf4903026d50cae7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a128f6f13a01a0358bf4903026d50cae7">&#9670;&#160;</a></span>Young3()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; size_t &gt; openphase::Initializations::Young3 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>gamma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html#l00478">478</a> of file <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html">Initializations.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  482</span>{</div>
<div class="line"><span class="lineno">  483</span>    vector&lt;size_t&gt; result;</div>
<div class="line"><span class="lineno">  484</span> </div>
<div class="line"><span class="lineno">  485</span>    <span class="keywordtype">int</span> Nx = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Nx;</div>
<div class="line"><span class="lineno">  486</span>    <span class="keywordtype">int</span> Nz = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Nz;</div>
<div class="line"><span class="lineno">  487</span> </div>
<div class="line"><span class="lineno">  488</span>    <span class="keywordtype">double</span> x = Nx/2.0;</div>
<div class="line"><span class="lineno">  489</span>    <span class="keywordtype">double</span> y = 0;</div>
<div class="line"><span class="lineno">  490</span>    <span class="keywordtype">double</span> z = Nz/2.0;</div>
<div class="line"><span class="lineno">  491</span> </div>
<div class="line"><span class="lineno">  492</span>    result.push_back(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e">Single</a>     (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, alpha,                   BC));</div>
<div class="line"><span class="lineno">  493</span>    result.push_back(<a class="code hl_function" href="../../de/dee/classopenphase_1_1Initializations.html#a299918f9104019121b5316cfe616d7b4">Rectangular</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>,  beta, x,y,z, 0.5*x,0,z, BC, <span class="keyword">false</span>));</div>
<div class="line"><span class="lineno">  494</span>    result.push_back(<a class="code hl_function" href="../../de/dee/classopenphase_1_1Initializations.html#a299918f9104019121b5316cfe616d7b4">Rectangular</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, gamma, x,y,z,     x,0,0, BC, <span class="keyword">false</span>));</div>
<div class="line"><span class="lineno">  495</span>    result.push_back(<a class="code hl_function" href="../../de/dee/classopenphase_1_1Initializations.html#a299918f9104019121b5316cfe616d7b4">Rectangular</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, delta, x,y,z, 1.5*x,0,z, BC, <span class="keyword">false</span>));</div>
<div class="line"><span class="lineno">  496</span> </div>
<div class="line"><span class="lineno">  497</span>    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FinalizeInitialization(BC);</div>
<div class="line"><span class="lineno">  498</span> </div>
<div class="line"><span class="lineno">  499</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  500</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7d99cbf6ca074c5de9bcedcaaa9fe9f9" name="a7d99cbf6ca074c5de9bcedcaaa9fe9f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d99cbf6ca074c5de9bcedcaaa9fe9f9">&#9670;&#160;</a></span>Young4()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; size_t &gt; openphase::Initializations::Young4 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>gamma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html#l00458">458</a> of file <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html">Initializations.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  462</span>{</div>
<div class="line"><span class="lineno">  463</span>    vector&lt;size_t&gt; result;</div>
<div class="line"><span class="lineno">  464</span> </div>
<div class="line"><span class="lineno">  465</span>    <span class="keywordtype">int</span> Nx = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Nx;</div>
<div class="line"><span class="lineno">  466</span>    <span class="keywordtype">int</span> Ny = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Ny;</div>
<div class="line"><span class="lineno">  467</span>    <span class="keywordtype">int</span> Nz = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Nz;</div>
<div class="line"><span class="lineno">  468</span> </div>
<div class="line"><span class="lineno">  469</span>    result.push_back(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a08a007ebb71a6dda0a7e0b5cd5286aa9a66ba162102bbf6ae31b522aec561735e">Single</a>     (<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>,alpha,                                                                                                                                BC));</div>
<div class="line"><span class="lineno">  470</span>    result.push_back(<a class="code hl_function" href="../../de/dee/classopenphase_1_1Initializations.html#a299918f9104019121b5316cfe616d7b4">Rectangular</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>,beta , 3.0*Nx/4.0+<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth,    Ny/3.0+<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth,Nz+2*<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth,5.0*Nx/8.0,    Ny/6.0-<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth,Nz/2, BC, <span class="keyword">false</span>));</div>
<div class="line"><span class="lineno">  471</span>    result.push_back(<a class="code hl_function" href="../../de/dee/classopenphase_1_1Initializations.html#a299918f9104019121b5316cfe616d7b4">Rectangular</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>,gamma, 3.0*Nx/4.0+<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth,2.0*Ny/3.0+<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth,Nz/2+<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth,5.0*Nx/8.0,4.0*Ny/6.0,                  Nz/4, BC, <span class="keyword">false</span>));</div>
<div class="line"><span class="lineno">  472</span>    result.push_back(<a class="code hl_function" href="../../de/dee/classopenphase_1_1Initializations.html#a299918f9104019121b5316cfe616d7b4">Rectangular</a>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>,delta, 3.0*Nx/4.0+<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth,2.0*Ny/3.0+<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth,Nz/2+<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.iWidth,5.0*Nx/8.0,4.0*Ny/6.0,              3.0*Nz/4, BC, <span class="keyword">false</span>));</div>
<div class="line"><span class="lineno">  473</span> </div>
<div class="line"><span class="lineno">  474</span>    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FinalizeInitialization(BC);</div>
<div class="line"><span class="lineno">  475</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  476</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aaf0a337a75548672e4ca7f73fbf0e2e7" name="aaf0a337a75548672e4ca7f73fbf0e2e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf0a337a75548672e4ca7f73fbf0e2e7">&#9670;&#160;</a></span>Young4Periodic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::Initializations::Young4Periodic </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>PhaseIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html#l00391">391</a> of file <a class="el" href="../../d3/d3a/Initializations_8cpp_source.html">Initializations.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  394</span>{</div>
<div class="line"><span class="lineno">  395</span>    <span class="keywordtype">int</span> Nx = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Nx;</div>
<div class="line"><span class="lineno">  396</span>    <span class="keywordtype">int</span> Ny = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Ny;</div>
<div class="line"><span class="lineno">  397</span>    <span class="keywordtype">int</span> Nz = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Nz;</div>
<div class="line"><span class="lineno">  398</span> </div>
<div class="line"><span class="lineno">  399</span>    <span class="keywordtype">size_t</span> locIndex0 = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.AddGrainInfo(PhaseIndex);</div>
<div class="line"><span class="lineno">  400</span>    <span class="keywordtype">size_t</span> locIndex1 = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.AddGrainInfo(PhaseIndex+1);</div>
<div class="line"><span class="lineno">  401</span>    <span class="keywordtype">size_t</span> locIndex2 = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.AddGrainInfo(PhaseIndex+2);</div>
<div class="line"><span class="lineno">  402</span>    <span class="keywordtype">size_t</span> locIndex3 = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.AddGrainInfo(PhaseIndex+3);</div>
<div class="line"><span class="lineno">  403</span>    <span class="keywordtype">size_t</span> locIndex4 = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.AddGrainInfo(PhaseIndex+4);</div>
<div class="line"><span class="lineno">  404</span>    <span class="keywordtype">size_t</span> locIndex5 = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.AddGrainInfo(PhaseIndex+5);</div>
<div class="line"><span class="lineno">  405</span>    <span class="keywordtype">size_t</span> locIndex6 = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.AddGrainInfo(PhaseIndex+6);</div>
<div class="line"><span class="lineno">  406</span>    <span class="keywordtype">size_t</span> locIndex7 = <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.AddGrainInfo(PhaseIndex+7);</div>
<div class="line"><span class="lineno">  407</span> </div>
<div class="line"><span class="lineno">  408</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a71aed4b94e116454c7b11985a91e49ec">STORAGE_LOOP_BEGIN</a>(i,j,k,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields,<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields.Bcells())</div>
<div class="line"><span class="lineno">  409</span>    {</div>
<div class="line"><span class="lineno">  410</span>        <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).flag = 2;</div>
<div class="line"><span class="lineno">  411</span> </div>
<div class="line"><span class="lineno">  412</span>        <span class="keywordflow">if</span> (j &lt;= Ny/2)</div>
<div class="line"><span class="lineno">  413</span>        {</div>
<div class="line"><span class="lineno">  414</span>            <span class="keywordflow">if</span>      (i &lt;= Nx/2 and k &gt;  Nz/4 and k &lt;= Nz*3./4)</div>
<div class="line"><span class="lineno">  415</span>                <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(locIndex1,1);</div>
<div class="line"><span class="lineno">  416</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i &gt;  Nx/2 and k &gt;  Nz/4 and k &lt;= Nz*3./4)</div>
<div class="line"><span class="lineno">  417</span>                <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(locIndex2,1);</div>
<div class="line"><span class="lineno">  418</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i &gt;  Nx/4 and i &lt;= Nx*3./4 and k &lt;= Nz/4)</div>
<div class="line"><span class="lineno">  419</span>                <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(locIndex3,1);</div>
<div class="line"><span class="lineno">  420</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i &gt;  Nx/4 and i &lt;= Nx*3./4 and k &gt;  Nz*3./4)</div>
<div class="line"><span class="lineno">  421</span>                <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(locIndex3,1);</div>
<div class="line"><span class="lineno">  422</span>            <span class="keywordflow">else</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).set_value(locIndex0,1);</div>
<div class="line"><span class="lineno">  423</span>        }</div>
<div class="line"><span class="lineno">  424</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  425</span>        {</div>
<div class="line"><span class="lineno">  426</span>            <span class="keywordflow">if</span>      (i &lt;= Nx/8 and k &gt;  Nz/8 and k &lt;= Nz*5./8)</div>
<div class="line"><span class="lineno">  427</span>                <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(locIndex5,1);</div>
<div class="line"><span class="lineno">  428</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i &gt;  Nx/8 and i &lt;= Nx*5./8 and k &gt;  Nz/8 and k &lt;= Nz*5./8)</div>
<div class="line"><span class="lineno">  429</span>                <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(locIndex4,1);</div>
<div class="line"><span class="lineno">  430</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i &gt;  Nx*5./8 and k &gt;  Nz/8 and k &lt;= Nz*5./8)</div>
<div class="line"><span class="lineno">  431</span>                <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(locIndex5,1);</div>
<div class="line"><span class="lineno">  432</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i &gt;  Nx*3./8 and i &lt;= Nx*7./8 and k &lt;= Nz/8)</div>
<div class="line"><span class="lineno">  433</span>                <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(locIndex6,1);</div>
<div class="line"><span class="lineno">  434</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i &gt;  Nx*3./8 and i &lt;= Nx*7./8 and k &gt;  Nz*5./8)</div>
<div class="line"><span class="lineno">  435</span>                <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i, j, k).set_value(locIndex6,1);</div>
<div class="line"><span class="lineno">  436</span>            <span class="keywordflow">else</span> <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Fields(i,j,k).set_value(locIndex7,1);</div>
<div class="line"><span class="lineno">  437</span>        }</div>
<div class="line"><span class="lineno">  438</span>    }</div>
<div class="line"><span class="lineno">  439</span>    <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a6ad2c83345f230517a1770304d7b39ad">STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  440</span> </div>
<div class="line"><span class="lineno">  441</span>    <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.SetBoundaryConditions(BC);</div>
<div class="line"><span class="lineno">  442</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a430c428a01443e146ef506a3305998a2" name="a430c428a01443e146ef506a3305998a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a430c428a01443e146ef506a3305998a2">&#9670;&#160;</a></span>thisclassname</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr auto openphase::Initializations::thisclassname = &quot;Initializations&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../df/db1/Initializations_8h_source.html#l00322">322</a> of file <a class="el" href="../../df/db1/Initializations_8h_source.html">Initializations.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../df/db1/Initializations_8h_source.html">Initializations.h</a></li>
<li><a class="el" href="../../d3/d3a/Initializations_8cpp_source.html">Initializations.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Dec 17 2025 09:11:00 for OpenPhase by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
