<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenPhase: openphase::Tools Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">OpenPhase
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d0/d6c/namespaceopenphase.html">openphase</a></li><li class="navelem"><a class="el" href="../../df/dfe/classopenphase_1_1Tools.html">Tools</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="../../dc/d30/classopenphase_1_1Tools-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">openphase::Tools Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &quot;<a class="el" href="../../d2/d8f/Tools_8h_source.html">Tools.h</a>&quot;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a4e705f80c82f77b5ebec80cdbd6d8dcb" id="r_a4e705f80c82f77b5ebec80cdbd6d8dcb"><td class="memItemLeft" align="right" valign="top">static std::vector&lt; <a class="el" href="../../da/d9c/classopenphase_1_1iVector3.html">iVector3</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dfe/classopenphase_1_1Tools.html#a4e705f80c82f77b5ebec80cdbd6d8dcb">findIndexPermutations</a> (<a class="el" href="../../da/d9c/classopenphase_1_1iVector3.html">iVector3</a> &amp;locIndices)</td></tr>
<tr class="memdesc:a4e705f80c82f77b5ebec80cdbd6d8dcb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds all index permutations of locIndices.  <br /></td></tr>
<tr class="separator:a4e705f80c82f77b5ebec80cdbd6d8dcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa0e13f9de8e0bc1648eca5fdfafaed4" id="r_afa0e13f9de8e0bc1648eca5fdfafaed4"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dfe/classopenphase_1_1Tools.html#afa0e13f9de8e0bc1648eca5fdfafaed4">jacobiRotate</a> (<a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a> &amp;A, <a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a> &amp;R, int p, int q)</td></tr>
<tr class="memdesc:afa0e13f9de8e0bc1648eca5fdfafaed4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implemented from <a href="https://dl.acm.org/doi/abs/10.1145/1028523.1028541">https://dl.acm.org/doi/abs/10.1145/1028523.1028541</a>.  <br /></td></tr>
<tr class="separator:afa0e13f9de8e0bc1648eca5fdfafaed4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60a7d5469cdf77db0cec3552f2211936" id="r_a60a7d5469cdf77db0cec3552f2211936"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dfe/classopenphase_1_1Tools.html#a60a7d5469cdf77db0cec3552f2211936">eigenDecomposition</a> (const <a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a> &amp;A, <a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a> &amp;eigenVecs, <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> &amp;eigenVals)</td></tr>
<tr class="separator:a60a7d5469cdf77db0cec3552f2211936"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ebd6ae82f8a9dabfd5a1f5879b01845" id="r_a6ebd6ae82f8a9dabfd5a1f5879b01845"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dfe/classopenphase_1_1Tools.html#a6ebd6ae82f8a9dabfd5a1f5879b01845">rotationMatrixIrving</a> (const <a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a> &amp;A, <a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a> &amp;R)</td></tr>
<tr class="separator:a6ebd6ae82f8a9dabfd5a1f5879b01845"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6e64e29384f0f87ba6725561038568f" id="r_ad6e64e29384f0f87ba6725561038568f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dfe/classopenphase_1_1Tools.html#ad6e64e29384f0f87ba6725561038568f">GetAxisAngleFromRotationMatrix</a> (const <a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a> RotMatrix, double &amp;Angle, <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> &amp;Axis)</td></tr>
<tr class="separator:ad6e64e29384f0f87ba6725561038568f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38134452ff33e20f92082d45081e9d5f" id="r_a38134452ff33e20f92082d45081e9d5f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dfe/classopenphase_1_1Tools.html#a38134452ff33e20f92082d45081e9d5f">getAxisAngle</a> (const <a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a> &amp;TransformationMatrix, <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> &amp;Axis, double &amp;Angle)</td></tr>
<tr class="separator:a38134452ff33e20f92082d45081e9d5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ef83a6fc2a78236f42efb36f23eb4ca" id="r_a3ef83a6fc2a78236f42efb36f23eb4ca"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dfe/classopenphase_1_1Tools.html#a3ef83a6fc2a78236f42efb36f23eb4ca">getMisorientation</a> (const <a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a> RotMatA, const <a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a> RotMatB)</td></tr>
<tr class="memdesc:a3ef83a6fc2a78236f42efb36f23eb4ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates missorientation between two matrices without consideration of symmetries.  <br /></td></tr>
<tr class="separator:a3ef83a6fc2a78236f42efb36f23eb4ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac027a3ad585e045c39b715a74fbe2c3f" id="r_ac027a3ad585e045c39b715a74fbe2c3f"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dfe/classopenphase_1_1Tools.html#ac027a3ad585e045c39b715a74fbe2c3f">getMisorientationCubic</a> (const <a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a> RotMatA, const <a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a> RotMatB, const <a class="el" href="../../d4/dbd/classopenphase_1_1Crystallography.html">Crystallography</a> &amp;<a class="el" href="../../d6/d0a/tinyxml2_8cpp.html#ad3136d2f1f34e592c66e09ba8a852812">CR</a>)</td></tr>
<tr class="memdesc:ac027a3ad585e045c39b715a74fbe2c3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates missorientation between two matrices considering cubic symmetry.  <br /></td></tr>
<tr class="separator:ac027a3ad585e045c39b715a74fbe2c3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a535b99b636157282edff658166c7d82d" id="r_a535b99b636157282edff658166c7d82d"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dfe/classopenphase_1_1Tools.html#a535b99b636157282edff658166c7d82d">getDisorientationCubic</a> (const <a class="el" href="../../d2/dda/classopenphase_1_1Quaternion.html">Quaternion</a> OrientationA, const <a class="el" href="../../d2/dda/classopenphase_1_1Quaternion.html">Quaternion</a> OrientationB)</td></tr>
<tr class="memdesc:a535b99b636157282edff658166c7d82d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates Disorientation between two quaternions considering cubic symmetry.  <br /></td></tr>
<tr class="separator:a535b99b636157282edff658166c7d82d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cd80e7273ca0fdd64bbbacefd9a3f6c" id="r_a0cd80e7273ca0fdd64bbbacefd9a3f6c"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../db/de4/classopenphase_1_1EulerAngles.html">EulerAngles</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dfe/classopenphase_1_1Tools.html#a0cd80e7273ca0fdd64bbbacefd9a3f6c">RotationToEuler</a> (const <a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a> &amp;Rot, const <a class="el" href="../../d0/d6c/namespaceopenphase.html#a631078f50f3da2bf1138bc0182054010">EulerConvention</a> locConvention)</td></tr>
<tr class="separator:a0cd80e7273ca0fdd64bbbacefd9a3f6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63240f7905b0aa979dcedd28c93d9896" id="r_a63240f7905b0aa979dcedd28c93d9896"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dfe/classopenphase_1_1Tools.html#a63240f7905b0aa979dcedd28c93d9896">MillerConversion</a> (const std::vector&lt; double &gt; &amp;hkil, <a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> hkl, bool PlaneNormal=true)</td></tr>
<tr class="memdesc:a63240f7905b0aa979dcedd28c93d9896"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hexagonal Miller plane Normal indices to Miller-Bravais // flase for directions &ndash;.  <br /></td></tr>
<tr class="separator:a63240f7905b0aa979dcedd28c93d9896"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f3966ce8eed56fba21607b3811dda00" id="r_a4f3966ce8eed56fba21607b3811dda00"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dfe/classopenphase_1_1Tools.html#a4f3966ce8eed56fba21607b3811dda00">SetRandomGrainOrientations</a> (<a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;<a class="el" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>, const int seed=0)</td></tr>
<tr class="memdesc:a4f3966ce8eed56fba21607b3811dda00"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets random grains orientations.  <br /></td></tr>
<tr class="separator:a4f3966ce8eed56fba21607b3811dda00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ce9b4d09fcb73e41ca3d4781b186e20" id="r_a2ce9b4d09fcb73e41ca3d4781b186e20"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dfe/classopenphase_1_1Tools.html#a2ce9b4d09fcb73e41ca3d4781b186e20">ExtractRotation</a> (<a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a> &amp;Mat, <a class="el" href="../../d2/dda/classopenphase_1_1Quaternion.html">Quaternion</a> &amp;Quat, const size_t maxIter=20)</td></tr>
<tr class="separator:a2ce9b4d09fcb73e41ca3d4781b186e20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15c9cac9ba24da74e9115aa11bbc3ea8" id="r_a15c9cac9ba24da74e9115aa11bbc3ea8"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dfe/classopenphase_1_1Tools.html#a15c9cac9ba24da74e9115aa11bbc3ea8">getMemoryUsageMB</a> ()</td></tr>
<tr class="memdesc:a15c9cac9ba24da74e9115aa11bbc3ea8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns memory used by the simulation (useful for memory leaks detection)  <br /></td></tr>
<tr class="separator:a15c9cac9ba24da74e9115aa11bbc3ea8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93a0b7772208d7b50d195dbe45fc816a" id="r_a93a0b7772208d7b50d195dbe45fc816a"><td class="memTemplParams" colspan="2">template&lt;typename vector &gt; </td></tr>
<tr class="memitem:a93a0b7772208d7b50d195dbe45fc816a"><td class="memTemplItemLeft" align="right" valign="top">static vector&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../df/dfe/classopenphase_1_1Tools.html#a93a0b7772208d7b50d195dbe45fc816a">Position</a> (const vector loc_pos, int OffsetX, int OffsetY, int OffsetZ)</td></tr>
<tr class="separator:a93a0b7772208d7b50d195dbe45fc816a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a398f24dcd5f292489423d3eceb3c6443" id="r_a398f24dcd5f292489423d3eceb3c6443"><td class="memTemplParams" colspan="2">template&lt;typename vector &gt; </td></tr>
<tr class="memitem:a398f24dcd5f292489423d3eceb3c6443"><td class="memTemplItemLeft" align="right" valign="top">static vector&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../df/dfe/classopenphase_1_1Tools.html#a398f24dcd5f292489423d3eceb3c6443">Distance</a> (const vector A, const vector B, int TotalNx, int TotalNy, int TotalNz, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="separator:a398f24dcd5f292489423d3eceb3c6443"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3497857e4ade828481f4b6990f7e6a88" id="r_a3497857e4ade828481f4b6990f7e6a88"><td class="memTemplParams" colspan="2">template&lt;typename vector &gt; </td></tr>
<tr class="memitem:a3497857e4ade828481f4b6990f7e6a88"><td class="memTemplItemLeft" align="right" valign="top">static void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../df/dfe/classopenphase_1_1Tools.html#a3497857e4ade828481f4b6990f7e6a88">MapIntoSimulationDomain</a> (vector &amp;A, int TotalNx, int TotalNy, int TotalNz, const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;BC)</td></tr>
<tr class="separator:a3497857e4ade828481f4b6990f7e6a88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaddb1d4e3844de19b4ec5ad2c91399b0" id="r_aaddb1d4e3844de19b4ec5ad2c91399b0"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:aaddb1d4e3844de19b4ec5ad2c91399b0"><td class="memTemplItemLeft" align="right" valign="top">static void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../df/dfe/classopenphase_1_1Tools.html#aaddb1d4e3844de19b4ec5ad2c91399b0">Smooth</a> (<a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; T, 0 &gt; &amp;Field, size_t SmoothIterations=1)</td></tr>
<tr class="separator:aaddb1d4e3844de19b4ec5ad2c91399b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="../../d2/d8f/Tools_8h_source.html#l00039">39</a> of file <a class="el" href="../../d2/d8f/Tools_8h_source.html">Tools.h</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a398f24dcd5f292489423d3eceb3c6443" name="a398f24dcd5f292489423d3eceb3c6443"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a398f24dcd5f292489423d3eceb3c6443">&#9670;&#160;</a></span>Distance()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename vector &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static vector openphase::Tools::Distance </td>
          <td>(</td>
          <td class="paramtype">const vector&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const vector&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>TotalNx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>TotalNy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>TotalNz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d8f/Tools_8h_source.html#l00074">74</a> of file <a class="el" href="../../d2/d8f/Tools_8h_source.html">Tools.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   75</span>    {</div>
<div class="line"><span class="lineno">   76</span>        vector dist = A-B;</div>
<div class="line"><span class="lineno">   77</span> </div>
<div class="line"><span class="lineno">   78</span>        <span class="keywordflow">if</span> (TotalNx &gt; 1)</div>
<div class="line"><span class="lineno">   79</span>        {</div>
<div class="line"><span class="lineno">   80</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno">   81</span>            <span class="keywordflow">if</span> (BC.MPIperiodicX or BC.BC0X == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>)</div>
<div class="line"><span class="lineno">   82</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">   83</span>            <span class="keywordflow">if</span> (BC.BC0X == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>)</div>
<div class="line"><span class="lineno">   84</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   85</span>            {</div>
<div class="line"><span class="lineno">   86</span>                <span class="keywordtype">double</span> val = dist[0] - TotalNx;</div>
<div class="line"><span class="lineno">   87</span>                <span class="keywordflow">if</span> (std::abs(val) &lt; std::abs(dist[0])) dist[0] = val;</div>
<div class="line"><span class="lineno">   88</span>            }</div>
<div class="line"><span class="lineno">   89</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno">   90</span>            <span class="keywordflow">if</span> (BC.MPIperiodicX or BC.BCNX == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>)</div>
<div class="line"><span class="lineno">   91</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">   92</span>            <span class="keywordflow">if</span> (BC.BCNX == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>)</div>
<div class="line"><span class="lineno">   93</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   94</span>            {</div>
<div class="line"><span class="lineno">   95</span>                <span class="keywordtype">double</span> val = dist[0] + TotalNx;</div>
<div class="line"><span class="lineno">   96</span>                <span class="keywordflow">if</span> (std::abs(val) &lt; std::abs(dist[0])) dist[0] = val;</div>
<div class="line"><span class="lineno">   97</span>            }</div>
<div class="line"><span class="lineno">   98</span>        }</div>
<div class="line"><span class="lineno">   99</span> </div>
<div class="line"><span class="lineno">  100</span>        <span class="keywordflow">if</span> (TotalNy &gt; 1)</div>
<div class="line"><span class="lineno">  101</span>        {</div>
<div class="line"><span class="lineno">  102</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno">  103</span>            <span class="keywordflow">if</span> (BC.MPIperiodicY or BC.BC0Y == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>)</div>
<div class="line"><span class="lineno">  104</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  105</span>            <span class="keywordflow">if</span> (BC.BC0Y == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>)</div>
<div class="line"><span class="lineno">  106</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  107</span>            {</div>
<div class="line"><span class="lineno">  108</span>                <span class="keywordtype">double</span> val = dist[1] - TotalNy;</div>
<div class="line"><span class="lineno">  109</span>                <span class="keywordflow">if</span> (std::abs(val) &lt; std::abs(dist[1])) dist[1] = val;</div>
<div class="line"><span class="lineno">  110</span>            }</div>
<div class="line"><span class="lineno">  111</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno">  112</span>            <span class="keywordflow">if</span> (BC.MPIperiodicY or BC.BCNY == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>)</div>
<div class="line"><span class="lineno">  113</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  114</span>            <span class="keywordflow">if</span> (BC.BCNY == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>)</div>
<div class="line"><span class="lineno">  115</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  116</span>            {</div>
<div class="line"><span class="lineno">  117</span>                <span class="keywordtype">double</span> val = dist[1] + TotalNy;</div>
<div class="line"><span class="lineno">  118</span>                <span class="keywordflow">if</span> (std::abs(val) &lt; std::abs(dist[1])) dist[1] = val;</div>
<div class="line"><span class="lineno">  119</span>            }</div>
<div class="line"><span class="lineno">  120</span>        }</div>
<div class="line"><span class="lineno">  121</span> </div>
<div class="line"><span class="lineno">  122</span>        <span class="keywordflow">if</span> (TotalNz &gt; 1)</div>
<div class="line"><span class="lineno">  123</span>        {</div>
<div class="line"><span class="lineno">  124</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno">  125</span>            <span class="keywordflow">if</span> (BC.MPIperiodicZ or BC.BC0Z == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>)</div>
<div class="line"><span class="lineno">  126</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  127</span>            <span class="keywordflow">if</span> (BC.BC0Z == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>)</div>
<div class="line"><span class="lineno">  128</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  129</span>            {</div>
<div class="line"><span class="lineno">  130</span>                <span class="keywordtype">double</span> val = dist[2] - TotalNz;</div>
<div class="line"><span class="lineno">  131</span>                <span class="keywordflow">if</span> (std::abs(val) &lt; std::abs(dist[2])) dist[2] = val;</div>
<div class="line"><span class="lineno">  132</span>            }</div>
<div class="line"><span class="lineno">  133</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno">  134</span>            <span class="keywordflow">if</span> (BC.MPIperiodicZ or BC.BCNZ == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>)</div>
<div class="line"><span class="lineno">  135</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  136</span>            <span class="keywordflow">if</span> (BC.BCNZ == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>)</div>
<div class="line"><span class="lineno">  137</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  138</span>            {</div>
<div class="line"><span class="lineno">  139</span>                <span class="keywordtype">double</span> val = dist[2] + TotalNz;</div>
<div class="line"><span class="lineno">  140</span>                <span class="keywordflow">if</span> (std::abs(val) &lt; std::abs(dist[2])) dist[2] = val;</div>
<div class="line"><span class="lineno">  141</span>            }</div>
<div class="line"><span class="lineno">  142</span>        }</div>
<div class="line"><span class="lineno">  143</span>        <span class="keywordflow">return</span> dist;</div>
<div class="line"><span class="lineno">  144</span>    }</div>
<div class="ttc" id="anamespaceopenphase_html_a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">openphase::BoundaryConditionTypes::Periodic</a></div><div class="ttdeci">@ Periodic</div><div class="ttdoc">Periodic boundary condition.</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a60a7d5469cdf77db0cec3552f2211936" name="a60a7d5469cdf77db0cec3552f2211936"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60a7d5469cdf77db0cec3552f2211936">&#9670;&#160;</a></span>eigenDecomposition()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::Tools::eigenDecomposition </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a> &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a> &amp;&#160;</td>
          <td class="paramname"><em>eigenVecs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> &amp;&#160;</td>
          <td class="paramname"><em>eigenVals</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d48/Tools_8cpp_source.html#l00355">355</a> of file <a class="el" href="../../dc/d48/Tools_8cpp_source.html">Tools.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  356</span>{</div>
<div class="line"><span class="lineno">  357</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> numJacobiIterations = 10;</div>
<div class="line"><span class="lineno">  358</span>    dMatrix3x3 D = A;</div>
<div class="line"><span class="lineno">  359</span>    EigenVectors.set_to_unity();</div>
<div class="line"><span class="lineno">  360</span>    <span class="keywordtype">int</span> iter = 0;</div>
<div class="line"><span class="lineno">  361</span>    <span class="keywordflow">while</span> (iter &lt; numJacobiIterations)</div>
<div class="line"><span class="lineno">  362</span>    {</div>
<div class="line"><span class="lineno">  363</span>        <span class="keywordtype">int</span> p, q;</div>
<div class="line"><span class="lineno">  364</span>        <span class="keywordtype">double</span> a, <a class="code hl_function" href="../../d1/d21/namespaceopenphase_1_1SystemOfLinearEquationsSolvers.html#a3c9fdec2355fde577142bf782e7c581c">max</a>;</div>
<div class="line"><span class="lineno">  365</span>        <a class="code hl_function" href="../../d1/d21/namespaceopenphase_1_1SystemOfLinearEquationsSolvers.html#a3c9fdec2355fde577142bf782e7c581c">max</a> = fabs(D(0, 1));</div>
<div class="line"><span class="lineno">  366</span>        p = 0;</div>
<div class="line"><span class="lineno">  367</span>        q = 1;</div>
<div class="line"><span class="lineno">  368</span>        a = fabs(D(0, 2));</div>
<div class="line"><span class="lineno">  369</span>        <span class="keywordflow">if</span> (a &gt; max)</div>
<div class="line"><span class="lineno">  370</span>        {</div>
<div class="line"><span class="lineno">  371</span>            p = 0;</div>
<div class="line"><span class="lineno">  372</span>            q = 2;</div>
<div class="line"><span class="lineno">  373</span>            <a class="code hl_function" href="../../d1/d21/namespaceopenphase_1_1SystemOfLinearEquationsSolvers.html#a3c9fdec2355fde577142bf782e7c581c">max</a> = a;</div>
<div class="line"><span class="lineno">  374</span>        }</div>
<div class="line"><span class="lineno">  375</span>        a = fabs(D(1, 2));</div>
<div class="line"><span class="lineno">  376</span>        <span class="keywordflow">if</span> (a &gt; max)</div>
<div class="line"><span class="lineno">  377</span>        {</div>
<div class="line"><span class="lineno">  378</span>            p = 1;</div>
<div class="line"><span class="lineno">  379</span>            q = 2;</div>
<div class="line"><span class="lineno">  380</span>            <a class="code hl_function" href="../../d1/d21/namespaceopenphase_1_1SystemOfLinearEquationsSolvers.html#a3c9fdec2355fde577142bf782e7c581c">max</a> = a;</div>
<div class="line"><span class="lineno">  381</span>        }</div>
<div class="line"><span class="lineno">  382</span>        <span class="keywordflow">if</span> (max &lt; DBL_EPSILON)</div>
<div class="line"><span class="lineno">  383</span>        {</div>
<div class="line"><span class="lineno">  384</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  385</span>        }</div>
<div class="line"><span class="lineno">  386</span>        <a class="code hl_function" href="../../df/dfe/classopenphase_1_1Tools.html#afa0e13f9de8e0bc1648eca5fdfafaed4">jacobiRotate</a>(D, EigenVectors, p, q);</div>
<div class="line"><span class="lineno">  387</span>        iter++;</div>
<div class="line"><span class="lineno">  388</span>    }</div>
<div class="line"><span class="lineno">  389</span>    EigenValues[0] = D(0, 0);</div>
<div class="line"><span class="lineno">  390</span>    EigenValues[1] = D(1, 1);</div>
<div class="line"><span class="lineno">  391</span>    EigenValues[2] = D(2, 2);</div>
<div class="line"><span class="lineno">  392</span>}</div>
<div class="ttc" id="aclassopenphase_1_1Tools_html_afa0e13f9de8e0bc1648eca5fdfafaed4"><div class="ttname"><a href="../../df/dfe/classopenphase_1_1Tools.html#afa0e13f9de8e0bc1648eca5fdfafaed4">openphase::Tools::jacobiRotate</a></div><div class="ttdeci">static void jacobiRotate(dMatrix3x3 &amp;A, dMatrix3x3 &amp;R, int p, int q)</div><div class="ttdoc">Implemented from https://dl.acm.org/doi/abs/10.1145/1028523.1028541.</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d48/Tools_8cpp_source.html#l00319">Tools.cpp:319</a></div></div>
<div class="ttc" id="anamespaceopenphase_1_1SystemOfLinearEquationsSolvers_html_a3c9fdec2355fde577142bf782e7c581c"><div class="ttname"><a href="../../d1/d21/namespaceopenphase_1_1SystemOfLinearEquationsSolvers.html#a3c9fdec2355fde577142bf782e7c581c">openphase::SystemOfLinearEquationsSolvers::max</a></div><div class="ttdeci">double OP_EXPORTS max(const Vector &amp;x)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d33/SystemOfLinearEquationsSolvers_8h_source.html#l00146">SystemOfLinearEquationsSolvers.h:146</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2ce9b4d09fcb73e41ca3d4781b186e20" name="a2ce9b4d09fcb73e41ca3d4781b186e20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ce9b4d09fcb73e41ca3d4781b186e20">&#9670;&#160;</a></span>ExtractRotation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::Tools::ExtractRotation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a> &amp;&#160;</td>
          <td class="paramname"><em>Mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/dda/classopenphase_1_1Quaternion.html">Quaternion</a> &amp;&#160;</td>
          <td class="paramname"><em>Quat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>maxIter</em> = <code>20</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d48/Tools_8cpp_source.html#l00843">843</a> of file <a class="el" href="../../dc/d48/Tools_8cpp_source.html">Tools.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  844</span>{</div>
<div class="line"><span class="lineno">  845</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iter = 0; iter &lt; maxIter; iter++)</div>
<div class="line"><span class="lineno">  846</span>    {</div>
<div class="line"><span class="lineno">  847</span>        dMatrix3x3 Rot = Quat.getRotationMatrix();</div>
<div class="line"><span class="lineno">  848</span> </div>
<div class="line"><span class="lineno">  849</span>        std::vector&lt;dVector3&gt; Rot_col = <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a92cbb947f85749fa18dc8398d82c7868">Col</a>(Rot);</div>
<div class="line"><span class="lineno">  850</span>        std::vector&lt;dVector3&gt; Mat_col = <a class="code hl_function" href="../../d0/d6c/namespaceopenphase.html#a92cbb947f85749fa18dc8398d82c7868">Col</a>(Mat);</div>
<div class="line"><span class="lineno">  851</span> </div>
<div class="line"><span class="lineno">  852</span>        <span class="keywordtype">double</span> b = 1.0 / fabs(Rot_col[0]*Mat_col[0] +</div>
<div class="line"><span class="lineno">  853</span>                              Rot_col[1]*Mat_col[1] +</div>
<div class="line"><span class="lineno">  854</span>                              Rot_col[2]*Mat_col[2]) + 1.0e-9;</div>
<div class="line"><span class="lineno">  855</span> </div>
<div class="line"><span class="lineno">  856</span>        dVector3 omega = (Rot_col[0].cross(Mat_col[0]) +</div>
<div class="line"><span class="lineno">  857</span>                          Rot_col[1].cross(Mat_col[1]) +</div>
<div class="line"><span class="lineno">  858</span>                          Rot_col[2].cross(Mat_col[2]))*b;</div>
<div class="line"><span class="lineno">  859</span> </div>
<div class="line"><span class="lineno">  860</span>        <span class="keywordtype">double</span> Angle = omega.length();</div>
<div class="line"><span class="lineno">  861</span> </div>
<div class="line"><span class="lineno">  862</span>        <span class="keywordflow">if</span> (Angle &lt; 1.0e-9) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  863</span> </div>
<div class="line"><span class="lineno">  864</span>        dVector3 Axis = omega * (1.0 / Angle);</div>
<div class="line"><span class="lineno">  865</span> </div>
<div class="line"><span class="lineno">  866</span>        Quaternion tempQuat;</div>
<div class="line"><span class="lineno">  867</span>        tempQuat.set(Axis, Angle);</div>
<div class="line"><span class="lineno">  868</span>        Quat = tempQuat*Quat;</div>
<div class="line"><span class="lineno">  869</span>        Quat.normalize();</div>
<div class="line"><span class="lineno">  870</span>    }</div>
<div class="line"><span class="lineno">  871</span>}</div>
<div class="ttc" id="anamespaceopenphase_html_a92cbb947f85749fa18dc8398d82c7868"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a92cbb947f85749fa18dc8398d82c7868">openphase::Col</a></div><div class="ttdeci">std::vector&lt; dVector3 &gt; Col(const dMatrix3x3 &amp;Mat)</div><div class="ttdef"><b>Definition</b> <a href="../../de/db6/MatrixVectorOperators_8h_source.html#l00239">MatrixVectorOperators.h:239</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4e705f80c82f77b5ebec80cdbd6d8dcb" name="a4e705f80c82f77b5ebec80cdbd6d8dcb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e705f80c82f77b5ebec80cdbd6d8dcb">&#9670;&#160;</a></span>findIndexPermutations()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="../../da/d9c/classopenphase_1_1iVector3.html">iVector3</a> &gt; openphase::Tools::findIndexPermutations </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d9c/classopenphase_1_1iVector3.html">iVector3</a> &amp;&#160;</td>
          <td class="paramname"><em>locIndices</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Finds all index permutations of locIndices. </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d48/Tools_8cpp_source.html#l00037">37</a> of file <a class="el" href="../../dc/d48/Tools_8cpp_source.html">Tools.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   38</span>{</div>
<div class="line"><span class="lineno">   39</span>    std::vector&lt;iVector3&gt; myReturn;</div>
<div class="line"><span class="lineno">   40</span>    <span class="comment">// dropping the signs</span></div>
<div class="line"><span class="lineno">   41</span>    <span class="keywordtype">int</span> x_val = std::abs(locIndices.get_x());</div>
<div class="line"><span class="lineno">   42</span>    <span class="keywordtype">int</span> y_val = std::abs(locIndices.get_y());</div>
<div class="line"><span class="lineno">   43</span>    <span class="keywordtype">int</span> z_val = std::abs(locIndices.get_z());</div>
<div class="line"><span class="lineno">   44</span> </div>
<div class="line"><span class="lineno">   45</span>    <span class="comment">// sorting indices</span></div>
<div class="line"><span class="lineno">   46</span>    <span class="keywordflow">if</span> (x_val &gt; y_val)</div>
<div class="line"><span class="lineno">   47</span>    {</div>
<div class="line"><span class="lineno">   48</span>        std::swap(x_val, y_val);</div>
<div class="line"><span class="lineno">   49</span>    }</div>
<div class="line"><span class="lineno">   50</span>    <span class="keywordflow">if</span> (y_val &gt; z_val)</div>
<div class="line"><span class="lineno">   51</span>    {</div>
<div class="line"><span class="lineno">   52</span>        std::swap(y_val, z_val);</div>
<div class="line"><span class="lineno">   53</span>    }</div>
<div class="line"><span class="lineno">   54</span>    <span class="keywordflow">if</span> (x_val &gt; y_val)</div>
<div class="line"><span class="lineno">   55</span>    {</div>
<div class="line"><span class="lineno">   56</span>        std::swap(x_val, y_val);</div>
<div class="line"><span class="lineno">   57</span>    }</div>
<div class="line"><span class="lineno">   58</span> </div>
<div class="line"><span class="lineno">   59</span>    <span class="comment">// generating permutations</span></div>
<div class="line"><span class="lineno">   60</span>    <span class="keywordflow">if</span>(x_val == 0)</div>
<div class="line"><span class="lineno">   61</span>    {</div>
<div class="line"><span class="lineno">   62</span>        <span class="keywordflow">if</span>(y_val == 0) <span class="comment">// x == 0; y == 0;</span></div>
<div class="line"><span class="lineno">   63</span>        {</div>
<div class="line"><span class="lineno">   64</span>            <span class="keywordflow">if</span>(z_val == 0) <span class="comment">// x == 0; y == 0; z == 0; (1)</span></div>
<div class="line"><span class="lineno">   65</span>            {</div>
<div class="line"><span class="lineno">   66</span>                myReturn.push_back({ 0, 0, 0});</div>
<div class="line"><span class="lineno">   67</span>            }</div>
<div class="line"><span class="lineno">   68</span>            <span class="keywordflow">else</span> <span class="comment">// x == 0; y == 0; z != 0; (6)</span></div>
<div class="line"><span class="lineno">   69</span>            {</div>
<div class="line"><span class="lineno">   70</span>                myReturn.push_back({     0,     0, z_val});</div>
<div class="line"><span class="lineno">   71</span>                myReturn.push_back({     0, z_val,     0});</div>
<div class="line"><span class="lineno">   72</span>                myReturn.push_back({ z_val,     0,     0});</div>
<div class="line"><span class="lineno">   73</span> </div>
<div class="line"><span class="lineno">   74</span>                myReturn.push_back({     0,     0,-z_val});</div>
<div class="line"><span class="lineno">   75</span>                myReturn.push_back({     0,-z_val,     0});</div>
<div class="line"><span class="lineno">   76</span>                myReturn.push_back({-z_val,     0,     0});</div>
<div class="line"><span class="lineno">   77</span>            }</div>
<div class="line"><span class="lineno">   78</span>        }</div>
<div class="line"><span class="lineno">   79</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(y_val == z_val) <span class="comment">// x == 0; y == z; (12)</span></div>
<div class="line"><span class="lineno">   80</span>        {</div>
<div class="line"><span class="lineno">   81</span>            myReturn.push_back({     0, y_val, y_val});</div>
<div class="line"><span class="lineno">   82</span>            myReturn.push_back({ y_val,     0, y_val});</div>
<div class="line"><span class="lineno">   83</span>            myReturn.push_back({ y_val, y_val,     0});</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>            myReturn.push_back({     0, y_val,-y_val});</div>
<div class="line"><span class="lineno">   86</span>            myReturn.push_back({ y_val,     0,-y_val});</div>
<div class="line"><span class="lineno">   87</span>            myReturn.push_back({ y_val,-y_val,     0});</div>
<div class="line"><span class="lineno">   88</span> </div>
<div class="line"><span class="lineno">   89</span>            myReturn.push_back({     0,-y_val, y_val});</div>
<div class="line"><span class="lineno">   90</span>            myReturn.push_back({-y_val,     0, y_val});</div>
<div class="line"><span class="lineno">   91</span>            myReturn.push_back({-y_val, y_val,     0});</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>            myReturn.push_back({     0,-y_val,-y_val});</div>
<div class="line"><span class="lineno">   94</span>            myReturn.push_back({-y_val,     0,-y_val});</div>
<div class="line"><span class="lineno">   95</span>            myReturn.push_back({-y_val,-y_val,     0});</div>
<div class="line"><span class="lineno">   96</span>        }</div>
<div class="line"><span class="lineno">   97</span>        <span class="keywordflow">else</span> <span class="comment">// x == 0; y != z; (24)</span></div>
<div class="line"><span class="lineno">   98</span>        {</div>
<div class="line"><span class="lineno">   99</span>            myReturn.push_back({     0, y_val, z_val});</div>
<div class="line"><span class="lineno">  100</span>            myReturn.push_back({ y_val,     0, z_val});</div>
<div class="line"><span class="lineno">  101</span>            myReturn.push_back({ y_val, z_val,     0});</div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span>            myReturn.push_back({     0, y_val,-z_val});</div>
<div class="line"><span class="lineno">  104</span>            myReturn.push_back({ y_val,     0,-z_val});</div>
<div class="line"><span class="lineno">  105</span>            myReturn.push_back({ y_val,-z_val,     0});</div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span>            myReturn.push_back({     0,-y_val, z_val});</div>
<div class="line"><span class="lineno">  108</span>            myReturn.push_back({-y_val,     0, z_val});</div>
<div class="line"><span class="lineno">  109</span>            myReturn.push_back({-y_val, z_val,     0});</div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>            myReturn.push_back({     0,-y_val,-z_val});</div>
<div class="line"><span class="lineno">  112</span>            myReturn.push_back({-y_val,     0,-z_val});</div>
<div class="line"><span class="lineno">  113</span>            myReturn.push_back({-y_val,-z_val,     0});</div>
<div class="line"><span class="lineno">  114</span> </div>
<div class="line"><span class="lineno">  115</span>            myReturn.push_back({     0, z_val, y_val});</div>
<div class="line"><span class="lineno">  116</span>            myReturn.push_back({ z_val,     0, y_val});</div>
<div class="line"><span class="lineno">  117</span>            myReturn.push_back({ z_val, y_val,     0});</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span>            myReturn.push_back({     0, z_val,-y_val});</div>
<div class="line"><span class="lineno">  120</span>            myReturn.push_back({ z_val,     0,-y_val});</div>
<div class="line"><span class="lineno">  121</span>            myReturn.push_back({ z_val,-y_val,     0});</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span>            myReturn.push_back({     0,-z_val, y_val});</div>
<div class="line"><span class="lineno">  124</span>            myReturn.push_back({-z_val,     0, y_val});</div>
<div class="line"><span class="lineno">  125</span>            myReturn.push_back({-z_val, y_val,     0});</div>
<div class="line"><span class="lineno">  126</span> </div>
<div class="line"><span class="lineno">  127</span>            myReturn.push_back({     0,-z_val,-y_val});</div>
<div class="line"><span class="lineno">  128</span>            myReturn.push_back({-z_val,     0,-y_val});</div>
<div class="line"><span class="lineno">  129</span>            myReturn.push_back({-z_val,-y_val,     0});</div>
<div class="line"><span class="lineno">  130</span>        }</div>
<div class="line"><span class="lineno">  131</span>    }</div>
<div class="line"><span class="lineno">  132</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (x_val == y_val and y_val == z_val) <span class="comment">// x == y == z; (8)</span></div>
<div class="line"><span class="lineno">  133</span>    {</div>
<div class="line"><span class="lineno">  134</span>        myReturn.push_back({ x_val, x_val, x_val});</div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span>        myReturn.push_back({ x_val, x_val,-x_val});</div>
<div class="line"><span class="lineno">  137</span>        myReturn.push_back({ x_val,-x_val, x_val});</div>
<div class="line"><span class="lineno">  138</span>        myReturn.push_back({-x_val, x_val, x_val});</div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span>        myReturn.push_back({ x_val,-x_val,-x_val});</div>
<div class="line"><span class="lineno">  141</span>        myReturn.push_back({-x_val, x_val,-x_val});</div>
<div class="line"><span class="lineno">  142</span>        myReturn.push_back({-x_val,-x_val, x_val});</div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>        myReturn.push_back({-x_val,-x_val,-x_val});</div>
<div class="line"><span class="lineno">  145</span>    }</div>
<div class="line"><span class="lineno">  146</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (x_val == y_val) <span class="comment">// x == y != z; (24)</span></div>
<div class="line"><span class="lineno">  147</span>    {</div>
<div class="line"><span class="lineno">  148</span>        myReturn.push_back({ x_val, x_val, z_val});</div>
<div class="line"><span class="lineno">  149</span>        myReturn.push_back({ x_val, z_val, x_val});</div>
<div class="line"><span class="lineno">  150</span>        myReturn.push_back({ z_val, x_val, x_val});</div>
<div class="line"><span class="lineno">  151</span> </div>
<div class="line"><span class="lineno">  152</span>        myReturn.push_back({ x_val, x_val,-z_val});</div>
<div class="line"><span class="lineno">  153</span>        myReturn.push_back({ x_val,-z_val, x_val});</div>
<div class="line"><span class="lineno">  154</span>        myReturn.push_back({-z_val, x_val, x_val});</div>
<div class="line"><span class="lineno">  155</span> </div>
<div class="line"><span class="lineno">  156</span>        myReturn.push_back({-x_val, x_val, z_val});</div>
<div class="line"><span class="lineno">  157</span>        myReturn.push_back({-x_val, z_val, x_val});</div>
<div class="line"><span class="lineno">  158</span>        myReturn.push_back({ z_val,-x_val, x_val});</div>
<div class="line"><span class="lineno">  159</span> </div>
<div class="line"><span class="lineno">  160</span>        myReturn.push_back({-x_val, x_val,-z_val});</div>
<div class="line"><span class="lineno">  161</span>        myReturn.push_back({-x_val,-z_val, x_val});</div>
<div class="line"><span class="lineno">  162</span>        myReturn.push_back({-z_val,-x_val, x_val});</div>
<div class="line"><span class="lineno">  163</span> </div>
<div class="line"><span class="lineno">  164</span>        myReturn.push_back({ x_val,-x_val, z_val});</div>
<div class="line"><span class="lineno">  165</span>        myReturn.push_back({ x_val, z_val,-x_val});</div>
<div class="line"><span class="lineno">  166</span>        myReturn.push_back({ z_val, x_val,-x_val});</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>        myReturn.push_back({ x_val,-x_val,-z_val});</div>
<div class="line"><span class="lineno">  169</span>        myReturn.push_back({ x_val,-z_val,-x_val});</div>
<div class="line"><span class="lineno">  170</span>        myReturn.push_back({-z_val, x_val,-x_val});</div>
<div class="line"><span class="lineno">  171</span> </div>
<div class="line"><span class="lineno">  172</span>        myReturn.push_back({-x_val,-x_val, z_val});</div>
<div class="line"><span class="lineno">  173</span>        myReturn.push_back({-x_val, z_val,-x_val});</div>
<div class="line"><span class="lineno">  174</span>        myReturn.push_back({ z_val,-x_val,-x_val});</div>
<div class="line"><span class="lineno">  175</span> </div>
<div class="line"><span class="lineno">  176</span>        myReturn.push_back({-x_val,-x_val,-z_val});</div>
<div class="line"><span class="lineno">  177</span>        myReturn.push_back({-x_val,-z_val,-x_val});</div>
<div class="line"><span class="lineno">  178</span>        myReturn.push_back({-z_val,-x_val,-x_val});</div>
<div class="line"><span class="lineno">  179</span>    }</div>
<div class="line"><span class="lineno">  180</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (y_val == z_val) <span class="comment">// x != y == z; (24)</span></div>
<div class="line"><span class="lineno">  181</span>    {</div>
<div class="line"><span class="lineno">  182</span>        myReturn.push_back({ x_val, y_val, y_val});</div>
<div class="line"><span class="lineno">  183</span>        myReturn.push_back({ y_val, x_val, y_val});</div>
<div class="line"><span class="lineno">  184</span>        myReturn.push_back({ y_val, y_val, x_val});</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>        myReturn.push_back({ x_val, y_val,-y_val});</div>
<div class="line"><span class="lineno">  187</span>        myReturn.push_back({ y_val, x_val,-y_val});</div>
<div class="line"><span class="lineno">  188</span>        myReturn.push_back({ y_val,-y_val, x_val});</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>        myReturn.push_back({ x_val,-y_val, y_val});</div>
<div class="line"><span class="lineno">  191</span>        myReturn.push_back({-y_val, x_val, y_val});</div>
<div class="line"><span class="lineno">  192</span>        myReturn.push_back({-y_val, y_val, x_val});</div>
<div class="line"><span class="lineno">  193</span> </div>
<div class="line"><span class="lineno">  194</span>        myReturn.push_back({ x_val,-y_val,-y_val});</div>
<div class="line"><span class="lineno">  195</span>        myReturn.push_back({-y_val, x_val,-y_val});</div>
<div class="line"><span class="lineno">  196</span>        myReturn.push_back({-y_val,-y_val, x_val});</div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span>        myReturn.push_back({-x_val, y_val, y_val});</div>
<div class="line"><span class="lineno">  199</span>        myReturn.push_back({ y_val,-x_val, y_val});</div>
<div class="line"><span class="lineno">  200</span>        myReturn.push_back({ y_val, y_val,-x_val});</div>
<div class="line"><span class="lineno">  201</span> </div>
<div class="line"><span class="lineno">  202</span>        myReturn.push_back({-x_val, y_val,-y_val});</div>
<div class="line"><span class="lineno">  203</span>        myReturn.push_back({ y_val,-x_val,-y_val});</div>
<div class="line"><span class="lineno">  204</span>        myReturn.push_back({ y_val,-y_val,-x_val});</div>
<div class="line"><span class="lineno">  205</span> </div>
<div class="line"><span class="lineno">  206</span>        myReturn.push_back({-x_val,-y_val, y_val});</div>
<div class="line"><span class="lineno">  207</span>        myReturn.push_back({-y_val,-x_val, y_val});</div>
<div class="line"><span class="lineno">  208</span>        myReturn.push_back({-y_val, y_val,-x_val});</div>
<div class="line"><span class="lineno">  209</span> </div>
<div class="line"><span class="lineno">  210</span>        myReturn.push_back({-x_val,-y_val,-y_val});</div>
<div class="line"><span class="lineno">  211</span>        myReturn.push_back({-y_val,-x_val,-y_val});</div>
<div class="line"><span class="lineno">  212</span>        myReturn.push_back({-y_val,-y_val,-x_val});</div>
<div class="line"><span class="lineno">  213</span>    }</div>
<div class="line"><span class="lineno">  214</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (x_val == z_val) <span class="comment">// x == z; x != y; (24)</span></div>
<div class="line"><span class="lineno">  215</span>    {</div>
<div class="line"><span class="lineno">  216</span>        myReturn.push_back({ x_val, y_val, x_val});</div>
<div class="line"><span class="lineno">  217</span>        myReturn.push_back({ y_val, x_val, x_val});</div>
<div class="line"><span class="lineno">  218</span>        myReturn.push_back({ x_val, x_val, y_val});</div>
<div class="line"><span class="lineno">  219</span> </div>
<div class="line"><span class="lineno">  220</span>        myReturn.push_back({ x_val, y_val,-x_val});</div>
<div class="line"><span class="lineno">  221</span>        myReturn.push_back({ y_val,-x_val, x_val});</div>
<div class="line"><span class="lineno">  222</span>        myReturn.push_back({-x_val, x_val, y_val});</div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span>        myReturn.push_back({-x_val, y_val, x_val});</div>
<div class="line"><span class="lineno">  225</span>        myReturn.push_back({-y_val, x_val, x_val});</div>
<div class="line"><span class="lineno">  226</span>        myReturn.push_back({ x_val,-x_val, y_val});</div>
<div class="line"><span class="lineno">  227</span> </div>
<div class="line"><span class="lineno">  228</span>        myReturn.push_back({-x_val, y_val,-x_val});</div>
<div class="line"><span class="lineno">  229</span>        myReturn.push_back({-y_val,-x_val, x_val});</div>
<div class="line"><span class="lineno">  230</span>        myReturn.push_back({-x_val,-x_val, y_val});</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>        myReturn.push_back({ x_val,-y_val, x_val});</div>
<div class="line"><span class="lineno">  233</span>        myReturn.push_back({ y_val, x_val,-x_val});</div>
<div class="line"><span class="lineno">  234</span>        myReturn.push_back({ x_val, x_val,-y_val});</div>
<div class="line"><span class="lineno">  235</span> </div>
<div class="line"><span class="lineno">  236</span>        myReturn.push_back({ x_val,-y_val,-x_val});</div>
<div class="line"><span class="lineno">  237</span>        myReturn.push_back({ y_val,-x_val,-x_val});</div>
<div class="line"><span class="lineno">  238</span>        myReturn.push_back({-x_val, x_val,-y_val});</div>
<div class="line"><span class="lineno">  239</span> </div>
<div class="line"><span class="lineno">  240</span>        myReturn.push_back({-x_val,-y_val, x_val});</div>
<div class="line"><span class="lineno">  241</span>        myReturn.push_back({-y_val, x_val,-x_val});</div>
<div class="line"><span class="lineno">  242</span>        myReturn.push_back({ x_val,-x_val,-y_val});</div>
<div class="line"><span class="lineno">  243</span> </div>
<div class="line"><span class="lineno">  244</span>        myReturn.push_back({-x_val,-y_val,-x_val});</div>
<div class="line"><span class="lineno">  245</span>        myReturn.push_back({-y_val,-x_val,-x_val});</div>
<div class="line"><span class="lineno">  246</span>        myReturn.push_back({-x_val,-x_val,-y_val});</div>
<div class="line"><span class="lineno">  247</span>    }</div>
<div class="line"><span class="lineno">  248</span>    <span class="keywordflow">else</span> <span class="comment">// x != y != z != x; (48)</span></div>
<div class="line"><span class="lineno">  249</span>    {</div>
<div class="line"><span class="lineno">  250</span>        myReturn.push_back({ x_val, y_val, z_val});</div>
<div class="line"><span class="lineno">  251</span>        myReturn.push_back({ y_val, x_val, z_val});</div>
<div class="line"><span class="lineno">  252</span>        myReturn.push_back({ y_val, z_val, x_val});</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>        myReturn.push_back({ x_val, y_val,-z_val});</div>
<div class="line"><span class="lineno">  255</span>        myReturn.push_back({ y_val, x_val,-z_val});</div>
<div class="line"><span class="lineno">  256</span>        myReturn.push_back({ y_val,-z_val, x_val});</div>
<div class="line"><span class="lineno">  257</span> </div>
<div class="line"><span class="lineno">  258</span>        myReturn.push_back({ x_val,-y_val, z_val});</div>
<div class="line"><span class="lineno">  259</span>        myReturn.push_back({-y_val, x_val, z_val});</div>
<div class="line"><span class="lineno">  260</span>        myReturn.push_back({-y_val, z_val, x_val});</div>
<div class="line"><span class="lineno">  261</span> </div>
<div class="line"><span class="lineno">  262</span>        myReturn.push_back({ x_val,-y_val,-z_val});</div>
<div class="line"><span class="lineno">  263</span>        myReturn.push_back({-y_val, x_val,-z_val});</div>
<div class="line"><span class="lineno">  264</span>        myReturn.push_back({-y_val,-z_val, x_val});</div>
<div class="line"><span class="lineno">  265</span> </div>
<div class="line"><span class="lineno">  266</span>        myReturn.push_back({ x_val, z_val, y_val});</div>
<div class="line"><span class="lineno">  267</span>        myReturn.push_back({ z_val, x_val, y_val});</div>
<div class="line"><span class="lineno">  268</span>        myReturn.push_back({ z_val, y_val, x_val});</div>
<div class="line"><span class="lineno">  269</span> </div>
<div class="line"><span class="lineno">  270</span>        myReturn.push_back({ x_val, z_val,-y_val});</div>
<div class="line"><span class="lineno">  271</span>        myReturn.push_back({ z_val, x_val,-y_val});</div>
<div class="line"><span class="lineno">  272</span>        myReturn.push_back({ z_val,-y_val, x_val});</div>
<div class="line"><span class="lineno">  273</span> </div>
<div class="line"><span class="lineno">  274</span>        myReturn.push_back({ x_val,-z_val, y_val});</div>
<div class="line"><span class="lineno">  275</span>        myReturn.push_back({-z_val, x_val, y_val});</div>
<div class="line"><span class="lineno">  276</span>        myReturn.push_back({-z_val, y_val, x_val});</div>
<div class="line"><span class="lineno">  277</span> </div>
<div class="line"><span class="lineno">  278</span>        myReturn.push_back({ x_val,-z_val,-y_val});</div>
<div class="line"><span class="lineno">  279</span>        myReturn.push_back({-z_val, x_val,-y_val});</div>
<div class="line"><span class="lineno">  280</span>        myReturn.push_back({-z_val,-y_val, x_val});</div>
<div class="line"><span class="lineno">  281</span> </div>
<div class="line"><span class="lineno">  282</span>        myReturn.push_back({-x_val, y_val, z_val});</div>
<div class="line"><span class="lineno">  283</span>        myReturn.push_back({ y_val,-x_val, z_val});</div>
<div class="line"><span class="lineno">  284</span>        myReturn.push_back({ y_val, z_val,-x_val});</div>
<div class="line"><span class="lineno">  285</span> </div>
<div class="line"><span class="lineno">  286</span>        myReturn.push_back({-x_val, y_val,-z_val});</div>
<div class="line"><span class="lineno">  287</span>        myReturn.push_back({ y_val,-x_val,-z_val});</div>
<div class="line"><span class="lineno">  288</span>        myReturn.push_back({ y_val,-z_val,-x_val});</div>
<div class="line"><span class="lineno">  289</span> </div>
<div class="line"><span class="lineno">  290</span>        myReturn.push_back({-x_val,-y_val, z_val});</div>
<div class="line"><span class="lineno">  291</span>        myReturn.push_back({-y_val,-x_val, z_val});</div>
<div class="line"><span class="lineno">  292</span>        myReturn.push_back({-y_val, z_val,-x_val});</div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>        myReturn.push_back({-x_val,-y_val,-z_val});</div>
<div class="line"><span class="lineno">  295</span>        myReturn.push_back({-y_val,-x_val,-z_val});</div>
<div class="line"><span class="lineno">  296</span>        myReturn.push_back({-y_val,-z_val,-x_val});</div>
<div class="line"><span class="lineno">  297</span> </div>
<div class="line"><span class="lineno">  298</span>        myReturn.push_back({-x_val, z_val, y_val});</div>
<div class="line"><span class="lineno">  299</span>        myReturn.push_back({ z_val,-x_val, y_val});</div>
<div class="line"><span class="lineno">  300</span>        myReturn.push_back({ z_val, y_val,-x_val});</div>
<div class="line"><span class="lineno">  301</span> </div>
<div class="line"><span class="lineno">  302</span>        myReturn.push_back({-x_val, z_val,-y_val});</div>
<div class="line"><span class="lineno">  303</span>        myReturn.push_back({ z_val,-x_val,-y_val});</div>
<div class="line"><span class="lineno">  304</span>        myReturn.push_back({ z_val,-y_val,-x_val});</div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span>        myReturn.push_back({-x_val,-z_val, y_val});</div>
<div class="line"><span class="lineno">  307</span>        myReturn.push_back({-z_val,-x_val, y_val});</div>
<div class="line"><span class="lineno">  308</span>        myReturn.push_back({-z_val, y_val,-x_val});</div>
<div class="line"><span class="lineno">  309</span> </div>
<div class="line"><span class="lineno">  310</span>        myReturn.push_back({-x_val,-z_val,-y_val});</div>
<div class="line"><span class="lineno">  311</span>        myReturn.push_back({-z_val,-x_val,-y_val});</div>
<div class="line"><span class="lineno">  312</span>        myReturn.push_back({-z_val,-y_val,-x_val});</div>
<div class="line"><span class="lineno">  313</span>    }</div>
<div class="line"><span class="lineno">  314</span>    <span class="keywordflow">return</span> myReturn;</div>
<div class="line"><span class="lineno">  315</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a38134452ff33e20f92082d45081e9d5f" name="a38134452ff33e20f92082d45081e9d5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38134452ff33e20f92082d45081e9d5f">&#9670;&#160;</a></span>getAxisAngle()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::Tools::getAxisAngle </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a> &amp;&#160;</td>
          <td class="paramname"><em>TransformationMatrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> &amp;&#160;</td>
          <td class="paramname"><em>Axis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>Angle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d48/Tools_8cpp_source.html#l00592">592</a> of file <a class="el" href="../../dc/d48/Tools_8cpp_source.html">Tools.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  593</span>{</div>
<div class="line"><span class="lineno">  594</span>    dMatrix3x3 RotationMatrix;</div>
<div class="line"><span class="lineno">  595</span>    <a class="code hl_function" href="../../df/dfe/classopenphase_1_1Tools.html#a6ebd6ae82f8a9dabfd5a1f5879b01845">rotationMatrixIrving</a>(TransformationMatrix,RotationMatrix);</div>
<div class="line"><span class="lineno">  596</span>    <a class="code hl_function" href="../../df/dfe/classopenphase_1_1Tools.html#ad6e64e29384f0f87ba6725561038568f">GetAxisAngleFromRotationMatrix</a>(RotationMatrix,Angle,Axis);</div>
<div class="line"><span class="lineno">  597</span>}</div>
<div class="ttc" id="aclassopenphase_1_1Tools_html_a6ebd6ae82f8a9dabfd5a1f5879b01845"><div class="ttname"><a href="../../df/dfe/classopenphase_1_1Tools.html#a6ebd6ae82f8a9dabfd5a1f5879b01845">openphase::Tools::rotationMatrixIrving</a></div><div class="ttdeci">static void rotationMatrixIrving(const dMatrix3x3 &amp;A, dMatrix3x3 &amp;R)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d48/Tools_8cpp_source.html#l00393">Tools.cpp:393</a></div></div>
<div class="ttc" id="aclassopenphase_1_1Tools_html_ad6e64e29384f0f87ba6725561038568f"><div class="ttname"><a href="../../df/dfe/classopenphase_1_1Tools.html#ad6e64e29384f0f87ba6725561038568f">openphase::Tools::GetAxisAngleFromRotationMatrix</a></div><div class="ttdeci">static void GetAxisAngleFromRotationMatrix(const dMatrix3x3 RotMatrix, double &amp;Angle, dVector3 &amp;Axis)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d48/Tools_8cpp_source.html#l00506">Tools.cpp:506</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad6e64e29384f0f87ba6725561038568f" name="ad6e64e29384f0f87ba6725561038568f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6e64e29384f0f87ba6725561038568f">&#9670;&#160;</a></span>GetAxisAngleFromRotationMatrix()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::Tools::GetAxisAngleFromRotationMatrix </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a>&#160;</td>
          <td class="paramname"><em>RotMatrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>Angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> &amp;&#160;</td>
          <td class="paramname"><em>Axis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Implemented from <a href="https://www.euclideanspace.com/maths/geometry/rotations/index.htm">https://www.euclideanspace.com/maths/geometry/rotations/index.htm</a></p>

<p class="definition">Definition at line <a class="el" href="../../dc/d48/Tools_8cpp_source.html#l00506">506</a> of file <a class="el" href="../../dc/d48/Tools_8cpp_source.html">Tools.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  507</span>{</div>
<div class="line"><span class="lineno">  509</span>    <span class="keywordtype">double</span> epsilon = 0.01; <span class="comment">// margin to allow for rounding errors</span></div>
<div class="line"><span class="lineno">  510</span>    <span class="keywordtype">double</span> epsilon2 = 0.1; <span class="comment">// margin to distinguish between 0 and 180 degrees</span></div>
<div class="line"><span class="lineno">  511</span>    <span class="keywordflow">if</span> ((fabs(RotMatrix(0,1)-RotMatrix(1,0)) &lt; epsilon)</div>
<div class="line"><span class="lineno">  512</span>     &amp;&amp; (fabs(RotMatrix(0,2)-RotMatrix(2,0)) &lt; epsilon)</div>
<div class="line"><span class="lineno">  513</span>     &amp;&amp; (fabs(RotMatrix(1,2)-RotMatrix(2,1)) &lt; epsilon))</div>
<div class="line"><span class="lineno">  514</span>    {</div>
<div class="line"><span class="lineno">  515</span>        <span class="comment">// singularity found</span></div>
<div class="line"><span class="lineno">  516</span>        <span class="comment">// first check for identity matrix which must have +1 for all terms</span></div>
<div class="line"><span class="lineno">  517</span>        <span class="comment">// in leading diagonal and zero in other terms</span></div>
<div class="line"><span class="lineno">  518</span>        <span class="keywordflow">if</span> ((fabs(RotMatrix(0,1)+RotMatrix(1,0)) &lt; epsilon2)</div>
<div class="line"><span class="lineno">  519</span>         &amp;&amp; (fabs(RotMatrix(0,2)+RotMatrix(2,0)) &lt; epsilon2)</div>
<div class="line"><span class="lineno">  520</span>         &amp;&amp; (fabs(RotMatrix(1,2)+RotMatrix(2,1)) &lt; epsilon2)</div>
<div class="line"><span class="lineno">  521</span>         &amp;&amp; (fabs(RotMatrix(0,0)+RotMatrix(1,1)+RotMatrix(2,2)-3.0) &lt; epsilon2))</div>
<div class="line"><span class="lineno">  522</span>        {</div>
<div class="line"><span class="lineno">  523</span>            <span class="comment">// this singularity is identity matrix so angle = 0</span></div>
<div class="line"><span class="lineno">  524</span>            Angle = 0.0;</div>
<div class="line"><span class="lineno">  525</span>            Axis = {1,0,0};</div>
<div class="line"><span class="lineno">  526</span>            <span class="comment">// zero angle, arbitrary axis</span></div>
<div class="line"><span class="lineno">  527</span>        }</div>
<div class="line"><span class="lineno">  528</span>        <span class="comment">// otherwise this singularity is angle = 180</span></div>
<div class="line"><span class="lineno">  529</span>        Angle = <a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>;</div>
<div class="line"><span class="lineno">  530</span>        <span class="keywordtype">double</span> xx = (RotMatrix(0,0)+1)/2;</div>
<div class="line"><span class="lineno">  531</span>        <span class="keywordtype">double</span> yy = (RotMatrix(1,1)+1)/2;</div>
<div class="line"><span class="lineno">  532</span>        <span class="keywordtype">double</span> zz = (RotMatrix(2,2)+1)/2;</div>
<div class="line"><span class="lineno">  533</span>        <span class="keywordtype">double</span> xy = (RotMatrix(0,1)+RotMatrix(1,0))/4;</div>
<div class="line"><span class="lineno">  534</span>        <span class="keywordtype">double</span> xz = (RotMatrix(0,2)+RotMatrix(2,0))/4;</div>
<div class="line"><span class="lineno">  535</span>        <span class="keywordtype">double</span> yz = (RotMatrix(1,2)+RotMatrix(2,1))/4;</div>
<div class="line"><span class="lineno">  536</span>        <span class="keywordflow">if</span> ((xx &gt; yy) &amp;&amp; (xx &gt; zz))</div>
<div class="line"><span class="lineno">  537</span>        {</div>
<div class="line"><span class="lineno">  538</span>            <span class="comment">// RotMatrix(0,0) is the largest diagonal term</span></div>
<div class="line"><span class="lineno">  539</span>            <span class="keywordflow">if</span> (xx&lt; epsilon)</div>
<div class="line"><span class="lineno">  540</span>            {</div>
<div class="line"><span class="lineno">  541</span>                Axis = {0,0.7071,0.7071};</div>
<div class="line"><span class="lineno">  542</span>            }</div>
<div class="line"><span class="lineno">  543</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  544</span>            {</div>
<div class="line"><span class="lineno">  545</span>                <span class="keywordtype">double</span> x = sqrt(xx);</div>
<div class="line"><span class="lineno">  546</span>                Axis = {x,xy/x,xz/x};</div>
<div class="line"><span class="lineno">  547</span>            }</div>
<div class="line"><span class="lineno">  548</span>        }</div>
<div class="line"><span class="lineno">  549</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(yy &gt; zz)</div>
<div class="line"><span class="lineno">  550</span>        {</div>
<div class="line"><span class="lineno">  551</span>            <span class="comment">// m[1][1] is the largest diagonal term</span></div>
<div class="line"><span class="lineno">  552</span>            <span class="keywordflow">if</span> (yy&lt; epsilon)</div>
<div class="line"><span class="lineno">  553</span>            {</div>
<div class="line"><span class="lineno">  554</span>                Axis = {0.7071,0,0.7071};</div>
<div class="line"><span class="lineno">  555</span>            }</div>
<div class="line"><span class="lineno">  556</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  557</span>            {</div>
<div class="line"><span class="lineno">  558</span>                <span class="keywordtype">double</span> y = sqrt(yy);</div>
<div class="line"><span class="lineno">  559</span>                Axis = {xy/y,y,yz/y};</div>
<div class="line"><span class="lineno">  560</span>            }</div>
<div class="line"><span class="lineno">  561</span>        }</div>
<div class="line"><span class="lineno">  562</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  563</span>        {</div>
<div class="line"><span class="lineno">  564</span>            <span class="comment">// m[2][2] is the largest diagonal term so base result on this</span></div>
<div class="line"><span class="lineno">  565</span>            <span class="keywordflow">if</span> (zz&lt; epsilon)</div>
<div class="line"><span class="lineno">  566</span>            {</div>
<div class="line"><span class="lineno">  567</span>                Axis = {0.7071,0.7071,0};</div>
<div class="line"><span class="lineno">  568</span>            }</div>
<div class="line"><span class="lineno">  569</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  570</span>            {</div>
<div class="line"><span class="lineno">  571</span>                <span class="keywordtype">double</span> z = sqrt(zz);</div>
<div class="line"><span class="lineno">  572</span>                Axis = {xz/z,yz/z,z};</div>
<div class="line"><span class="lineno">  573</span>            }</div>
<div class="line"><span class="lineno">  574</span>        }</div>
<div class="line"><span class="lineno">  575</span>    }</div>
<div class="line"><span class="lineno">  576</span>    <span class="comment">// as we have reached here there are no singularities so we can handle normally</span></div>
<div class="line"><span class="lineno">  577</span>    <span class="comment">// First, normalise the rotation matrix</span></div>
<div class="line"><span class="lineno">  578</span>    <span class="keywordtype">double</span> Norm = pow((RotMatrix(1,2) - RotMatrix(2,1)),2) + pow((RotMatrix(2,0) - RotMatrix(0,2)),2) + pow((RotMatrix(0,1) - RotMatrix(1,0)),2);</div>
<div class="line"><span class="lineno">  579</span>    Norm =  sqrt(Norm);</div>
<div class="line"><span class="lineno">  580</span> </div>
<div class="line"><span class="lineno">  581</span>    <span class="keywordflow">if</span> (fabs(Norm) &lt; 0.001)</div>
<div class="line"><span class="lineno">  582</span>    {</div>
<div class="line"><span class="lineno">  583</span>        Norm = 1.0;</div>
<div class="line"><span class="lineno">  584</span>        <span class="comment">// prevent divide by zero, should not happen if matrix is orthogonal and should be</span></div>
<div class="line"><span class="lineno">  585</span>        <span class="comment">// caught by singularity test above, but I&#39;ve left it in just in case</span></div>
<div class="line"><span class="lineno">  586</span>    }</div>
<div class="line"><span class="lineno">  587</span>    Angle = acos(0.5*(RotMatrix.trace() - 1));</div>
<div class="line"><span class="lineno">  588</span>    Axis[0] = ( RotMatrix(2,1) - RotMatrix(1,2) ) / Norm;</div>
<div class="line"><span class="lineno">  589</span>    Axis[1] = ( RotMatrix(0,2) - RotMatrix(2,0) ) / Norm;</div>
<div class="line"><span class="lineno">  590</span>    Axis[2] = ( RotMatrix(1,0) - RotMatrix(0,1) ) / Norm;</div>
<div class="line"><span class="lineno">  591</span>}</div>
<div class="ttc" id="anamespaceopenphase_html_a2c26ef9422df111d9487d3d34cf3d613"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">openphase::Pi</a></div><div class="ttdeci">static constexpr double Pi</div><div class="ttdoc">Pi constant value.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/df1/Globals_8h_source.html#l00124">Globals.h:124</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a535b99b636157282edff658166c7d82d" name="a535b99b636157282edff658166c7d82d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a535b99b636157282edff658166c7d82d">&#9670;&#160;</a></span>getDisorientationCubic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::Tools::getDisorientationCubic </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d2/dda/classopenphase_1_1Quaternion.html">Quaternion</a>&#160;</td>
          <td class="paramname"><em>OrientationA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d2/dda/classopenphase_1_1Quaternion.html">Quaternion</a>&#160;</td>
          <td class="paramname"><em>OrientationB</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates Disorientation between two quaternions considering cubic symmetry. </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d48/Tools_8cpp_source.html#l00626">626</a> of file <a class="el" href="../../dc/d48/Tools_8cpp_source.html">Tools.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  627</span>{</div>
<div class="line"><span class="lineno">  628</span>    <span class="comment">// Taken from Grimmer 1974</span></div>
<div class="line"><span class="lineno">  629</span>    <span class="comment">// Only for cubic system. Needs to be generalized!</span></div>
<div class="line"><span class="lineno">  630</span> </div>
<div class="line"><span class="lineno">  631</span>    <span class="keywordtype">double</span> Angle[24];</div>
<div class="line"><span class="lineno">  632</span>    <span class="keywordtype">double</span> misorientation = 0.0;</div>
<div class="line"><span class="lineno">  633</span>    Quaternion deltaQ;</div>
<div class="line"><span class="lineno">  634</span>    deltaQ  = OrientationA* OrientationB.inverted();</div>
<div class="line"><span class="lineno">  635</span> </div>
<div class="line"><span class="lineno">  636</span>    Angle[0]  = deltaQ[0];</div>
<div class="line"><span class="lineno">  637</span>    Angle[1]  = deltaQ[1];</div>
<div class="line"><span class="lineno">  638</span>    Angle[2]  = deltaQ[2];</div>
<div class="line"><span class="lineno">  639</span>    Angle[3]  = deltaQ[3];</div>
<div class="line"><span class="lineno">  640</span> </div>
<div class="line"><span class="lineno">  641</span>    Angle[4]  = (deltaQ[0] + deltaQ[1])*0.707;</div>
<div class="line"><span class="lineno">  642</span>    Angle[5]  = (deltaQ[0] - deltaQ[1])*0.707;</div>
<div class="line"><span class="lineno">  643</span>    Angle[6]  = (deltaQ[2] + deltaQ[3])*0.707;</div>
<div class="line"><span class="lineno">  644</span>    Angle[7]  = (deltaQ[2] - deltaQ[3])*0.707;</div>
<div class="line"><span class="lineno">  645</span> </div>
<div class="line"><span class="lineno">  646</span>    Angle[8]  = (deltaQ[0] + deltaQ[2])*0.707;</div>
<div class="line"><span class="lineno">  647</span>    Angle[9]  = (deltaQ[0] - deltaQ[2])*0.707;</div>
<div class="line"><span class="lineno">  648</span>    Angle[10] = (deltaQ[1] + deltaQ[3])*0.707;</div>
<div class="line"><span class="lineno">  649</span>    Angle[11] = (deltaQ[1] - deltaQ[3])*0.707;</div>
<div class="line"><span class="lineno">  650</span> </div>
<div class="line"><span class="lineno">  651</span>    Angle[12] = (deltaQ[0] + deltaQ[3])*0.707;</div>
<div class="line"><span class="lineno">  652</span>    Angle[13] = (deltaQ[0] - deltaQ[3])*0.707;</div>
<div class="line"><span class="lineno">  653</span>    Angle[14] = (deltaQ[1] + deltaQ[2])*0.707;</div>
<div class="line"><span class="lineno">  654</span>    Angle[15] = (deltaQ[1] - deltaQ[2])*0.707;</div>
<div class="line"><span class="lineno">  655</span> </div>
<div class="line"><span class="lineno">  656</span>    Angle[16] = (deltaQ[0] + deltaQ[1] + deltaQ[2] + deltaQ[3])*0.5;</div>
<div class="line"><span class="lineno">  657</span>    Angle[17] = (deltaQ[0] + deltaQ[1] - deltaQ[2] - deltaQ[3])*0.5;</div>
<div class="line"><span class="lineno">  658</span>    Angle[18] = (deltaQ[0] - deltaQ[1] + deltaQ[2] - deltaQ[3])*0.5;</div>
<div class="line"><span class="lineno">  659</span>    Angle[19] = (deltaQ[0] - deltaQ[1] - deltaQ[2] + deltaQ[3])*0.5;</div>
<div class="line"><span class="lineno">  660</span> </div>
<div class="line"><span class="lineno">  661</span>    Angle[20] = (deltaQ[0] + deltaQ[1] + deltaQ[2] - deltaQ[3])*0.5;</div>
<div class="line"><span class="lineno">  662</span>    Angle[21] = (deltaQ[0] + deltaQ[1] - deltaQ[2] + deltaQ[3])*0.5;</div>
<div class="line"><span class="lineno">  663</span>    Angle[22] = (deltaQ[0] - deltaQ[1] + deltaQ[2] + deltaQ[3])*0.5;</div>
<div class="line"><span class="lineno">  664</span>    Angle[23] = (deltaQ[0] - deltaQ[1] - deltaQ[2] - deltaQ[3])*0.5;</div>
<div class="line"><span class="lineno">  665</span> </div>
<div class="line"><span class="lineno">  666</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> a=0; a&lt;24; a++)</div>
<div class="line"><span class="lineno">  667</span>    {</div>
<div class="line"><span class="lineno">  668</span>        Angle[a] = abs(Angle[a]);</div>
<div class="line"><span class="lineno">  669</span>    }</div>
<div class="line"><span class="lineno">  670</span>    <span class="keywordtype">double</span> DisAngle = 0;</div>
<div class="line"><span class="lineno">  671</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> a=0; a&lt;24; a++)</div>
<div class="line"><span class="lineno">  672</span>    {</div>
<div class="line"><span class="lineno">  673</span>        <span class="keywordflow">if</span> (DisAngle &lt; Angle[a])</div>
<div class="line"><span class="lineno">  674</span>            DisAngle =  Angle[a];</div>
<div class="line"><span class="lineno">  675</span>    }</div>
<div class="line"><span class="lineno">  676</span>    misorientation = 2*acos(DisAngle);</div>
<div class="line"><span class="lineno">  677</span>    <span class="keywordflow">return</span> misorientation;</div>
<div class="line"><span class="lineno">  678</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a15c9cac9ba24da74e9115aa11bbc3ea8" name="a15c9cac9ba24da74e9115aa11bbc3ea8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15c9cac9ba24da74e9115aa11bbc3ea8">&#9670;&#160;</a></span>getMemoryUsageMB()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::Tools::getMemoryUsageMB </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns memory used by the simulation (useful for memory leaks detection) </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d48/Tools_8cpp_source.html#l00873">873</a> of file <a class="el" href="../../dc/d48/Tools_8cpp_source.html">Tools.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  874</span>{</div>
<div class="line"><span class="lineno">  875</span>    std::ifstream file(<span class="stringliteral">&quot;/proc/self/status&quot;</span>);</div>
<div class="line"><span class="lineno">  876</span>    std::string line;</div>
<div class="line"><span class="lineno">  877</span>    <span class="keywordflow">while</span> (getline(file, line))</div>
<div class="line"><span class="lineno">  878</span>    {</div>
<div class="line"><span class="lineno">  879</span>        <span class="keywordflow">if</span> (line.substr(0, 6) == <span class="stringliteral">&quot;VmRSS:&quot;</span>)</div>
<div class="line"><span class="lineno">  880</span>        {</div>
<div class="line"><span class="lineno">  881</span>            std::istringstream iss(line);</div>
<div class="line"><span class="lineno">  882</span>            std::string key, value, unit;</div>
<div class="line"><span class="lineno">  883</span>            iss &gt;&gt; key &gt;&gt; value &gt;&gt; unit;</div>
<div class="line"><span class="lineno">  884</span>            <span class="keywordflow">return</span> std::stol(value) / 1024.0;  <span class="comment">// Convert kB to MB</span></div>
<div class="line"><span class="lineno">  885</span>        }</div>
<div class="line"><span class="lineno">  886</span>    }</div>
<div class="line"><span class="lineno">  887</span>    <span class="keywordflow">return</span> -1.0;</div>
<div class="line"><span class="lineno">  888</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3ef83a6fc2a78236f42efb36f23eb4ca" name="a3ef83a6fc2a78236f42efb36f23eb4ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ef83a6fc2a78236f42efb36f23eb4ca">&#9670;&#160;</a></span>getMisorientation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::Tools::getMisorientation </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a>&#160;</td>
          <td class="paramname"><em>RotMatA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a>&#160;</td>
          <td class="paramname"><em>RotMatB</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates missorientation between two matrices without consideration of symmetries. </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d48/Tools_8cpp_source.html#l00599">599</a> of file <a class="el" href="../../dc/d48/Tools_8cpp_source.html">Tools.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  600</span>{</div>
<div class="line"><span class="lineno">  601</span>    <span class="comment">// Taken from Kocks, Tome and Wenk</span></div>
<div class="line"><span class="lineno">  602</span>    <span class="comment">// &#39;Texture and Anisotropy&#39;, Cambride University Press 1998, p. 69, eq. 9b</span></div>
<div class="line"><span class="lineno">  603</span>    <span class="keywordflow">return</span> acos(((RotMatB*RotMatA.transposed()).trace()-1.0)/2.0);</div>
<div class="line"><span class="lineno">  604</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac027a3ad585e045c39b715a74fbe2c3f" name="ac027a3ad585e045c39b715a74fbe2c3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac027a3ad585e045c39b715a74fbe2c3f">&#9670;&#160;</a></span>getMisorientationCubic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double openphase::Tools::getMisorientationCubic </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a>&#160;</td>
          <td class="paramname"><em>RotMatA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a>&#160;</td>
          <td class="paramname"><em>RotMatB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/dbd/classopenphase_1_1Crystallography.html">Crystallography</a> &amp;&#160;</td>
          <td class="paramname"><em>CR</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates missorientation between two matrices considering cubic symmetry. </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d48/Tools_8cpp_source.html#l00606">606</a> of file <a class="el" href="../../dc/d48/Tools_8cpp_source.html">Tools.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  607</span>{</div>
<div class="line"><span class="lineno">  608</span>    <span class="comment">// Taken from Kocks, Tome and Wenk</span></div>
<div class="line"><span class="lineno">  609</span>    <span class="comment">// &#39;Texture and Anisotropy&#39;, Cambride University Press 1998, p. 69, eq. 9b</span></div>
<div class="line"><span class="lineno">  610</span> </div>
<div class="line"><span class="lineno">  611</span>    <span class="comment">// Only for cubic system. Needs to be generalized!</span></div>
<div class="line"><span class="lineno">  612</span> </div>
<div class="line"><span class="lineno">  613</span>    <span class="keywordtype">double</span> misorientation = 10.0;</div>
<div class="line"><span class="lineno">  614</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 24; i++)</div>
<div class="line"><span class="lineno">  615</span>    {</div>
<div class="line"><span class="lineno">  616</span>        <span class="keywordtype">double</span> misorientationloc = acos(((<a class="code hl_variable" href="../../d6/d0a/tinyxml2_8cpp.html#ad3136d2f1f34e592c66e09ba8a852812">CR</a>.SymmetriesCubic[i]*RotMatB*</div>
<div class="line"><span class="lineno">  617</span>                RotMatA.transposed()).trace()-1.0)/2.0);</div>
<div class="line"><span class="lineno">  618</span>        <span class="keywordflow">if</span> (abs(misorientationloc) &lt;= abs(misorientation))</div>
<div class="line"><span class="lineno">  619</span>        {</div>
<div class="line"><span class="lineno">  620</span>            misorientation = misorientationloc;</div>
<div class="line"><span class="lineno">  621</span>        }</div>
<div class="line"><span class="lineno">  622</span>    }</div>
<div class="line"><span class="lineno">  623</span>    <span class="keywordflow">return</span> misorientation;</div>
<div class="line"><span class="lineno">  624</span>}</div>
<div class="ttc" id="atinyxml2_8cpp_html_ad3136d2f1f34e592c66e09ba8a852812"><div class="ttname"><a href="../../d6/d0a/tinyxml2_8cpp.html#ad3136d2f1f34e592c66e09ba8a852812">CR</a></div><div class="ttdeci">static const char CR</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d0a/tinyxml2_8cpp_source.html#l00142">tinyxml2.cpp:142</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afa0e13f9de8e0bc1648eca5fdfafaed4" name="afa0e13f9de8e0bc1648eca5fdfafaed4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa0e13f9de8e0bc1648eca5fdfafaed4">&#9670;&#160;</a></span>jacobiRotate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::Tools::jacobiRotate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a> &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a> &amp;&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented from <a href="https://dl.acm.org/doi/abs/10.1145/1028523.1028541">https://dl.acm.org/doi/abs/10.1145/1028523.1028541</a>. </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d48/Tools_8cpp_source.html#l00319">319</a> of file <a class="el" href="../../dc/d48/Tools_8cpp_source.html">Tools.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  320</span>{</div>
<div class="line"><span class="lineno">  321</span>    <span class="keywordflow">if</span> (A(p, q) == 0.0)</div>
<div class="line"><span class="lineno">  322</span>    {</div>
<div class="line"><span class="lineno">  323</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  324</span>    }</div>
<div class="line"><span class="lineno">  325</span>    <span class="keywordtype">double</span> d = (A(p, p) - A(q, q)) / (2.0*A(p, q));</div>
<div class="line"><span class="lineno">  326</span>    <span class="keywordtype">double</span> t = 1.0 / (fabs(d) + sqrt(d*d + 1.0));</div>
<div class="line"><span class="lineno">  327</span>    <span class="keywordflow">if</span> (d &lt; 0.0)</div>
<div class="line"><span class="lineno">  328</span>    {</div>
<div class="line"><span class="lineno">  329</span>        t = -t;</div>
<div class="line"><span class="lineno">  330</span>    }</div>
<div class="line"><span class="lineno">  331</span>    <span class="keywordtype">double</span> c = 1.0 / sqrt(t*t + 1);</div>
<div class="line"><span class="lineno">  332</span>    <span class="keywordtype">double</span> s = t*c;</div>
<div class="line"><span class="lineno">  333</span>    A(p, p) += t*A(p, q);</div>
<div class="line"><span class="lineno">  334</span>    A(q, q) -= t*A(p, q);</div>
<div class="line"><span class="lineno">  335</span>    A(p, q) = A(q, p) = 0.0;</div>
<div class="line"><span class="lineno">  336</span>    <span class="keywordtype">int</span> k;</div>
<div class="line"><span class="lineno">  337</span>    <span class="keywordflow">for</span> (k = 0; k &lt; 3; k++)</div>
<div class="line"><span class="lineno">  338</span>    {</div>
<div class="line"><span class="lineno">  339</span>        <span class="keywordflow">if</span> (k != p &amp;&amp; k != q)</div>
<div class="line"><span class="lineno">  340</span>        {</div>
<div class="line"><span class="lineno">  341</span>            <span class="keywordtype">double</span> Akp = c*A(k, p) + s*A(k, q);</div>
<div class="line"><span class="lineno">  342</span>            <span class="keywordtype">double</span> Akq = -s*A(k, p) + c*A(k, q);</div>
<div class="line"><span class="lineno">  343</span>            A(k, p) = A(p, k) = Akp;</div>
<div class="line"><span class="lineno">  344</span>            A(k, q) = A(q, k) = Akq;</div>
<div class="line"><span class="lineno">  345</span>        }</div>
<div class="line"><span class="lineno">  346</span>    }</div>
<div class="line"><span class="lineno">  347</span>    <span class="keywordflow">for</span> (k = 0; k &lt; 3; k++)</div>
<div class="line"><span class="lineno">  348</span>    {</div>
<div class="line"><span class="lineno">  349</span>        <span class="keywordtype">double</span> Rkp = c*R(k, p) + s*R(k, q);</div>
<div class="line"><span class="lineno">  350</span>        <span class="keywordtype">double</span> Rkq = -s*R(k, p) + c*R(k, q);</div>
<div class="line"><span class="lineno">  351</span>        R(k, p) = Rkp;</div>
<div class="line"><span class="lineno">  352</span>        R(k, q) = Rkq;</div>
<div class="line"><span class="lineno">  353</span>    }</div>
<div class="line"><span class="lineno">  354</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3497857e4ade828481f4b6990f7e6a88" name="a3497857e4ade828481f4b6990f7e6a88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3497857e4ade828481f4b6990f7e6a88">&#9670;&#160;</a></span>MapIntoSimulationDomain()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename vector &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void openphase::Tools::MapIntoSimulationDomain </td>
          <td>(</td>
          <td class="paramtype">vector &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>TotalNx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>TotalNy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>TotalNz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/ddb/classopenphase_1_1BoundaryConditions.html">BoundaryConditions</a> &amp;&#160;</td>
          <td class="paramname"><em>BC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d8f/Tools_8h_source.html#l00147">147</a> of file <a class="el" href="../../d2/d8f/Tools_8h_source.html">Tools.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  148</span>    {</div>
<div class="line"><span class="lineno">  149</span><span class="preprocessor">#ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno">  150</span>        <span class="keywordflow">if</span> (BC.MPIperiodicX or BC.BCNX == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>) <span class="keywordflow">while</span> (A[0] &gt;= TotalNx) A[0] -= TotalNx;</div>
<div class="line"><span class="lineno">  151</span>        <span class="keywordflow">if</span> (BC.MPIperiodicY or BC.BCNY == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>) <span class="keywordflow">while</span> (A[1] &gt;= TotalNy) A[1] -= TotalNy;</div>
<div class="line"><span class="lineno">  152</span>        <span class="keywordflow">if</span> (BC.MPIperiodicZ or BC.BCNZ == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>) <span class="keywordflow">while</span> (A[2] &gt;= TotalNz) A[2] -= TotalNz;</div>
<div class="line"><span class="lineno">  153</span>        <span class="keywordflow">if</span> (BC.MPIperiodicX or BC.BC0X == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>) <span class="keywordflow">while</span> (A[0] &lt;  0) A[0] += TotalNx;</div>
<div class="line"><span class="lineno">  154</span>        <span class="keywordflow">if</span> (BC.MPIperiodicY or BC.BC0Y == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>) <span class="keywordflow">while</span> (A[1] &lt;  0) A[1] += TotalNy;</div>
<div class="line"><span class="lineno">  155</span>        <span class="keywordflow">if</span> (BC.MPIperiodicZ or BC.BC0Z == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>) <span class="keywordflow">while</span> (A[2] &lt;  0) A[2] += TotalNz;</div>
<div class="line"><span class="lineno">  156</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  157</span>        <span class="keywordflow">if</span> (BC.BCNX == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>) <span class="keywordflow">while</span> (A[0] &gt;= TotalNx) A[0] -= TotalNx;</div>
<div class="line"><span class="lineno">  158</span>        <span class="keywordflow">if</span> (BC.BCNY == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>) <span class="keywordflow">while</span> (A[1] &gt;= TotalNy) A[1] -= TotalNy;</div>
<div class="line"><span class="lineno">  159</span>        <span class="keywordflow">if</span> (BC.BCNZ == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>) <span class="keywordflow">while</span> (A[2] &gt;= TotalNz) A[2] -= TotalNz;</div>
<div class="line"><span class="lineno">  160</span>        <span class="keywordflow">if</span> (BC.BC0X == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>) <span class="keywordflow">while</span> (A[0] &lt;  0) A[0] += TotalNx;</div>
<div class="line"><span class="lineno">  161</span>        <span class="keywordflow">if</span> (BC.BC0Y == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>) <span class="keywordflow">while</span> (A[1] &lt;  0) A[1] += TotalNy;</div>
<div class="line"><span class="lineno">  162</span>        <span class="keywordflow">if</span> (BC.BC0Z == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a69910bb765933ee28721d9784d7b6a5bacdcc32a064503184053bd2018d1c0e7e">BoundaryConditionTypes::Periodic</a>) <span class="keywordflow">while</span> (A[0] &lt;  0) A[2] += TotalNz;</div>
<div class="line"><span class="lineno">  163</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  164</span>    };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a63240f7905b0aa979dcedd28c93d9896" name="a63240f7905b0aa979dcedd28c93d9896"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63240f7905b0aa979dcedd28c93d9896">&#9670;&#160;</a></span>MillerConversion()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a> openphase::Tools::MillerConversion </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>hkil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d94/classopenphase_1_1dVector3.html">dVector3</a>&#160;</td>
          <td class="paramname"><em>hkl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>PlaneNormal</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Hexagonal Miller plane Normal indices to Miller-Bravais // flase for directions &ndash;. </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d48/Tools_8cpp_source.html#l00743">743</a> of file <a class="el" href="../../dc/d48/Tools_8cpp_source.html">Tools.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  744</span>{</div>
<div class="line"><span class="lineno">  745</span>    <span class="keywordflow">if</span>(PlaneNormal)</div>
<div class="line"><span class="lineno">  746</span>    {</div>
<div class="line"><span class="lineno">  747</span>        hkl[0] = hkil[0];</div>
<div class="line"><span class="lineno">  748</span>        hkl[1] = hkil[1];</div>
<div class="line"><span class="lineno">  749</span>        hkl[2] = hkil[3];</div>
<div class="line"><span class="lineno">  750</span>    }</div>
<div class="line"><span class="lineno">  751</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  752</span>    {</div>
<div class="line"><span class="lineno">  753</span>        hkl[0] = hkil[0]-hkil[2];</div>
<div class="line"><span class="lineno">  754</span>        hkl[1] = hkil[1]-hkil[2];</div>
<div class="line"><span class="lineno">  755</span>        hkl[2] = hkil[3];</div>
<div class="line"><span class="lineno">  756</span>    }</div>
<div class="line"><span class="lineno">  757</span> </div>
<div class="line"><span class="lineno">  758</span>    <span class="comment">// Titanium c/a ratio ( to be generalized depends on the element )</span></div>
<div class="line"><span class="lineno">  759</span>    <span class="keywordtype">double</span> a = 0.2950;</div>
<div class="line"><span class="lineno">  760</span>    <span class="keywordtype">double</span> c = 0.4683;</div>
<div class="line"><span class="lineno">  761</span> </div>
<div class="line"><span class="lineno">  762</span>    dMatrix3x3 locMat {a, -a/2.0, 0,</div>
<div class="line"><span class="lineno">  763</span>                       0, a*sqrt(3)/2.0, 0,</div>
<div class="line"><span class="lineno">  764</span>                       0, 0, c};</div>
<div class="line"><span class="lineno">  765</span>    hkl = locMat * hkl;</div>
<div class="line"><span class="lineno">  766</span> </div>
<div class="line"><span class="lineno">  767</span>    hkl.normalize();</div>
<div class="line"><span class="lineno">  768</span>    <span class="keywordflow">return</span> hkl;</div>
<div class="line"><span class="lineno">  769</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a93a0b7772208d7b50d195dbe45fc816a" name="a93a0b7772208d7b50d195dbe45fc816a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93a0b7772208d7b50d195dbe45fc816a">&#9670;&#160;</a></span>Position()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename vector &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static vector openphase::Tools::Position </td>
          <td>(</td>
          <td class="paramtype">const vector&#160;</td>
          <td class="paramname"><em>loc_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>OffsetX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>OffsetY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>OffsetZ</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">OffsetZ</td><td>Gives global coordinates in MPI mode. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d8f/Tools_8h_source.html#l00064">64</a> of file <a class="el" href="../../d2/d8f/Tools_8h_source.html">Tools.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   65</span>    {</div>
<div class="line"><span class="lineno">   66</span><span class="preprocessor">        #ifdef MPI_PARALLEL</span></div>
<div class="line"><span class="lineno">   67</span>        <span class="keywordflow">return</span> vector({loc_pos[0] + OffsetX, loc_pos[1] + OffsetY, loc_pos[2] + OffsetZ});</div>
<div class="line"><span class="lineno">   68</span><span class="preprocessor">        #else</span></div>
<div class="line"><span class="lineno">   69</span>        <span class="keywordflow">return</span> loc_pos;</div>
<div class="line"><span class="lineno">   70</span><span class="preprocessor">        #endif</span></div>
<div class="line"><span class="lineno">   71</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6ebd6ae82f8a9dabfd5a1f5879b01845" name="a6ebd6ae82f8a9dabfd5a1f5879b01845"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ebd6ae82f8a9dabfd5a1f5879b01845">&#9670;&#160;</a></span>rotationMatrixIrving()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::Tools::rotationMatrixIrving </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a> &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a> &amp;&#160;</td>
          <td class="paramname"><em>R</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d48/Tools_8cpp_source.html#l00393">393</a> of file <a class="el" href="../../dc/d48/Tools_8cpp_source.html">Tools.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  394</span>{</div>
<div class="line"><span class="lineno">  395</span>    dMatrix3x3 AT_A, V;</div>
<div class="line"><span class="lineno">  396</span>    AT_A = A.transposed() * A;</div>
<div class="line"><span class="lineno">  397</span>    dVector3 S;</div>
<div class="line"><span class="lineno">  398</span>    <a class="code hl_function" href="../../df/dfe/classopenphase_1_1Tools.html#a60a7d5469cdf77db0cec3552f2211936">eigenDecomposition</a>(AT_A, V, S);</div>
<div class="line"><span class="lineno">  399</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> detV = V.determinant();</div>
<div class="line"><span class="lineno">  400</span>    <span class="keywordflow">if</span> (detV &lt; 0.0)</div>
<div class="line"><span class="lineno">  401</span>    {</div>
<div class="line"><span class="lineno">  402</span>        <span class="keywordtype">double</span> minLambda = DBL_MAX;</div>
<div class="line"><span class="lineno">  403</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> pos = 0;</div>
<div class="line"><span class="lineno">  404</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> l = 0; l &lt; 3; l++)</div>
<div class="line"><span class="lineno">  405</span>        {</div>
<div class="line"><span class="lineno">  406</span>            <span class="keywordflow">if</span> (S[l] &lt; minLambda)</div>
<div class="line"><span class="lineno">  407</span>            {</div>
<div class="line"><span class="lineno">  408</span>                pos = l;</div>
<div class="line"><span class="lineno">  409</span>                minLambda = S[l];</div>
<div class="line"><span class="lineno">  410</span>            }</div>
<div class="line"><span class="lineno">  411</span>        }</div>
<div class="line"><span class="lineno">  412</span>        V(0, pos) = -V(0, pos);</div>
<div class="line"><span class="lineno">  413</span>        V(1, pos) = -V(1, pos);</div>
<div class="line"><span class="lineno">  414</span>        V(2, pos) = -V(2, pos);</div>
<div class="line"><span class="lineno">  415</span>    }</div>
<div class="line"><span class="lineno">  416</span>    <span class="keywordflow">if</span> (S[0] &lt; 0.0f)</div>
<div class="line"><span class="lineno">  417</span>        S[0] = 0.0f;</div>
<div class="line"><span class="lineno">  418</span>    <span class="keywordflow">if</span> (S[1] &lt; 0.0f)</div>
<div class="line"><span class="lineno">  419</span>        S[1] = 0.0f;</div>
<div class="line"><span class="lineno">  420</span>    <span class="keywordflow">if</span> (S[2] &lt; 0.0f)</div>
<div class="line"><span class="lineno">  421</span>        S[2] = 0.0f;</div>
<div class="line"><span class="lineno">  422</span> </div>
<div class="line"><span class="lineno">  423</span>    dVector3 sigma;</div>
<div class="line"><span class="lineno">  424</span>    sigma[0] = sqrt(S[0]);</div>
<div class="line"><span class="lineno">  425</span>    sigma[1] = sqrt(S[1]);</div>
<div class="line"><span class="lineno">  426</span>    sigma[2] = sqrt(S[2]);</div>
<div class="line"><span class="lineno">  427</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> chk = 0;</div>
<div class="line"><span class="lineno">  428</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> pos = 0;</div>
<div class="line"><span class="lineno">  429</span>    dMatrix3x3 U;</div>
<div class="line"><span class="lineno">  430</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> l = 0; l &lt; 3; l++)</div>
<div class="line"><span class="lineno">  431</span>    {</div>
<div class="line"><span class="lineno">  432</span>        <span class="keywordflow">if</span> (fabs(sigma[l]) &lt; 1.0e-4)</div>
<div class="line"><span class="lineno">  433</span>        {</div>
<div class="line"><span class="lineno">  434</span>            pos = l;</div>
<div class="line"><span class="lineno">  435</span>            chk++;</div>
<div class="line"><span class="lineno">  436</span>        }</div>
<div class="line"><span class="lineno">  437</span>    }</div>
<div class="line"><span class="lineno">  438</span>    <span class="keywordflow">if</span> (chk &gt; 0)</div>
<div class="line"><span class="lineno">  439</span>    {</div>
<div class="line"><span class="lineno">  440</span>        <span class="keywordflow">if</span> (chk &gt; 1)</div>
<div class="line"><span class="lineno">  441</span>        {</div>
<div class="line"><span class="lineno">  442</span>            U.set_to_unity();</div>
<div class="line"><span class="lineno">  443</span>        }</div>
<div class="line"><span class="lineno">  444</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  445</span>        {</div>
<div class="line"><span class="lineno">  446</span>            U = A * V;</div>
<div class="line"><span class="lineno">  447</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> l = 0; l &lt; 3; l++)</div>
<div class="line"><span class="lineno">  448</span>            {</div>
<div class="line"><span class="lineno">  449</span>                <span class="keywordflow">if</span> (l != pos)</div>
<div class="line"><span class="lineno">  450</span>                {</div>
<div class="line"><span class="lineno">  451</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> m = 0; m &lt; 3; m++)</div>
<div class="line"><span class="lineno">  452</span>                    {</div>
<div class="line"><span class="lineno">  453</span>                        U(m, l) *= 1.0f / sigma[l];</div>
<div class="line"><span class="lineno">  454</span>                    }</div>
<div class="line"><span class="lineno">  455</span>                }</div>
<div class="line"><span class="lineno">  456</span>            }</div>
<div class="line"><span class="lineno">  457</span>            dVector3 v[2];</div>
<div class="line"><span class="lineno">  458</span>            <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> index = 0;</div>
<div class="line"><span class="lineno">  459</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> l = 0; l &lt; 3; l++)</div>
<div class="line"><span class="lineno">  460</span>            {</div>
<div class="line"><span class="lineno">  461</span>                <span class="keywordflow">if</span> (l != pos)</div>
<div class="line"><span class="lineno">  462</span>                {</div>
<div class="line"><span class="lineno">  463</span>                    v[index++] = dVector3({U(0, l), U(1, l), U(2, l)});</div>
<div class="line"><span class="lineno">  464</span>                }</div>
<div class="line"><span class="lineno">  465</span>            }</div>
<div class="line"><span class="lineno">  466</span>            dVector3 vec = v[0].cross(v[1]);</div>
<div class="line"><span class="lineno">  467</span>            vec.normalized();</div>
<div class="line"><span class="lineno">  468</span>            U(0, pos) = vec[0];</div>
<div class="line"><span class="lineno">  469</span>            U(1, pos) = vec[1];</div>
<div class="line"><span class="lineno">  470</span>            U(2, pos) = vec[2];</div>
<div class="line"><span class="lineno">  471</span>        }</div>
<div class="line"><span class="lineno">  472</span>    }</div>
<div class="line"><span class="lineno">  473</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  474</span>    {</div>
<div class="line"><span class="lineno">  475</span>        dVector3 sigmaInv;</div>
<div class="line"><span class="lineno">  476</span>        sigmaInv = {1.0 / sigma[0], 1.0 / sigma[1], 1.0 / sigma[2]};</div>
<div class="line"><span class="lineno">  477</span>        U = A * V;</div>
<div class="line"><span class="lineno">  478</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> l = 0; l &lt; 3; l++)</div>
<div class="line"><span class="lineno">  479</span>        {</div>
<div class="line"><span class="lineno">  480</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> m = 0; m &lt; 3; m++)</div>
<div class="line"><span class="lineno">  481</span>            {</div>
<div class="line"><span class="lineno">  482</span>                U(m, l) *= sigmaInv[l];</div>
<div class="line"><span class="lineno">  483</span>            }</div>
<div class="line"><span class="lineno">  484</span>        }</div>
<div class="line"><span class="lineno">  485</span>    }</div>
<div class="line"><span class="lineno">  486</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> detU = U.determinant();</div>
<div class="line"><span class="lineno">  487</span>    <span class="keywordflow">if</span> (detU &lt; 0.0)</div>
<div class="line"><span class="lineno">  488</span>    {</div>
<div class="line"><span class="lineno">  489</span>        <span class="keywordtype">double</span> minLambda = DBL_MAX;</div>
<div class="line"><span class="lineno">  490</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> pos = 0;</div>
<div class="line"><span class="lineno">  491</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> l = 0; l &lt; 3; l++)</div>
<div class="line"><span class="lineno">  492</span>        {</div>
<div class="line"><span class="lineno">  493</span>            <span class="keywordflow">if</span> (sigma[l] &lt; minLambda)</div>
<div class="line"><span class="lineno">  494</span>            {</div>
<div class="line"><span class="lineno">  495</span>                pos = l;</div>
<div class="line"><span class="lineno">  496</span>                minLambda = sigma[l];</div>
<div class="line"><span class="lineno">  497</span>            }</div>
<div class="line"><span class="lineno">  498</span>        }</div>
<div class="line"><span class="lineno">  499</span>        sigma[pos] = -sigma[pos];</div>
<div class="line"><span class="lineno">  500</span>        U(0, pos) = -U(0, pos);</div>
<div class="line"><span class="lineno">  501</span>        U(1, pos) = -U(1, pos);</div>
<div class="line"><span class="lineno">  502</span>        U(2, pos) = -U(2, pos);</div>
<div class="line"><span class="lineno">  503</span>    }</div>
<div class="line"><span class="lineno">  504</span>    R = U * V.transpose();</div>
<div class="line"><span class="lineno">  505</span>}</div>
<div class="ttc" id="aclassopenphase_1_1Tools_html_a60a7d5469cdf77db0cec3552f2211936"><div class="ttname"><a href="../../df/dfe/classopenphase_1_1Tools.html#a60a7d5469cdf77db0cec3552f2211936">openphase::Tools::eigenDecomposition</a></div><div class="ttdeci">static void eigenDecomposition(const dMatrix3x3 &amp;A, dMatrix3x3 &amp;eigenVecs, dVector3 &amp;eigenVals)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d48/Tools_8cpp_source.html#l00355">Tools.cpp:355</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0cd80e7273ca0fdd64bbbacefd9a3f6c" name="a0cd80e7273ca0fdd64bbbacefd9a3f6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cd80e7273ca0fdd64bbbacefd9a3f6c">&#9670;&#160;</a></span>RotationToEuler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/de4/classopenphase_1_1EulerAngles.html">EulerAngles</a> openphase::Tools::RotationToEuler </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../db/da1/classopenphase_1_1dMatrix3x3.html">dMatrix3x3</a> &amp;&#160;</td>
          <td class="paramname"><em>Rot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d6c/namespaceopenphase.html#a631078f50f3da2bf1138bc0182054010">EulerConvention</a>&#160;</td>
          <td class="paramname"><em>locConvention</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d48/Tools_8cpp_source.html#l00680">680</a> of file <a class="el" href="../../dc/d48/Tools_8cpp_source.html">Tools.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  681</span>{</div>
<div class="line"><span class="lineno">  682</span>    EulerAngles Euler;</div>
<div class="line"><span class="lineno">  683</span>    Euler.Convention = EConvention;</div>
<div class="line"><span class="lineno">  684</span>    dMatrix3x3 RT = Rot.transposed();</div>
<div class="line"><span class="lineno">  685</span> </div>
<div class="line"><span class="lineno">  686</span>    <span class="keywordflow">if</span>(EConvention == <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a631078f50f3da2bf1138bc0182054010a3f621246b8dd589df33df6fce0956d8c">ZXZ</a>)</div>
<div class="line"><span class="lineno">  687</span>    {</div>
<div class="line"><span class="lineno">  688</span>        <span class="comment">// Euler ZXZ passive (following formulation by Martin Boeff)</span></div>
<div class="line"><span class="lineno">  689</span>        <span class="keywordtype">double</span> squvw = sqrt(RT(0,0)*RT(0,0)</div>
<div class="line"><span class="lineno">  690</span>            + RT(1,0)*RT(1,0) + RT(2,0)*RT(2,0));</div>
<div class="line"><span class="lineno">  691</span>        <span class="keywordtype">double</span> sqhk = sqrt(RT(0,2)*RT(0,2)</div>
<div class="line"><span class="lineno">  692</span>            + RT(1,2)*RT(1,2));</div>
<div class="line"><span class="lineno">  693</span>        <span class="keywordtype">double</span> sqhkl = sqrt(RT(0,2)*RT(0,2)</div>
<div class="line"><span class="lineno">  694</span>            + RT(1,2)*RT(1,2) + RT(2,2)*RT(2,2));</div>
<div class="line"><span class="lineno">  695</span>        <span class="keywordtype">double</span> tempval = RT(2,2)/sqhkl;</div>
<div class="line"><span class="lineno">  696</span> </div>
<div class="line"><span class="lineno">  697</span>        <span class="keywordflow">if</span>(tempval &gt;  1.0) {tempval =  1.0;}</div>
<div class="line"><span class="lineno">  698</span>        <span class="keywordflow">if</span>(tempval &lt; -1.0) {tempval = -1.0;}</div>
<div class="line"><span class="lineno">  699</span>        Euler.Q[1] = acos(tempval);</div>
<div class="line"><span class="lineno">  700</span> </div>
<div class="line"><span class="lineno">  701</span>        <span class="keywordflow">if</span>(Euler.Q[1] &lt; 1.0e-8)</div>
<div class="line"><span class="lineno">  702</span>        {</div>
<div class="line"><span class="lineno">  703</span>            <span class="comment">// calculate phi2</span></div>
<div class="line"><span class="lineno">  704</span>            Euler.Q[2] = 0.0;</div>
<div class="line"><span class="lineno">  705</span>            <span class="comment">// calculate phi1</span></div>
<div class="line"><span class="lineno">  706</span>            tempval = RT(0,0)/squvw;</div>
<div class="line"><span class="lineno">  707</span>            <span class="keywordflow">if</span>(tempval &gt;  1.0) {tempval =  1.0;}</div>
<div class="line"><span class="lineno">  708</span>            <span class="keywordflow">if</span>(tempval &lt; -1.0) {tempval = -1.0;}</div>
<div class="line"><span class="lineno">  709</span> </div>
<div class="line"><span class="lineno">  710</span>            Euler.Q[0] = acos(tempval);</div>
<div class="line"><span class="lineno">  711</span>            <span class="keywordflow">if</span>(RT(1,0) &gt; 0.0) {Euler.Q[0] = 2.0*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a> - Euler.Q[0];}</div>
<div class="line"><span class="lineno">  712</span>        }</div>
<div class="line"><span class="lineno">  713</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  714</span>        {</div>
<div class="line"><span class="lineno">  715</span>            <span class="comment">// calculate phi2</span></div>
<div class="line"><span class="lineno">  716</span>            tempval = RT(1,2)/sqhk;</div>
<div class="line"><span class="lineno">  717</span>            <span class="keywordflow">if</span>(tempval &gt;  1.0) {tempval =  1.0;}</div>
<div class="line"><span class="lineno">  718</span>            <span class="keywordflow">if</span>(tempval &lt; -1.0) {tempval = -1.0;}</div>
<div class="line"><span class="lineno">  719</span> </div>
<div class="line"><span class="lineno">  720</span>            Euler.Q[2] = acos(tempval);</div>
<div class="line"><span class="lineno">  721</span>            <span class="keywordflow">if</span>(RT(0,2) &lt; 0.0) {Euler.Q[2] = 2.0*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a> - Euler.Q[2];}</div>
<div class="line"><span class="lineno">  722</span>            <span class="comment">// calculate phi1</span></div>
<div class="line"><span class="lineno">  723</span>            tempval = - RT(2,1)/Euler.SinQ[1];</div>
<div class="line"><span class="lineno">  724</span>            <span class="keywordflow">if</span>(tempval &gt;  1.0) {tempval = 1.0;}</div>
<div class="line"><span class="lineno">  725</span>            <span class="keywordflow">if</span>(tempval &lt; -1.0) {tempval = -1.0;}</div>
<div class="line"><span class="lineno">  726</span> </div>
<div class="line"><span class="lineno">  727</span>            Euler.Q[0] = acos(tempval);</div>
<div class="line"><span class="lineno">  728</span>            <span class="keywordflow">if</span>(RT(2,0) &lt; 0.0) {Euler.Q[0] = 2.0*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a> - Euler.Q[0];}</div>
<div class="line"><span class="lineno">  729</span>        }</div>
<div class="line"><span class="lineno">  730</span>        Euler.setTrigonometricFunctions();</div>
<div class="line"><span class="lineno">  731</span>    }</div>
<div class="line"><span class="lineno">  732</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  733</span>    {</div>
<div class="line"><span class="lineno">  734</span>        std::stringstream message;</div>
<div class="line"><span class="lineno">  735</span>        message&lt;&lt; <span class="stringliteral">&quot;Wrong/Unknown/None Euler convention used: &quot;</span> &lt;&lt; EConvention ;</div>
<div class="line"><span class="lineno">  736</span> </div>
<div class="line"><span class="lineno">  737</span>        <a class="code hl_function" href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a421faa2fe5d86991328b2b06041a326d">ConsoleOutput::WriteExit</a>(message.str(), <span class="stringliteral">&quot;Tools&quot;</span>, <span class="stringliteral">&quot;RotationToEulerAngles()&quot;</span>);</div>
<div class="line"><span class="lineno">  738</span>        exit(13);</div>
<div class="line"><span class="lineno">  739</span>    }</div>
<div class="line"><span class="lineno">  740</span>    <span class="keywordflow">return</span> Euler;</div>
<div class="line"><span class="lineno">  741</span>}</div>
<div class="ttc" id="aclassopenphase_1_1ConsoleOutput_html_a421faa2fe5d86991328b2b06041a326d"><div class="ttname"><a href="../../d2/db5/classopenphase_1_1ConsoleOutput.html#a421faa2fe5d86991328b2b06041a326d">openphase::ConsoleOutput::WriteExit</a></div><div class="ttdeci">static void WriteExit(const std::string Message, const std::string Instance=&quot;&quot;, const std::string Method=&quot;&quot;)</div><div class="ttdef"><b>Definition</b> <a href="../../da/da0/ConsoleOutput_8cpp_source.html#l00196">ConsoleOutput.cpp:196</a></div></div>
<div class="ttc" id="anamespaceopenphase_html_a631078f50f3da2bf1138bc0182054010a3f621246b8dd589df33df6fce0956d8c"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a631078f50f3da2bf1138bc0182054010a3f621246b8dd589df33df6fce0956d8c">openphase::ZXZ</a></div><div class="ttdeci">@ ZXZ</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d29/EulerAngles_8h_source.html#l00036">EulerAngles.h:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4f3966ce8eed56fba21607b3811dda00" name="a4f3966ce8eed56fba21607b3811dda00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f3966ce8eed56fba21607b3811dda00">&#9670;&#160;</a></span>SetRandomGrainOrientations()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void openphase::Tools::SetRandomGrainOrientations </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d16/classopenphase_1_1PhaseField.html">PhaseField</a> &amp;&#160;</td>
          <td class="paramname"><em>Phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>seed</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets random grains orientations. </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d48/Tools_8cpp_source.html#l00771">771</a> of file <a class="el" href="../../dc/d48/Tools_8cpp_source.html">Tools.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  772</span>{</div>
<div class="line"><span class="lineno">  773</span>    <span class="comment">// uniform sampling of quaternion parameters using the method presented in (Shoemake, 1992)</span></div>
<div class="line"><span class="lineno">  774</span>    <span class="comment">// taken from :: http://planning.cs.uiuc.edu/node198.html#eqn:shoemake</span></div>
<div class="line"><span class="lineno">  775</span> </div>
<div class="line"><span class="lineno">  776</span>    default_random_engine generator(seed);</div>
<div class="line"><span class="lineno">  777</span> </div>
<div class="line"><span class="lineno">  778</span>    uniform_real_distribution &lt;double&gt; Q1Distribution(0, 1.0);</div>
<div class="line"><span class="lineno">  779</span>    uniform_real_distribution &lt;double&gt; Q2Distribution(0, 1.0);</div>
<div class="line"><span class="lineno">  780</span>    uniform_real_distribution &lt;double&gt; Q3Distribution(0, 1.0);</div>
<div class="line"><span class="lineno">  781</span> </div>
<div class="line"><span class="lineno">  782</span>    uniform_real_distribution &lt;double&gt; A1Distribution(0.0, 2.0*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>);</div>
<div class="line"><span class="lineno">  783</span>    uniform_real_distribution &lt;double&gt; A2Distribution(0.0, 2.0*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>);</div>
<div class="line"><span class="lineno">  784</span>    uniform_real_distribution &lt;double&gt; A3Distribution(0.0, 2.0*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>);</div>
<div class="line"><span class="lineno">  785</span> </div>
<div class="line"><span class="lineno">  786</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> alpha = 0; alpha &lt; <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties.size(); alpha++)</div>
<div class="line"><span class="lineno">  787</span>    <span class="keywordflow">if</span>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[alpha].Exist)</div>
<div class="line"><span class="lineno">  788</span>    {</div>
<div class="line"><span class="lineno">  789</span>        Quaternion tempQuat;</div>
<div class="line"><span class="lineno">  790</span>        <span class="keywordflow">switch</span>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.Active())</div>
<div class="line"><span class="lineno">  791</span>        {</div>
<div class="line"><span class="lineno">  792</span>            <span class="keywordflow">case</span> 1: <span class="comment">// 1D</span></div>
<div class="line"><span class="lineno">  793</span>            {</div>
<div class="line"><span class="lineno">  794</span>                <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[alpha].Orientation.set(1.0, 0.0, 0.0, 0.0);</div>
<div class="line"><span class="lineno">  795</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  796</span>            }</div>
<div class="line"><span class="lineno">  797</span>            <span class="keywordflow">case</span> 2: <span class="comment">// 2D</span></div>
<div class="line"><span class="lineno">  798</span>            {</div>
<div class="line"><span class="lineno">  799</span>                <span class="keywordtype">double</span> a1 = 0.0;</div>
<div class="line"><span class="lineno">  800</span>                <span class="keywordtype">double</span> a2 = 0.0;</div>
<div class="line"><span class="lineno">  801</span>                <span class="keywordtype">double</span> a3 = 0.0;</div>
<div class="line"><span class="lineno">  802</span>                <span class="keywordflow">if</span>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.dNx == 0) a1 = A1Distribution(generator);</div>
<div class="line"><span class="lineno">  803</span>                <span class="keywordflow">if</span>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.dNy == 0) a2 = A2Distribution(generator);</div>
<div class="line"><span class="lineno">  804</span>                <span class="keywordflow">if</span>(<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.Grid.dNz == 0) a3 = A3Distribution(generator);</div>
<div class="line"><span class="lineno">  805</span>                EulerAngles ph1({a1,a2,a3},<a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a631078f50f3da2bf1138bc0182054010ab71eaef9d6f6d31e69a4401fc00b737c">XYZ</a>);</div>
<div class="line"><span class="lineno">  806</span>                <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[alpha].Orientation = ph1.getQuaternion().normalized();</div>
<div class="line"><span class="lineno">  807</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  808</span>            }</div>
<div class="line"><span class="lineno">  809</span>            <span class="keywordflow">case</span> 3: <span class="comment">// 3D Full Rotation</span></div>
<div class="line"><span class="lineno">  810</span>            {</div>
<div class="line"><span class="lineno">  811</span>                <span class="keywordtype">double</span> u1 = Q1Distribution(generator);</div>
<div class="line"><span class="lineno">  812</span>                <span class="keywordtype">double</span> u2 = Q2Distribution(generator);</div>
<div class="line"><span class="lineno">  813</span>                <span class="keywordtype">double</span> u3 = Q3Distribution(generator);</div>
<div class="line"><span class="lineno">  814</span> </div>
<div class="line"><span class="lineno">  815</span>                tempQuat.set(sqrt(1.0-u1)*sin(2.0*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>*u2),</div>
<div class="line"><span class="lineno">  816</span>                             sqrt(1.0-u1)*cos(2.0*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>*u2),</div>
<div class="line"><span class="lineno">  817</span>                             sqrt(u1)*sin(2.0*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>*u3),</div>
<div class="line"><span class="lineno">  818</span>                             sqrt(u1)*cos(2.0*<a class="code hl_variable" href="../../d0/d6c/namespaceopenphase.html#a2c26ef9422df111d9487d3d34cf3d613">Pi</a>*u3));</div>
<div class="line"><span class="lineno">  819</span> </div>
<div class="line"><span class="lineno">  820</span>                <a class="code hl_enumvalue" href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">Phase</a>.FieldsProperties[alpha].Orientation = tempQuat.normalized();</div>
<div class="line"><span class="lineno">  821</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  822</span>            }</div>
<div class="line"><span class="lineno">  823</span>        }</div>
<div class="line"><span class="lineno">  824</span>    }</div>
<div class="line"><span class="lineno">  825</span>}</div>
<div class="ttc" id="anamespaceopenphase_html_a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a11d979f2867f3122297a79b5cfa34030a5e35d7fff7b903516cba242ff68fc6d3">openphase::HeatSourceTypes::Phase</a></div><div class="ttdeci">@ Phase</div><div class="ttdoc">Selected phase will act as a heat source.</div></div>
<div class="ttc" id="anamespaceopenphase_html_a631078f50f3da2bf1138bc0182054010ab71eaef9d6f6d31e69a4401fc00b737c"><div class="ttname"><a href="../../d0/d6c/namespaceopenphase.html#a631078f50f3da2bf1138bc0182054010ab71eaef9d6f6d31e69a4401fc00b737c">openphase::XYZ</a></div><div class="ttdeci">@ XYZ</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d29/EulerAngles_8h_source.html#l00037">EulerAngles.h:37</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaddb1d4e3844de19b4ec5ad2c91399b0" name="aaddb1d4e3844de19b4ec5ad2c91399b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaddb1d4e3844de19b4ec5ad2c91399b0">&#9670;&#160;</a></span>Smooth()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void openphase::Tools::Smooth </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d19/classopenphase_1_1Storage3D.html">Storage3D</a>&lt; T, 0 &gt; &amp;&#160;</td>
          <td class="paramname"><em>Field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>SmoothIterations</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d8f/Tools_8h_source.html#l00167">167</a> of file <a class="el" href="../../d2/d8f/Tools_8h_source.html">Tools.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  168</span>    {</div>
<div class="line"><span class="lineno">  169</span>        <span class="keywordtype">int</span> Nx = Field.sizeX();</div>
<div class="line"><span class="lineno">  170</span>        <span class="keywordtype">int</span> Ny = Field.sizeY();</div>
<div class="line"><span class="lineno">  171</span>        <span class="keywordtype">int</span> Nz = Field.sizeZ();</div>
<div class="line"><span class="lineno">  172</span>        <span class="keywordtype">int</span> dNx = Field.dNx();</div>
<div class="line"><span class="lineno">  173</span>        <span class="keywordtype">int</span> dNy = Field.dNy();</div>
<div class="line"><span class="lineno">  174</span>        <span class="keywordtype">int</span> dNz = Field.dNz();</div>
<div class="line"><span class="lineno">  175</span>        <span class="keywordtype">double</span> Stencil[3][3][3] = {{{1.0/64.0,   1.0/32.0, 1.0/64.0},</div>
<div class="line"><span class="lineno">  176</span>                                   {1.0/32.0,   1.0/16.0, 1.0/32.0},</div>
<div class="line"><span class="lineno">  177</span>                                   {1.0/64.0,   1.0/32.0, 1.0/64.0}},</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>                                  {{1.0/32.0,   1.0/16.0, 1.0/32.0},</div>
<div class="line"><span class="lineno">  180</span>                                   {1.0/16.0,   1.0/8.0, 1.0/16.0},</div>
<div class="line"><span class="lineno">  181</span>                                   {1.0/32.0,   1.0/16.0, 1.0/32.0}},</div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span>                                  {{1.0/64.0,   1.0/32.0, 1.0/64.0},</div>
<div class="line"><span class="lineno">  184</span>                                   {1.0/32.0,   1.0/16.0, 1.0/32.0},</div>
<div class="line"><span class="lineno">  185</span>                                   {1.0/64.0,   1.0/32.0, 1.0/64.0}}};</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>        std::function&lt;bool(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>)&gt; condition = [Nx,Ny,Nz](<span class="keywordtype">int</span> u,<span class="keywordtype">int</span> v,<span class="keywordtype">int</span> w)</div>
<div class="line"><span class="lineno">  188</span>        {</div>
<div class="line"><span class="lineno">  189</span>            <span class="keywordflow">return</span> u &lt; Nx and v &lt; Ny and w &lt; Nz and u &gt;= 0 and v &gt;= 0 and w &gt;= 0;</div>
<div class="line"><span class="lineno">  190</span>        };</div>
<div class="line"><span class="lineno">  191</span>        Storage3D&lt;T, 0&gt; FieldTmp;</div>
<div class="line"><span class="lineno">  192</span>        FieldTmp.Allocate(Nx, Ny, Nz, dNx, dNy, dNz, 1);</div>
<div class="line"><span class="lineno">  193</span>        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> start = 0; start &lt; SmoothIterations; start++)</div>
<div class="line"><span class="lineno">  194</span>        {</div>
<div class="line"><span class="lineno">  195</span>            <span class="keywordflow">if</span>(start)</div>
<div class="line"><span class="lineno">  196</span>            {</div>
<div class="line"><span class="lineno">  197</span>                FieldTmp.Reallocate(Nx, Ny, Nz);</div>
<div class="line"><span class="lineno">  198</span>            }</div>
<div class="line"><span class="lineno">  199</span>            <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k, Field,Field.Bcells(),)</div>
<div class="line"><span class="lineno">  200</span>            {</div>
<div class="line"><span class="lineno">  201</span>                        <span class="keywordtype">double</span> tmpStencil[3][3][3] = {{{0.0,   0.0,  0.0},</div>
<div class="line"><span class="lineno">  202</span>                                                     {0.0,   0.0,  0.0},</div>
<div class="line"><span class="lineno">  203</span>                                                     {0.0,   0.0,  0.0}},</div>
<div class="line"><span class="lineno">  204</span> </div>
<div class="line"><span class="lineno">  205</span>                                                     {{0.0,   0.0,  0.0},</div>
<div class="line"><span class="lineno">  206</span>                                                      {0.0,   0.0,  0.0},</div>
<div class="line"><span class="lineno">  207</span>                                                      {0.0,   0.0,  0.0}},</div>
<div class="line"><span class="lineno">  208</span> </div>
<div class="line"><span class="lineno">  209</span>                                                     {{0.0,   0.0,  0.0},</div>
<div class="line"><span class="lineno">  210</span>                                                      {0.0,   0.0,  0.0},</div>
<div class="line"><span class="lineno">  211</span>                                                      {0.0,   0.0,  0.0}}};</div>
<div class="line"><span class="lineno">  212</span>                        <span class="keywordtype">double</span> WS = 0;</div>
<div class="line"><span class="lineno">  213</span>                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> a = -dNx; a &lt;= +dNx; a++)</div>
<div class="line"><span class="lineno">  214</span>                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> b = -dNy; b &lt;= +dNy; b++)</div>
<div class="line"><span class="lineno">  215</span>                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c = -dNz; c &lt;= +dNz; c++)</div>
<div class="line"><span class="lineno">  216</span>                        {</div>
<div class="line"><span class="lineno">  217</span>                            <span class="keywordflow">if</span> (condition(i+a,j+b,k+c))</div>
<div class="line"><span class="lineno">  218</span>                            {</div>
<div class="line"><span class="lineno">  219</span>                                WS += Stencil[a+1][b+1][c+1];</div>
<div class="line"><span class="lineno">  220</span>                            }</div>
<div class="line"><span class="lineno">  221</span>                        }</div>
<div class="line"><span class="lineno">  222</span>                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> a = -dNx; a &lt;= +dNx; a++)</div>
<div class="line"><span class="lineno">  223</span>                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> b = -dNy; b &lt;= +dNy; b++)</div>
<div class="line"><span class="lineno">  224</span>                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c = -dNz; c &lt;= +dNz; c++)</div>
<div class="line"><span class="lineno">  225</span>                        {</div>
<div class="line"><span class="lineno">  226</span>                            <span class="keywordflow">if</span> (condition(i+a,j+b,k+c))</div>
<div class="line"><span class="lineno">  227</span>                            {</div>
<div class="line"><span class="lineno">  228</span>                                tmpStencil[a+1][b+1][c+1] = Stencil[a+1][b+1][c+1]/WS;</div>
<div class="line"><span class="lineno">  229</span>                            }</div>
<div class="line"><span class="lineno">  230</span>                            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  231</span>                            {</div>
<div class="line"><span class="lineno">  232</span>                                tmpStencil[a+1][b+1][c+1] = Stencil[a+1][b+1][c+1];</div>
<div class="line"><span class="lineno">  233</span>                            }</div>
<div class="line"><span class="lineno">  234</span>                        }</div>
<div class="line"><span class="lineno">  235</span> </div>
<div class="line"><span class="lineno">  236</span>                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> a = -dNx; a &lt;= +dNx; a++)</div>
<div class="line"><span class="lineno">  237</span>                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> b = -dNy; b &lt;= +dNy; b++)</div>
<div class="line"><span class="lineno">  238</span>                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c = -dNz; c &lt;= +dNz; c++)</div>
<div class="line"><span class="lineno">  239</span>                        {</div>
<div class="line"><span class="lineno">  240</span>                            <span class="keywordflow">if</span>(condition(i+a,j+b,k+c))</div>
<div class="line"><span class="lineno">  241</span>                            {</div>
<div class="line"><span class="lineno">  242</span>                                FieldTmp(i,j,k) += Field(i+a,j+b,k+c) * tmpStencil[a+1][b+1][c+1];</div>
<div class="line"><span class="lineno">  243</span>                            }</div>
<div class="line"><span class="lineno">  244</span>                        }</div>
<div class="line"><span class="lineno">  245</span>            }</div>
<div class="line"><span class="lineno">  246</span>            <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  247</span>            <a class="code hl_define" href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a>(i,j,k,Field,0,)</div>
<div class="line"><span class="lineno">  248</span>            {</div>
<div class="line"><span class="lineno">  249</span>                Field(i,j,k) = FieldTmp(i,j,k);</div>
<div class="line"><span class="lineno">  250</span>            }</div>
<div class="line"><span class="lineno">  251</span>            <a class="code hl_define" href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div>
<div class="line"><span class="lineno">  252</span>        }</div>
<div class="line"><span class="lineno">  253</span>    }</div>
<div class="ttc" id="aMacros_8h_html_a62927f995b0bd1de2eba0c018173118a"><div class="ttname"><a href="../../df/d0a/Macros_8h.html#a62927f995b0bd1de2eba0c018173118a">OMP_PARALLEL_STORAGE_LOOP_BEGIN</a></div><div class="ttdeci">#define OMP_PARALLEL_STORAGE_LOOP_BEGIN(i, j, k, T__, op_loop_bcells__,...)</div><div class="ttdef"><b>Definition</b> <a href="../../df/d0a/Macros_8h_source.html#l00090">Macros.h:90</a></div></div>
<div class="ttc" id="aMacros_8h_html_aeb62b2001f34442764a83858492dcff3"><div class="ttname"><a href="../../df/d0a/Macros_8h.html#aeb62b2001f34442764a83858492dcff3">OMP_PARALLEL_STORAGE_LOOP_END</a></div><div class="ttdeci">#define OMP_PARALLEL_STORAGE_LOOP_END</div><div class="ttdef"><b>Definition</b> <a href="../../df/d0a/Macros_8h_source.html#l00112">Macros.h:112</a></div></div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../d2/d8f/Tools_8h_source.html">Tools.h</a></li>
<li><a class="el" href="../../dc/d48/Tools_8cpp_source.html">Tools.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Dec 17 2025 09:11:01 for OpenPhase by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
